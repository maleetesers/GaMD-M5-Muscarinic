1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 46b1     August 15, 2021            
                                Revision unknown                                
       Copyright(c) 1984-2020  President and Fellows of Harvard College
                              All Rights Reserved
      Current operating system: Linux-3.10.0-1160.45.1.el7.x86_64(x86_64)       
                 Created on  2/24/22 at  9:46:53 by user: apache      

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON FEB, 24. 2022. JOBID=4570103519
 RDTITL> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 3000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     3000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        50000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream toppar.str
 VOPEN> Attempting to open::toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON FEB, 24. 2022. JOBID=4570103519
 RDTITL> * STREAM FILE FOR TOPOLOGY AND PARAMETER READING
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! protein topology and parameter
 CHARMM>    open read card unit 10 name toppar/top_all36_prot.rtf
 VOPEN> Attempting to open::toppar/top_all36_prot.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_prot.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *>>>>>>>>CHARMM36 ALL-HYDROGEN TOPOLOGY FILE FOR PROTEINS <<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> MAY 2011 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36m_prot.prm
 VOPEN> Attempting to open::toppar/par_all36m_prot.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36m_prot.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *>>>> CHARMM36 ALL-HYDROGEN PARAMETER FILE FOR PROTEINS <<<<<<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! nucleic acids
 CHARMM>    open read card unit 10 name toppar/top_all36_na.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_na.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_na.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID TOPOLOGY FILE ////
 TITLE> *   ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                      APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *           PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_na.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_na.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_na.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID PARAMETER FILE ////
 TITLE> *         ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                        APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG PARAMETER
 TITLE> *                     SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! carbohydrates
 CHARMM>    open read card unit 10 name toppar/top_all36_carb.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_carb.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_carb.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * $ID: TOP_ALLXX_SUGAR.INP,V 1.106 2014/08/19 19:07:43 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN TOPOLOGIES USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_carb.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_carb.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_carb.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * $ID: PAR_ALLXX_SUGAR.INP,V 1.132 2014/08/19 19:03:21 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN PARAMETERS USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! lipids
 CHARMM>    open read card unit 10 name toppar/top_all36_lipid.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_lipid.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_lipid.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID TOPOLOGY FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_lipid.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_lipid.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_lipid.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID PARAMETER FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! CGENFF
 CHARMM>    open read card unit 10 name toppar/top_all36_cgenff.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_cgenff.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_cgenff.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *          CGENFF: TOPOLOGY FOR THE CHARMM GENERAL FORCE FIELD V. 4.6          *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_cgenff.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_cgenff.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_cgenff.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *         CGENFF: PARAMETERS FOR THE CHARMM GENERAL FORCE FIELD V. 4.6         *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *  2017/8: IF PROTEIN, NUCLEIC ACID AND CARBOHYDRATE TOPOLOGY AND PARAMETER FILES
 TITLE> *  ARE NOT READ PRIOR TO THE CGENFF FILES "WARNING: ATOMS IN NBFIX ' errors will
 TITLE> *  BE ENCOUNTERED.  THESE CAN BE PASSED BY SETTING BOMLEV ( -2) PRIOR TO READING
 TITLE> *  THIS FILE. IN ADDITION, WHEN GENERATING AROMATIC HALOGENS (CL, BR, I) WITH
 TITLE> *  PRE C41B/C42A VERSIONS OF CHARMM "MISSING PARAMETER" ERRORS WILL BE
 TITLE> *  ENCOUNTERED THAT ALSO REQUIRE SETTING BOMLEV ( -2).
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! Phosphates and Sulfates
 CHARMM>    stream toppar/toppar_all36_moreions.str
 VOPEN> Attempting to open::toppar/toppar_all36_moreions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_moreions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIONAL IONS GENERATED USING CGENFF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "345"
 Parameter: NAT <- "345"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "345"
 Parameter: NAT -> "345"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""345"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "345" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES GENERATED BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Interface FF
 CHARMM>    open read card unit 10 name toppar/top_interface.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_interface.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_interface.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY FOR NANOMATERIALS
 TITLE> *
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO17      -1.050
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO21      -1.050
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/par_interface.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_interface.prm::
 OPNLGU> Unit 10 opened for READONLY access to toppar/par_interface.prm
  
 CHARMM>    read para card unit 10 append flex

          PARAMETER FILE BEING READ FROM UNIT 10
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY AND PARAMETER FOR CALY MINERALS, CEMENT MINERALS
 TITLE> *
 PARRDR> Error: Repeated DIHE parameter ( 10950): HGR6  ICG1  ICG1  ICGE is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    stream toppar/toppar_all36_nano_lig.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR NANO-LIGAND
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_nano_lig_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for synthetic polymer
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_polymer_solvent.str
 VOPEN> Attempting to open::toppar/toppar_all36_polymer_solvent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_polymer_solvent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for water and ions
 CHARMM>    stream toppar/toppar_water_ions.str
 VOPEN> Attempting to open::toppar/toppar_water_ions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_water_ions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR WATER AND IONS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_water_ions.inp
 CHARMM>     
  
 CHARMM>    ! IMPORTANT NOTE: this file contains NBFixes between carboxylates and sodium,
 CHARMM>    ! which will only apply if the main files containing carboxylate atom types
 CHARMM>    ! have been read in first!
 CHARMM>     
  
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !TIP3P water model
 CHARMM>    !
 CHARMM>    !W.L. Jorgensen; J.Chandrasekhar; J.D. Madura; R.W. Impey;
 CHARMM>    !M.L. Klein; "Comparison of simple potential functions for
 CHARMM>    !simulating liquid water", J. Chem. Phys. 79 926-935 (1983).
 CHARMM>    !
 CHARMM>    !IONS
 CHARMM>    !
 CHARMM>    !Ions from Roux and coworkers
 CHARMM>    !
 CHARMM>    !Beglov, D. and Roux, B., Finite Representation of an Infinite
 CHARMM>    !Bulk System: Solvent Boundary Potential for Computer Simulations,
 CHARMM>    !Journal of Chemical Physics, 1994, 100: 9050-9063
 CHARMM>    !
 CHARMM>    !ZINC
 CHARMM>    !
 CHARMM>    !Stote, R.H. and Karplus, M. Zinc Binding in Proteins and
 CHARMM>    !Solution: A Simple but Accurate Nonbonded Representation, PROTEINS:
 CHARMM>    !Structure, Function, and Genetics 23:12-31 (1995)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "455"
 Parameter: NAT <- "455"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "455"
 Parameter: NAT -> "455"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""455"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "455" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR WATER AND IONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for sodium interacting with
 CHARMM>    ! carboxylate oxygens of various CHARMM force fields. It will generate
 CHARMM>    ! level -1 warnings whenever any of these force fields have not been
 CHARMM>    ! read prior to the current stream file. Since we don't want to force
 CHARMM>    ! the user to always read all the force fields, we're suppressing the
 CHARMM>    ! warnings. The only side effect is that you will have "most severe
 CHARMM>    ! warning was at level 0" at the end of your output. Also note that
 CHARMM>    ! the user is responsible for reading the current file last if they
 CHARMM>    ! want the NBFixes to apply. A more elegant solution would require new
 CHARMM>    ! features to be added to CHARMM.
 CHARMM>    ! parallel fix, to avoid duplicated messages in the log
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CARBOXYLATE AND SODIUM
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_dum_noble_gases.str
 VOPEN> Attempting to open::toppar/toppar_dum_noble_gases.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_dum_noble_gases.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_dum_nobel_gases.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous	toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "472"
 Parameter: NAT <- "472"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "472"
 Parameter: NAT -> "472"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""472"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "472" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_ions_won.str
 VOPEN> Attempting to open::toppar/toppar_ions_won.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_ions_won.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOP_IONS_WON.STR: GENERAL MODEL FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !This is a comprehensive set of ions developed using stochastic boundary
 CHARMM>    !conditions. It is strongly recommended that ion parameters in
 CHARMM>    !toppar_water_ions.str be used if available, as they are more highly
 CHARMM>    !optimized.  Accordingly, those ions have been commented in this
 CHARMM>    !file.
 CHARMM>    !
 CHARMM>    !reference
 CHARMM>    !Won, Y., "Force Field for Monovalent, Divalent, and Trivalent Cations
 CHARMM>    !Developed under the Solvent Boundary Potential," Journal of Physical
 CHARMM>    !Chemistry A., 116: 11763-11767, 2012.
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "475"
 Parameter: NAT <- "475"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "475"
 Parameter: NAT -> "475"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""475"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "475" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PAR_CATION.PRM FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for protein
 CHARMM>    stream toppar/toppar_all36_prot_arg0.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_arg0.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_arg0.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>> ALL-HYDROGEN TOPOLOGY FOR NEUTRAL ARG <<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> 2007 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Atom names include "R" (for Arg) as the second letter. The
 CHARMM>    ! only other atom types in the additive FF with this second
 CHARMM>    ! letter are histidine [HN]R[123] in the protein FF and CRL[12]
 CHARMM>    ! in toppar_all36_lipid_cholesterol.str , so no more conflicts.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.rtf
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_arg0.inp
 CHARMM>     
  
 CHARMM>    !Li, L., Vorobyov, I.V., MacKerell, Jr., A.D., Allen, T.W., "Is
 CHARMM>    !arginine charged in a membrane?" Biophysical Journal, 94: L11-L13,
 CHARMM>    !2008, PMCID: PMC2157258
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MGU1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU1          0.00
*** WARNING **** residue MGU2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU2          0.00
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_c36m_d_aminoacids.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_c36m_d_aminoacids.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_c36m_d_aminoacids.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>>CHARMM36 ALL-HYDROGEN TOPPAR FILE FOR D-PROTEINS <<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 RDTITL> *             PARAMETER SET DISCUSSION FORUM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !update 2016/2. use directly inverted CMAPs
 CHARMM>     
  
 CHARMM>    !toppar stream file for D-amino acids. Includes new residue
 CHARMM>    !names, inverted CMAP and additional parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36m_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_d_amino_acid.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "539"
 Parameter: NAT <- "539"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "539"
 Parameter: NAT -> "539"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""539"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "539" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR D- AMINOACIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR D- AMINOACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_fluoro_alkanes.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_fluoro_alkanes.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_fluoro_alkanes.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR FLUORINATED ALKANES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !These parameters are maintained for historic reasons.  The CGenFF
 CHARMM>    !halogen parameters are a significant improvement over these
 CHARMM>    !parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_fluoro_alkanes.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Chen, I.-J., Yin, D. and MacKerell, Jr., A.D., "Combined Ab
 CHARMM>    !initio/Empirical Approach for Optimization of Lennard-Jones Parameters
 CHARMM>    !for Polar-Neutral Compounds," Journal of Computational Chemistry,
 CHARMM>    !2002, 23:199-213.
 CHARMM>    !
 CHARMM>    !Note that these parameters are higly optimized to reproduce the
 CHARMM>    !corresponding condensed phase properties and have not been incorporated
 CHARMM>    !into the CHARMM22 or CHARMM27 biomolecular force fields
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR FLUOROALKANES
 RDTITL> *
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA  0.0
*** WARNING **** residue FETH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FETH  0.0
*** WARNING **** residue DFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DFET 0.0
*** WARNING **** residue TFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFET  0.0
*** WARNING **** residue TFE  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFE   0.0
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * FLUOROALKANE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_heme.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_heme.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_heme.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR HEME AND RELATED
 RDTITL> * LIGANDS AND PATCHES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !updated 2016/2, allow for use of AUTOGENERATE ANGLE DIHEDRAl PATCH
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_heme.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HEME AND RELATED COMPOUNDS AND PATCHES
 RDTITL> *
*** WARNING **** residue CO2  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO2             0.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR HEME
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_na_combined.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_na_combined.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_na_combined.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR PATCHES TO CREATE
 RDTITL> * MODEL COMPOUNDS AND PATCHES THAT REQUIRE BOTH PROTEIN AND
 RDTITL> * NUCLEIC ACID TOPOLOGY AND PARAMETER INFORMATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>    !stream/toppar_all36_prot_fluoro_alkanes.str ! atom types an parameters for fluorinated compounds
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_na_combined.inp
 CHARMM>     
  
 CHARMM>    !all patches must be followed by AUTOGENERATE ANGLES DIHEDRALS
 CHARMM>     
  
 CHARMM>    !PHOSPHOTYROSINE
 CHARMM>    !
 CHARMM>    !Feng, M.-H., Philippopoulos, M., MacKerell, Jr., A.D. and Lim, C.
 CHARMM>    !Structural Characterization of the Phosphotyrosine Binding Region of a
 CHARMM>    !High-Affinity aSH2 Domain-Phosphopeptide Complex by Molecular Dynamics
 CHARMM>    !Simulation and Chemical Shift Calculations. Journal of the American
 CHARMM>    !Chemical Society, 1996, 118: 11265-11277.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
*** WARNING **** residue THFI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFI       0.00
*** WARNING **** residue THMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THMI       0.00
*** WARNING **** residue THFA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFA        0.00
*** WARNING **** residue THAO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THAO         0.00
*** WARNING **** residue RNUS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RNUS         0.00
*** WARNING **** residue NUCL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NUCL        -1.00
*** WARNING **** residue PPH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPH1      -1.00
*** WARNING **** residue BMPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPH      -1.00
*** WARNING **** residue BMPD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPD      -2.00
*** WARNING **** residue BDFP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFP      -1.00
*** WARNING **** residue BDFD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFD -2.00
*** WARNING **** residue EP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EP_2        -2.00
*** WARNING **** residue IP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IP_2        -2.00
 There were  13 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_retinol.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_retinol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_retinol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR RETINOL AND RETINAL PARAMETERS
 RDTITL> * A. LOCCISANO, A.M.W., J. EVANSECK AND A.D. MACKERELL, JR.
 RDTITL> * APRIL, 2005
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !use with c36 protein force fields
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * RETINAL/RETINOL AND RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue 13DB already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DB       0.00
*** WARNING **** residue 13DP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DP       0.00
*** WARNING **** residue DMB1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMB1       0.00
*** WARNING **** residue DMP1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP1       0.00
*** WARNING **** residue DMP2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP2       0.00
*** WARNING **** residue CROT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CROT       0.00
*** WARNING **** residue PACP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PACP       0.00
*** WARNING **** residue MECH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MECH       0.00
*** WARNING **** residue TMCH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TMCH       0.00
*** WARNING **** residue FRET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FRET       0.00
*** WARNING **** residue RTOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTOL       0.00
*** WARNING **** residue RTAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAL       0.00
*** WARNING **** residue RTAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAC      -1.00
*** WARNING **** residue PRAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAC      -1.00
*** WARNING **** residue PROL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROL       0.00
*** WARNING **** residue PRAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAL       0.00
*** WARNING **** residue SCH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH1       0.00
*** WARNING **** residue SCH2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH2       1.00
*** WARNING **** residue SCH3 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH3       1.00
 There were  20 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * RETINAL/RETINOL AND RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>> ALL-HYDROGEN TOPOLOGY FOR SMALL MODEL COMPOUNDS USED IN THE <<
 RDTITL> *>> DEVELOPMENT OF THE CHARMM22 PROTEIN ALL-HYDROGEN PARAMETERS <<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> JULY 1997 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *CONVERTED TO STREAM FORMAT, DECEMBER 2003
 RDTITL> *CONVERTED TO CHARMM36 PROTEIN ATOM TYPES, MAY 2011
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_model.inp
 CHARMM>     
  
 CHARMM>    !changes after 9/98
 CHARMM>    !
 CHARMM>    !change alkene HA1 and HA2 to HE1 and HE2
 CHARMM>    !
 CHARMM>    !improper atom ordering corrected
 CHARMM>    !
 CHARMM>    !version b5i to be consistent with protein toppar files
 CHARMM>    !
 CHARMM>    !Heme vinyl groups upgraded based on new butene parameters
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    ! references
 CHARMM>    !
 CHARMM>    !PROTEINS
 CHARMM>    !
 CHARMM>    !MacKerell, Jr., A. D.; Bashford, D.; Bellott, M.; Dunbrack Jr., R.L.;
 CHARMM>    !Evanseck, J.D.; Field, M.J.; Fischer, S.; Gao, J.; Guo, H.; Ha, S.;
 CHARMM>    !Joseph-McCarthy, D.; Kuchnir, L.; Kuczera, K.; Lau, F.T.K.; Mattos,
 CHARMM>    !C.; Michnick, S.; Ngo, T.; Nguyen, D.T.; Prodhom, B.; Reiher, III,
 CHARMM>    !W.E.; Roux, B.; Schlenkrich, M.; Smith, J.C.; Stote, R.; Straub, J.;
 CHARMM>    !Watanabe, M.; Wiorkiewicz-Kuczera, J.; Yin, D.; Karplus, M.  All-atom
 CHARMM>    !empirical potential for molecular modeling and dynamics Studies of
 CHARMM>    !proteins.  Journal of Physical Chemistry B, 1998, 102, 3586-3616.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue ACET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACET       -1.00
*** WARNING **** residue PROA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROA       -1.00
*** WARNING **** residue GUAN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GUAN        1.00
*** WARNING **** residue MGUA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGUA        1.00
*** WARNING **** residue GLYN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYN         0.00
*** WARNING **** residue MAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAMM        1.00
*** WARNING **** residue EAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EAMM        1.00
*** WARNING **** residue ACEH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEH        0.00
*** WARNING **** residue MEOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MEOH        0.00
*** WARNING **** residue METO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI METO       -1.00
*** WARNING **** residue ETOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETOH        0.00
*** WARNING **** residue ETO  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETO        -1.00
*** WARNING **** residue PRO2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRO2        0.00
*** WARNING **** residue FORM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FORM        0.00
*** WARNING **** residue ACEM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEM        0.00
*** WARNING **** residue NMA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NMA         0.00
*** WARNING **** residue MESH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MESH        0.00
*** WARNING **** residue MES1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MES1       -1.00
*** WARNING **** residue ETSH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETSH        0.00
*** WARNING **** residue ES1  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ES1        -1.00
*** WARNING **** residue DMDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMDS        0.00
*** WARNING **** residue DEDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DEDS        0.00
*** WARNING **** residue EMS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EMS         0.00
*** WARNING **** residue IMIA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIA        0.00
*** WARNING **** residue MIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MIMI        0.00
*** WARNING **** residue EIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMI        0.00
*** WARNING **** residue IMIM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIM        1.00
*** WARNING **** residue EIMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMM        1.00
*** WARNING **** residue BENZ already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BENZ        0.00
*** WARNING **** residue EBEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EBEN         0.00
*** WARNING **** residue PHEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEN        0.00
*** WARNING **** residue EPHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EPHE        0.00
*** WARNING **** residue PHEO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEO       -1.00
*** WARNING **** residue INDO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI INDO        0.00
*** WARNING **** residue EIND already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIND        0.00
*** WARNING **** residue PDIP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PDIP        0.00
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA        0.00
*** WARNING **** residue PRPA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPA        0.00
*** WARNING **** residue IBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IBUT        0.00
*** WARNING **** residue OCOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI OCOH    0.0
*** WARNING **** residue CO3  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO3  -2.0
*** WARNING **** residue C3   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI C3    0.00
 There were  42 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_modify_res.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_modify_res.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_modify_res.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR FILE FOR VARIOUS MODIFIED RESIDUES AND PATCHES, INCLUDING
 RDTITL> * PATCHES TO COVALENTLY LINK RESIDUES TO IONS TO WORK WITH THE
 RDTITL> * ADDITIVE C36 PROTEIN FORCE FIELD
 RDTITL> * REQUIRES CGENFF PARAMETER FILE
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Acetyllysine (ALY)
 CHARMM>    !Norleucine (NLE) and
 CHARMM>    ! residues and patches for Zn-protein interactions modeled using
 CHARMM>    ! bond and angles between the protein and Zn.
 CHARMM>     
  
 CHARMM>    !non-standard amino acids: 2021
 CHARMM>    !Croitoru, A., Park, S.-J., Kumar, A., Lee, J., Im, Wonpil; MacKerell,
 CHARMM>    !A.D., Jr., and Aleksandrov, A. Additive CHARMM36 Force Field for
 CHARMM>    !Nonstandard Amino Acids, Journal of Chemical Theory and Computation,
 CHARMM>    !17:3554-3570, doi: 10.1021/acs.jctc.1c00254.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPPAR FILE PROTEIN MODIFICATIONS
 RDTITL> *
*** WARNING **** residue CGU  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGU              -2.000
*** WARNING **** residue CME  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CME               0.000
*** WARNING **** residue HIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HIC               0.000
*** WARNING **** residue HICP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HICP              1.000
*** WARNING **** residue CGUP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGUP             -1.000
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for nucleic acids
 CHARMM>    stream toppar/toppar_all36_na_nad_ppi.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_nad_ppi.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_nad_ppi.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN NUCLEIC ACID FORCE TOPPAR STREAM FILE
 RDTITL> * NAD+, NADH, ADP, ATP, PPI AND RELATED ANALOGS
 RDTITL> * A.D. MACKERELL, JR., JULY 2001
 RDTITL> * STREAM FOLLOWING RTF AND PARAM READ OF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Update, 2015/1, nomenclature for NAD+ etc. consistent with PDB
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_na_nad_ppi.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Pavelites, J.J., Bash, P.A., Gao, J., and MacKerell, Jr.,
 CHARMM>    !A.D. A Molecular Mechanics Force Field for NAD+, NADH and the
 CHARMM>    !Pyrophosphate Groups of Nucleotides, Journal of Computational
 CHARMM>    !Chemistry, 1997, 18: 221-239.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * NAD, PPI TOPOLOGY
 RDTITL> *
*** WARNING **** residue NIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NIC         1.00
*** WARNING **** residue NICH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NICH         0.00
*** WARNING **** residue PPI1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI1        -3.00
*** WARNING **** residue PPI2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI2        -2.00
*** WARNING **** residue AMP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI AMP         -2.00
*** WARNING **** residue ADP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ADP         -3.00
*** WARNING **** residue ATP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ATP         -4.00
*** WARNING **** residue 5DP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES 5DP         -3.00
*** WARNING **** residue NAD  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NAD         -1.00
*** WARNING **** residue NADH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADH        -2.00
*** WARNING **** residue NADP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADP        -2.00
*** WARNING **** residue NDPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NDPH        -3.00
 There were  12 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NAD, PPI PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_na_rna_modified.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_rna_modified.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_rna_modified.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIVE CHARMM FORCE FIELD FOR MODIFIED RIBONUCLEIC ACIDS, INCLUDING
 RDTITL> * THOSE FOUNDS IN TRNA. YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> * |
 RDTITL> * WARNING: PARAMETERS AND ATOM TYPE ASSIGNMENTS IN THIS FILE ARE SPECIFIC
 RDTITL> * FOR THESE COMPOUNDS AND SHOULD UNDER NO CIRCUMSTANCES BE APPLIED TO
 RDTITL> * OTHER ORGANIC MOLECULES
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Xu, Y., Vanommeslaeghe, K., Aleksandrov, A., MacKerell, A.D.,
 CHARMM>    ! Jr. Nilsson, L., Additive CHARMM force field for naturally
 CHARMM>    ! occurring modified ribonucleotides, Journal of Computational
 CHARMM>    !  Chemistry, DOI: 10.1002/jcc.24307, 2016
 CHARMM>     
  
 CHARMM>    ! Should be used with parent files CGenFF: top_all36_cgenff.inp and par_all36_cgenff.inp
 CHARMM>    !                                    NA36: top_all36_na.inp and par_all36_na.inp
 CHARMM>    !                              and Carb36: top_all36_carb.inp and par_all36_carb.inp
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES OF MODIFIED NUCLEOTIDES
 RDTITL> *
*** WARNING **** residue BUG  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUG           -1.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIVE CHARMM PARAMETERS FOR MODIFIED NUCLEIC ACIDS, BETA VERSION
 RDTITL> * YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for lipids
 CHARMM>    stream toppar/toppar_all36_lipid_sphingo.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_sphingo.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_sphingo.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FOR CERAMIDES AND SPINGOMYELINS; REQUIRES FLEX FORMAT FILES
 RDTITL> * TOP_ALL36_LIPID.RTF AND PAR_ALL36_LIPID.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! PSM and SSM Lipids
 CHARMM>    !
 CHARMM>    ! Venable, R. M.; Sodt, A. J.; Rogaski, B.; Rui, H.; Hatcher, E.; MacKerell, A. D.;
 CHARMM>    ! Pastor, R. W.; Klauda, J. B., CHARMM All-Atom Additive Force Field for Sphingomyelin:
 CHARMM>    ! Elucidation of Hydrogen Bonding and of Positive Curvature. Biophys. J. 2014, 107 (1), 134-145
 CHARMM>    !
 CHARMM>    ! Ceramide
 CHARMM>    !
 CHARMM>    ! Submited by Sam Tonddast-Navaei of U. Cincinnati. Advised by Russell Devane
 CHARMM>    ! Tested by Eric Wang of U. Maryland. Advised by Jeffery Klauda
 CHARMM>    !
 CHARMM>    !
 CHARMM>    ! CerAP/Cer6, CerNP/Cer3, and CerEOS/Cer1
 CHARMM>    !
 CHARMM>    ! Wang, E.; Klauda, J. B., Structure and Permeability of Ceramide Bilayers and Multilayers.
 CHARMM>    ! J. Phys. Chem. B., 2019, 123, 11, 2525-2535
 CHARMM>    ! Wang, E.; Klauda, J. B., Molecular Structure of the Long Periodicity Phase in the Stratum Corneum.
 CHARMM>    ! J. Amer. Chem. Soc., 2019. 141, 42, 16930-16943
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "570"
 Parameter: NAT <- "570"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "570"
 Parameter: NAT -> "570"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""570"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "570" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CER/SM RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 14695): NHL   C     CTO1  HAL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 14716): O     C     CTO1  HAL1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_archaeal.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_archaeal.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_archaeal.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR ARCHAEAL LIPIDS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! This is an on-going file of archaeal lipids
 CHARMM>    ! I am adding meanquinone-7 now
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * ARCHAEAL LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY CGENFF
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_bacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_bacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_bacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! Branched Lipids
 CHARMM>    !
 CHARMM>    ! Lim, J.B. & Klauda, J.B. Branching at the Iso- and Anteiso- Positions in Complex Chlamydia
 CHARMM>    ! Membranes: A Molecular Dynamics Study. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1808:323-331 (2011).
 CHARMM>    !
 CHARMM>    ! Cyclic-replacement of double bond
 CHARMM>    !
 CHARMM>    ! Pandit, K.R. & Klauda, J.B. Membrane models of E. coli containing cyclic moieties in
 CHARMM>    ! the aliphatic lipid chain. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1818:1205-1210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cardiolipin.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cardiolipin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cardiolipin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL>  
 RDTITL> No title read.
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cholesterol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cholesterol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cholesterol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR CHOLESTEROL.  STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> * TOP_ALL36_CGENFF.RTF
 RDTITL> * AND PAR_ALL36_CGENFF.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !topology and parameters are included for two cholesterol models. the
 CHARMM>    !model may be selected by setting variable chol_model to 1 or 2, as
 CHARMM>    !specified below
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set chol_model 1 !2 for original Suits et al. model
 Parameter: CHOL_MODEL <- "1"
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    !1) Revised model of Lim et al.  This contains a number of NBFIXes that
 CHARMM>    !makes it unsuitable for ANTON (set chol_model 1)
 CHARMM>    !
 CHARMM>    !2) Original model of Suits et al., which is used on ANTON as well as
 CHARMM>    !being suitable for other systems (set chol_model 2 (or anything but 1....))
 CHARMM>    !
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    !Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>    !Suits, F., Pitman, M., MacKerell, A.D., Jr., Feller, S.E. "Molecular Level
 CHARMM>    !Organization of Saturated and Polyunsaturated Fatty Acids in a
 CHARMM>    !Phosphatidylcholine Bilayer Containing Cholesterol" Biochemistry,
 CHARMM>    !43(49):15318-28, 2004
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    !test "append"
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    if chol_model eq 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>    ! reference
 CHARMM>    ! Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    ! Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR CHOLESTEROL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CHOLESTEROL PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_dag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_dag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_dag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM DAG
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_inositol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_inositol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_inositol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lnp.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lnp.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lnp.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LNP
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
 **** WARNING from RTFRDR **** The total charge of the residue, DAGP,  -0.0100000,
 does not equal the expected charge,   0.0000000.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
          PRES DPEPEG
 **** WARNING from RTFRDR **** The total charge of the residue, DPEP,  -0.0100000,
 does not equal the expected charge,   0.0000000.
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * LNP
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lps.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lps.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lps.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM LPS
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read param card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_mycobacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_mycobacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_mycobacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MYCOBACTERIAL (ACPIM2) RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_miscellaneous.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_miscellaneous.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_miscellaneous.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR MISCELLANEOUS LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETER FOR ACYL PYROPHOSPHATE: ADDED 2019_7
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN LIPID FORCE FIELD TOPPAR STREAM FILE
 RDTITL> * COLLECTION OF RESIDUES AND PATCHES FOR MODEL COMPOUNDS USED
 RDTITL> * IN THE OPTIMIZATION THE LIPID FORCE FIELD.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_lipid_model.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 LIPID MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MAS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAS          0.00
*** WARNING **** residue ETAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAC         0.00
*** WARNING **** residue MPRO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MPRO         0.00
*** WARNING **** residue MP_1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_1        -1.00
*** WARNING **** residue MP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_2        -2.00
*** WARNING **** residue MSO4 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MSO4        -1.00
*** WARNING **** residue BUTA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUTA         0.00
*** WARNING **** residue PENT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PENT         0.00
*** WARNING **** residue HEXA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HEXA         0.00
*** WARNING **** residue ETHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHE       0.00
*** WARNING **** residue PRPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPE       0.00
*** WARNING **** residue BTE1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE1       0.00
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue DIPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIPE       0.00
*** WARNING **** residue DIHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIHE       0.00
*** WARNING **** residue NC4  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC4          1.00
*** WARNING **** residue NC5  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC5          1.00
*** WARNING **** residue CHOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CHOL         1.00
*** WARNING **** residue ACHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACHO         1.00
*** WARNING **** residue PC   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PC           0.00
*** WARNING **** residue GPC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GPC          0.00
*** WARNING **** residue TEA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TEA          1.00
*** WARNING **** residue ETAM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAM       1.00
*** WARNING **** residue GLYC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYC         0.00
*** WARNING **** residue MBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MBUT         0.00
 There were  25 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_prot.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_prot.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_prot.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR LIPID TAIL LINKERS TO CYSTEINE AND GLYCINE,
 RDTITL> * FOR EXAMPLE, PALMITOYLATION, MARISTOYLATION, FERNASYLATION, GERANYLATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LIPID-MODIFIED PROTEIN RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CYSTEIN-PALMITATE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_tag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_tag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_tag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TRIACYLGLYCEROLS [STEPHEN GEE FROM LEHIGH UNIVERSITY]
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_yeast.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_yeast.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_yeast.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_hmmm.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_hmmm.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_hmmm.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TERMINAL PATCHES FOR HMMM TRUNCATED LIPIDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_detergent.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_detergent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_detergent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR DETERGENTS AND FATTY ACIDS.
 RDTITL> * STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Additional residues added by Im lab, Aug. 2017
 CHARMM>     
  
 CHARMM>    !Fatty acids added Jan. 2016
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * DETERGENT AND FATTY ACID RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SB3-12 AND SB3-14 PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_ether.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_ether.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_ether.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN ETHER LIPID FORCE FIELD INCLUDING PLASMALOGENS ALISON
 RDTITL> * N. LEONARD (A. L.), 7/18 WITH RICHARD PASTOR AND JEFFERY KLAUDA, JPCB 122(26)
 RDTITL> * PP. 6744 - 6754.  ANA WEST, 1/20 WITH VALERIA ZONI, WALTER TEAGUE JR., ALISON
 RDTITL> * LEONARD, STEFANO VANNI, KLAUS GAWRISCH, STEPHANIE TRISTAM-NAGLE, JONATHAN
 RDTITL> * SACHS, AND JEFFERY KLAUDA, JPCB 124(5) PP. 828 - 839.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>    !top_all36_cgenff.rtf
 CHARMM>    !par_all36_cgenff.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 ETHER MODEL COMPOUNDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for carbohydrates
 CHARMM>    stream toppar/toppar_all36_carb_glycolipid.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycolipid.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycolipid.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOLIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PIP RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_glycopeptide.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycopeptide.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycopeptide.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOPEPTIDE LINKAGES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_imlab.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_imlab.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_imlab.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for spin/fluorophore labels
 CHARMM>    stream toppar/toppar_all36_label_spin.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_spin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_spin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>> TOPOLOGY FOR NITROXYDE SPIN LABELS <<<<<<<
 RDTITL> * SHAHIDUL M. ISLAM, UNIVERSITY OF CHICAGO
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! please reference the following:
 CHARMM>    !Sezer, D., Freed J. H., and Roux, B. Parametrization, Molecular Dynamics Simulation, and Calculation of Electron Spin
 CHARMM>    !Resonance Spectra of a Nitroxide Spin Label on a Polyalanine alpha-Helix J. Phys. Chem. B 2008, 112, 5755-5767
 CHARMM>     
  
 CHARMM>    !Islam, S. M., and Roux, B. Parameterization and molecular dynamics simulations of a
 CHARMM>    !conformationally constrained double linked spin label constrained by EPR/DEER data
 CHARMM>    !(planed submission to J journal)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "575"
 Parameter: NAT <- "575"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "575"
 Parameter: NAT -> "575"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""575"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "575" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SPIN LABEL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR SPIN LABEL
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_label_fluorophore.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_fluorophore.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_fluorophore.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FILES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MINI FORCE FIELD PARAMETER FILE.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    ! Read PSF and Coordinates
 CHARMM>    open read unit 10 card name step1_pdbreader.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step1_pdbreader.psf::
 OPNLGU> Unit 10 opened for READONLY access to step1_pdbreader.psf
  
 CHARMM>    read psf  unit 10 card
 MAINIO> Protein structure file being read from unit  10.
 PSFRD2> Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON FEB, 24. 2022. JOB
 TITLE>  * READ PDB, MANIPULATE STRUCTURE IF NEEDED, AND GENERATE TOPOLOGY FILE
 TITLE>  *  DATE:     2/24/22      6:15:14      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      486
         Number of atoms         =     7759   Number of groups     =     2309
         Number of bonds         =     7851   Number of angles     =    14229
         Number of dihedrals     =    20913   Number of impropers  =     1255
         Number of cross-terms   =      484
         Number of HB acceptors  =      699   Number of HB donors  =      889
         Number of NB exclusions =        0   Total charge =   23.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step2_orient.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step2_orient.crd::
 OPNLGU> Unit 10 opened for READONLY access to step2_orient.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * CALC TOPAREA = 1018.46492
 TITLE> * CALC BOTAREA = 1340.93861
 TITLE> * CALC XMAX = 21.0915479
 TITLE> * CALC XMIN = -26.4785682
 TITLE> * CALC YMAX = 44.8568547
 TITLE> * CALC YMIN = -30.8954737
 TITLE> * CALC ZMAX = 52.6146141
 TITLE> * CALC ZMIN = -45.5801239
 TITLE> *  DATE:     2/24/22      6:16:20      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    define PROT sele all end
 SELRPN>   7759 atoms have been selected out of   7759
  
 CHARMM>     
  
 CHARMM>    !Read the system information
 CHARMM>    stream step3_size.str
 VOPEN> Attempting to open::step3_size.str::
 OPNLGU> Unit 99 opened for READONLY access to step3_size.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE  = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE  = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET XTLTYPE  = TETRAGONAL
 Parameter: XTLTYPE <- "TETRAGONAL"
  
 CHARMM>     SET A        = 90.067469
 Parameter: A <- "90.067469"
  
 CHARMM>     SET B        = 90.067469
 Parameter: B <- "90.067469"
  
 CHARMM>     SET C        = 143.194738
 Parameter: C <- "143.194738"
  
 CHARMM>     SET ALPHA    = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA     = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA    = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET ZCEN     = 3.5172451
 Parameter: ZCEN <- "3.5172451"
  
 CHARMM>     SET NLIPTOP  = 104
 Parameter: NLIPTOP <- "104"
  
 CHARMM>     SET NLIPBOT  = 99
 Parameter: NLIPBOT <- "99"
  
 CHARMM>     SET WBOXZ    = 22.5
 Parameter: WBOXZ <- "22.5"
  
 CHARMM>     SET WATBOXZ  = 55.1146141
 Parameter: WATBOXZ <- "55.1146141"
  
 CHARMM>     SET NCHARGE  = 23
 Parameter: NCHARGE <- "23"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream step4_components.str
 VOPEN> Attempting to open::step4_components.str::
 OPNLGU> Unit 99 opened for READONLY access to step4_components.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET NWATER = 0
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET NWATER = 0
 Parameter: NWATER <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    if islconj .eq. YES stream step3_lipid_conjugate.str
 Comparing "ISLCONJ" and "YES".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    ! Read Lipids
 CHARMM>    open read unit 10 card name step4_lipid_lipid.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.psf::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.psf
  
 CHARMM>    read psf  unit 10 card append
 MAINIO> Protein structure file being read from unit  10.
 PSFRD2> Reading PSF in the expanded format.
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON FEB, 24. 2022. JOB
 TITLE>  * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE>  *  DATE:     2/24/22      9:46: 6      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =      689
         Number of atoms         =    34961   Number of groups     =     9211
         Number of bonds         =    34850   Number of angles     =    66197
         Number of dihedrals     =    93181   Number of impropers  =     1661
         Number of cross-terms   =      484
         Number of HB acceptors  =      699   Number of HB donors  =      889
         Number of NB exclusions =        0   Total charge =   23.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4_lipid_lipid.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4_lipid_lipid.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4_lipid_lipid.crd
  
 CHARMM>    read coor unit 10 card append
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 A RESIDUE OFFSET OF 486 WILL BE USED.
 INFO: A subset of total atoms will be read.

 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON FEB, 24. 2022. JOB
 TITLE> * GET A DIFFERENT CONFORMATION FOR LIPIDS PENETRATING PROTEIN / CHOL
 TITLE> *  DATE:     2/24/22      9:46: 6      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    ! Write coordinates
 CHARMM>    open write unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for WRITE access to step4.3_ion_protmemb.crd
  
 CHARMM>    write coor unit 10 card
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    define LPSION sele none end
 SELRPN>      0 atoms have been selected out of  34961
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions
 CHARMM>    ! nneg    : number of negative ions
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set zmemb =  20.0           ! ion exclusion membrane region
 Parameter: ZMEMB <- "20.0"
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR     34961 SELECTED ATOMS:
    XMIN =  -49.463450 XMAX =   51.189517 XAVE =    0.322398
    YMIN =  -51.724346 YMAX =   49.762554 YAVE =    0.274095
    ZMIN =  -46.383688 ZMAX =   53.488665 ZAVE =    0.182594
    WMIN =    0.000000 WMAX =    0.099420 WAVE =    0.000011
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "51.1895169"
 RDCMND substituted energy or value "?XMIN" to "-49.46345"
Evaluating: INT((51.1895169--49.46345+5.0)/0.5)+1
 Parameter: XDIM <- "212"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "49.7625542"
 RDCMND substituted energy or value "?YMIN" to "-51.7243462"
Evaluating: INT((49.7625542--51.7243462+5.0)/0.5)+1
 Parameter: YDIM <- "213"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "53.4886648"
 RDCMND substituted energy or value "?ZMIN" to "-46.3836876"
Evaluating: INT((53.4886648--46.3836876+5.0)/0.5)+1
 Parameter: ZDIM <- "210"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "212"
 Parameter: YDIM -> "213"
 Parameter: ZDIM -> "210"
Evaluating: 212*213*210
 Parameter: SPACE <- "9482760"
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname TIP3 end
 Parameter: SPACE -> "9482760"
 SELRPN>  34961 atoms have been selected out of  34961
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=    -52.2854 XMAX=     53.9295 NX= 212
   YMIN=    -54.4643 YMAX=     52.5695 NY= 213
   ZMIN=    -48.8301 ZMAX=     55.8646 NZ= 209


 A TOTAL OF    31368   VACUUM POINTS WERE FOUND
 A TOTAL OF  3425674 OCCUPIED POINTS WERE FOUND
 A TOTAL OF  5980562 EXTERNAL POINTS WERE FOUND
 A TOTAL OF  9406236 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =  432032.127386
 TOTAL SELECTED  VOLUME = 1186276.379416
 TOTAL FREE      VOLUME =    3956.005087
 FRACTIONAL FREE VOLUME =       0.907365
  
 CHARMM>     
  
 CHARMM>    set sysvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "432032.127"
 Parameter: SYSVOL <- "432032.127"
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .ne. HEXA then
 Comparing "RECT" and "HEXA".
 IF test evaluated as true.  Performing command
  
 CHARMM>       calc volumn = ( @A * @B * @C ) - @sysvol
 Parameter: A -> "90.067469"
 Parameter: B -> "90.067469"
 Parameter: C -> "143.194738"
 Parameter: SYSVOL -> "432032.127"
Evaluating: (90.067469*90.067469*143.194738)-432032.127
 Parameter: VOLUMN <- "729584.92"
  
 CHARMM>    ENDIF
  
 CHARMM>     
  
 CHARMM>    IF BOXTYPE .eq. HEXA THEN
 Comparing "RECT" and "HEXA".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    if @?nlipaion  .eq. 0 set nlipaion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NLIPAION <- "0"
  
 CHARMM>    if @?ncoreion  .eq. 0 set ncoreion  = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NCOREION <- "0"
  
 CHARMM>    if @?noantiion .eq. 0 set noantiion = 0
 Comparing "0" and "0".
 IF test evaluated as true.  Performing command
 Parameter: NOANTIION <- "0"
  
 CHARMM>     
  
 CHARMM>    calc npostot = @nlipaion + @ncoreion + @noantiion
 Parameter: NLIPAION -> "0"
 Parameter: NCOREION -> "0"
 Parameter: NOANTIION -> "0"
Evaluating: 0+0+0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = @npostot
 Parameter: NPOSTOT -> "0"
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of  34961
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of  34961
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of  34961
  
 CHARMM>     
  
 CHARMM>        stream step2.2_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step2.2_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to step2.2_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = SOD
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "SOD"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CLA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CLA"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0.15
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0.15"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "23"
Evaluating: INT(23)
 Parameter: NCHARGE <- "23"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "23"
Evaluating: 23
 Parameter: CGTOT <- "23"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "23"
 Parameter: POSCHARGE -> "1"
 Comparing "23" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "23"
 Parameter: NEGCHARGE -> "1"
 Comparing "23" and "0".
 IF test evaluated as true.  Performing command
Evaluating: INT(ABS(23)/1)
 Parameter: NNEG <- "23"
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "23"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "23"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(23+0*1-23*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "23"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff   = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "23"
 Parameter: NPOS -> "0"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "23"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(23+0*1-23*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "0"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "729584.92"
 Parameter: NEGVAL -> "1"
Evaluating: 0+INT(0.15*6.021*0.0001*729584.92)*1
 Parameter: NPOS <- "65"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "23"
 Parameter: CONC -> "0.15"
 Parameter: VOLUMN -> "729584.92"
 Parameter: POSVAL -> "1"
Evaluating: 23+INT(0.15*6.021*0.0001*729584.92)*1
 Parameter: NNEG <- "88"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "65" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "88" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "65" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "SOD"
 Parameter: NPOS -> "65"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 GENPSF> Segment   3 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =      754
         Number of atoms         =    35026   Number of groups     =     9276
         Number of bonds         =    34850   Number of angles     =    66197
         Number of dihedrals     =    93181   Number of impropers  =     1661
         Number of cross-terms   =      484
         Number of HB acceptors  =      699   Number of HB donors  =      889
         Number of NB exclusions =        0   Total charge =   88.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     65 atoms have been selected out of  35026
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele POS end
 SELRPN>     65 atoms have been selected out of  35026
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "88" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isuseranion .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @neg @nneg
 Parameter: NEG -> "CLA"
 Parameter: NNEG -> "88"
  
 CHARMM>                generate NEG warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 GENPSF> Segment   4 has been generated. Its identifier is NEG.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        4   Number of residues   =      842
         Number of atoms         =    35114   Number of groups     =     9364
         Number of bonds         =    34850   Number of angles     =    66197
         Number of dihedrals     =    93181   Number of impropers  =     1661
         Number of cross-terms   =      484
         Number of HB acceptors  =      699   Number of HB donors  =      889
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     88 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            if natomneg .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                ! move ion to origin
  
 CHARMM>                coor set sele NEG end
 SELRPN>     88 atoms have been selected out of  35114
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>    153 atoms have been selected out of  35114
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>    153 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "65"
 Parameter: NNEG -> "88"
Evaluating: 65+88
 Parameter: NION <- "153"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "65"
 Parameter: NPOSTOT <- "65"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "88"
 Parameter: NNEGTOT <- "88"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "153"
 Parameter: NIONTOT <- "153"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "153" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        !
  
 CHARMM>        !Images Setup [to place all atoms inside the box]
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        open read unit 10 card name crystal_image.str
 VOPEN> Attempting to open::crystal_image.str::
 OPNLGU> Unit 10 opened for READONLY access to crystal_image.str
  
 CHARMM>        CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
 Parameter: XTLTYPE -> "TETRAGONAL"
 Parameter: A -> "90.067469"
 Parameter: B -> "90.067469"
 Parameter: C -> "143.194738"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
 Crystal Parameters : Crystal Type = TETR
           A     =   90.06747 B    =   90.06747 C     =  143.19474
           Alpha =   90.00000 Beta =   90.00000 Gamma =   90.00000
  
 CHARMM>        CRYSTAL READ UNIT 10 CARD
 CRYSTAL FILE BEING READ FROM UNIT    10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON FEB, 24. 2022. JOBID=4570103519
 TITLE> * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE> *
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON FEB, 24. 2022. JOB
 TITLE>  * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE>  *
                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
    26 Transformations have been processed.

  
 CHARMM>     
  
 CHARMM>        !Image centering by residue
  
 CHARMM>        IMAGE BYRES XCEN 0.0 YCEN 0.0 ZCEN @zcen
 Parameter: ZCEN -> "3.5172451"
 IMAGE CENTERING ON FOR SOME ATOMS
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000  3.517245
 RESIDUE  566 OPERATED ON BY TRANSFORMATION C008
 RESIDUE  587 OPERATED ON BY TRANSFORMATION C011
 RESIDUE  689 OPERATED ON BY TRANSFORMATION C008

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  C001 has       0       0       0       65.73
    2  C002 has       0       0       0       52.74
    3  C003 has       0       0       0       61.78
    4  C004 has       0       0       0       60.69
    5  C005 has       0       0       0       43.32
    6  C006 has       0       0       0       53.97
    7  C007 has     893     231      12        0.00
    8  C008 has    5728    1435      53        0.00
    9  C009 has     648     151       8        0.00
   10  C010 has    6113    1532      64        0.00
   12  C012 has       0       0       0       57.03
   13  C013 has       0       0       0       54.18
   14  C014 has       0       0       0       56.99
 Total of48496 atoms and12713 groups and  979 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>     
  
 CHARMM>        CONS FIX SELE .NOT. ( POS .OR. NEG ) END
 SELRPN>  34961 atoms have been selected out of  35114
  
 CHARMM>        SKIP ALL EXCL VDW ELEC
 SKIPE> The following energy terms will be computed :
  VDW  ELEC
  
 CHARMM>        scalar wmain = charge
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>     
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "1" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.519459156"
Evaluating: 90.067469*(0.519459156-0.5)
 Parameter: XPOS <- "1.75263693"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.636031299"
Evaluating: 90.067469*(0.636031299-0.5)
 Parameter: YPOS <- "12.2519948"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.11808863"
Evaluating: 143.194738*(0.11808863-0.5)+3.5172451
 Parameter: ZPOS <- "-51.1704535"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.1704535" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.75263693"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.75263693-0
 Parameter: XTRAN <- "1.75263693"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.2519948"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.2519948-0
 Parameter: YTRAN <- "12.2519948"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.1704535"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.1704535-0
 Parameter: ZTRAN <- "-51.1704535"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.75263693"
 Parameter: YTRAN -> "12.2519948"
 Parameter: ZTRAN -> "-51.1704535"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     1.752637   12.251995  -51.170454
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.279478102"
Evaluating: 0.279478102*360.0
 Parameter: XPHI <- "100.612117"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.867878186"
Evaluating: 0.867878186*360.0
 Parameter: YPHI <- "312.436147"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.376877535"
Evaluating: 0.376877535*360.0
 Parameter: ZPHI <- "135.675913"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.75263693"
 Parameter: YPOS -> "12.2519948"
 Parameter: ZPOS -> "-51.1704535"
 Parameter: XPHI -> "100.612117"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.184159    0.982896
    0.000000   -0.982896   -0.184159

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  100.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.75263693"
 Parameter: YPOS -> "12.2519948"
 Parameter: ZPOS -> "-51.1704535"
 Parameter: YPHI -> "312.436147"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.674768    0.000000    0.738030
    0.000000    1.000000    0.000000
   -0.738030    0.000000    0.674768

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   47.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.75263693"
 Parameter: YPOS -> "12.2519948"
 Parameter: ZPOS -> "-51.1704535"
 Parameter: ZPHI -> "135.675913"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.715399    0.698716    0.000000
   -0.698716   -0.715399    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  135.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.752637 XMAX =    1.752637 XAVE =    1.752637
    YMIN =   12.251995 YMAX =   12.251995 YAVE =   12.251995
    ZMIN =  -51.170454 ZMAX =  -51.170454 ZAVE =  -51.170454
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.75263693"
Evaluating: 1.75263693+3.5
 Parameter: XMAX <- "5.25263693"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.2519948"
Evaluating: 12.2519948+3.5
 Parameter: YMAX <- "15.7519948"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.1704535"
Evaluating: -51.1704535+3.5
 Parameter: ZMAX <- "-47.6704535"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.75263693"
Evaluating: 1.75263693-3.5
 Parameter: XMIN <- "-1.74736307"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.2519948"
Evaluating: 12.2519948-3.5
 Parameter: YMIN <- "8.7519948"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.1704535"
Evaluating: -51.1704535-3.5
 Parameter: ZMIN <- "-54.6704535"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.25263693"
 Parameter: XMIN -> "-1.74736307"
 Parameter: YMAX -> "15.7519948"
 Parameter: YMIN -> "8.7519948"
 Parameter: ZMAX -> "-47.6704535"
 Parameter: ZMIN -> "-54.6704535"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "2" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "2" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.444583691"
Evaluating: 90.067469*(0.444583691-0.5)
 Parameter: XPOS <- "-4.99120669"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.51298675"
Evaluating: 90.067469*(0.51298675-0.5)
 Parameter: YPOS <- "1.1696837"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "9.209788555E-02"
Evaluating: 143.194738*(9.209788555E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-54.8921913"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-54.8921913" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.99120669"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.99120669-0
 Parameter: XTRAN <- "-4.99120669"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.1696837"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.1696837-0
 Parameter: YTRAN <- "1.1696837"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-54.8921913"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -54.8921913-0
 Parameter: ZTRAN <- "-54.8921913"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.99120669"
 Parameter: YTRAN -> "1.1696837"
 Parameter: ZTRAN -> "-54.8921913"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -4.991207    1.169684  -54.892191
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.539200856"
Evaluating: 0.539200856*360.0
 Parameter: XPHI <- "194.112308"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.658266115"
Evaluating: 0.658266115*360.0
 Parameter: YPHI <- "236.975801"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.644104754"
Evaluating: 0.644104754*360.0
 Parameter: ZPHI <- "231.877711"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.99120669"
 Parameter: YPOS -> "1.1696837"
 Parameter: ZPOS -> "-54.8921913"
 Parameter: XPHI -> "194.112308"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.969820   -0.243823
    0.000000    0.243823   -0.969820

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  165.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.99120669"
 Parameter: YPOS -> "1.1696837"
 Parameter: ZPOS -> "-54.8921913"
 Parameter: YPHI -> "236.975801"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.544993    0.000000    0.838440
    0.000000    1.000000    0.000000
   -0.838440    0.000000   -0.544993

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  123.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.99120669"
 Parameter: YPOS -> "1.1696837"
 Parameter: ZPOS -> "-54.8921913"
 Parameter: ZPHI -> "231.877711"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.617342   -0.786695    0.000000
    0.786695   -0.617342    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.991207 XMAX =   -4.991207 XAVE =   -4.991207
    YMIN =    1.169684 YMAX =    1.169684 YAVE =    1.169684
    ZMIN =  -54.892191 ZMAX =  -54.892191 ZAVE =  -54.892191
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.99120669"
Evaluating: -4.99120669+3.5
 Parameter: XMAX <- "-1.49120669"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.1696837"
Evaluating: 1.1696837+3.5
 Parameter: YMAX <- "4.6696837"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-54.8921913"
Evaluating: -54.8921913+3.5
 Parameter: ZMAX <- "-51.3921913"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.99120669"
Evaluating: -4.99120669-3.5
 Parameter: XMIN <- "-8.49120669"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.1696837"
Evaluating: 1.1696837-3.5
 Parameter: YMIN <- "-2.3303163"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-54.8921913"
Evaluating: -54.8921913-3.5
 Parameter: ZMIN <- "-58.3921913"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.49120669"
 Parameter: XMIN -> "-8.49120669"
 Parameter: YMAX -> "4.6696837"
 Parameter: YMIN -> "-2.3303163"
 Parameter: ZMAX -> "-51.3921913"
 Parameter: ZMIN -> "-58.3921913"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "3" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "3" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "5.484956435E-03"
Evaluating: 90.067469*(5.484956435E-03-0.5)
 Parameter: XPOS <- "-44.5397184"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.849139587"
Evaluating: 90.067469*(0.849139587-0.5)
 Parameter: YPOS <- "31.4461189"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "6.467922063E-02"
Evaluating: 143.194738*(6.467922063E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-58.8183998"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-58.8183998" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.5397184"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.5397184-0
 Parameter: XTRAN <- "-44.5397184"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.4461189"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.4461189-0
 Parameter: YTRAN <- "31.4461189"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-58.8183998"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -58.8183998-0
 Parameter: ZTRAN <- "-58.8183998"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.5397184"
 Parameter: YTRAN -> "31.4461189"
 Parameter: ZTRAN -> "-58.8183998"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -44.539718   31.446119  -58.818400
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.409314454"
Evaluating: 0.409314454*360.0
 Parameter: XPHI <- "147.353203"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.407183565"
Evaluating: 0.407183565*360.0
 Parameter: YPHI <- "146.586083"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.161208282"
Evaluating: 0.161208282*360.0
 Parameter: ZPHI <- "58.0349815"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.5397184"
 Parameter: YPOS -> "31.4461189"
 Parameter: ZPOS -> "-58.8183998"
 Parameter: XPHI -> "147.353203"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.842012    0.539459
    0.000000   -0.539459   -0.842012

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  147.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.5397184"
 Parameter: YPOS -> "31.4461189"
 Parameter: ZPOS -> "-58.8183998"
 Parameter: YPHI -> "146.586083"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.834714    0.000000   -0.550684
    0.000000    1.000000    0.000000
    0.550684    0.000000   -0.834714

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  146.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.5397184"
 Parameter: YPOS -> "31.4461189"
 Parameter: ZPOS -> "-58.8183998"
 Parameter: ZPHI -> "58.0349815"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.529401    0.848371    0.000000
   -0.848371    0.529401    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   58.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.539718 XMAX =  -44.539718 XAVE =  -44.539718
    YMIN =   31.446119 YMAX =   31.446119 YAVE =   31.446119
    ZMIN =  -58.818400 ZMAX =  -58.818400 ZAVE =  -58.818400
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.5397184"
Evaluating: -44.5397184+3.5
 Parameter: XMAX <- "-41.0397184"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.4461189"
Evaluating: 31.4461189+3.5
 Parameter: YMAX <- "34.9461189"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-58.8183998"
Evaluating: -58.8183998+3.5
 Parameter: ZMAX <- "-55.3183998"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.5397184"
Evaluating: -44.5397184-3.5
 Parameter: XMIN <- "-48.0397184"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.4461189"
Evaluating: 31.4461189-3.5
 Parameter: YMIN <- "27.9461189"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-58.8183998"
Evaluating: -58.8183998-3.5
 Parameter: ZMIN <- "-62.3183998"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.0397184"
 Parameter: XMIN -> "-48.0397184"
 Parameter: YMAX -> "34.9461189"
 Parameter: YMIN -> "27.9461189"
 Parameter: ZMAX -> "-55.3183998"
 Parameter: ZMIN -> "-62.3183998"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "4" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "4" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.472272305E-02"
Evaluating: 90.067469*(8.472272305E-02-0.5)
 Parameter: XPOS <- "-37.4029733"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.608898424"
Evaluating: 90.067469*(0.608898424-0.5)
 Parameter: YPOS <- "9.80820543"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.36741157"
Evaluating: 143.194738*(0.36741157-0.5)+3.5172451
 Parameter: ZPOS <- "-15.4687204"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.4687204" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.4029733"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -37.4029733-0
 Parameter: XTRAN <- "-37.4029733"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.80820543"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.80820543-0
 Parameter: YTRAN <- "9.80820543"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.4687204"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.4687204-0
 Parameter: ZTRAN <- "-15.4687204"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.4029733"
 Parameter: YTRAN -> "9.80820543"
 Parameter: ZTRAN -> "-15.4687204"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -37.402973    9.808205  -15.468720
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.118669626"
Evaluating: 0.118669626*360.0
 Parameter: XPHI <- "42.7210654"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.445485153"
Evaluating: 0.445485153*360.0
 Parameter: YPHI <- "160.374655"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.937681717"
Evaluating: 0.937681717*360.0
 Parameter: ZPHI <- "337.565418"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.4029733"
 Parameter: YPOS -> "9.80820543"
 Parameter: ZPOS -> "-15.4687204"
 Parameter: XPHI -> "42.7210654"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.734665    0.678430
    0.000000   -0.678430    0.734665

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   42.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.4029733"
 Parameter: YPOS -> "9.80820543"
 Parameter: ZPOS -> "-15.4687204"
 Parameter: YPHI -> "160.374655"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.941909    0.000000   -0.335868
    0.000000    1.000000    0.000000
    0.335868    0.000000   -0.941909

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  160.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.4029733"
 Parameter: YPOS -> "9.80820543"
 Parameter: ZPOS -> "-15.4687204"
 Parameter: ZPHI -> "337.565418"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.924316   -0.381628    0.000000
    0.381628    0.924316    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   22.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.402973 XMAX =  -37.402973 XAVE =  -37.402973
    YMIN =    9.808205 YMAX =    9.808205 YAVE =    9.808205
    ZMIN =  -15.468720 ZMAX =  -15.468720 ZAVE =  -15.468720
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.4029733"
Evaluating: -37.4029733+3.5
 Parameter: XMAX <- "-33.9029733"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.80820543"
Evaluating: 9.80820543+3.5
 Parameter: YMAX <- "13.3082054"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.4687204"
Evaluating: -15.4687204+3.5
 Parameter: ZMAX <- "-11.9687204"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.4029733"
Evaluating: -37.4029733-3.5
 Parameter: XMIN <- "-40.9029733"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.80820543"
Evaluating: 9.80820543-3.5
 Parameter: YMIN <- "6.30820543"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.4687204"
Evaluating: -15.4687204-3.5
 Parameter: ZMIN <- "-18.9687204"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.9029733"
 Parameter: XMIN -> "-40.9029733"
 Parameter: YMAX -> "13.3082054"
 Parameter: YMIN -> "6.30820543"
 Parameter: ZMAX -> "-11.9687204"
 Parameter: ZMIN -> "-18.9687204"
 SELRPN>     21 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      9 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
34965 POS      SOD      4        SOD     -**** MEMB     POPC     164      C14           3.4741
34965 POS      SOD      4        SOD     -**** MEMB     POPC     164      C15           3.9002
34965 POS      SOD      4        SOD     -**** MEMB     POPC     172      O13           3.5200
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "4" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "5.114711097E-02"
Evaluating: 90.067469*(5.114711097E-02-0.5)
 Parameter: XPOS <- "-40.4270437"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.212160428"
Evaluating: 90.067469*(0.212160428-0.5)
 Parameter: YPOS <- "-25.9249817"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.683831875"
Evaluating: 143.194738*(0.683831875-0.5)+3.5172451
 Parameter: ZPOS <- "29.8410023"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.8410023" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.8410023" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.402973 XMAX =  -37.402973 XAVE =  -37.402973
    YMIN =    9.808205 YMAX =    9.808205 YAVE =    9.808205
    ZMIN =  -15.468720 ZMAX =  -15.468720 ZAVE =  -15.468720
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.4270437"
 RDCMND substituted energy or value "?XAVE" to "-37.4029733"
Evaluating: -40.4270437--37.4029733
 Parameter: XTRAN <- "-3.0240704"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.9249817"
 RDCMND substituted energy or value "?YAVE" to "9.80820543"
Evaluating: -25.9249817-9.80820543
 Parameter: YTRAN <- "-35.7331871"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.8410023"
 RDCMND substituted energy or value "?ZAVE" to "-15.4687204"
Evaluating: 29.8410023--15.4687204
 Parameter: ZTRAN <- "45.3097227"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-3.0240704"
 Parameter: YTRAN -> "-35.7331871"
 Parameter: ZTRAN -> "45.3097227"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -3.024070  -35.733187   45.309723
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.679547589"
Evaluating: 0.679547589*360.0
 Parameter: XPHI <- "244.637132"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.395115316"
Evaluating: 0.395115316*360.0
 Parameter: YPHI <- "142.241514"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.702543583"
Evaluating: 0.702543583*360.0
 Parameter: ZPHI <- "252.91569"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.4270437"
 Parameter: YPOS -> "-25.9249817"
 Parameter: ZPOS -> "29.8410023"
 Parameter: XPHI -> "244.637132"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.428350   -0.903613
    0.000000    0.903613   -0.428350

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.4270437"
 Parameter: YPOS -> "-25.9249817"
 Parameter: ZPOS -> "29.8410023"
 Parameter: YPHI -> "142.241514"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.790599    0.000000   -0.612334
    0.000000    1.000000    0.000000
    0.612334    0.000000   -0.790599

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.4270437"
 Parameter: YPOS -> "-25.9249817"
 Parameter: ZPOS -> "29.8410023"
 Parameter: ZPHI -> "252.91569"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.293779   -0.955873    0.000000
    0.955873   -0.293779    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  107.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.427044 XMAX =  -40.427044 XAVE =  -40.427044
    YMIN =  -25.924982 YMAX =  -25.924982 YAVE =  -25.924982
    ZMIN =   29.841002 ZMAX =   29.841002 ZAVE =   29.841002
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.4270437"
Evaluating: -40.4270437+3.5
 Parameter: XMAX <- "-36.9270437"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.9249817"
Evaluating: -25.9249817+3.5
 Parameter: YMAX <- "-22.4249817"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.8410023"
Evaluating: 29.8410023+3.5
 Parameter: ZMAX <- "33.3410023"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.4270437"
Evaluating: -40.4270437-3.5
 Parameter: XMIN <- "-43.9270437"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.9249817"
Evaluating: -25.9249817-3.5
 Parameter: YMIN <- "-29.4249817"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.8410023"
Evaluating: 29.8410023-3.5
 Parameter: ZMIN <- "26.3410023"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.9270437"
 Parameter: XMIN -> "-43.9270437"
 Parameter: YMAX -> "-22.4249817"
 Parameter: YMIN -> "-29.4249817"
 Parameter: ZMAX -> "33.3410023"
 Parameter: ZMIN -> "26.3410023"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "5" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "5" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.679725327"
Evaluating: 90.067469*(0.679725327-0.5)
 Parameter: XPOS <- "16.1874053"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.7404333"
Evaluating: 90.067469*(0.7404333-0.5)
 Parameter: YPOS <- "21.6552188"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.342119687"
Evaluating: 143.194738*(0.342119687-0.5)+3.5172451
 Parameter: ZPOS <- "-19.090385"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.090385" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.1874053"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 16.1874053-0
 Parameter: XTRAN <- "16.1874053"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.6552188"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 21.6552188-0
 Parameter: YTRAN <- "21.6552188"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.090385"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.090385-0
 Parameter: ZTRAN <- "-19.090385"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.1874053"
 Parameter: YTRAN -> "21.6552188"
 Parameter: ZTRAN -> "-19.090385"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    16.187405   21.655219  -19.090385
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.89799622"
Evaluating: 0.89799622*360.0
 Parameter: XPHI <- "323.278639"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.634235169E-02"
Evaluating: 9.634235169E-02*360.0
 Parameter: YPHI <- "34.6832466"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.130199671"
Evaluating: 0.130199671*360.0
 Parameter: ZPHI <- "46.8718816"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.1874053"
 Parameter: YPOS -> "21.6552188"
 Parameter: ZPOS -> "-19.090385"
 Parameter: XPHI -> "323.278639"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.801553   -0.597924
    0.000000    0.597924    0.801553

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   36.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.1874053"
 Parameter: YPOS -> "21.6552188"
 Parameter: ZPOS -> "-19.090385"
 Parameter: YPHI -> "34.6832466"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.822310    0.000000   -0.569039
    0.000000    1.000000    0.000000
    0.569039    0.000000    0.822310

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   34.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.1874053"
 Parameter: YPOS -> "21.6552188"
 Parameter: ZPOS -> "-19.090385"
 Parameter: ZPHI -> "46.8718816"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.683632    0.729827    0.000000
   -0.729827    0.683632    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   46.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.187405 XMAX =   16.187405 XAVE =   16.187405
    YMIN =   21.655219 YMAX =   21.655219 YAVE =   21.655219
    ZMIN =  -19.090385 ZMAX =  -19.090385 ZAVE =  -19.090385
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.1874053"
Evaluating: 16.1874053+3.5
 Parameter: XMAX <- "19.6874053"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.6552188"
Evaluating: 21.6552188+3.5
 Parameter: YMAX <- "25.1552188"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.090385"
Evaluating: -19.090385+3.5
 Parameter: ZMAX <- "-15.590385"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.1874053"
Evaluating: 16.1874053-3.5
 Parameter: XMIN <- "12.6874053"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.6552188"
Evaluating: 21.6552188-3.5
 Parameter: YMIN <- "18.1552188"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.090385"
Evaluating: -19.090385-3.5
 Parameter: ZMIN <- "-22.590385"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.6874053"
 Parameter: XMIN -> "12.6874053"
 Parameter: YMAX -> "25.1552188"
 Parameter: YMIN -> "18.1552188"
 Parameter: ZMAX -> "-15.590385"
 Parameter: ZMIN -> "-22.590385"
 SELRPN>     11 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      7 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
34966 POS      SOD      5        SOD     -**** MEMB     POPC     117      P             3.8728
34966 POS      SOD      5        SOD     -**** MEMB     POPC     117      O13           2.7434
34966 POS      SOD      5        SOD     -**** MEMB     POPC     121      P             3.4484
34966 POS      SOD      5        SOD     -**** MEMB     POPC     121      O13           2.3220
34966 POS      SOD      5        SOD     -**** MEMB     POPC     121      O14           3.6658
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "5" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "1.491269398E-02"
Evaluating: 90.067469*(1.491269398E-02-0.5)
 Parameter: XPOS <- "-43.6905859"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.480572215"
Evaluating: 90.067469*(0.480572215-0.5)
 Parameter: YPOS <- "-1.74981142"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.888335792"
Evaluating: 143.194738*(0.888335792-0.5)+3.5172451
 Parameter: ZPOS <- "59.1248871"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "59.1248871" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "59.1248871" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.187405 XMAX =   16.187405 XAVE =   16.187405
    YMIN =   21.655219 YMAX =   21.655219 YAVE =   21.655219
    ZMIN =  -19.090385 ZMAX =  -19.090385 ZAVE =  -19.090385
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.6905859"
 RDCMND substituted energy or value "?XAVE" to "16.1874053"
Evaluating: -43.6905859-16.1874053
 Parameter: XTRAN <- "-59.8779912"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.74981142"
 RDCMND substituted energy or value "?YAVE" to "21.6552188"
Evaluating: -1.74981142-21.6552188
 Parameter: YTRAN <- "-23.4050302"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "59.1248871"
 RDCMND substituted energy or value "?ZAVE" to "-19.090385"
Evaluating: 59.1248871--19.090385
 Parameter: ZTRAN <- "78.2152721"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-59.8779912"
 Parameter: YTRAN -> "-23.4050302"
 Parameter: ZTRAN -> "78.2152721"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -59.877991  -23.405030   78.215272
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.102643028"
Evaluating: 0.102643028*360.0
 Parameter: XPHI <- "36.9514901"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.322441437"
Evaluating: 0.322441437*360.0
 Parameter: YPHI <- "116.078917"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.751191988E-02"
Evaluating: 4.751191988E-02*360.0
 Parameter: ZPHI <- "17.1042912"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.6905859"
 Parameter: YPOS -> "-1.74981142"
 Parameter: ZPOS -> "59.1248871"
 Parameter: XPHI -> "36.9514901"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.799145    0.601139
    0.000000   -0.601139    0.799145

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   36.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.6905859"
 Parameter: YPOS -> "-1.74981142"
 Parameter: ZPOS -> "59.1248871"
 Parameter: YPHI -> "116.078917"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.439609    0.000000   -0.898189
    0.000000    1.000000    0.000000
    0.898189    0.000000   -0.439609

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  116.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.6905859"
 Parameter: YPOS -> "-1.74981142"
 Parameter: ZPOS -> "59.1248871"
 Parameter: ZPHI -> "17.1042912"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.955771    0.294112    0.000000
   -0.294112    0.955771    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.690586 XMAX =  -43.690586 XAVE =  -43.690586
    YMIN =   -1.749811 YMAX =   -1.749811 YAVE =   -1.749811
    ZMIN =   59.124887 ZMAX =   59.124887 ZAVE =   59.124887
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.6905859"
Evaluating: -43.6905859+3.5
 Parameter: XMAX <- "-40.1905859"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.74981141"
Evaluating: -1.74981141+3.5
 Parameter: YMAX <- "1.75018859"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "59.1248871"
Evaluating: 59.1248871+3.5
 Parameter: ZMAX <- "62.6248871"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.6905859"
Evaluating: -43.6905859-3.5
 Parameter: XMIN <- "-47.1905859"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.74981141"
Evaluating: -1.74981141-3.5
 Parameter: YMIN <- "-5.24981141"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "59.1248871"
Evaluating: 59.1248871-3.5
 Parameter: ZMIN <- "55.6248871"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.1905859"
 Parameter: XMIN -> "-47.1905859"
 Parameter: YMAX -> "1.75018859"
 Parameter: YMIN -> "-5.24981141"
 Parameter: ZMAX -> "62.6248871"
 Parameter: ZMIN -> "55.6248871"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "6" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "6" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.103573599"
Evaluating: 90.067469*(0.103573599-0.5)
 Parameter: XPOS <- "-35.7051226"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.643039774"
Evaluating: 90.067469*(0.643039774-0.5)
 Parameter: YPOS <- "12.8832304"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.405981697"
Evaluating: 143.194738*(0.405981697-0.5)+3.5172451
 Parameter: ZPOS <- "-9.94568117"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.94568117" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.94568117" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "6" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.352321405"
Evaluating: 90.067469*(0.352321405-0.5)
 Parameter: XPOS <- "-13.3010373"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "7.290146712E-02"
Evaluating: 90.067469*(7.290146712E-02-0.5)
 Parameter: YPOS <- "-38.4676839"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.547670861"
Evaluating: 143.194738*(0.547670861-0.5)+3.5172451
 Parameter: ZPOS <- "10.3434616"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.3434616" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.3434616" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "6" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "2.227929757E-02"
Evaluating: 90.067469*(2.227929757E-02-0.5)
 Parameter: XPOS <- "-43.0270946"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.786642861"
Evaluating: 90.067469*(0.786642861-0.5)
 Parameter: YPOS <- "25.817197"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.546884651"
Evaluating: 143.194738*(0.546884651-0.5)+3.5172451
 Parameter: ZPOS <- "10.2308804"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "10.2308804" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "10.2308804" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "6" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.101809156"
Evaluating: 90.067469*(0.101809156-0.5)
 Parameter: XPOS <- "-35.8640415"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.242998093"
Evaluating: 90.067469*(0.242998093-0.5)
 Parameter: YPOS <- "-23.1475113"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.693641323"
Evaluating: 143.194738*(0.693641323-0.5)+3.5172451
 Parameter: ZPOS <- "31.2456636"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.2456636" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.2456636" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.8640415"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -35.8640415-0
 Parameter: XTRAN <- "-35.8640415"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.1475113"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -23.1475113-0
 Parameter: YTRAN <- "-23.1475113"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.2456636"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.2456636-0
 Parameter: ZTRAN <- "31.2456636"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.8640415"
 Parameter: YTRAN -> "-23.1475113"
 Parameter: ZTRAN -> "31.2456636"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -35.864041  -23.147511   31.245664
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.407140047"
Evaluating: 0.407140047*360.0
 Parameter: XPHI <- "146.570417"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.836743395"
Evaluating: 0.836743395*360.0
 Parameter: YPHI <- "301.227622"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.387894702"
Evaluating: 0.387894702*360.0
 Parameter: ZPHI <- "139.642093"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.8640415"
 Parameter: YPOS -> "-23.1475113"
 Parameter: ZPOS -> "31.2456636"
 Parameter: XPHI -> "146.570417"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.834564    0.550912
    0.000000   -0.550912   -0.834564

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  146.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.8640415"
 Parameter: YPOS -> "-23.1475113"
 Parameter: ZPOS -> "31.2456636"
 Parameter: YPHI -> "301.227622"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.518439    0.000000    0.855114
    0.000000    1.000000    0.000000
   -0.855114    0.000000    0.518439

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   58.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.8640415"
 Parameter: YPOS -> "-23.1475113"
 Parameter: ZPOS -> "31.2456636"
 Parameter: ZPHI -> "139.642093"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.762014    0.647560    0.000000
   -0.647560   -0.762014    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  139.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.864041 XMAX =  -35.864041 XAVE =  -35.864041
    YMIN =  -23.147511 YMAX =  -23.147511 YAVE =  -23.147511
    ZMIN =   31.245664 ZMAX =   31.245664 ZAVE =   31.245664
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.8640415"
Evaluating: -35.8640415+3.5
 Parameter: XMAX <- "-32.3640415"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.1475113"
Evaluating: -23.1475113+3.5
 Parameter: YMAX <- "-19.6475113"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.2456636"
Evaluating: 31.2456636+3.5
 Parameter: ZMAX <- "34.7456636"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.8640415"
Evaluating: -35.8640415-3.5
 Parameter: XMIN <- "-39.3640415"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.1475113"
Evaluating: -23.1475113-3.5
 Parameter: YMIN <- "-26.6475113"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.2456636"
Evaluating: 31.2456636-3.5
 Parameter: ZMIN <- "27.7456636"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.3640415"
 Parameter: XMIN -> "-39.3640415"
 Parameter: YMAX -> "-19.6475113"
 Parameter: YMIN -> "-26.6475113"
 Parameter: ZMAX -> "34.7456636"
 Parameter: ZMIN -> "27.7456636"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "7" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "7" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.508793833"
Evaluating: 90.067469*(0.508793833-0.5)
 Parameter: XPOS <- "0.792038281"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.837890153"
Evaluating: 90.067469*(0.837890153-0.5)
 Parameter: YPOS <- "30.4329109"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.636230948"
Evaluating: 143.194738*(0.636230948-0.5)+3.5172451
 Parameter: ZPOS <- "23.0248"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.0248" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.0248" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.792038281"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 0.792038281-0
 Parameter: XTRAN <- "0.792038281"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.4329109"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.4329109-0
 Parameter: YTRAN <- "30.4329109"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.0248"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.0248-0
 Parameter: ZTRAN <- "23.0248"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.792038281"
 Parameter: YTRAN -> "30.4329109"
 Parameter: ZTRAN -> "23.0248"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     0.792038   30.432911   23.024800
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.821126686"
Evaluating: 0.821126686*360.0
 Parameter: XPHI <- "295.605607"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.199666578"
Evaluating: 0.199666578*360.0
 Parameter: YPHI <- "71.8799681"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.24800308"
Evaluating: 0.24800308*360.0
 Parameter: ZPHI <- "89.2811088"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.792038281"
 Parameter: YPOS -> "30.4329109"
 Parameter: ZPOS -> "23.0248"
 Parameter: XPHI -> "295.605607"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.432174   -0.901790
    0.000000    0.901790    0.432174

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   64.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.792038281"
 Parameter: YPOS -> "30.4329109"
 Parameter: ZPOS -> "23.0248"
 Parameter: YPHI -> "71.8799681"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.311009    0.000000   -0.950407
    0.000000    1.000000    0.000000
    0.950407    0.000000    0.311009

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   71.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.792038281"
 Parameter: YPOS -> "30.4329109"
 Parameter: ZPOS -> "23.0248"
 Parameter: ZPHI -> "89.2811088"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.012547    0.999921    0.000000
   -0.999921    0.012547    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   89.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.792038 XMAX =    0.792038 XAVE =    0.792038
    YMIN =   30.432911 YMAX =   30.432911 YAVE =   30.432911
    ZMIN =   23.024800 ZMAX =   23.024800 ZAVE =   23.024800
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.792038281"
Evaluating: 0.792038281+3.5
 Parameter: XMAX <- "4.29203828"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.4329109"
Evaluating: 30.4329109+3.5
 Parameter: YMAX <- "33.9329109"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.0248"
Evaluating: 23.0248+3.5
 Parameter: ZMAX <- "26.5248"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.792038281"
Evaluating: 0.792038281-3.5
 Parameter: XMIN <- "-2.70796172"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.4329109"
Evaluating: 30.4329109-3.5
 Parameter: YMIN <- "26.9329109"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.0248"
Evaluating: 23.0248-3.5
 Parameter: ZMIN <- "19.5248"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.29203828"
 Parameter: XMIN -> "-2.70796172"
 Parameter: YMAX -> "33.9329109"
 Parameter: YMIN -> "26.9329109"
 Parameter: ZMAX -> "26.5248"
 Parameter: ZMIN -> "19.5248"
 SELRPN>     14 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      5 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
34968 POS      SOD      7        SOD     -**** MEMB     POPC     54       N             2.7233
34968 POS      SOD      7        SOD     -**** MEMB     POPC     54       C12           3.4721
34968 POS      SOD      7        SOD     -**** MEMB     POPC     54       C13           3.3696
34968 POS      SOD      7        SOD     -**** MEMB     POPC     54       C14           3.6867
34968 POS      SOD      7        SOD     -**** MEMB     POPC     54       C15           1.2537
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "7" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "1.433963942E-02"
Evaluating: 90.067469*(1.433963942E-02-0.5)
 Parameter: XPOS <- "-43.7421995"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.318903193"
Evaluating: 90.067469*(0.318903193-0.5)
 Parameter: YPOS <- "-16.3109311"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.186346029"
Evaluating: 143.194738*(0.186346029-0.5)+3.5172451
 Parameter: ZPOS <- "-41.3963531"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-41.3963531" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.792038 XMAX =    0.792038 XAVE =    0.792038
    YMIN =   30.432911 YMAX =   30.432911 YAVE =   30.432911
    ZMIN =   23.024800 ZMAX =   23.024800 ZAVE =   23.024800
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.7421995"
 RDCMND substituted energy or value "?XAVE" to "0.792038281"
Evaluating: -43.7421995-0.792038281
 Parameter: XTRAN <- "-44.5342378"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.3109311"
 RDCMND substituted energy or value "?YAVE" to "30.4329109"
Evaluating: -16.3109311-30.4329109
 Parameter: YTRAN <- "-46.743842"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-41.3963531"
 RDCMND substituted energy or value "?ZAVE" to "23.0248"
Evaluating: -41.3963531-23.0248
 Parameter: ZTRAN <- "-64.4211531"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.5342378"
 Parameter: YTRAN -> "-46.743842"
 Parameter: ZTRAN -> "-64.4211531"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -44.534238  -46.743842  -64.421153
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.119382161"
Evaluating: 0.119382161*360.0
 Parameter: XPHI <- "42.977578"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.986881248"
Evaluating: 0.986881248*360.0
 Parameter: YPHI <- "355.277249"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.479031459"
Evaluating: 0.479031459*360.0
 Parameter: ZPHI <- "172.451325"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.7421995"
 Parameter: YPOS -> "-16.3109311"
 Parameter: ZPOS -> "-41.3963531"
 Parameter: XPHI -> "42.977578"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.731621    0.681712
    0.000000   -0.681712    0.731621

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   42.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.7421995"
 Parameter: YPOS -> "-16.3109311"
 Parameter: ZPOS -> "-41.3963531"
 Parameter: YPHI -> "355.277249"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.996605    0.000000    0.082334
    0.000000    1.000000    0.000000
   -0.082334    0.000000    0.996605

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    4.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.7421995"
 Parameter: YPOS -> "-16.3109311"
 Parameter: ZPOS -> "-41.3963531"
 Parameter: ZPHI -> "172.451325"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.991334    0.131368    0.000000
   -0.131368   -0.991334    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  172.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.742199 XMAX =  -43.742199 XAVE =  -43.742199
    YMIN =  -16.310931 YMAX =  -16.310931 YAVE =  -16.310931
    ZMIN =  -41.396353 ZMAX =  -41.396353 ZAVE =  -41.396353
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.7421995"
Evaluating: -43.7421995+3.5
 Parameter: XMAX <- "-40.2421995"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.3109311"
Evaluating: -16.3109311+3.5
 Parameter: YMAX <- "-12.8109311"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-41.3963531"
Evaluating: -41.3963531+3.5
 Parameter: ZMAX <- "-37.8963531"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.7421995"
Evaluating: -43.7421995-3.5
 Parameter: XMIN <- "-47.2421995"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.3109311"
Evaluating: -16.3109311-3.5
 Parameter: YMIN <- "-19.8109311"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-41.3963531"
Evaluating: -41.3963531-3.5
 Parameter: ZMIN <- "-44.8963531"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-40.2421995"
 Parameter: XMIN -> "-47.2421995"
 Parameter: YMAX -> "-12.8109311"
 Parameter: YMIN -> "-19.8109311"
 Parameter: ZMAX -> "-37.8963531"
 Parameter: ZMIN -> "-44.8963531"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "8" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "8" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.632551759"
Evaluating: 90.067469*(0.632551759-0.5)
 Parameter: XPOS <- "11.9386014"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "4.035354822E-02"
Evaluating: 90.067469*(4.035354822E-02-0.5)
 Parameter: YPOS <- "-41.3991925"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.971123945"
Evaluating: 143.194738*(0.971123945-0.5)+3.5172451
 Parameter: ZPOS <- "70.979715"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "70.979715" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "70.979715" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.9386014"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.9386014-0
 Parameter: XTRAN <- "11.9386014"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.3991925"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -41.3991925-0
 Parameter: YTRAN <- "-41.3991925"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "70.979715"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 70.979715-0
 Parameter: ZTRAN <- "70.979715"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.9386014"
 Parameter: YTRAN -> "-41.3991925"
 Parameter: ZTRAN -> "70.979715"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    11.938601  -41.399192   70.979715
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.531317919"
Evaluating: 0.531317919*360.0
 Parameter: XPHI <- "191.274451"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.341053871"
Evaluating: 0.341053871*360.0
 Parameter: YPHI <- "122.779394"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.936644674"
Evaluating: 0.936644674*360.0
 Parameter: ZPHI <- "337.192083"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.9386014"
 Parameter: YPOS -> "-41.3991925"
 Parameter: ZPOS -> "70.979715"
 Parameter: XPHI -> "191.274451"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.980702   -0.195509
    0.000000    0.195509   -0.980702

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  168.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.9386014"
 Parameter: YPOS -> "-41.3991925"
 Parameter: ZPOS -> "70.979715"
 Parameter: YPHI -> "122.779394"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.541406    0.000000   -0.840761
    0.000000    1.000000    0.000000
    0.840761    0.000000   -0.541406

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  122.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.9386014"
 Parameter: YPOS -> "-41.3991925"
 Parameter: ZPOS -> "70.979715"
 Parameter: ZPHI -> "337.192083"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.921810   -0.387643    0.000000
    0.387643    0.921810    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   22.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.938601 XMAX =   11.938601 XAVE =   11.938601
    YMIN =  -41.399192 YMAX =  -41.399192 YAVE =  -41.399192
    ZMIN =   70.979715 ZMAX =   70.979715 ZAVE =   70.979715
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.9386014"
Evaluating: 11.9386014+3.5
 Parameter: XMAX <- "15.4386014"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.3991925"
Evaluating: -41.3991925+3.5
 Parameter: YMAX <- "-37.8991925"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "70.979715"
Evaluating: 70.979715+3.5
 Parameter: ZMAX <- "74.479715"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.9386014"
Evaluating: 11.9386014-3.5
 Parameter: XMIN <- "8.4386014"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.3991925"
Evaluating: -41.3991925-3.5
 Parameter: YMIN <- "-44.8991925"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "70.979715"
Evaluating: 70.979715-3.5
 Parameter: ZMIN <- "67.479715"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.4386014"
 Parameter: XMIN -> "8.4386014"
 Parameter: YMAX -> "-37.8991925"
 Parameter: YMIN -> "-44.8991925"
 Parameter: ZMAX -> "74.479715"
 Parameter: ZMIN -> "67.479715"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "9" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "9" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.456933057E-02"
Evaluating: 90.067469*(8.456933057E-02-0.5)
 Parameter: XPOS <- "-37.4167889"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.718915232"
Evaluating: 90.067469*(0.718915232-0.5)
 Parameter: YPOS <- "19.7171409"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.996257703"
Evaluating: 143.194738*(0.996257703-0.5)+3.5172451
 Parameter: ZPOS <- "74.5787369"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "74.5787369" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "74.5787369" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.4167889"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -37.4167889-0
 Parameter: XTRAN <- "-37.4167889"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.7171409"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.7171409-0
 Parameter: YTRAN <- "19.7171409"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "74.5787369"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 74.5787369-0
 Parameter: ZTRAN <- "74.5787369"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.4167889"
 Parameter: YTRAN -> "19.7171409"
 Parameter: ZTRAN -> "74.5787369"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -37.416789   19.717141   74.578737
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.202057006"
Evaluating: 0.202057006*360.0
 Parameter: XPHI <- "72.7405222"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.840702955"
Evaluating: 0.840702955*360.0
 Parameter: YPHI <- "302.653064"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.831035251"
Evaluating: 0.831035251*360.0
 Parameter: ZPHI <- "299.17269"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.4167889"
 Parameter: YPOS -> "19.7171409"
 Parameter: ZPOS -> "74.5787369"
 Parameter: XPHI -> "72.7405222"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.296700    0.954971
    0.000000   -0.954971    0.296700

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   72.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.4167889"
 Parameter: YPOS -> "19.7171409"
 Parameter: ZPOS -> "74.5787369"
 Parameter: YPHI -> "302.653064"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.539551    0.000000    0.841953
    0.000000    1.000000    0.000000
   -0.841953    0.000000    0.539551

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   57.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.4167889"
 Parameter: YPOS -> "19.7171409"
 Parameter: ZPOS -> "74.5787369"
 Parameter: ZPHI -> "299.17269"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.487444   -0.873155    0.000000
    0.873155    0.487444    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.416789 XMAX =  -37.416789 XAVE =  -37.416789
    YMIN =   19.717141 YMAX =   19.717141 YAVE =   19.717141
    ZMIN =   74.578737 ZMAX =   74.578737 ZAVE =   74.578737
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.4167889"
Evaluating: -37.4167889+3.5
 Parameter: XMAX <- "-33.9167889"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.7171409"
Evaluating: 19.7171409+3.5
 Parameter: YMAX <- "23.2171409"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "74.5787369"
Evaluating: 74.5787369+3.5
 Parameter: ZMAX <- "78.0787369"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.4167889"
Evaluating: -37.4167889-3.5
 Parameter: XMIN <- "-40.9167889"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.7171409"
Evaluating: 19.7171409-3.5
 Parameter: YMIN <- "16.2171409"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "74.5787369"
Evaluating: 74.5787369-3.5
 Parameter: ZMIN <- "71.0787369"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.9167889"
 Parameter: XMIN -> "-40.9167889"
 Parameter: YMAX -> "23.2171409"
 Parameter: YMIN -> "16.2171409"
 Parameter: ZMAX -> "78.0787369"
 Parameter: ZMIN -> "71.0787369"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "10" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "10" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.832888969"
Evaluating: 90.067469*(0.832888969-0.5)
 Parameter: XPOS <- "29.9824669"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.870577019"
Evaluating: 90.067469*(0.870577019-0.5)
 Parameter: YPOS <- "33.3769342"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.310877995"
Evaluating: 143.194738*(0.310877995-0.5)+3.5172451
 Parameter: ZPOS <- "-23.5640309"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.5640309" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.9824669"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.9824669-0
 Parameter: XTRAN <- "29.9824669"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.3769342"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.3769342-0
 Parameter: YTRAN <- "33.3769342"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.5640309"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -23.5640309-0
 Parameter: ZTRAN <- "-23.5640309"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.9824669"
 Parameter: YTRAN -> "33.3769342"
 Parameter: ZTRAN -> "-23.5640309"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    29.982467   33.376934  -23.564031
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.503555213"
Evaluating: 0.503555213*360.0
 Parameter: XPHI <- "181.279877"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.37147162"
Evaluating: 0.37147162*360.0
 Parameter: YPHI <- "133.729783"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.775736022"
Evaluating: 0.775736022*360.0
 Parameter: ZPHI <- "279.264968"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.9824669"
 Parameter: YPOS -> "33.3769342"
 Parameter: ZPOS -> "-23.5640309"
 Parameter: XPHI -> "181.279877"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999751   -0.022336
    0.000000    0.022336   -0.999751

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  178.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.9824669"
 Parameter: YPOS -> "33.3769342"
 Parameter: ZPOS -> "-23.5640309"
 Parameter: YPHI -> "133.729783"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.691258    0.000000   -0.722608
    0.000000    1.000000    0.000000
    0.722608    0.000000   -0.691258

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  133.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.9824669"
 Parameter: YPOS -> "33.3769342"
 Parameter: ZPOS -> "-23.5640309"
 Parameter: ZPHI -> "279.264968"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.161000   -0.986954    0.000000
    0.986954    0.161000    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   80.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.982467 XMAX =   29.982467 XAVE =   29.982467
    YMIN =   33.376934 YMAX =   33.376934 YAVE =   33.376934
    ZMIN =  -23.564031 ZMAX =  -23.564031 ZAVE =  -23.564031
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.9824669"
Evaluating: 29.9824669+3.5
 Parameter: XMAX <- "33.4824669"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.3769342"
Evaluating: 33.3769342+3.5
 Parameter: YMAX <- "36.8769342"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.5640309"
Evaluating: -23.5640309+3.5
 Parameter: ZMAX <- "-20.0640309"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.9824669"
Evaluating: 29.9824669-3.5
 Parameter: XMIN <- "26.4824669"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.3769342"
Evaluating: 33.3769342-3.5
 Parameter: YMIN <- "29.8769342"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.5640309"
Evaluating: -23.5640309-3.5
 Parameter: ZMIN <- "-27.0640309"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.4824669"
 Parameter: XMIN -> "26.4824669"
 Parameter: YMAX -> "36.8769342"
 Parameter: YMIN -> "29.8769342"
 Parameter: ZMAX -> "-20.0640309"
 Parameter: ZMIN -> "-27.0640309"
 SELRPN>     11 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      4 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
34971 POS      SOD      10       SOD     -**** MEMB     POPC     183      N             3.7447
34971 POS      SOD      10       SOD     -**** MEMB     POPC     183      C12           3.7728
34971 POS      SOD      10       SOD     -**** MEMB     POPC     183      C14           3.3893
34971 POS      SOD      10       SOD     -**** MEMB     POPC     183      C15           3.2720
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "10" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.18268163"
Evaluating: 90.067469*(0.18268163-0.5)
 Parameter: XPOS <- "-28.5800625"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.901889167"
Evaluating: 90.067469*(0.901889167-0.5)
 Parameter: YPOS <- "36.1971401"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.490787289"
Evaluating: 143.194738*(0.490787289-0.5)+3.5172451
 Parameter: ZPOS <- "2.19803336"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.19803336" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.19803336" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "10" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.60105874"
Evaluating: 90.067469*(0.60105874-0.5)
 Parameter: XPOS <- "9.10210493"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.559946421"
Evaluating: 90.067469*(0.559946421-0.5)
 Parameter: YPOS <- "5.39922242"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.814091184"
Evaluating: 143.194738*(0.814091184-0.5)+3.5172451
 Parameter: ZPOS <- "48.4934499"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "48.4934499" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "48.4934499" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.982467 XMAX =   29.982467 XAVE =   29.982467
    YMIN =   33.376934 YMAX =   33.376934 YAVE =   33.376934
    ZMIN =  -23.564031 ZMAX =  -23.564031 ZAVE =  -23.564031
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.10210493"
 RDCMND substituted energy or value "?XAVE" to "29.9824669"
Evaluating: 9.10210493-29.9824669
 Parameter: XTRAN <- "-20.880362"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.39922242"
 RDCMND substituted energy or value "?YAVE" to "33.3769342"
Evaluating: 5.39922242-33.3769342
 Parameter: YTRAN <- "-27.9777118"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "48.4934499"
 RDCMND substituted energy or value "?ZAVE" to "-23.5640309"
Evaluating: 48.4934499--23.5640309
 Parameter: ZTRAN <- "72.0574808"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.880362"
 Parameter: YTRAN -> "-27.9777118"
 Parameter: ZTRAN -> "72.0574808"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -20.880362  -27.977712   72.057481
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.21914144E-02"
Evaluating: 7.21914144E-02*360.0
 Parameter: XPHI <- "25.9889092"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.461764804"
Evaluating: 0.461764804*360.0
 Parameter: YPHI <- "166.235329"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.25965221"
Evaluating: 0.25965221*360.0
 Parameter: ZPHI <- "93.4747956"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.10210493"
 Parameter: YPOS -> "5.39922242"
 Parameter: ZPOS -> "48.4934499"
 Parameter: XPHI -> "25.9889092"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.898879    0.438197
    0.000000   -0.438197    0.898879

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   25.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.10210493"
 Parameter: YPOS -> "5.39922242"
 Parameter: ZPOS -> "48.4934499"
 Parameter: YPHI -> "166.235329"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.971281    0.000000   -0.237935
    0.000000    1.000000    0.000000
    0.237935    0.000000   -0.971281

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  166.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.10210493"
 Parameter: YPOS -> "5.39922242"
 Parameter: ZPOS -> "48.4934499"
 Parameter: ZPHI -> "93.4747956"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.060609    0.998162    0.000000
   -0.998162   -0.060609    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   93.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.102105 XMAX =    9.102105 XAVE =    9.102105
    YMIN =    5.399222 YMAX =    5.399222 YAVE =    5.399222
    ZMIN =   48.493450 ZMAX =   48.493450 ZAVE =   48.493450
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.10210491"
Evaluating: 9.10210491+3.5
 Parameter: XMAX <- "12.6021049"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.39922239"
Evaluating: 5.39922239+3.5
 Parameter: YMAX <- "8.89922239"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "48.4934499"
Evaluating: 48.4934499+3.5
 Parameter: ZMAX <- "51.9934499"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.10210491"
Evaluating: 9.10210491-3.5
 Parameter: XMIN <- "5.60210491"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.39922239"
Evaluating: 5.39922239-3.5
 Parameter: YMIN <- "1.89922239"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "48.4934499"
Evaluating: 48.4934499-3.5
 Parameter: ZMIN <- "44.9934499"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.6021049"
 Parameter: XMIN -> "5.60210491"
 Parameter: YMAX -> "8.89922239"
 Parameter: YMIN -> "1.89922239"
 Parameter: ZMAX -> "51.9934499"
 Parameter: ZMIN -> "44.9934499"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "11" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "11" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.505285656"
Evaluating: 90.067469*(0.505285656-0.5)
 Parameter: XPOS <- "0.476065658"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.161737753"
Evaluating: 90.067469*(0.161737753-0.5)
 Parameter: YPOS <- "-30.4664244"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.576035355"
Evaluating: 143.194738*(0.576035355-0.5)+3.5172451
 Parameter: ZPOS <- "14.4051078"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.4051078" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.4051078" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "11" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.594037427"
Evaluating: 90.067469*(0.594037427-0.5)
 Parameter: XPOS <- "8.46971304"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.188049047"
Evaluating: 90.067469*(0.188049047-0.5)
 Parameter: YPOS <- "-28.0966328"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.907318394"
Evaluating: 143.194738*(0.907318394-0.5)+3.5172451
 Parameter: ZPOS <- "61.8430958"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "61.8430958" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "61.8430958" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.46971304"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.46971304-0
 Parameter: XTRAN <- "8.46971304"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.0966328"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.0966328-0
 Parameter: YTRAN <- "-28.0966328"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.8430958"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 61.8430958-0
 Parameter: ZTRAN <- "61.8430958"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.46971304"
 Parameter: YTRAN -> "-28.0966328"
 Parameter: ZTRAN -> "61.8430958"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     8.469713  -28.096633   61.843096
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.911740889"
Evaluating: 0.911740889*360.0
 Parameter: XPHI <- "328.22672"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.908351692"
Evaluating: 0.908351692*360.0
 Parameter: YPHI <- "327.006609"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.76800413"
Evaluating: 0.76800413*360.0
 Parameter: ZPHI <- "276.481487"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.46971304"
 Parameter: YPOS -> "-28.0966328"
 Parameter: ZPOS -> "61.8430958"
 Parameter: XPHI -> "328.22672"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.850138   -0.526559
    0.000000    0.526559    0.850138

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   31.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.46971304"
 Parameter: YPOS -> "-28.0966328"
 Parameter: ZPOS -> "61.8430958"
 Parameter: YPHI -> "327.006609"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.838733    0.000000    0.544542
    0.000000    1.000000    0.000000
   -0.544542    0.000000    0.838733

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   32.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.46971304"
 Parameter: YPOS -> "-28.0966328"
 Parameter: ZPOS -> "61.8430958"
 Parameter: ZPHI -> "276.481487"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.112882   -0.993608    0.000000
    0.993608    0.112882    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   83.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.469713 XMAX =    8.469713 XAVE =    8.469713
    YMIN =  -28.096633 YMAX =  -28.096633 YAVE =  -28.096633
    ZMIN =   61.843096 ZMAX =   61.843096 ZAVE =   61.843096
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.46971304"
Evaluating: 8.46971304+3.5
 Parameter: XMAX <- "11.969713"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.0966328"
Evaluating: -28.0966328+3.5
 Parameter: YMAX <- "-24.5966328"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.8430958"
Evaluating: 61.8430958+3.5
 Parameter: ZMAX <- "65.3430958"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.46971304"
Evaluating: 8.46971304-3.5
 Parameter: XMIN <- "4.96971304"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.0966328"
Evaluating: -28.0966328-3.5
 Parameter: YMIN <- "-31.5966328"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.8430958"
Evaluating: 61.8430958-3.5
 Parameter: ZMIN <- "58.3430958"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.969713"
 Parameter: XMIN -> "4.96971304"
 Parameter: YMAX -> "-24.5966328"
 Parameter: YMIN -> "-31.5966328"
 Parameter: ZMAX -> "65.3430958"
 Parameter: ZMIN -> "58.3430958"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "12" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "12" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.493472358"
Evaluating: 90.067469*(0.493472358-0.5)
 Parameter: XPOS <- "-0.587928193"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.948858666"
Evaluating: 90.067469*(0.948858666-0.5)
 Parameter: YPOS <- "40.427564"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.706057808"
Evaluating: 143.194738*(0.706057808-0.5)+3.5172451
 Parameter: ZPOS <- "33.0236389"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.0236389" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.0236389" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.587928193"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.587928193-0
 Parameter: XTRAN <- "-0.587928193"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "40.427564"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 40.427564-0
 Parameter: YTRAN <- "40.427564"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.0236389"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.0236389-0
 Parameter: ZTRAN <- "33.0236389"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.587928193"
 Parameter: YTRAN -> "40.427564"
 Parameter: ZTRAN -> "33.0236389"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -0.587928   40.427564   33.023639
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.214338718"
Evaluating: 0.214338718*360.0
 Parameter: XPHI <- "77.1619385"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.373861914"
Evaluating: 0.373861914*360.0
 Parameter: YPHI <- "134.590289"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.801163578E-02"
Evaluating: 6.801163578E-02*360.0
 Parameter: ZPHI <- "24.4841889"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.587928193"
 Parameter: YPOS -> "40.427564"
 Parameter: ZPOS -> "33.0236389"
 Parameter: XPHI -> "77.1619385"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.222196    0.975002
    0.000000   -0.975002    0.222196

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   77.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.587928193"
 Parameter: YPOS -> "40.427564"
 Parameter: ZPOS -> "33.0236389"
 Parameter: YPHI -> "134.590289"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.702032    0.000000   -0.712145
    0.000000    1.000000    0.000000
    0.712145    0.000000   -0.702032

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  134.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.587928193"
 Parameter: YPOS -> "40.427564"
 Parameter: ZPOS -> "33.0236389"
 Parameter: ZPHI -> "24.4841889"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.910076    0.414442    0.000000
   -0.414442    0.910076    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   24.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.587928 XMAX =   -0.587928 XAVE =   -0.587928
    YMIN =   40.427564 YMAX =   40.427564 YAVE =   40.427564
    ZMIN =   33.023639 ZMAX =   33.023639 ZAVE =   33.023639
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.587928193"
Evaluating: -0.587928193+3.5
 Parameter: XMAX <- "2.91207181"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "40.427564"
Evaluating: 40.427564+3.5
 Parameter: YMAX <- "43.927564"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.0236389"
Evaluating: 33.0236389+3.5
 Parameter: ZMAX <- "36.5236389"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.587928193"
Evaluating: -0.587928193-3.5
 Parameter: XMIN <- "-4.08792819"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "40.427564"
Evaluating: 40.427564-3.5
 Parameter: YMIN <- "36.927564"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.0236389"
Evaluating: 33.0236389-3.5
 Parameter: ZMIN <- "29.5236389"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.91207181"
 Parameter: XMIN -> "-4.08792819"
 Parameter: YMAX -> "43.927564"
 Parameter: YMIN -> "36.927564"
 Parameter: ZMAX -> "36.5236389"
 Parameter: ZMIN -> "29.5236389"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "13" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "13" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.411501693"
Evaluating: 90.067469*(0.411501693-0.5)
 Parameter: XPOS <- "-7.97081852"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.983851294"
Evaluating: 90.067469*(0.983851294-0.5)
 Parameter: YPOS <- "43.5792614"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.709832945"
Evaluating: 143.194738*(0.709832945-0.5)+3.5172451
 Parameter: ZPOS <- "33.5642187"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.5642187" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.5642187" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.97081852"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.97081852-0
 Parameter: XTRAN <- "-7.97081852"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "43.5792614"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 43.5792614-0
 Parameter: YTRAN <- "43.5792614"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.5642187"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.5642187-0
 Parameter: ZTRAN <- "33.5642187"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.97081852"
 Parameter: YTRAN -> "43.5792614"
 Parameter: ZTRAN -> "33.5642187"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -7.970819   43.579261   33.564219
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.29325376"
Evaluating: 0.29325376*360.0
 Parameter: XPHI <- "105.571354"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.274443514"
Evaluating: 0.274443514*360.0
 Parameter: YPHI <- "98.799665"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.950042555"
Evaluating: 0.950042555*360.0
 Parameter: ZPHI <- "342.01532"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.97081852"
 Parameter: YPOS -> "43.5792614"
 Parameter: ZPOS -> "33.5642187"
 Parameter: XPHI -> "105.571354"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.268438    0.963297
    0.000000   -0.963297   -0.268438

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  105.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.97081852"
 Parameter: YPOS -> "43.5792614"
 Parameter: ZPOS -> "33.5642187"
 Parameter: YPHI -> "98.799665"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.152980    0.000000   -0.988229
    0.000000    1.000000    0.000000
    0.988229    0.000000   -0.152980

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   98.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.97081852"
 Parameter: YPOS -> "43.5792614"
 Parameter: ZPOS -> "33.5642187"
 Parameter: ZPHI -> "342.01532"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.951139   -0.308763    0.000000
    0.308763    0.951139    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   17.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.970819 XMAX =   -7.970819 XAVE =   -7.970819
    YMIN =   43.579261 YMAX =   43.579261 YAVE =   43.579261
    ZMIN =   33.564219 ZMAX =   33.564219 ZAVE =   33.564219
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.97081852"
Evaluating: -7.97081852+3.5
 Parameter: XMAX <- "-4.47081852"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "43.5792614"
Evaluating: 43.5792614+3.5
 Parameter: YMAX <- "47.0792614"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.5642187"
Evaluating: 33.5642187+3.5
 Parameter: ZMAX <- "37.0642187"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.97081852"
Evaluating: -7.97081852-3.5
 Parameter: XMIN <- "-11.4708185"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "43.5792614"
Evaluating: 43.5792614-3.5
 Parameter: YMIN <- "40.0792614"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.5642187"
Evaluating: 33.5642187-3.5
 Parameter: ZMIN <- "30.0642187"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.47081852"
 Parameter: XMIN -> "-11.4708185"
 Parameter: YMAX -> "47.0792614"
 Parameter: YMIN -> "40.0792614"
 Parameter: ZMAX -> "37.0642187"
 Parameter: ZMIN -> "30.0642187"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "14" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "14" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.074573395E-02"
Evaluating: 90.067469*(8.074573395E-02-0.5)
 Parameter: XPOS <- "-37.7611706"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.455427268"
Evaluating: 90.067469*(0.455427268-0.5)
 Parameter: YPOS <- "-4.01455316"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.519846398"
Evaluating: 143.194738*(0.519846398-0.5)+3.5172451
 Parameter: ZPOS <- "6.35914486"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.35914486" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.35914486" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "14" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.785353074"
Evaluating: 90.067469*(0.785353074-0.5)
 Parameter: XPOS <- "25.7010291"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.314274145"
Evaluating: 90.067469*(0.314274145-0.5)
 Parameter: YPOS <- "-16.7278577"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.370848147"
Evaluating: 143.194738*(0.370848147-0.5)+3.5172451
 Parameter: ZPOS <- "-14.9766207"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.9766207" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.9766207" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "14" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.283586032"
Evaluating: 90.067469*(0.283586032-0.5)
 Parameter: XPOS <- "-19.4918584"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.826393766"
Evaluating: 90.067469*(0.826393766-0.5)
 Parameter: YPOS <- "29.3974604"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.369389841"
Evaluating: 143.194738*(0.369389841-0.5)+3.5172451
 Parameter: ZPOS <- "-15.1854424"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.1854424" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.4918584"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -19.4918584-0
 Parameter: XTRAN <- "-19.4918584"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.3974604"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.3974604-0
 Parameter: YTRAN <- "29.3974604"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.1854424"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.1854424-0
 Parameter: ZTRAN <- "-15.1854424"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-19.4918584"
 Parameter: YTRAN -> "29.3974604"
 Parameter: ZTRAN -> "-15.1854424"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -19.491858   29.397460  -15.185442
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.680509686"
Evaluating: 0.680509686*360.0
 Parameter: XPHI <- "244.983487"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.626099325"
Evaluating: 0.626099325*360.0
 Parameter: YPHI <- "225.395757"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.987493595"
Evaluating: 0.987493595*360.0
 Parameter: ZPHI <- "355.497694"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.4918584"
 Parameter: YPOS -> "29.3974604"
 Parameter: ZPOS -> "-15.1854424"
 Parameter: XPHI -> "244.983487"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.422879   -0.906186
    0.000000    0.906186   -0.422879

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.4918584"
 Parameter: YPOS -> "29.3974604"
 Parameter: ZPOS -> "-15.1854424"
 Parameter: YPHI -> "225.395757"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.702206    0.000000    0.711974
    0.000000    1.000000    0.000000
   -0.711974    0.000000   -0.702206

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  134.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.4918584"
 Parameter: YPOS -> "29.3974604"
 Parameter: ZPOS -> "-15.1854424"
 Parameter: ZPHI -> "355.497694"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.996914   -0.078499    0.000000
    0.078499    0.996914    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    4.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.491858 XMAX =  -19.491858 XAVE =  -19.491858
    YMIN =   29.397460 YMAX =   29.397460 YAVE =   29.397460
    ZMIN =  -15.185442 ZMAX =  -15.185442 ZAVE =  -15.185442
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.4918584"
Evaluating: -19.4918584+3.5
 Parameter: XMAX <- "-15.9918584"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.3974604"
Evaluating: 29.3974604+3.5
 Parameter: YMAX <- "32.8974604"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.1854424"
Evaluating: -15.1854424+3.5
 Parameter: ZMAX <- "-11.6854424"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.4918584"
Evaluating: -19.4918584-3.5
 Parameter: XMIN <- "-22.9918584"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.3974604"
Evaluating: 29.3974604-3.5
 Parameter: YMIN <- "25.8974604"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.1854424"
Evaluating: -15.1854424-3.5
 Parameter: ZMIN <- "-18.6854424"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.9918584"
 Parameter: XMIN -> "-22.9918584"
 Parameter: YMAX -> "32.8974604"
 Parameter: YMIN -> "25.8974604"
 Parameter: ZMAX -> "-11.6854424"
 Parameter: ZMIN -> "-18.6854424"
 SELRPN>     22 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      8 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
34975 POS      SOD      14       SOD     -**** MEMB     POPC     137      C25           3.9319
34975 POS      SOD      14       SOD     -**** MEMB     POPC     138      C3            3.0527
34975 POS      SOD      14       SOD     -**** MEMB     POPC     138      O31           3.0795
34975 POS      SOD      14       SOD     -**** MEMB     POPC     138      C31           3.7985
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "14" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "3.869902183E-02"
Evaluating: 90.067469*(3.869902183E-02-0.5)
 Parameter: XPOS <- "-41.5482116"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.691742796"
Evaluating: 90.067469*(0.691742796-0.5)
 Parameter: YPOS <- "17.2697883"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.238707978"
Evaluating: 143.194738*(0.238707978-0.5)+3.5172451
 Parameter: ZPOS <- "-33.8983975"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.8983975" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.491858 XMAX =  -19.491858 XAVE =  -19.491858
    YMIN =   29.397460 YMAX =   29.397460 YAVE =   29.397460
    ZMIN =  -15.185442 ZMAX =  -15.185442 ZAVE =  -15.185442
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.5482116"
 RDCMND substituted energy or value "?XAVE" to "-19.4918584"
Evaluating: -41.5482116--19.4918584
 Parameter: XTRAN <- "-22.0563532"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.2697883"
 RDCMND substituted energy or value "?YAVE" to "29.3974604"
Evaluating: 17.2697883-29.3974604
 Parameter: YTRAN <- "-12.1276721"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.8983975"
 RDCMND substituted energy or value "?ZAVE" to "-15.1854424"
Evaluating: -33.8983975--15.1854424
 Parameter: ZTRAN <- "-18.7129551"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.0563532"
 Parameter: YTRAN -> "-12.1276721"
 Parameter: ZTRAN -> "-18.7129551"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -22.056353  -12.127672  -18.712955
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.10775947"
Evaluating: 0.10775947*360.0
 Parameter: XPHI <- "38.7934092"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.539482552E-04"
Evaluating: 9.539482552E-04*360.0
 Parameter: YPHI <- "0.343421372"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.688535531"
Evaluating: 0.688535531*360.0
 Parameter: ZPHI <- "247.872791"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.5482116"
 Parameter: YPOS -> "17.2697883"
 Parameter: ZPOS -> "-33.8983975"
 Parameter: XPHI -> "38.7934092"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.779410    0.626514
    0.000000   -0.626514    0.779410

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   38.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.5482116"
 Parameter: YPOS -> "17.2697883"
 Parameter: ZPOS -> "-33.8983975"
 Parameter: YPHI -> "0.343421372"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.999982    0.000000   -0.005994
    0.000000    1.000000    0.000000
    0.005994    0.000000    0.999982

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    0.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.5482116"
 Parameter: YPOS -> "17.2697883"
 Parameter: ZPOS -> "-33.8983975"
 Parameter: ZPHI -> "247.872791"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.376664   -0.926350    0.000000
    0.926350   -0.376664    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  112.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.548212 XMAX =  -41.548212 XAVE =  -41.548212
    YMIN =   17.269788 YMAX =   17.269788 YAVE =   17.269788
    ZMIN =  -33.898398 ZMAX =  -33.898398 ZAVE =  -33.898398
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.5482116"
Evaluating: -41.5482116+3.5
 Parameter: XMAX <- "-38.0482116"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.2697883"
Evaluating: 17.2697883+3.5
 Parameter: YMAX <- "20.7697883"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.8983975"
Evaluating: -33.8983975+3.5
 Parameter: ZMAX <- "-30.3983975"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.5482116"
Evaluating: -41.5482116-3.5
 Parameter: XMIN <- "-45.0482116"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.2697883"
Evaluating: 17.2697883-3.5
 Parameter: YMIN <- "13.7697883"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.8983975"
Evaluating: -33.8983975-3.5
 Parameter: ZMIN <- "-37.3983975"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.0482116"
 Parameter: XMIN -> "-45.0482116"
 Parameter: YMAX -> "20.7697883"
 Parameter: YMIN -> "13.7697883"
 Parameter: ZMAX -> "-30.3983975"
 Parameter: ZMIN -> "-37.3983975"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "15" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "15" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.185233132"
Evaluating: 90.067469*(0.185233132-0.5)
 Parameter: XPOS <- "-28.3502551"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.392740328"
Evaluating: 90.067469*(0.392740328-0.5)
 Parameter: YPOS <- "-9.66060718"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.669123817"
Evaluating: 143.194738*(0.669123817-0.5)+3.5172451
 Parameter: ZPOS <- "27.7348858"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.7348858" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.7348858" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.3502551"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.3502551-0
 Parameter: XTRAN <- "-28.3502551"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.66060718"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -9.66060718-0
 Parameter: YTRAN <- "-9.66060718"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.7348858"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.7348858-0
 Parameter: ZTRAN <- "27.7348858"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.3502551"
 Parameter: YTRAN -> "-9.66060718"
 Parameter: ZTRAN -> "27.7348858"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -28.350255   -9.660607   27.734886
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.828889784"
Evaluating: 0.828889784*360.0
 Parameter: XPHI <- "298.400322"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.615950996"
Evaluating: 0.615950996*360.0
 Parameter: YPHI <- "221.742359"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.741737294"
Evaluating: 0.741737294*360.0
 Parameter: ZPHI <- "267.025426"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.3502551"
 Parameter: YPOS -> "-9.66060718"
 Parameter: ZPOS -> "27.7348858"
 Parameter: XPHI -> "298.400322"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.475629   -0.879646
    0.000000    0.879646    0.475629

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   61.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.3502551"
 Parameter: YPOS -> "-9.66060718"
 Parameter: ZPOS -> "27.7348858"
 Parameter: YPHI -> "221.742359"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.746146    0.000000    0.665782
    0.000000    1.000000    0.000000
   -0.665782    0.000000   -0.746146

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  138.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.3502551"
 Parameter: YPOS -> "-9.66060718"
 Parameter: ZPOS -> "27.7348858"
 Parameter: ZPHI -> "267.025426"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.051893   -0.998653    0.000000
    0.998653   -0.051893    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   92.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.350255 XMAX =  -28.350255 XAVE =  -28.350255
    YMIN =   -9.660607 YMAX =   -9.660607 YAVE =   -9.660607
    ZMIN =   27.734886 ZMAX =   27.734886 ZAVE =   27.734886
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.3502551"
Evaluating: -28.3502551+3.5
 Parameter: XMAX <- "-24.8502551"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.66060718"
Evaluating: -9.66060718+3.5
 Parameter: YMAX <- "-6.16060718"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.7348858"
Evaluating: 27.7348858+3.5
 Parameter: ZMAX <- "31.2348858"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.3502551"
Evaluating: -28.3502551-3.5
 Parameter: XMIN <- "-31.8502551"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.66060718"
Evaluating: -9.66060718-3.5
 Parameter: YMIN <- "-13.1606072"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.7348858"
Evaluating: 27.7348858-3.5
 Parameter: ZMIN <- "24.2348858"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.8502551"
 Parameter: XMIN -> "-31.8502551"
 Parameter: YMAX -> "-6.16060718"
 Parameter: YMIN -> "-13.1606072"
 Parameter: ZMAX -> "31.2348858"
 Parameter: ZMIN -> "24.2348858"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "16" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "16" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.93916507"
Evaluating: 90.067469*(0.93916507-0.5)
 Parameter: XPOS <- "39.5544863"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.475658263"
Evaluating: 90.067469*(0.475658263-0.5)
 Parameter: YPOS <- "-2.19239864"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.930382124"
Evaluating: 143.194738*(0.930382124-0.5)+3.5172451
 Parameter: ZPOS <- "65.1457006"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "65.1457006" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "65.1457006" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.5544863"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.5544863-0
 Parameter: XTRAN <- "39.5544863"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.19239864"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.19239864-0
 Parameter: YTRAN <- "-2.19239864"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "65.1457006"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 65.1457006-0
 Parameter: ZTRAN <- "65.1457006"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.5544863"
 Parameter: YTRAN -> "-2.19239864"
 Parameter: ZTRAN -> "65.1457006"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    39.554486   -2.192399   65.145701
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.831571993"
Evaluating: 0.831571993*360.0
 Parameter: XPHI <- "299.365917"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.471978381"
Evaluating: 0.471978381*360.0
 Parameter: YPHI <- "169.912217"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.389461188E-02"
Evaluating: 6.389461188E-02*360.0
 Parameter: ZPHI <- "23.0020603"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.5544863"
 Parameter: YPOS -> "-2.19239864"
 Parameter: ZPOS -> "65.1457006"
 Parameter: XPHI -> "299.365917"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.490385   -0.871506
    0.000000    0.871506    0.490385

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   60.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.5544863"
 Parameter: YPOS -> "-2.19239864"
 Parameter: ZPOS -> "65.1457006"
 Parameter: YPHI -> "169.912217"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.984541    0.000000   -0.175157
    0.000000    1.000000    0.000000
    0.175157    0.000000   -0.984541

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  169.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.5544863"
 Parameter: YPOS -> "-2.19239864"
 Parameter: ZPOS -> "65.1457006"
 Parameter: ZPHI -> "23.0020603"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.920491    0.390764    0.000000
   -0.390764    0.920491    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   23.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.554486 XMAX =   39.554486 XAVE =   39.554486
    YMIN =   -2.192399 YMAX =   -2.192399 YAVE =   -2.192399
    ZMIN =   65.145701 ZMAX =   65.145701 ZAVE =   65.145701
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.5544863"
Evaluating: 39.5544863+3.5
 Parameter: XMAX <- "43.0544863"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.19239864"
Evaluating: -2.19239864+3.5
 Parameter: YMAX <- "1.30760136"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "65.1457006"
Evaluating: 65.1457006+3.5
 Parameter: ZMAX <- "68.6457006"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.5544863"
Evaluating: 39.5544863-3.5
 Parameter: XMIN <- "36.0544863"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.19239864"
Evaluating: -2.19239864-3.5
 Parameter: YMIN <- "-5.69239864"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "65.1457006"
Evaluating: 65.1457006-3.5
 Parameter: ZMIN <- "61.6457006"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.0544863"
 Parameter: XMIN -> "36.0544863"
 Parameter: YMAX -> "1.30760136"
 Parameter: YMIN -> "-5.69239864"
 Parameter: ZMAX -> "68.6457006"
 Parameter: ZMIN -> "61.6457006"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "17" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "17" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.903643985"
Evaluating: 90.067469*(0.903643985-0.5)
 Parameter: XPOS <- "36.3551921"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.86264233"
Evaluating: 90.067469*(0.86264233-0.5)
 Parameter: YPOS <- "32.6622768"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.582973906"
Evaluating: 143.194738*(0.582973906-0.5)+3.5172451
 Parameter: ZPOS <- "15.3986718"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.3986718" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.3986718" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.3551921"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.3551921-0
 Parameter: XTRAN <- "36.3551921"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.6622768"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.6622768-0
 Parameter: YTRAN <- "32.6622768"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.3986718"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.3986718-0
 Parameter: ZTRAN <- "15.3986718"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.3551921"
 Parameter: YTRAN -> "32.6622768"
 Parameter: ZTRAN -> "15.3986718"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    36.355192   32.662277   15.398672
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.13198471"
Evaluating: 0.13198471*360.0
 Parameter: XPHI <- "47.5144956"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.110925461"
Evaluating: 0.110925461*360.0
 Parameter: YPHI <- "39.933166"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.729229797"
Evaluating: 0.729229797*360.0
 Parameter: ZPHI <- "262.522727"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.3551921"
 Parameter: YPOS -> "32.6622768"
 Parameter: ZPOS -> "15.3986718"
 Parameter: XPHI -> "47.5144956"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.675404    0.737448
    0.000000   -0.737448    0.675404

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   47.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.3551921"
 Parameter: YPOS -> "32.6622768"
 Parameter: ZPOS -> "15.3986718"
 Parameter: YPHI -> "39.933166"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.766794    0.000000   -0.641894
    0.000000    1.000000    0.000000
    0.641894    0.000000    0.766794

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   39.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.3551921"
 Parameter: YPOS -> "32.6622768"
 Parameter: ZPOS -> "15.3986718"
 Parameter: ZPHI -> "262.522727"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.130133   -0.991497    0.000000
    0.991497   -0.130133    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   97.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.355192 XMAX =   36.355192 XAVE =   36.355192
    YMIN =   32.662277 YMAX =   32.662277 YAVE =   32.662277
    ZMIN =   15.398672 ZMAX =   15.398672 ZAVE =   15.398672
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.3551921"
Evaluating: 36.3551921+3.5
 Parameter: XMAX <- "39.8551921"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.6622768"
Evaluating: 32.6622768+3.5
 Parameter: YMAX <- "36.1622768"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.3986718"
Evaluating: 15.3986718+3.5
 Parameter: ZMAX <- "18.8986718"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.3551921"
Evaluating: 36.3551921-3.5
 Parameter: XMIN <- "32.8551921"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.6622768"
Evaluating: 32.6622768-3.5
 Parameter: YMIN <- "29.1622768"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.3986718"
Evaluating: 15.3986718-3.5
 Parameter: ZMIN <- "11.8986718"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.8551921"
 Parameter: XMIN -> "32.8551921"
 Parameter: YMAX -> "36.1622768"
 Parameter: YMIN -> "29.1622768"
 Parameter: ZMAX -> "18.8986718"
 Parameter: ZMIN -> "11.8986718"
 SELRPN>     39 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     22 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
34978 POS      SOD      17       SOD     -**** MEMB     POPC     94       O22           3.1382
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C11           3.9577
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       P             2.3181
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       O13           3.0239
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       O14           2.6946
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       O12           3.5815
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       O11           1.2068
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C1            2.1603
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C2            2.9594
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       O21           2.9024
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C21           3.3882
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C22           3.8188
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C3            3.5325
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       O31           2.9861
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C31           3.2385
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C32           3.5137
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C23           3.8772
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C24           2.8139
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C25           3.7885
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C26           3.9083
34978 POS      SOD      17       SOD     -**** MEMB     POPC     96       C33           3.4275
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        21
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "21"
 Comparing "21" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "17" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.87966942"
Evaluating: 90.067469*(0.87966942-0.5)
 Parameter: XPOS <- "34.1958637"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.554501668"
Evaluating: 90.067469*(0.554501668-0.5)
 Parameter: YPOS <- "4.90882729"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "5.016012656E-02"
Evaluating: 143.194738*(5.016012656E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-60.8974577"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-60.8974577" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.355192 XMAX =   36.355192 XAVE =   36.355192
    YMIN =   32.662277 YMAX =   32.662277 YAVE =   32.662277
    ZMIN =   15.398672 ZMAX =   15.398672 ZAVE =   15.398672
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.1958637"
 RDCMND substituted energy or value "?XAVE" to "36.3551921"
Evaluating: 34.1958637-36.3551921
 Parameter: XTRAN <- "-2.1593284"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.90882729"
 RDCMND substituted energy or value "?YAVE" to "32.6622768"
Evaluating: 4.90882729-32.6622768
 Parameter: YTRAN <- "-27.7534495"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-60.8974577"
 RDCMND substituted energy or value "?ZAVE" to "15.3986718"
Evaluating: -60.8974577-15.3986718
 Parameter: ZTRAN <- "-76.2961295"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.1593284"
 Parameter: YTRAN -> "-27.7534495"
 Parameter: ZTRAN -> "-76.2961295"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -2.159328  -27.753449  -76.296130
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.727620005"
Evaluating: 0.727620005*360.0
 Parameter: XPHI <- "261.943202"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.839235573"
Evaluating: 0.839235573*360.0
 Parameter: YPHI <- "302.124806"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.203254043"
Evaluating: 0.203254043*360.0
 Parameter: ZPHI <- "73.1714555"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.1958637"
 Parameter: YPOS -> "4.90882729"
 Parameter: ZPOS -> "-60.8974577"
 Parameter: XPHI -> "261.943202"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.140155   -0.990130
    0.000000    0.990130   -0.140155

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   98.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.1958637"
 Parameter: YPOS -> "4.90882729"
 Parameter: ZPOS -> "-60.8974577"
 Parameter: YPHI -> "302.124806"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.531765    0.000000    0.846892
    0.000000    1.000000    0.000000
   -0.846892    0.000000    0.531765

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   57.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.1958637"
 Parameter: YPOS -> "4.90882729"
 Parameter: ZPOS -> "-60.8974577"
 Parameter: ZPHI -> "73.1714555"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.289509    0.957175    0.000000
   -0.957175    0.289509    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   73.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.195864 XMAX =   34.195864 XAVE =   34.195864
    YMIN =    4.908827 YMAX =    4.908827 YAVE =    4.908827
    ZMIN =  -60.897458 ZMAX =  -60.897458 ZAVE =  -60.897458
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.1958637"
Evaluating: 34.1958637+3.5
 Parameter: XMAX <- "37.6958637"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.90882728"
Evaluating: 4.90882728+3.5
 Parameter: YMAX <- "8.40882728"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-60.8974577"
Evaluating: -60.8974577+3.5
 Parameter: ZMAX <- "-57.3974577"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.1958637"
Evaluating: 34.1958637-3.5
 Parameter: XMIN <- "30.6958637"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.90882728"
Evaluating: 4.90882728-3.5
 Parameter: YMIN <- "1.40882728"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-60.8974577"
Evaluating: -60.8974577-3.5
 Parameter: ZMIN <- "-64.3974577"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.6958637"
 Parameter: XMIN -> "30.6958637"
 Parameter: YMAX -> "8.40882728"
 Parameter: YMIN -> "1.40882728"
 Parameter: ZMAX -> "-57.3974577"
 Parameter: ZMIN -> "-64.3974577"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "18" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "18" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.820912751"
Evaluating: 90.067469*(0.820912751-0.5)
 Parameter: XPOS <- "28.9037993"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.589016586E-02"
Evaluating: 90.067469*(8.589016586E-02-0.5)
 Parameter: YPOS <- "-37.2978246"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "1.104485537E-02"
Evaluating: 143.194738*(1.104485537E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-66.4985587"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-66.4985587" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.9037993"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.9037993-0
 Parameter: XTRAN <- "28.9037993"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.2978246"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.2978246-0
 Parameter: YTRAN <- "-37.2978246"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-66.4985587"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -66.4985587-0
 Parameter: ZTRAN <- "-66.4985587"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.9037993"
 Parameter: YTRAN -> "-37.2978246"
 Parameter: ZTRAN -> "-66.4985587"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    28.903799  -37.297825  -66.498559
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.748487864"
Evaluating: 0.748487864*360.0
 Parameter: XPHI <- "269.455631"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.564836457"
Evaluating: 0.564836457*360.0
 Parameter: YPHI <- "203.341125"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.743034378E-02"
Evaluating: 4.743034378E-02*360.0
 Parameter: ZPHI <- "17.0749238"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.9037993"
 Parameter: YPOS -> "-37.2978246"
 Parameter: ZPOS -> "-66.4985587"
 Parameter: XPHI -> "269.455631"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.009501   -0.999955
    0.000000    0.999955   -0.009501

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   90.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.9037993"
 Parameter: YPOS -> "-37.2978246"
 Parameter: ZPOS -> "-66.4985587"
 Parameter: YPHI -> "203.341125"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.918162    0.000000    0.396205
    0.000000    1.000000    0.000000
   -0.396205    0.000000   -0.918162

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  156.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.9037993"
 Parameter: YPOS -> "-37.2978246"
 Parameter: ZPOS -> "-66.4985587"
 Parameter: ZPHI -> "17.0749238"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.955922    0.293622    0.000000
   -0.293622    0.955922    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.903799 XMAX =   28.903799 XAVE =   28.903799
    YMIN =  -37.297825 YMAX =  -37.297825 YAVE =  -37.297825
    ZMIN =  -66.498559 ZMAX =  -66.498559 ZAVE =  -66.498559
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.9037993"
Evaluating: 28.9037993+3.5
 Parameter: XMAX <- "32.4037993"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.2978246"
Evaluating: -37.2978246+3.5
 Parameter: YMAX <- "-33.7978246"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-66.4985587"
Evaluating: -66.4985587+3.5
 Parameter: ZMAX <- "-62.9985587"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.9037993"
Evaluating: 28.9037993-3.5
 Parameter: XMIN <- "25.4037993"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.2978246"
Evaluating: -37.2978246-3.5
 Parameter: YMIN <- "-40.7978246"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-66.4985587"
Evaluating: -66.4985587-3.5
 Parameter: ZMIN <- "-69.9985587"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.4037993"
 Parameter: XMIN -> "25.4037993"
 Parameter: YMAX -> "-33.7978246"
 Parameter: YMIN -> "-40.7978246"
 Parameter: ZMAX -> "-62.9985587"
 Parameter: ZMIN -> "-69.9985587"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "19" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "19" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.471087397"
Evaluating: 90.067469*(0.471087397-0.5)
 Parameter: XPOS <- "-2.60408497"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.544046852"
Evaluating: 90.067469*(0.544046852-0.5)
 Parameter: YPOS <- "3.96718848"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.776363038"
Evaluating: 143.194738*(0.776363038-0.5)+3.5172451
 Parameter: ZPOS <- "43.0909779"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.0909779" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.0909779" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.60408497"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -2.60408497-0
 Parameter: XTRAN <- "-2.60408497"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.96718848"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 3.96718848-0
 Parameter: YTRAN <- "3.96718848"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.0909779"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 43.0909779-0
 Parameter: ZTRAN <- "43.0909779"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-2.60408497"
 Parameter: YTRAN -> "3.96718848"
 Parameter: ZTRAN -> "43.0909779"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -2.604085    3.967188   43.090978
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.811493229"
Evaluating: 0.811493229*360.0
 Parameter: XPHI <- "292.137562"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.647584239"
Evaluating: 0.647584239*360.0
 Parameter: YPHI <- "233.130326"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.309651792"
Evaluating: 0.309651792*360.0
 Parameter: ZPHI <- "111.474645"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.60408497"
 Parameter: YPOS -> "3.96718848"
 Parameter: ZPOS -> "43.0909779"
 Parameter: XPHI -> "292.137562"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.376832   -0.926282
    0.000000    0.926282    0.376832

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   67.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.60408497"
 Parameter: YPOS -> "3.96718848"
 Parameter: ZPOS -> "43.0909779"
 Parameter: YPHI -> "233.130326"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.599997    0.000000    0.800002
    0.000000    1.000000    0.000000
   -0.800002    0.000000   -0.599997

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  126.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.60408497"
 Parameter: YPOS -> "3.96718848"
 Parameter: ZPOS -> "43.0909779"
 Parameter: ZPHI -> "111.474645"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.366089    0.930580    0.000000
   -0.930580   -0.366089    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  111.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.604085 XMAX =   -2.604085 XAVE =   -2.604085
    YMIN =    3.967188 YMAX =    3.967188 YAVE =    3.967188
    ZMIN =   43.090978 ZMAX =   43.090978 ZAVE =   43.090978
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.60408497"
Evaluating: -2.60408497+3.5
 Parameter: XMAX <- "0.89591503"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.96718848"
Evaluating: 3.96718848+3.5
 Parameter: YMAX <- "7.46718848"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.0909779"
Evaluating: 43.0909779+3.5
 Parameter: ZMAX <- "46.5909779"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.60408497"
Evaluating: -2.60408497-3.5
 Parameter: XMIN <- "-6.10408497"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.96718848"
Evaluating: 3.96718848-3.5
 Parameter: YMIN <- "0.46718848"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.0909779"
Evaluating: 43.0909779-3.5
 Parameter: ZMIN <- "39.5909779"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.89591503"
 Parameter: XMIN -> "-6.10408497"
 Parameter: YMAX -> "7.46718848"
 Parameter: YMIN -> "0.46718848"
 Parameter: ZMAX -> "46.5909779"
 Parameter: ZMIN -> "39.5909779"
 SELRPN>     37 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     22 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
34980 POS      SOD      19       SOD     -2458 PROA     PRO      179      CA            3.7975
34980 POS      SOD      19       SOD     -2460 PROA     PRO      179      CB            2.9992
34980 POS      SOD      19       SOD     -2466 PROA     PRO      179      C             3.4765
34980 POS      SOD      19       SOD     -2468 PROA     LEU      180      N             3.5355
34980 POS      SOD      19       SOD     -2470 PROA     LEU      180      CA            4.1118
34980 POS      SOD      19       SOD     -2485 PROA     LEU      180      C             3.4950
34980 POS      SOD      19       SOD     -2486 PROA     LEU      180      O             4.3869
34980 POS      SOD      19       SOD     -2487 PROA     ASP      181      N             2.3363
34980 POS      SOD      19       SOD     -2489 PROA     ASP      181      CA            2.4511
34980 POS      SOD      19       SOD     -2491 PROA     ASP      181      CB            3.2429
34980 POS      SOD      19       SOD     -2494 PROA     ASP      181      CG            3.0911
34980 POS      SOD      19       SOD     -2495 PROA     ASP      181      OD1           2.8704
34980 POS      SOD      19       SOD     -2496 PROA     ASP      181      OD2           3.9209
34980 POS      SOD      19       SOD     -2497 PROA     ASP      181      C             1.8512
34980 POS      SOD      19       SOD     -2498 PROA     ASP      181      O             2.9638
34980 POS      SOD      19       SOD     -2499 PROA     GLU      182      N             0.9052
34980 POS      SOD      19       SOD     -2501 PROA     GLU      182      CA            2.1350
34980 POS      SOD      19       SOD     -2503 PROA     GLU      182      CB            2.8230
34980 POS      SOD      19       SOD     -2506 PROA     GLU      182      CG            3.4024
34980 POS      SOD      19       SOD     -2509 PROA     GLU      182      CD            4.7587
34980 POS      SOD      19       SOD     -2512 PROA     GLU      182      C             3.0090
34980 POS      SOD      19       SOD     -2513 PROA     GLU      182      O             3.0728
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        22
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "22"
 Comparing "22" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "19" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.153229194"
Evaluating: 90.067469*(0.153229194-0.5)
 Parameter: XPOS <- "-31.2327688"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.995282384"
Evaluating: 90.067469*(0.995282384-0.5)
 Parameter: YPOS <- "44.6088308"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "2.015378039E-02"
Evaluating: 143.194738*(2.015378039E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-65.1942086"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-65.1942086" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.604085 XMAX =   -2.604085 XAVE =   -2.604085
    YMIN =    3.967188 YMAX =    3.967188 YAVE =    3.967188
    ZMIN =   43.090978 ZMAX =   43.090978 ZAVE =   43.090978
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.2327688"
 RDCMND substituted energy or value "?XAVE" to "-2.60408497"
Evaluating: -31.2327688--2.60408497
 Parameter: XTRAN <- "-28.6286838"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.6088308"
 RDCMND substituted energy or value "?YAVE" to "3.96718848"
Evaluating: 44.6088308-3.96718848
 Parameter: YTRAN <- "40.6416423"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-65.1942086"
 RDCMND substituted energy or value "?ZAVE" to "43.0909779"
Evaluating: -65.1942086-43.0909779
 Parameter: ZTRAN <- "-108.285186"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.6286838"
 Parameter: YTRAN -> "40.6416423"
 Parameter: ZTRAN -> "-108.285186"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -28.628684   40.641642 -108.285186
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.588898282"
Evaluating: 0.588898282*360.0
 Parameter: XPHI <- "212.003382"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.337219624"
Evaluating: 0.337219624*360.0
 Parameter: YPHI <- "121.399065"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.598231413E-02"
Evaluating: 3.598231413E-02*360.0
 Parameter: ZPHI <- "12.9536331"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.2327688"
 Parameter: YPOS -> "44.6088308"
 Parameter: ZPOS -> "-65.1942086"
 Parameter: XPHI -> "212.003382"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.848017   -0.529969
    0.000000    0.529969   -0.848017

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  148.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.2327688"
 Parameter: YPOS -> "44.6088308"
 Parameter: ZPOS -> "-65.1942086"
 Parameter: YPHI -> "121.399065"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.520996    0.000000   -0.853559
    0.000000    1.000000    0.000000
    0.853559    0.000000   -0.520996

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  121.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.2327688"
 Parameter: YPOS -> "44.6088308"
 Parameter: ZPOS -> "-65.1942086"
 Parameter: ZPHI -> "12.9536331"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.974552    0.224162    0.000000
   -0.224162    0.974552    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   12.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.232769 XMAX =  -31.232769 XAVE =  -31.232769
    YMIN =   44.608830 YMAX =   44.608830 YAVE =   44.608830
    ZMIN =  -65.194208 ZMAX =  -65.194208 ZAVE =  -65.194208
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.2327685"
Evaluating: -31.2327685+3.5
 Parameter: XMAX <- "-27.7327685"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.6088305"
Evaluating: 44.6088305+3.5
 Parameter: YMAX <- "48.1088305"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-65.1942083"
Evaluating: -65.1942083+3.5
 Parameter: ZMAX <- "-61.6942083"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.2327685"
Evaluating: -31.2327685-3.5
 Parameter: XMIN <- "-34.7327685"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.6088305"
Evaluating: 44.6088305-3.5
 Parameter: YMIN <- "41.1088305"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-65.1942083"
Evaluating: -65.1942083-3.5
 Parameter: ZMIN <- "-68.6942083"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.7327685"
 Parameter: XMIN -> "-34.7327685"
 Parameter: YMAX -> "48.1088305"
 Parameter: YMIN -> "41.1088305"
 Parameter: ZMAX -> "-61.6942083"
 Parameter: ZMIN -> "-68.6942083"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "20" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "20" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.753950025"
Evaluating: 90.067469*(0.753950025-0.5)
 Parameter: XPOS <- "22.872636"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.245475292"
Evaluating: 90.067469*(0.245475292-0.5)
 Parameter: YPOS <- "-22.9243962"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.670087216"
Evaluating: 143.194738*(0.670087216-0.5)+3.5172451
 Parameter: ZPOS <- "27.8728394"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.8728394" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.8728394" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.872636"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 22.872636-0
 Parameter: XTRAN <- "22.872636"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.9243962"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.9243962-0
 Parameter: YTRAN <- "-22.9243962"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.8728394"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.8728394-0
 Parameter: ZTRAN <- "27.8728394"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.872636"
 Parameter: YTRAN -> "-22.9243962"
 Parameter: ZTRAN -> "27.8728394"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    22.872636  -22.924396   27.872839
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.561521272"
Evaluating: 0.561521272*360.0
 Parameter: XPHI <- "202.147658"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.327287985"
Evaluating: 0.327287985*360.0
 Parameter: YPHI <- "117.823675"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.825722901"
Evaluating: 0.825722901*360.0
 Parameter: ZPHI <- "297.260244"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.872636"
 Parameter: YPOS -> "-22.9243962"
 Parameter: ZPOS -> "27.8728394"
 Parameter: XPHI -> "202.147658"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.926215   -0.376995
    0.000000    0.376995   -0.926215

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  157.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.872636"
 Parameter: YPOS -> "-22.9243962"
 Parameter: ZPOS -> "27.8728394"
 Parameter: YPHI -> "117.823675"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.466752    0.000000   -0.884388
    0.000000    1.000000    0.000000
    0.884388    0.000000   -0.466752

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  117.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.872636"
 Parameter: YPOS -> "-22.9243962"
 Parameter: ZPOS -> "27.8728394"
 Parameter: ZPHI -> "297.260244"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.458033   -0.888935    0.000000
    0.888935    0.458033    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   62.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.872636 XMAX =   22.872636 XAVE =   22.872636
    YMIN =  -22.924396 YMAX =  -22.924396 YAVE =  -22.924396
    ZMIN =   27.872839 ZMAX =   27.872839 ZAVE =   27.872839
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.872636"
Evaluating: 22.872636+3.5
 Parameter: XMAX <- "26.372636"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.9243962"
Evaluating: -22.9243962+3.5
 Parameter: YMAX <- "-19.4243962"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.8728394"
Evaluating: 27.8728394+3.5
 Parameter: ZMAX <- "31.3728394"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.872636"
Evaluating: 22.872636-3.5
 Parameter: XMIN <- "19.372636"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.9243962"
Evaluating: -22.9243962-3.5
 Parameter: YMIN <- "-26.4243962"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.8728394"
Evaluating: 27.8728394-3.5
 Parameter: ZMIN <- "24.3728394"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.372636"
 Parameter: XMIN -> "19.372636"
 Parameter: YMAX -> "-19.4243962"
 Parameter: YMIN -> "-26.4243962"
 Parameter: ZMAX -> "31.3728394"
 Parameter: ZMIN -> "24.3728394"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "21" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "21" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.36209687"
Evaluating: 90.067469*(0.36209687-0.5)
 Parameter: XPOS <- "-12.4205859"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.446317352"
Evaluating: 90.067469*(0.446317352-0.5)
 Parameter: YPOS <- "-4.83506023"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.117023462"
Evaluating: 143.194738*(0.117023462-0.5)+3.5172451
 Parameter: ZPOS <- "-51.3229799"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.3229799" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.4205859"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.4205859-0
 Parameter: XTRAN <- "-12.4205859"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.83506023"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -4.83506023-0
 Parameter: YTRAN <- "-4.83506023"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.3229799"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.3229799-0
 Parameter: ZTRAN <- "-51.3229799"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.4205859"
 Parameter: YTRAN -> "-4.83506023"
 Parameter: ZTRAN -> "-51.3229799"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -12.420586   -4.835060  -51.322980
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.38905504E-02"
Evaluating: 4.38905504E-02*360.0
 Parameter: XPHI <- "15.8005981"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.688390514"
Evaluating: 0.688390514*360.0
 Parameter: YPHI <- "247.820585"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.556631665"
Evaluating: 0.556631665*360.0
 Parameter: ZPHI <- "200.387399"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.4205859"
 Parameter: YPOS -> "-4.83506023"
 Parameter: ZPOS -> "-51.3229799"
 Parameter: XPHI -> "15.8005981"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.962215    0.272290
    0.000000   -0.272290    0.962215

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   15.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.4205859"
 Parameter: YPOS -> "-4.83506023"
 Parameter: ZPOS -> "-51.3229799"
 Parameter: YPHI -> "247.820585"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.377508    0.000000    0.926006
    0.000000    1.000000    0.000000
   -0.926006    0.000000   -0.377508

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  112.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.4205859"
 Parameter: YPOS -> "-4.83506023"
 Parameter: ZPOS -> "-51.3229799"
 Parameter: ZPHI -> "200.387399"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.937359   -0.348366    0.000000
    0.348366   -0.937359    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  159.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.420586 XMAX =  -12.420586 XAVE =  -12.420586
    YMIN =   -4.835060 YMAX =   -4.835060 YAVE =   -4.835060
    ZMIN =  -51.322980 ZMAX =  -51.322980 ZAVE =  -51.322980
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.4205859"
Evaluating: -12.4205859+3.5
 Parameter: XMAX <- "-8.9205859"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.83506023"
Evaluating: -4.83506023+3.5
 Parameter: YMAX <- "-1.33506023"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.3229799"
Evaluating: -51.3229799+3.5
 Parameter: ZMAX <- "-47.8229799"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.4205859"
Evaluating: -12.4205859-3.5
 Parameter: XMIN <- "-15.9205859"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.83506023"
Evaluating: -4.83506023-3.5
 Parameter: YMIN <- "-8.33506023"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.3229799"
Evaluating: -51.3229799-3.5
 Parameter: ZMIN <- "-54.8229799"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.9205859"
 Parameter: XMIN -> "-15.9205859"
 Parameter: YMAX -> "-1.33506023"
 Parameter: YMIN -> "-8.33506023"
 Parameter: ZMAX -> "-47.8229799"
 Parameter: ZMIN -> "-54.8229799"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "22" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "22" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.677933218E-02"
Evaluating: 90.067469*(8.677933218E-02-0.5)
 Parameter: XPOS <- "-37.2177397"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.107933463"
Evaluating: 90.067469*(0.107933463-0.5)
 Parameter: YPOS <- "-35.3124407"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.920512723"
Evaluating: 143.194738*(0.920512723-0.5)+3.5172451
 Parameter: ZPOS <- "63.7324543"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.7324543" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.7324543" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.2177397"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -37.2177397-0
 Parameter: XTRAN <- "-37.2177397"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.3124407"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.3124407-0
 Parameter: YTRAN <- "-35.3124407"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.7324543"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 63.7324543-0
 Parameter: ZTRAN <- "63.7324543"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.2177397"
 Parameter: YTRAN -> "-35.3124407"
 Parameter: ZTRAN -> "63.7324543"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -37.217740  -35.312441   63.732454
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.850761558"
Evaluating: 0.850761558*360.0
 Parameter: XPHI <- "306.274161"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.770547206"
Evaluating: 0.770547206*360.0
 Parameter: YPHI <- "277.396994"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.639214365"
Evaluating: 0.639214365*360.0
 Parameter: ZPHI <- "230.117171"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.2177397"
 Parameter: YPOS -> "-35.3124407"
 Parameter: ZPOS -> "63.7324543"
 Parameter: XPHI -> "306.274161"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.591650   -0.806195
    0.000000    0.806195    0.591650

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   53.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.2177397"
 Parameter: YPOS -> "-35.3124407"
 Parameter: ZPOS -> "63.7324543"
 Parameter: YPHI -> "277.396994"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.128744    0.000000    0.991678
    0.000000    1.000000    0.000000
   -0.991678    0.000000    0.128744

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   82.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.2177397"
 Parameter: YPOS -> "-35.3124407"
 Parameter: ZPOS -> "63.7324543"
 Parameter: ZPHI -> "230.117171"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.641220   -0.767357    0.000000
    0.767357   -0.641220    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  129.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.217740 XMAX =  -37.217740 XAVE =  -37.217740
    YMIN =  -35.312441 YMAX =  -35.312441 YAVE =  -35.312441
    ZMIN =   63.732454 ZMAX =   63.732454 ZAVE =   63.732454
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.2177397"
Evaluating: -37.2177397+3.5
 Parameter: XMAX <- "-33.7177397"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.3124407"
Evaluating: -35.3124407+3.5
 Parameter: YMAX <- "-31.8124407"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.7324543"
Evaluating: 63.7324543+3.5
 Parameter: ZMAX <- "67.2324543"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.2177397"
Evaluating: -37.2177397-3.5
 Parameter: XMIN <- "-40.7177397"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.3124407"
Evaluating: -35.3124407-3.5
 Parameter: YMIN <- "-38.8124407"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.7324543"
Evaluating: 63.7324543-3.5
 Parameter: ZMIN <- "60.2324543"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.7177397"
 Parameter: XMIN -> "-40.7177397"
 Parameter: YMAX -> "-31.8124407"
 Parameter: YMIN -> "-38.8124407"
 Parameter: ZMAX -> "67.2324543"
 Parameter: ZMIN -> "60.2324543"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "23" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "23" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "3.622855512E-02"
Evaluating: 90.067469*(3.622855512E-02-0.5)
 Parameter: XPOS <- "-41.7707202"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "2.115761593E-02"
Evaluating: 90.067469*(2.115761593E-02-0.5)
 Parameter: YPOS <- "-43.1281216"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.757069121"
Evaluating: 143.194738*(0.757069121-0.5)+3.5172451
 Parameter: ZPOS <- "40.3281905"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.3281905" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.3281905" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.7707202"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.7707202-0
 Parameter: XTRAN <- "-41.7707202"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.1281216"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.1281216-0
 Parameter: YTRAN <- "-43.1281216"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.3281905"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.3281905-0
 Parameter: ZTRAN <- "40.3281905"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.7707202"
 Parameter: YTRAN -> "-43.1281216"
 Parameter: ZTRAN -> "40.3281905"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -41.770720  -43.128122   40.328190
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.132047818"
Evaluating: 0.132047818*360.0
 Parameter: XPHI <- "47.5372145"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.609562059"
Evaluating: 0.609562059*360.0
 Parameter: YPHI <- "219.442341"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.803309805"
Evaluating: 0.803309805*360.0
 Parameter: ZPHI <- "289.19153"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.7707202"
 Parameter: YPOS -> "-43.1281216"
 Parameter: ZPOS -> "40.3281905"
 Parameter: XPHI -> "47.5372145"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.675111    0.737716
    0.000000   -0.737716    0.675111

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   47.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.7707202"
 Parameter: YPOS -> "-43.1281216"
 Parameter: ZPOS -> "40.3281905"
 Parameter: YPHI -> "219.442341"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.772264    0.000000    0.635301
    0.000000    1.000000    0.000000
   -0.635301    0.000000   -0.772264

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  140.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.7707202"
 Parameter: YPOS -> "-43.1281216"
 Parameter: ZPOS -> "40.3281905"
 Parameter: ZPHI -> "289.19153"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.328727   -0.944425    0.000000
    0.944425    0.328727    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   70.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.770720 XMAX =  -41.770720 XAVE =  -41.770720
    YMIN =  -43.128122 YMAX =  -43.128122 YAVE =  -43.128122
    ZMIN =   40.328190 ZMAX =   40.328190 ZAVE =   40.328190
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.7707202"
Evaluating: -41.7707202+3.5
 Parameter: XMAX <- "-38.2707202"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.1281216"
Evaluating: -43.1281216+3.5
 Parameter: YMAX <- "-39.6281216"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.3281905"
Evaluating: 40.3281905+3.5
 Parameter: ZMAX <- "43.8281905"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.7707202"
Evaluating: -41.7707202-3.5
 Parameter: XMIN <- "-45.2707202"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.1281216"
Evaluating: -43.1281216-3.5
 Parameter: YMIN <- "-46.6281216"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.3281905"
Evaluating: 40.3281905-3.5
 Parameter: ZMIN <- "36.8281905"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.2707202"
 Parameter: XMIN -> "-45.2707202"
 Parameter: YMAX -> "-39.6281216"
 Parameter: YMIN -> "-46.6281216"
 Parameter: ZMAX -> "43.8281905"
 Parameter: ZMIN -> "36.8281905"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "24" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "24" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.430089908"
Evaluating: 90.067469*(0.430089908-0.5)
 Parameter: XPOS <- "-6.29662504"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.728906233"
Evaluating: 90.067469*(0.728906233-0.5)
 Parameter: YPOS <- "20.617005"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.117783112"
Evaluating: 143.194738*(0.117783112-0.5)+3.5172451
 Parameter: ZPOS <- "-51.214202"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.214202" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.29662504"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -6.29662504-0
 Parameter: XTRAN <- "-6.29662504"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.617005"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 20.617005-0
 Parameter: YTRAN <- "20.617005"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.214202"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.214202-0
 Parameter: ZTRAN <- "-51.214202"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.29662504"
 Parameter: YTRAN -> "20.617005"
 Parameter: ZTRAN -> "-51.214202"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -6.296625   20.617005  -51.214202
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.413178836E-03"
Evaluating: 8.413178836E-03*360.0
 Parameter: XPHI <- "3.02874438"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.172220497"
Evaluating: 0.172220497*360.0
 Parameter: YPHI <- "61.9993789"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.429382904"
Evaluating: 0.429382904*360.0
 Parameter: ZPHI <- "154.577845"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.29662504"
 Parameter: YPOS -> "20.617005"
 Parameter: ZPOS -> "-51.214202"
 Parameter: XPHI -> "3.02874438"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998603    0.052837
    0.000000   -0.052837    0.998603

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.29662504"
 Parameter: YPOS -> "20.617005"
 Parameter: ZPOS -> "-51.214202"
 Parameter: YPHI -> "61.9993789"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.469481    0.000000   -0.882943
    0.000000    1.000000    0.000000
    0.882943    0.000000    0.469481

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   62.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.29662504"
 Parameter: YPOS -> "20.617005"
 Parameter: ZPOS -> "-51.214202"
 Parameter: ZPHI -> "154.577845"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.903169    0.429284    0.000000
   -0.429284   -0.903169    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  154.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.296625 XMAX =   -6.296625 XAVE =   -6.296625
    YMIN =   20.617005 YMAX =   20.617005 YAVE =   20.617005
    ZMIN =  -51.214202 ZMAX =  -51.214202 ZAVE =  -51.214202
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.29662504"
Evaluating: -6.29662504+3.5
 Parameter: XMAX <- "-2.79662504"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.617005"
Evaluating: 20.617005+3.5
 Parameter: YMAX <- "24.117005"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.214202"
Evaluating: -51.214202+3.5
 Parameter: ZMAX <- "-47.714202"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.29662504"
Evaluating: -6.29662504-3.5
 Parameter: XMIN <- "-9.79662504"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.617005"
Evaluating: 20.617005-3.5
 Parameter: YMIN <- "17.117005"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.214202"
Evaluating: -51.214202-3.5
 Parameter: ZMIN <- "-54.714202"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.79662504"
 Parameter: XMIN -> "-9.79662504"
 Parameter: YMAX -> "24.117005"
 Parameter: YMIN -> "17.117005"
 Parameter: ZMAX -> "-47.714202"
 Parameter: ZMIN -> "-54.714202"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "25" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "25" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.925844039"
Evaluating: 90.067469*(0.925844039-0.5)
 Parameter: XPOS <- "38.3546948"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.650093532"
Evaluating: 90.067469*(0.650093532-0.5)
 Parameter: YPOS <- "13.5185445"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.641769376"
Evaluating: 143.194738*(0.641769376-0.5)+3.5172451
 Parameter: ZPOS <- "23.8178738"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.8178738" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.8178738" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.3546948"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 38.3546948-0
 Parameter: XTRAN <- "38.3546948"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.5185445"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.5185445-0
 Parameter: YTRAN <- "13.5185445"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.8178738"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.8178738-0
 Parameter: ZTRAN <- "23.8178738"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "38.3546948"
 Parameter: YTRAN -> "13.5185445"
 Parameter: ZTRAN -> "23.8178738"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    38.354695   13.518545   23.817874
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.885143691"
Evaluating: 0.885143691*360.0
 Parameter: XPHI <- "318.651729"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.318386184"
Evaluating: 0.318386184*360.0
 Parameter: YPHI <- "114.619026"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.426460727"
Evaluating: 0.426460727*360.0
 Parameter: ZPHI <- "153.525862"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.3546948"
 Parameter: YPOS -> "13.5185445"
 Parameter: ZPOS -> "23.8178738"
 Parameter: XPHI -> "318.651729"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.750708   -0.660634
    0.000000    0.660634    0.750708

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   41.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.3546948"
 Parameter: YPOS -> "13.5185445"
 Parameter: ZPOS -> "23.8178738"
 Parameter: YPHI -> "114.619026"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.416583    0.000000   -0.909098
    0.000000    1.000000    0.000000
    0.909098    0.000000   -0.416583

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  114.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.3546948"
 Parameter: YPOS -> "13.5185445"
 Parameter: ZPOS -> "23.8178738"
 Parameter: ZPHI -> "153.525862"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.895136    0.445794    0.000000
   -0.445794   -0.895136    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  153.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.354695 XMAX =   38.354695 XAVE =   38.354695
    YMIN =   13.518545 YMAX =   13.518545 YAVE =   13.518545
    ZMIN =   23.817874 ZMAX =   23.817874 ZAVE =   23.817874
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.3546948"
Evaluating: 38.3546948+3.5
 Parameter: XMAX <- "41.8546948"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.5185445"
Evaluating: 13.5185445+3.5
 Parameter: YMAX <- "17.0185445"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.8178738"
Evaluating: 23.8178738+3.5
 Parameter: ZMAX <- "27.3178738"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.3546948"
Evaluating: 38.3546948-3.5
 Parameter: XMIN <- "34.8546948"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.5185445"
Evaluating: 13.5185445-3.5
 Parameter: YMIN <- "10.0185445"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.8178738"
Evaluating: 23.8178738-3.5
 Parameter: ZMIN <- "20.3178738"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.8546948"
 Parameter: XMIN -> "34.8546948"
 Parameter: YMAX -> "17.0185445"
 Parameter: YMIN -> "10.0185445"
 Parameter: ZMAX -> "27.3178738"
 Parameter: ZMIN -> "20.3178738"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      1 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "26" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "26" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.446645695"
Evaluating: 90.067469*(0.446645695-0.5)
 Parameter: XPOS <- "-4.80548721"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "1.186358712E-02"
Evaluating: 90.067469*(1.186358712E-02-0.5)
 Parameter: YPOS <- "-43.9652112"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.243890139"
Evaluating: 143.194738*(0.243890139-0.5)+3.5172451
 Parameter: ZPOS <- "-33.1563393"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.1563393" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.80548721"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.80548721-0
 Parameter: XTRAN <- "-4.80548721"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.9652112"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.9652112-0
 Parameter: YTRAN <- "-43.9652112"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.1563393"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.1563393-0
 Parameter: ZTRAN <- "-33.1563393"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.80548721"
 Parameter: YTRAN -> "-43.9652112"
 Parameter: ZTRAN -> "-33.1563393"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -4.805487  -43.965211  -33.156339
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.576832105E-02"
Evaluating: 7.576832105E-02*360.0
 Parameter: XPHI <- "27.2765956"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.393259152"
Evaluating: 0.393259152*360.0
 Parameter: YPHI <- "141.573295"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.803191961"
Evaluating: 0.803191961*360.0
 Parameter: ZPHI <- "289.149106"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.80548721"
 Parameter: YPOS -> "-43.9652112"
 Parameter: ZPOS -> "-33.1563393"
 Parameter: XPHI -> "27.2765956"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.888805    0.458287
    0.000000   -0.458287    0.888805

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   27.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.80548721"
 Parameter: YPOS -> "-43.9652112"
 Parameter: ZPOS -> "-33.1563393"
 Parameter: YPHI -> "141.573295"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.783404    0.000000   -0.621513
    0.000000    1.000000    0.000000
    0.621513    0.000000   -0.783404

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  141.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.80548721"
 Parameter: YPOS -> "-43.9652112"
 Parameter: ZPOS -> "-33.1563393"
 Parameter: ZPHI -> "289.149106"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.328028   -0.944668    0.000000
    0.944668    0.328028    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   70.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.805487 XMAX =   -4.805487 XAVE =   -4.805487
    YMIN =  -43.965211 YMAX =  -43.965211 YAVE =  -43.965211
    ZMIN =  -33.156339 ZMAX =  -33.156339 ZAVE =  -33.156339
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.80548721"
Evaluating: -4.80548721+3.5
 Parameter: XMAX <- "-1.30548721"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.9652112"
Evaluating: -43.9652112+3.5
 Parameter: YMAX <- "-40.4652112"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.1563393"
Evaluating: -33.1563393+3.5
 Parameter: ZMAX <- "-29.6563393"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.80548721"
Evaluating: -4.80548721-3.5
 Parameter: XMIN <- "-8.30548721"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.9652112"
Evaluating: -43.9652112-3.5
 Parameter: YMIN <- "-47.4652112"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.1563393"
Evaluating: -33.1563393-3.5
 Parameter: ZMIN <- "-36.6563393"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.30548721"
 Parameter: XMIN -> "-8.30548721"
 Parameter: YMAX -> "-40.4652112"
 Parameter: YMIN -> "-47.4652112"
 Parameter: ZMAX -> "-29.6563393"
 Parameter: ZMIN -> "-36.6563393"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "27" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "27" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.982525004"
Evaluating: 90.067469*(0.982525004-0.5)
 Parameter: XPOS <- "43.4598058"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.944249151"
Evaluating: 90.067469*(0.944249151-0.5)
 Parameter: YPOS <- "40.0123966"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.489543117"
Evaluating: 143.194738*(0.489543117-0.5)+3.5172451
 Parameter: ZPOS <- "2.01987448"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.01987448" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.01987448" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "27" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.210926465"
Evaluating: 90.067469*(0.210926465-0.5)
 Parameter: XPOS <- "-26.0361217"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.803435605"
Evaluating: 90.067469*(0.803435605-0.5)
 Parameter: YPOS <- "27.3296769"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.465966328"
Evaluating: 143.194738*(0.465966328-0.5)+3.5172451
 Parameter: ZPOS <- "-1.35619765"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-1.35619765" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-1.35619765" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "27" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.521890611"
Evaluating: 90.067469*(0.521890611-0.5)
 Parameter: XPOS <- "1.97163193"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "5.437558869E-02"
Evaluating: 90.067469*(5.437558869E-02-0.5)
 Parameter: YPOS <- "-40.1362629"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.585991363"
Evaluating: 143.194738*(0.585991363-0.5)+3.5172451
 Parameter: ZPOS <- "15.8307558"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.8307558" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.8307558" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.97163193"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.97163193-0
 Parameter: XTRAN <- "1.97163193"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.1362629"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.1362629-0
 Parameter: YTRAN <- "-40.1362629"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.8307558"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.8307558-0
 Parameter: ZTRAN <- "15.8307558"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.97163193"
 Parameter: YTRAN -> "-40.1362629"
 Parameter: ZTRAN -> "15.8307558"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     1.971632  -40.136263   15.830756
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.589019453E-02"
Evaluating: 2.589019453E-02*360.0
 Parameter: XPHI <- "9.32047003"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.409010291"
Evaluating: 0.409010291*360.0
 Parameter: YPHI <- "147.243705"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.14197623"
Evaluating: 0.14197623*360.0
 Parameter: ZPHI <- "51.1114428"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.97163193"
 Parameter: YPOS -> "-40.1362629"
 Parameter: ZPOS -> "15.8307558"
 Parameter: XPHI -> "9.32047003"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.986798    0.161956
    0.000000   -0.161956    0.986798

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    9.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.97163193"
 Parameter: YPOS -> "-40.1362629"
 Parameter: ZPOS -> "15.8307558"
 Parameter: YPHI -> "147.243705"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.840980    0.000000   -0.541067
    0.000000    1.000000    0.000000
    0.541067    0.000000   -0.840980

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  147.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.97163193"
 Parameter: YPOS -> "-40.1362629"
 Parameter: ZPOS -> "15.8307558"
 Parameter: ZPHI -> "51.1114428"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.627808    0.778369    0.000000
   -0.778369    0.627808    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   51.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.971632 XMAX =    1.971632 XAVE =    1.971632
    YMIN =  -40.136263 YMAX =  -40.136263 YAVE =  -40.136263
    ZMIN =   15.830756 ZMAX =   15.830756 ZAVE =   15.830756
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.97163193"
Evaluating: 1.97163193+3.5
 Parameter: XMAX <- "5.47163193"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.1362629"
Evaluating: -40.1362629+3.5
 Parameter: YMAX <- "-36.6362629"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.8307558"
Evaluating: 15.8307558+3.5
 Parameter: ZMAX <- "19.3307558"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.97163193"
Evaluating: 1.97163193-3.5
 Parameter: XMIN <- "-1.52836807"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.1362629"
Evaluating: -40.1362629-3.5
 Parameter: YMIN <- "-43.6362629"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.8307558"
Evaluating: 15.8307558-3.5
 Parameter: ZMIN <- "12.3307558"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.47163193"
 Parameter: XMIN -> "-1.52836807"
 Parameter: YMAX -> "-36.6362629"
 Parameter: YMIN -> "-43.6362629"
 Parameter: ZMAX -> "19.3307558"
 Parameter: ZMIN -> "12.3307558"
 SELRPN>     10 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      2 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
34988 POS      SOD      27       SOD     -**** MEMB     POPC     57       C11           3.9229
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "27" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.854707394"
Evaluating: 90.067469*(0.854707394-0.5)
 Parameter: XPOS <- "31.9475972"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.256727418"
Evaluating: 90.067469*(0.256727418-0.5)
 Parameter: YPOS <- "-21.9109457"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.233256657"
Evaluating: 143.194738*(0.233256657-0.5)+3.5172451
 Parameter: ZPOS <- "-34.678998"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.678998" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.971632 XMAX =    1.971632 XAVE =    1.971632
    YMIN =  -40.136263 YMAX =  -40.136263 YAVE =  -40.136263
    ZMIN =   15.830756 ZMAX =   15.830756 ZAVE =   15.830756
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.9475972"
 RDCMND substituted energy or value "?XAVE" to "1.97163193"
Evaluating: 31.9475972-1.97163193
 Parameter: XTRAN <- "29.9759653"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.9109457"
 RDCMND substituted energy or value "?YAVE" to "-40.1362629"
Evaluating: -21.9109457--40.1362629
 Parameter: YTRAN <- "18.2253172"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.678998"
 RDCMND substituted energy or value "?ZAVE" to "15.8307558"
Evaluating: -34.678998-15.8307558
 Parameter: ZTRAN <- "-50.5097538"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.9759653"
 Parameter: YTRAN -> "18.2253172"
 Parameter: ZTRAN -> "-50.5097538"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    29.975965   18.225317  -50.509754
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.13345862"
Evaluating: 0.13345862*360.0
 Parameter: XPHI <- "48.0451032"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.890801257"
Evaluating: 0.890801257*360.0
 Parameter: YPHI <- "320.688453"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67592364"
Evaluating: 0.67592364*360.0
 Parameter: ZPHI <- "243.33251"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.9475972"
 Parameter: YPOS -> "-21.9109457"
 Parameter: ZPOS -> "-34.678998"
 Parameter: XPHI -> "48.0451032"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.668545    0.743671
    0.000000   -0.743671    0.668545

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   48.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.9475972"
 Parameter: YPOS -> "-21.9109457"
 Parameter: ZPOS -> "-34.678998"
 Parameter: YPHI -> "320.688453"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.773713    0.000000    0.633537
    0.000000    1.000000    0.000000
   -0.633537    0.000000    0.773713

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.9475972"
 Parameter: YPOS -> "-21.9109457"
 Parameter: ZPOS -> "-34.678998"
 Parameter: ZPHI -> "243.33251"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.448812   -0.893626    0.000000
    0.893626   -0.448812    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  116.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.947597 XMAX =   31.947597 XAVE =   31.947597
    YMIN =  -21.910946 YMAX =  -21.910946 YAVE =  -21.910946
    ZMIN =  -34.678998 ZMAX =  -34.678998 ZAVE =  -34.678998
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.9475972"
Evaluating: 31.9475972+3.5
 Parameter: XMAX <- "35.4475972"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.9109457"
Evaluating: -21.9109457+3.5
 Parameter: YMAX <- "-18.4109457"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.678998"
Evaluating: -34.678998+3.5
 Parameter: ZMAX <- "-31.178998"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.9475972"
Evaluating: 31.9475972-3.5
 Parameter: XMIN <- "28.4475972"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.9109457"
Evaluating: -21.9109457-3.5
 Parameter: YMIN <- "-25.4109457"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.678998"
Evaluating: -34.678998-3.5
 Parameter: ZMIN <- "-38.178998"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.4475972"
 Parameter: XMIN -> "28.4475972"
 Parameter: YMAX -> "-18.4109457"
 Parameter: YMIN -> "-25.4109457"
 Parameter: ZMAX -> "-31.178998"
 Parameter: ZMIN -> "-38.178998"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "28" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "28" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.951988722E-02"
Evaluating: 90.067469*(8.951988722E-02-0.5)
 Parameter: XPOS <- "-36.9709048"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.128351423"
Evaluating: 90.067469*(0.128351423-0.5)
 Parameter: YPOS <- "-33.4734467"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.84099761"
Evaluating: 143.194738*(0.84099761-0.5)+3.5172451
 Parameter: ZPOS <- "52.3463085"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.3463085" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.3463085" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.9709048"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.9709048-0
 Parameter: XTRAN <- "-36.9709048"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.4734467"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.4734467-0
 Parameter: YTRAN <- "-33.4734467"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.3463085"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 52.3463085-0
 Parameter: ZTRAN <- "52.3463085"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.9709048"
 Parameter: YTRAN -> "-33.4734467"
 Parameter: ZTRAN -> "52.3463085"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -36.970905  -33.473447   52.346308
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.175817573"
Evaluating: 0.175817573*360.0
 Parameter: XPHI <- "63.2943263"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.601492621"
Evaluating: 0.601492621*360.0
 Parameter: YPHI <- "216.537344"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.416047807"
Evaluating: 0.416047807*360.0
 Parameter: ZPHI <- "149.777211"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.9709048"
 Parameter: YPOS -> "-33.4734467"
 Parameter: ZPOS -> "52.3463085"
 Parameter: XPHI -> "63.2943263"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.449407    0.893327
    0.000000   -0.893327    0.449407

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   63.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.9709048"
 Parameter: YPOS -> "-33.4734467"
 Parameter: ZPOS -> "52.3463085"
 Parameter: YPHI -> "216.537344"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.803469    0.000000    0.595347
    0.000000    1.000000    0.000000
   -0.595347    0.000000   -0.803469

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  143.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.9709048"
 Parameter: YPOS -> "-33.4734467"
 Parameter: ZPOS -> "52.3463085"
 Parameter: ZPHI -> "149.777211"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.864075    0.503364    0.000000
   -0.503364   -0.864075    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  149.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.970905 XMAX =  -36.970905 XAVE =  -36.970905
    YMIN =  -33.473447 YMAX =  -33.473447 YAVE =  -33.473447
    ZMIN =   52.346308 ZMAX =   52.346308 ZAVE =   52.346308
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.9709048"
Evaluating: -36.9709048+3.5
 Parameter: XMAX <- "-33.4709048"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.4734467"
Evaluating: -33.4734467+3.5
 Parameter: YMAX <- "-29.9734467"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.3463085"
Evaluating: 52.3463085+3.5
 Parameter: ZMAX <- "55.8463085"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.9709048"
Evaluating: -36.9709048-3.5
 Parameter: XMIN <- "-40.4709048"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.4734467"
Evaluating: -33.4734467-3.5
 Parameter: YMIN <- "-36.9734467"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.3463085"
Evaluating: 52.3463085-3.5
 Parameter: ZMIN <- "48.8463085"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.4709048"
 Parameter: XMIN -> "-40.4709048"
 Parameter: YMAX -> "-29.9734467"
 Parameter: YMIN -> "-36.9734467"
 Parameter: ZMAX -> "55.8463085"
 Parameter: ZMIN -> "48.8463085"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "29" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "29" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.229249027"
Evaluating: 90.067469*(0.229249027-0.5)
 Parameter: XPOS <- "-24.3858549"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.3037703"
Evaluating: 90.067469*(0.3037703-0.5)
 Parameter: YPOS <- "-17.6739124"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.116412555"
Evaluating: 143.194738*(0.116412555-0.5)+3.5172451
 Parameter: ZPOS <- "-51.4104586"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-51.4104586" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.3858549"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.3858549-0
 Parameter: XTRAN <- "-24.3858549"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.6739124"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -17.6739124-0
 Parameter: YTRAN <- "-17.6739124"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-51.4104586"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -51.4104586-0
 Parameter: ZTRAN <- "-51.4104586"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.3858549"
 Parameter: YTRAN -> "-17.6739124"
 Parameter: ZTRAN -> "-51.4104586"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -24.385855  -17.673912  -51.410459
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.263063998"
Evaluating: 0.263063998*360.0
 Parameter: XPHI <- "94.7030393"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179757656"
Evaluating: 0.179757656*360.0
 Parameter: YPHI <- "64.7127562"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.913327339"
Evaluating: 0.913327339*360.0
 Parameter: ZPHI <- "328.797842"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.3858549"
 Parameter: YPOS -> "-17.6739124"
 Parameter: ZPOS -> "-51.4104586"
 Parameter: XPHI -> "94.7030393"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.081991    0.996633
    0.000000   -0.996633   -0.081991

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   94.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.3858549"
 Parameter: YPOS -> "-17.6739124"
 Parameter: ZPOS -> "-51.4104586"
 Parameter: YPHI -> "64.7127562"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.427157    0.000000   -0.904178
    0.000000    1.000000    0.000000
    0.904178    0.000000    0.427157

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   64.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.3858549"
 Parameter: YPOS -> "-17.6739124"
 Parameter: ZPOS -> "-51.4104586"
 Parameter: ZPHI -> "328.797842"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.855345   -0.518059    0.000000
    0.518059    0.855345    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   31.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.385855 XMAX =  -24.385855 XAVE =  -24.385855
    YMIN =  -17.673912 YMAX =  -17.673912 YAVE =  -17.673912
    ZMIN =  -51.410459 ZMAX =  -51.410459 ZAVE =  -51.410459
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.3858549"
Evaluating: -24.3858549+3.5
 Parameter: XMAX <- "-20.8858549"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.6739124"
Evaluating: -17.6739124+3.5
 Parameter: YMAX <- "-14.1739124"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-51.4104586"
Evaluating: -51.4104586+3.5
 Parameter: ZMAX <- "-47.9104586"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.3858549"
Evaluating: -24.3858549-3.5
 Parameter: XMIN <- "-27.8858549"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.6739124"
Evaluating: -17.6739124-3.5
 Parameter: YMIN <- "-21.1739124"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-51.4104586"
Evaluating: -51.4104586-3.5
 Parameter: ZMIN <- "-54.9104586"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.8858549"
 Parameter: XMIN -> "-27.8858549"
 Parameter: YMAX -> "-14.1739124"
 Parameter: YMIN -> "-21.1739124"
 Parameter: ZMAX -> "-47.9104586"
 Parameter: ZMIN -> "-54.9104586"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "30" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "30" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.370697835"
Evaluating: 90.067469*(0.370697835-0.5)
 Parameter: XPOS <- "-11.6459187"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.610774573"
Evaluating: 90.067469*(0.610774573-0.5)
 Parameter: YPOS <- "9.97718542"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.841217275"
Evaluating: 143.194738*(0.841217275-0.5)+3.5172451
 Parameter: ZPOS <- "52.3777634"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.3777634" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.3777634" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.6459187"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -11.6459187-0
 Parameter: XTRAN <- "-11.6459187"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.97718542"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.97718542-0
 Parameter: YTRAN <- "9.97718542"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.3777634"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 52.3777634-0
 Parameter: ZTRAN <- "52.3777634"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.6459187"
 Parameter: YTRAN -> "9.97718542"
 Parameter: ZTRAN -> "52.3777634"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -11.645919    9.977185   52.377763
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.976262497"
Evaluating: 0.976262497*360.0
 Parameter: XPHI <- "351.454499"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919211097"
Evaluating: 0.919211097*360.0
 Parameter: YPHI <- "330.915995"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.210323996"
Evaluating: 0.210323996*360.0
 Parameter: ZPHI <- "75.7166386"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.6459187"
 Parameter: YPOS -> "9.97718542"
 Parameter: ZPOS -> "52.3777634"
 Parameter: XPHI -> "351.454499"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.988898   -0.148595
    0.000000    0.148595    0.988898

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    8.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.6459187"
 Parameter: YPOS -> "9.97718542"
 Parameter: ZPOS -> "52.3777634"
 Parameter: YPHI -> "330.915995"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.873908    0.000000    0.486091
    0.000000    1.000000    0.000000
   -0.486091    0.000000    0.873908

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   29.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.6459187"
 Parameter: YPOS -> "9.97718542"
 Parameter: ZPOS -> "52.3777634"
 Parameter: ZPHI -> "75.7166386"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.246718    0.969087    0.000000
   -0.969087    0.246718    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   75.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.645919 XMAX =  -11.645919 XAVE =  -11.645919
    YMIN =    9.977185 YMAX =    9.977185 YAVE =    9.977185
    ZMIN =   52.377763 ZMAX =   52.377763 ZAVE =   52.377763
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.6459187"
Evaluating: -11.6459187+3.5
 Parameter: XMAX <- "-8.1459187"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.97718542"
Evaluating: 9.97718542+3.5
 Parameter: YMAX <- "13.4771854"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.3777634"
Evaluating: 52.3777634+3.5
 Parameter: ZMAX <- "55.8777634"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.6459187"
Evaluating: -11.6459187-3.5
 Parameter: XMIN <- "-15.1459187"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.97718542"
Evaluating: 9.97718542-3.5
 Parameter: YMIN <- "6.47718542"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.3777634"
Evaluating: 52.3777634-3.5
 Parameter: ZMIN <- "48.8777634"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.1459187"
 Parameter: XMIN -> "-15.1459187"
 Parameter: YMAX -> "13.4771854"
 Parameter: YMIN -> "6.47718542"
 Parameter: ZMAX -> "55.8777634"
 Parameter: ZMIN -> "48.8777634"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "31" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "31" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.669779912"
Evaluating: 90.067469*(0.669779912-0.5)
 Parameter: XPOS <- "15.291647"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.6622417"
Evaluating: 90.067469*(0.6622417-0.5)
 Parameter: YPOS <- "14.6126993"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.633570566"
Evaluating: 143.194738*(0.633570566-0.5)+3.5172451
 Parameter: ZPOS <- "22.6438473"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.6438473" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.6438473" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.291647"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.291647-0
 Parameter: XTRAN <- "15.291647"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.6126993"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 14.6126993-0
 Parameter: YTRAN <- "14.6126993"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.6438473"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.6438473-0
 Parameter: ZTRAN <- "22.6438473"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.291647"
 Parameter: YTRAN -> "14.6126993"
 Parameter: ZTRAN -> "22.6438473"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    15.291647   14.612699   22.643847
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.621124336"
Evaluating: 0.621124336*360.0
 Parameter: XPHI <- "223.604761"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.894566166"
Evaluating: 0.894566166*360.0
 Parameter: YPHI <- "322.04382"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.116957241"
Evaluating: 0.116957241*360.0
 Parameter: ZPHI <- "42.1046068"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.291647"
 Parameter: YPOS -> "14.6126993"
 Parameter: ZPOS -> "22.6438473"
 Parameter: XPHI -> "223.604761"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.724115   -0.689680
    0.000000    0.689680   -0.724115

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  136.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.291647"
 Parameter: YPOS -> "14.6126993"
 Parameter: ZPOS -> "22.6438473"
 Parameter: YPHI -> "322.04382"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.788481    0.000000    0.615059
    0.000000    1.000000    0.000000
   -0.615059    0.000000    0.788481

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   37.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.291647"
 Parameter: YPOS -> "14.6126993"
 Parameter: ZPOS -> "22.6438473"
 Parameter: ZPHI -> "42.1046068"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.741922    0.670486    0.000000
   -0.670486    0.741922    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   42.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.291647 XMAX =   15.291647 XAVE =   15.291647
    YMIN =   14.612699 YMAX =   14.612699 YAVE =   14.612699
    ZMIN =   22.643847 ZMAX =   22.643847 ZAVE =   22.643847
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.291647"
Evaluating: 15.291647+3.5
 Parameter: XMAX <- "18.791647"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.6126993"
Evaluating: 14.6126993+3.5
 Parameter: YMAX <- "18.1126993"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.6438473"
Evaluating: 22.6438473+3.5
 Parameter: ZMAX <- "26.1438473"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.291647"
Evaluating: 15.291647-3.5
 Parameter: XMIN <- "11.791647"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.6126993"
Evaluating: 14.6126993-3.5
 Parameter: YMIN <- "11.1126993"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.6438473"
Evaluating: 22.6438473-3.5
 Parameter: ZMIN <- "19.1438473"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.791647"
 Parameter: XMIN -> "11.791647"
 Parameter: YMAX -> "18.1126993"
 Parameter: YMIN -> "11.1126993"
 Parameter: ZMAX -> "26.1438473"
 Parameter: ZMIN -> "19.1438473"
 SELRPN>     11 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      2 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
34992 POS      SOD      31       SOD     -6876 PROA     ILE      460      O             5.4034
34992 POS      SOD      31       SOD     -6923 PROA     LEU      463      CD2           3.8342
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "31" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.174235097"
Evaluating: 90.067469*(0.174235097-0.5)
 Parameter: XPOS <- "-29.3408203"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "3.637358827E-02"
Evaluating: 90.067469*(3.637358827E-02-0.5)
 Parameter: YPOS <- "-41.7576575"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.224804851"
Evaluating: 143.194738*(0.224804851-0.5)+3.5172451
 Parameter: ZPOS <- "-35.8892522"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.8892522" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.291647 XMAX =   15.291647 XAVE =   15.291647
    YMIN =   14.612699 YMAX =   14.612699 YAVE =   14.612699
    ZMIN =   22.643847 ZMAX =   22.643847 ZAVE =   22.643847
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.3408203"
 RDCMND substituted energy or value "?XAVE" to "15.291647"
Evaluating: -29.3408203-15.291647
 Parameter: XTRAN <- "-44.6324673"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.7576575"
 RDCMND substituted energy or value "?YAVE" to "14.6126993"
Evaluating: -41.7576575-14.6126993
 Parameter: YTRAN <- "-56.3703568"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.8892522"
 RDCMND substituted energy or value "?ZAVE" to "22.6438473"
Evaluating: -35.8892522-22.6438473
 Parameter: ZTRAN <- "-58.5330995"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.6324673"
 Parameter: YTRAN -> "-56.3703568"
 Parameter: ZTRAN -> "-58.5330995"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -44.632467  -56.370357  -58.533099
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.19154133"
Evaluating: 0.19154133*360.0
 Parameter: XPHI <- "68.9548788"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.906339962"
Evaluating: 0.906339962*360.0
 Parameter: YPHI <- "326.282386"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.72610744"
Evaluating: 0.72610744*360.0
 Parameter: ZPHI <- "261.398678"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.3408203"
 Parameter: YPOS -> "-41.7576575"
 Parameter: ZPOS -> "-35.8892522"
 Parameter: XPHI -> "68.9548788"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.359103    0.933298
    0.000000   -0.933298    0.359103

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   68.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.3408203"
 Parameter: YPOS -> "-41.7576575"
 Parameter: ZPOS -> "-35.8892522"
 Parameter: YPHI -> "326.282386"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.831784    0.000000    0.555100
    0.000000    1.000000    0.000000
   -0.555100    0.000000    0.831784

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   33.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.3408203"
 Parameter: YPOS -> "-41.7576575"
 Parameter: ZPOS -> "-35.8892522"
 Parameter: ZPHI -> "261.398678"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.149558   -0.988753    0.000000
    0.988753   -0.149558    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   98.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.340820 XMAX =  -29.340820 XAVE =  -29.340820
    YMIN =  -41.757658 YMAX =  -41.757658 YAVE =  -41.757658
    ZMIN =  -35.889252 ZMAX =  -35.889252 ZAVE =  -35.889252
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.3408203"
Evaluating: -29.3408203+3.5
 Parameter: XMAX <- "-25.8408203"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.7576575"
Evaluating: -41.7576575+3.5
 Parameter: YMAX <- "-38.2576575"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.8892522"
Evaluating: -35.8892522+3.5
 Parameter: ZMAX <- "-32.3892522"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.3408203"
Evaluating: -29.3408203-3.5
 Parameter: XMIN <- "-32.8408203"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.7576575"
Evaluating: -41.7576575-3.5
 Parameter: YMIN <- "-45.2576575"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.8892522"
Evaluating: -35.8892522-3.5
 Parameter: ZMIN <- "-39.3892522"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.8408203"
 Parameter: XMIN -> "-32.8408203"
 Parameter: YMAX -> "-38.2576575"
 Parameter: YMIN -> "-45.2576575"
 Parameter: ZMAX -> "-32.3892522"
 Parameter: ZMIN -> "-39.3892522"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "32" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "32" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.656930496"
Evaluating: 90.067469*(0.656930496-0.5)
 Parameter: XPOS <- "14.1343326"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.845358374"
Evaluating: 90.067469*(0.845358374-0.5)
 Parameter: YPOS <- "31.1055546"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.783121533"
Evaluating: 143.194738*(0.783121533-0.5)+3.5172451
 Parameter: ZPOS <- "44.0587588"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.0587588" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.0587588" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.1343326"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.1343326-0
 Parameter: XTRAN <- "14.1343326"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.1055546"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.1055546-0
 Parameter: YTRAN <- "31.1055546"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.0587588"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.0587588-0
 Parameter: ZTRAN <- "44.0587588"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.1343326"
 Parameter: YTRAN -> "31.1055546"
 Parameter: ZTRAN -> "44.0587588"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    14.134333   31.105555   44.058759
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.389652083"
Evaluating: 0.389652083*360.0
 Parameter: XPHI <- "140.27475"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.60077912"
Evaluating: 0.60077912*360.0
 Parameter: YPHI <- "216.280483"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.102640236"
Evaluating: 0.102640236*360.0
 Parameter: ZPHI <- "36.950485"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.1343326"
 Parameter: YPOS -> "31.1055546"
 Parameter: ZPOS -> "44.0587588"
 Parameter: XPHI -> "140.27475"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.769118    0.639107
    0.000000   -0.639107   -0.769118

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  140.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.1343326"
 Parameter: YPOS -> "31.1055546"
 Parameter: ZPOS -> "44.0587588"
 Parameter: YPHI -> "216.280483"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.806130    0.000000    0.591739
    0.000000    1.000000    0.000000
   -0.591739    0.000000   -0.806130

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  143.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.1343326"
 Parameter: YPOS -> "31.1055546"
 Parameter: ZPOS -> "44.0587588"
 Parameter: ZPHI -> "36.950485"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.799155    0.601125    0.000000
   -0.601125    0.799155    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   36.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.134333 XMAX =   14.134333 XAVE =   14.134333
    YMIN =   31.105555 YMAX =   31.105555 YAVE =   31.105555
    ZMIN =   44.058759 ZMAX =   44.058759 ZAVE =   44.058759
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.1343326"
Evaluating: 14.1343326+3.5
 Parameter: XMAX <- "17.6343326"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.1055546"
Evaluating: 31.1055546+3.5
 Parameter: YMAX <- "34.6055546"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.0587588"
Evaluating: 44.0587588+3.5
 Parameter: ZMAX <- "47.5587588"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.1343326"
Evaluating: 14.1343326-3.5
 Parameter: XMIN <- "10.6343326"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.1055546"
Evaluating: 31.1055546-3.5
 Parameter: YMIN <- "27.6055546"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.0587588"
Evaluating: 44.0587588-3.5
 Parameter: ZMIN <- "40.5587588"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.6343326"
 Parameter: XMIN -> "10.6343326"
 Parameter: YMAX -> "34.6055546"
 Parameter: YMIN -> "27.6055546"
 Parameter: ZMAX -> "47.5587588"
 Parameter: ZMIN -> "40.5587588"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "33" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "33" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.763012598"
Evaluating: 90.067469*(0.763012598-0.5)
 Parameter: XPOS <- "23.688879"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "7.143322577E-02"
Evaluating: 90.067469*(7.143322577E-02-0.5)
 Parameter: YPOS <- "-38.5999247"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.48771944"
Evaluating: 143.194738*(0.48771944-0.5)+3.5172451
 Parameter: ZPOS <- "1.75873353"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.75873353" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.75873353" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "33" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "4.251183223E-03"
Evaluating: 90.067469*(4.251183223E-03-0.5)
 Parameter: XPOS <- "-44.6508412"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.895670209"
Evaluating: 90.067469*(0.895670209-0.5)
 Parameter: YPOS <- "35.6370143"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.420418982"
Evaluating: 143.194738*(0.420418982-0.5)+3.5172451
 Parameter: ZPOS <- "-7.87833792"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-7.87833792" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-7.87833792" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "33" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.879150018"
Evaluating: 90.067469*(0.879150018-0.5)
 Parameter: XPOS <- "34.1490825"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.266538312"
Evaluating: 90.067469*(0.266538312-0.5)
 Parameter: YPOS <- "-21.0273033"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.729099928"
Evaluating: 143.194738*(0.729099928-0.5)+3.5172451
 Parameter: ZPOS <- "36.3231493"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.3231493" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.3231493" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.1490825"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 34.1490825-0
 Parameter: XTRAN <- "34.1490825"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.0273033"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -21.0273033-0
 Parameter: YTRAN <- "-21.0273033"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.3231493"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.3231493-0
 Parameter: ZTRAN <- "36.3231493"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "34.1490825"
 Parameter: YTRAN -> "-21.0273033"
 Parameter: ZTRAN -> "36.3231493"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    34.149082  -21.027303   36.323149
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.737305476"
Evaluating: 0.737305476*360.0
 Parameter: XPHI <- "265.429971"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.663201859"
Evaluating: 0.663201859*360.0
 Parameter: YPHI <- "238.752669"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.944337681"
Evaluating: 0.944337681*360.0
 Parameter: ZPHI <- "339.961565"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.1490825"
 Parameter: YPOS -> "-21.0273033"
 Parameter: ZPOS -> "36.3231493"
 Parameter: XPHI -> "265.429971"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.079678   -0.996821
    0.000000    0.996821   -0.079678

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   94.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.1490825"
 Parameter: YPOS -> "-21.0273033"
 Parameter: ZPOS -> "36.3231493"
 Parameter: YPHI -> "238.752669"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.518733    0.000000    0.854936
    0.000000    1.000000    0.000000
   -0.854936    0.000000   -0.518733

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  121.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.1490825"
 Parameter: YPOS -> "-21.0273033"
 Parameter: ZPOS -> "36.3231493"
 Parameter: ZPHI -> "339.961565"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.939463   -0.342650    0.000000
    0.342650    0.939463    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   20.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.149082 XMAX =   34.149082 XAVE =   34.149082
    YMIN =  -21.027303 YMAX =  -21.027303 YAVE =  -21.027303
    ZMIN =   36.323149 ZMAX =   36.323149 ZAVE =   36.323149
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.1490825"
Evaluating: 34.1490825+3.5
 Parameter: XMAX <- "37.6490825"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.0273033"
Evaluating: -21.0273033+3.5
 Parameter: YMAX <- "-17.5273033"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.3231493"
Evaluating: 36.3231493+3.5
 Parameter: ZMAX <- "39.8231493"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.1490825"
Evaluating: 34.1490825-3.5
 Parameter: XMIN <- "30.6490825"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.0273033"
Evaluating: -21.0273033-3.5
 Parameter: YMIN <- "-24.5273033"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.3231493"
Evaluating: 36.3231493-3.5
 Parameter: ZMIN <- "32.8231493"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.6490825"
 Parameter: XMIN -> "30.6490825"
 Parameter: YMAX -> "-17.5273033"
 Parameter: YMIN -> "-24.5273033"
 Parameter: ZMAX -> "39.8231493"
 Parameter: ZMIN -> "32.8231493"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "34" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "34" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.280464158"
Evaluating: 90.067469*(0.280464158-0.5)
 Parameter: XPOS <- "-19.7730376"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.469404461"
Evaluating: 90.067469*(0.469404461-0.5)
 Parameter: YPOS <- "-2.75566276"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.457962711"
Evaluating: 143.194738*(0.457962711-0.5)+3.5172451
 Parameter: ZPOS <- "-2.50227348"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.50227348" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.50227348" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "34" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.653157096"
Evaluating: 90.067469*(0.653157096-0.5)
 Parameter: XPOS <- "13.794472"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.879183413"
Evaluating: 90.067469*(0.879183413-0.5)
 Parameter: YPOS <- "34.1520903"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.250294542"
Evaluating: 143.194738*(0.250294542-0.5)+3.5172451
 Parameter: ZPOS <- "-32.2392625"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.2392625" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.794472"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.794472-0
 Parameter: XTRAN <- "13.794472"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.1520903"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.1520903-0
 Parameter: YTRAN <- "34.1520903"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.2392625"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.2392625-0
 Parameter: ZTRAN <- "-32.2392625"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.794472"
 Parameter: YTRAN -> "34.1520903"
 Parameter: ZTRAN -> "-32.2392625"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    13.794472   34.152090  -32.239263
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.454902671"
Evaluating: 0.454902671*360.0
 Parameter: XPHI <- "163.764962"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.185696694"
Evaluating: 0.185696694*360.0
 Parameter: YPHI <- "66.8508098"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.581713852"
Evaluating: 0.581713852*360.0
 Parameter: ZPHI <- "209.416987"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.794472"
 Parameter: YPOS -> "34.1520903"
 Parameter: ZPOS -> "-32.2392625"
 Parameter: XPHI -> "163.764962"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.960123    0.279578
    0.000000   -0.279578   -0.960123

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  163.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.794472"
 Parameter: YPOS -> "34.1520903"
 Parameter: ZPOS -> "-32.2392625"
 Parameter: YPHI -> "66.8508098"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.393127    0.000000   -0.919484
    0.000000    1.000000    0.000000
    0.919484    0.000000    0.393127

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   66.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.794472"
 Parameter: YPOS -> "34.1520903"
 Parameter: ZPOS -> "-32.2392625"
 Parameter: ZPHI -> "209.416987"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.871068   -0.491162    0.000000
    0.491162   -0.871068    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  150.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.794472 XMAX =   13.794472 XAVE =   13.794472
    YMIN =   34.152090 YMAX =   34.152090 YAVE =   34.152090
    ZMIN =  -32.239263 ZMAX =  -32.239263 ZAVE =  -32.239263
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.794472"
Evaluating: 13.794472+3.5
 Parameter: XMAX <- "17.294472"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.1520903"
Evaluating: 34.1520903+3.5
 Parameter: YMAX <- "37.6520903"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.2392625"
Evaluating: -32.2392625+3.5
 Parameter: ZMAX <- "-28.7392625"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.794472"
Evaluating: 13.794472-3.5
 Parameter: XMIN <- "10.294472"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.1520903"
Evaluating: 34.1520903-3.5
 Parameter: YMIN <- "30.6520903"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.2392625"
Evaluating: -32.2392625-3.5
 Parameter: ZMIN <- "-35.7392625"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.294472"
 Parameter: XMIN -> "10.294472"
 Parameter: YMAX -> "37.6520903"
 Parameter: YMIN -> "30.6520903"
 Parameter: ZMAX -> "-28.7392625"
 Parameter: ZMIN -> "-35.7392625"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "35" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "35" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.628289771"
Evaluating: 90.067469*(0.628289771-0.5)
 Parameter: XPOS <- "11.554735"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.299237516"
Evaluating: 90.067469*(0.299237516-0.5)
 Parameter: YPOS <- "-18.0821688"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.760963542"
Evaluating: 143.194738*(0.760963542-0.5)+3.5172451
 Parameter: ZPOS <- "40.8858511"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.8858511" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.8858511" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.554735"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.554735-0
 Parameter: XTRAN <- "11.554735"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.0821688"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.0821688-0
 Parameter: YTRAN <- "-18.0821688"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.8858511"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.8858511-0
 Parameter: ZTRAN <- "40.8858511"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.554735"
 Parameter: YTRAN -> "-18.0821688"
 Parameter: ZTRAN -> "40.8858511"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    11.554735  -18.082169   40.885851
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.220960988"
Evaluating: 0.220960988*360.0
 Parameter: XPHI <- "79.5459557"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.465059078"
Evaluating: 0.465059078*360.0
 Parameter: YPHI <- "167.421268"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.860078247"
Evaluating: 0.860078247*360.0
 Parameter: ZPHI <- "309.628169"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.554735"
 Parameter: YPOS -> "-18.0821688"
 Parameter: ZPOS -> "40.8858511"
 Parameter: XPHI -> "79.5459557"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.181447    0.983401
    0.000000   -0.983401    0.181447

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   79.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.554735"
 Parameter: YPOS -> "-18.0821688"
 Parameter: ZPOS -> "40.8858511"
 Parameter: YPHI -> "167.421268"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.975998    0.000000   -0.217781
    0.000000    1.000000    0.000000
    0.217781    0.000000   -0.975998

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  167.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.554735"
 Parameter: YPOS -> "-18.0821688"
 Parameter: ZPOS -> "40.8858511"
 Parameter: ZPHI -> "309.628169"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.637803   -0.770200    0.000000
    0.770200    0.637803    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   50.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.554735 XMAX =   11.554735 XAVE =   11.554735
    YMIN =  -18.082169 YMAX =  -18.082169 YAVE =  -18.082169
    ZMIN =   40.885851 ZMAX =   40.885851 ZAVE =   40.885851
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.554735"
Evaluating: 11.554735+3.5
 Parameter: XMAX <- "15.054735"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.0821688"
Evaluating: -18.0821688+3.5
 Parameter: YMAX <- "-14.5821688"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.8858511"
Evaluating: 40.8858511+3.5
 Parameter: ZMAX <- "44.3858511"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.554735"
Evaluating: 11.554735-3.5
 Parameter: XMIN <- "8.054735"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.0821688"
Evaluating: -18.0821688-3.5
 Parameter: YMIN <- "-21.5821688"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.8858511"
Evaluating: 40.8858511-3.5
 Parameter: ZMIN <- "37.3858511"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.054735"
 Parameter: XMIN -> "8.054735"
 Parameter: YMAX -> "-14.5821688"
 Parameter: YMIN -> "-21.5821688"
 Parameter: ZMAX -> "44.3858511"
 Parameter: ZMIN -> "37.3858511"
 SELRPN>      2 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "36" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "36" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.733071721"
Evaluating: 90.067469*(0.733071721-0.5)
 Parameter: XPOS <- "20.99218"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.267332842"
Evaluating: 90.067469*(0.267332842-0.5)
 Parameter: YPOS <- "-20.955742"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.306544974"
Evaluating: 143.194738*(0.306544974-0.5)+3.5172451
 Parameter: ZPOS <- "-24.1844967"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.1844967" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.99218"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 20.99218-0
 Parameter: XTRAN <- "20.99218"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.955742"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.955742-0
 Parameter: YTRAN <- "-20.955742"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.1844967"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -24.1844967-0
 Parameter: ZTRAN <- "-24.1844967"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.99218"
 Parameter: YTRAN -> "-20.955742"
 Parameter: ZTRAN -> "-24.1844967"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    20.992180  -20.955742  -24.184497
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.486417015"
Evaluating: 0.486417015*360.0
 Parameter: XPHI <- "175.110125"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.954273709E-02"
Evaluating: 2.954273709E-02*360.0
 Parameter: YPHI <- "10.6353854"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.042483655E-02"
Evaluating: 1.042483655E-02*360.0
 Parameter: ZPHI <- "3.75294116"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.99218"
 Parameter: YPOS -> "-20.955742"
 Parameter: ZPOS -> "-24.1844967"
 Parameter: XPHI -> "175.110125"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.996360    0.085241
    0.000000   -0.085241   -0.996360

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  175.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.99218"
 Parameter: YPOS -> "-20.955742"
 Parameter: ZPOS -> "-24.1844967"
 Parameter: YPHI -> "10.6353854"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.982822    0.000000   -0.184558
    0.000000    1.000000    0.000000
    0.184558    0.000000    0.982822

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   10.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.99218"
 Parameter: YPOS -> "-20.955742"
 Parameter: ZPOS -> "-24.1844967"
 Parameter: ZPHI -> "3.75294116"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.997856    0.065454    0.000000
   -0.065454    0.997856    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    3.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.992180 XMAX =   20.992180 XAVE =   20.992180
    YMIN =  -20.955742 YMAX =  -20.955742 YAVE =  -20.955742
    ZMIN =  -24.184497 ZMAX =  -24.184497 ZAVE =  -24.184497
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.99218"
Evaluating: 20.99218+3.5
 Parameter: XMAX <- "24.49218"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.955742"
Evaluating: -20.955742+3.5
 Parameter: YMAX <- "-17.455742"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.1844967"
Evaluating: -24.1844967+3.5
 Parameter: ZMAX <- "-20.6844967"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.99218"
Evaluating: 20.99218-3.5
 Parameter: XMIN <- "17.49218"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.955742"
Evaluating: -20.955742-3.5
 Parameter: YMIN <- "-24.455742"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.1844967"
Evaluating: -24.1844967-3.5
 Parameter: ZMIN <- "-27.6844967"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.49218"
 Parameter: XMIN -> "17.49218"
 Parameter: YMAX -> "-17.455742"
 Parameter: YMIN -> "-24.455742"
 Parameter: ZMAX -> "-20.6844967"
 Parameter: ZMIN -> "-27.6844967"
 SELRPN>      5 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      1 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
34997 POS      SOD      36       SOD     -**** MEMB     POPC     124      C15           3.1928
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "36" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.713172629"
Evaluating: 90.067469*(0.713172629-0.5)
 Parameter: XPOS <- "19.1999192"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.515841475"
Evaluating: 90.067469*(0.515841475-0.5)
 Parameter: YPOS <- "1.42680156"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.539701391"
Evaluating: 143.194738*(0.539701391-0.5)+3.5172451
 Parameter: ZPOS <- "9.20227538"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.20227538" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.20227538" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "36" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.909476546"
Evaluating: 90.067469*(0.909476546-0.5)
 Parameter: XPOS <- "36.8805161"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.251856974"
Evaluating: 90.067469*(0.251856974-0.5)
 Parameter: YPOS <- "-22.3496143"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.29590487"
Evaluating: 143.194738*(0.29590487-0.5)+3.5172451
 Parameter: ZPOS <- "-25.7081036"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-25.7081036" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.992180 XMAX =   20.992180 XAVE =   20.992180
    YMIN =  -20.955742 YMAX =  -20.955742 YAVE =  -20.955742
    ZMIN =  -24.184497 ZMAX =  -24.184497 ZAVE =  -24.184497
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.8805161"
 RDCMND substituted energy or value "?XAVE" to "20.99218"
Evaluating: 36.8805161-20.99218
 Parameter: XTRAN <- "15.8883361"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.3496143"
 RDCMND substituted energy or value "?YAVE" to "-20.955742"
Evaluating: -22.3496143--20.955742
 Parameter: YTRAN <- "-1.3938723"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-25.7081036"
 RDCMND substituted energy or value "?ZAVE" to "-24.1844967"
Evaluating: -25.7081036--24.1844967
 Parameter: ZTRAN <- "-1.5236069"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.8883361"
 Parameter: YTRAN -> "-1.3938723"
 Parameter: ZTRAN -> "-1.5236069"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    15.888336   -1.393872   -1.523607
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.462133788"
Evaluating: 0.462133788*360.0
 Parameter: XPHI <- "166.368164"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.771595554"
Evaluating: 0.771595554*360.0
 Parameter: YPHI <- "277.774399"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.660045657"
Evaluating: 0.660045657*360.0
 Parameter: ZPHI <- "237.616437"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.8805161"
 Parameter: YPOS -> "-22.3496143"
 Parameter: ZPOS -> "-25.7081036"
 Parameter: XPHI -> "166.368164"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.971830    0.235682
    0.000000   -0.235682   -0.971830

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  166.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.8805161"
 Parameter: YPOS -> "-22.3496143"
 Parameter: ZPOS -> "-25.7081036"
 Parameter: YPHI -> "277.774399"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.135273    0.000000    0.990808
    0.000000    1.000000    0.000000
   -0.990808    0.000000    0.135273

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   82.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.8805161"
 Parameter: YPOS -> "-22.3496143"
 Parameter: ZPOS -> "-25.7081036"
 Parameter: ZPHI -> "237.616437"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.535585   -0.844482    0.000000
    0.844482   -0.535585    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  122.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.880516 XMAX =   36.880516 XAVE =   36.880516
    YMIN =  -22.349614 YMAX =  -22.349614 YAVE =  -22.349614
    ZMIN =  -25.708104 ZMAX =  -25.708104 ZAVE =  -25.708104
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.8805161"
Evaluating: 36.8805161+3.5
 Parameter: XMAX <- "40.3805161"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.3496143"
Evaluating: -22.3496143+3.5
 Parameter: YMAX <- "-18.8496143"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-25.7081036"
Evaluating: -25.7081036+3.5
 Parameter: ZMAX <- "-22.2081036"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.8805161"
Evaluating: 36.8805161-3.5
 Parameter: XMIN <- "33.3805161"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.3496143"
Evaluating: -22.3496143-3.5
 Parameter: YMIN <- "-25.8496143"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-25.7081036"
Evaluating: -25.7081036-3.5
 Parameter: ZMIN <- "-29.2081036"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.3805161"
 Parameter: XMIN -> "33.3805161"
 Parameter: YMAX -> "-18.8496143"
 Parameter: YMIN -> "-25.8496143"
 Parameter: ZMAX -> "-22.2081036"
 Parameter: ZMIN -> "-29.2081036"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "37" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "37" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.288791321"
Evaluating: 90.067469*(0.288791321-0.5)
 Parameter: XPOS <- "-19.0230311"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.217539717"
Evaluating: 90.067469*(0.217539717-0.5)
 Parameter: YPOS <- "-25.4404828"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.742779122"
Evaluating: 143.194738*(0.742779122-0.5)+3.5172451
 Parameter: ZPOS <- "38.2819379"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.2819379" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.2819379" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.0230311"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -19.0230311-0
 Parameter: XTRAN <- "-19.0230311"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.4404828"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.4404828-0
 Parameter: YTRAN <- "-25.4404828"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.2819379"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.2819379-0
 Parameter: ZTRAN <- "38.2819379"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-19.0230311"
 Parameter: YTRAN -> "-25.4404828"
 Parameter: ZTRAN -> "38.2819379"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -19.023031  -25.440483   38.281938
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.444227549E-02"
Evaluating: 4.444227549E-02*360.0
 Parameter: XPHI <- "15.9992192"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.150859407"
Evaluating: 0.150859407*360.0
 Parameter: YPHI <- "54.3093865"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.737724322"
Evaluating: 0.737724322*360.0
 Parameter: ZPHI <- "265.580756"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.0230311"
 Parameter: YPOS -> "-25.4404828"
 Parameter: ZPOS -> "38.2819379"
 Parameter: XPHI -> "15.9992192"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.961265    0.275624
    0.000000   -0.275624    0.961265

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   16.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.0230311"
 Parameter: YPOS -> "-25.4404828"
 Parameter: ZPOS -> "38.2819379"
 Parameter: YPHI -> "54.3093865"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.583408    0.000000   -0.812179
    0.000000    1.000000    0.000000
    0.812179    0.000000    0.583408

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   54.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.0230311"
 Parameter: YPOS -> "-25.4404828"
 Parameter: ZPOS -> "38.2819379"
 Parameter: ZPHI -> "265.580756"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.077054   -0.997027    0.000000
    0.997027   -0.077054    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   94.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.023031 XMAX =  -19.023031 XAVE =  -19.023031
    YMIN =  -25.440483 YMAX =  -25.440483 YAVE =  -25.440483
    ZMIN =   38.281938 ZMAX =   38.281938 ZAVE =   38.281938
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.0230311"
Evaluating: -19.0230311+3.5
 Parameter: XMAX <- "-15.5230311"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.4404828"
Evaluating: -25.4404828+3.5
 Parameter: YMAX <- "-21.9404828"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.2819379"
Evaluating: 38.2819379+3.5
 Parameter: ZMAX <- "41.7819379"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.0230311"
Evaluating: -19.0230311-3.5
 Parameter: XMIN <- "-22.5230311"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.4404828"
Evaluating: -25.4404828-3.5
 Parameter: YMIN <- "-28.9404828"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.2819379"
Evaluating: 38.2819379-3.5
 Parameter: ZMIN <- "34.7819379"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.5230311"
 Parameter: XMIN -> "-22.5230311"
 Parameter: YMAX -> "-21.9404828"
 Parameter: YMIN -> "-28.9404828"
 Parameter: ZMAX -> "41.7819379"
 Parameter: ZMIN -> "34.7819379"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "38" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "38" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.904517001"
Evaluating: 90.067469*(0.904517001-0.5)
 Parameter: XPOS <- "36.4338224"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "4.143052632E-02"
Evaluating: 90.067469*(4.143052632E-02-0.5)
 Parameter: YPOS <- "-41.3021919"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.869259061"
Evaluating: 143.194738*(0.869259061-0.5)+3.5172451
 Parameter: ZPOS <- "56.3931996"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.3931996" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.3931996" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.4338224"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.4338224-0
 Parameter: XTRAN <- "36.4338224"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.3021919"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -41.3021919-0
 Parameter: YTRAN <- "-41.3021919"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.3931996"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 56.3931996-0
 Parameter: ZTRAN <- "56.3931996"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.4338224"
 Parameter: YTRAN -> "-41.3021919"
 Parameter: ZTRAN -> "56.3931996"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    36.433822  -41.302192   56.393200
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.159898075E-02"
Evaluating: 7.159898075E-02*360.0
 Parameter: XPHI <- "25.7756331"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.204313252"
Evaluating: 0.204313252*360.0
 Parameter: YPHI <- "73.5527707"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.68983522"
Evaluating: 0.68983522*360.0
 Parameter: ZPHI <- "248.340679"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.4338224"
 Parameter: YPOS -> "-41.3021919"
 Parameter: ZPOS -> "56.3931996"
 Parameter: XPHI -> "25.7756331"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.900504    0.434848
    0.000000   -0.434848    0.900504

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   25.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.4338224"
 Parameter: YPOS -> "-41.3021919"
 Parameter: ZPOS -> "56.3931996"
 Parameter: YPHI -> "73.5527707"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.283132    0.000000   -0.959081
    0.000000    1.000000    0.000000
    0.959081    0.000000    0.283132

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   73.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.4338224"
 Parameter: YPOS -> "-41.3021919"
 Parameter: ZPOS -> "56.3931996"
 Parameter: ZPHI -> "248.340679"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.369087   -0.929395    0.000000
    0.929395   -0.369087    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  111.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.433822 XMAX =   36.433822 XAVE =   36.433822
    YMIN =  -41.302192 YMAX =  -41.302192 YAVE =  -41.302192
    ZMIN =   56.393200 ZMAX =   56.393200 ZAVE =   56.393200
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.4338224"
Evaluating: 36.4338224+3.5
 Parameter: XMAX <- "39.9338224"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.3021919"
Evaluating: -41.3021919+3.5
 Parameter: YMAX <- "-37.8021919"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.3931996"
Evaluating: 56.3931996+3.5
 Parameter: ZMAX <- "59.8931996"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.4338224"
Evaluating: 36.4338224-3.5
 Parameter: XMIN <- "32.9338224"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.3021919"
Evaluating: -41.3021919-3.5
 Parameter: YMIN <- "-44.8021919"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.3931996"
Evaluating: 56.3931996-3.5
 Parameter: ZMIN <- "52.8931996"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.9338224"
 Parameter: XMIN -> "32.9338224"
 Parameter: YMAX -> "-37.8021919"
 Parameter: YMIN -> "-44.8021919"
 Parameter: ZMAX -> "59.8931996"
 Parameter: ZMIN -> "52.8931996"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "39" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "39" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.257123785"
Evaluating: 90.067469*(0.257123785-0.5)
 Parameter: XPOS <- "-21.875246"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.231470566"
Evaluating: 90.067469*(0.231470566-0.5)
 Parameter: YPOS <- "-24.1857665"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.448197332"
Evaluating: 143.194738*(0.448197332-0.5)+3.5172451
 Parameter: ZPOS <- "-3.90062437"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.90062437" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.90062437" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "39" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.656179717"
Evaluating: 90.067469*(0.656179717-0.5)
 Parameter: XPOS <- "14.0667118"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.152081711"
Evaluating: 90.067469*(0.152081711-0.5)
 Parameter: YPOS <- "-31.3361197"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.500532066"
Evaluating: 143.194738*(0.500532066-0.5)+3.5172451
 Parameter: ZPOS <- "3.59343415"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.59343415" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.59343415" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "39" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.901045731"
Evaluating: 90.067469*(0.901045731-0.5)
 Parameter: XPOS <- "36.1211739"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.631861379"
Evaluating: 90.067469*(0.631861379-0.5)
 Parameter: YPOS <- "11.8764207"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.366763864"
Evaluating: 143.194738*(0.366763864-0.5)+3.5172451
 Parameter: ZPOS <- "-15.5614685"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.5614685" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.1211739"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.1211739-0
 Parameter: XTRAN <- "36.1211739"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.8764207"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 11.8764207-0
 Parameter: YTRAN <- "11.8764207"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.5614685"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -15.5614685-0
 Parameter: ZTRAN <- "-15.5614685"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.1211739"
 Parameter: YTRAN -> "11.8764207"
 Parameter: ZTRAN -> "-15.5614685"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    36.121174   11.876421  -15.561469
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.902152447E-02"
Evaluating: 9.902152447E-02*360.0
 Parameter: XPHI <- "35.6477488"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.571697366"
Evaluating: 0.571697366*360.0
 Parameter: YPHI <- "205.811052"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.389422543"
Evaluating: 0.389422543*360.0
 Parameter: ZPHI <- "140.192115"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.1211739"
 Parameter: YPOS -> "11.8764207"
 Parameter: ZPOS -> "-15.5614685"
 Parameter: XPHI -> "35.6477488"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.812615    0.582800
    0.000000   -0.582800    0.812615

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   35.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.1211739"
 Parameter: YPOS -> "11.8764207"
 Parameter: ZPOS -> "-15.5614685"
 Parameter: YPHI -> "205.811052"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.900235    0.000000    0.435405
    0.000000    1.000000    0.000000
   -0.435405    0.000000   -0.900235

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  154.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.1211739"
 Parameter: YPOS -> "11.8764207"
 Parameter: ZPOS -> "-15.5614685"
 Parameter: ZPHI -> "140.192115"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.768195    0.640215    0.000000
   -0.640215   -0.768195    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  140.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.121174 XMAX =   36.121174 XAVE =   36.121174
    YMIN =   11.876421 YMAX =   11.876421 YAVE =   11.876421
    ZMIN =  -15.561469 ZMAX =  -15.561469 ZAVE =  -15.561469
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.1211739"
Evaluating: 36.1211739+3.5
 Parameter: XMAX <- "39.6211739"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.8764207"
Evaluating: 11.8764207+3.5
 Parameter: YMAX <- "15.3764207"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.5614685"
Evaluating: -15.5614685+3.5
 Parameter: ZMAX <- "-12.0614685"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.1211739"
Evaluating: 36.1211739-3.5
 Parameter: XMIN <- "32.6211739"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.8764207"
Evaluating: 11.8764207-3.5
 Parameter: YMIN <- "8.3764207"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.5614685"
Evaluating: -15.5614685-3.5
 Parameter: ZMIN <- "-19.0614685"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.6211739"
 Parameter: XMIN -> "32.6211739"
 Parameter: YMAX -> "15.3764207"
 Parameter: YMIN -> "8.3764207"
 Parameter: ZMAX -> "-12.0614685"
 Parameter: ZMIN -> "-19.0614685"
 SELRPN>     22 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     11 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35000 POS      SOD      39       SOD     -**** MEMB     POPC     160      O13           2.7351
35000 POS      SOD      39       SOD     -**** MEMB     POPC     179      O21           3.3232
35000 POS      SOD      39       SOD     -**** MEMB     POPC     179      C21           2.8196
35000 POS      SOD      39       SOD     -**** MEMB     POPC     179      O22           3.2344
35000 POS      SOD      39       SOD     -**** MEMB     POPC     179      C22           2.8406
35000 POS      SOD      39       SOD     -**** MEMB     POPC     179      C23           3.3980
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "39" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.81837466"
Evaluating: 90.067469*(0.81837466-0.5)
 Parameter: XPOS <- "28.6751998"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.441677724"
Evaluating: 90.067469*(0.441677724-0.5)
 Parameter: YPOS <- "-5.25293979"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.584709852"
Evaluating: 143.194738*(0.584709852-0.5)+3.5172451
 Parameter: ZPOS <- "15.6472502"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.6472502" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.6472502" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.121174 XMAX =   36.121174 XAVE =   36.121174
    YMIN =   11.876421 YMAX =   11.876421 YAVE =   11.876421
    ZMIN =  -15.561469 ZMAX =  -15.561469 ZAVE =  -15.561469
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.6751998"
 RDCMND substituted energy or value "?XAVE" to "36.1211739"
Evaluating: 28.6751998-36.1211739
 Parameter: XTRAN <- "-7.4459741"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.25293979"
 RDCMND substituted energy or value "?YAVE" to "11.8764207"
Evaluating: -5.25293979-11.8764207
 Parameter: YTRAN <- "-17.1293605"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.6472502"
 RDCMND substituted energy or value "?ZAVE" to "-15.5614685"
Evaluating: 15.6472502--15.5614685
 Parameter: ZTRAN <- "31.2087187"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.4459741"
 Parameter: YTRAN -> "-17.1293605"
 Parameter: ZTRAN -> "31.2087187"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -7.445974  -17.129361   31.208719
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.529430743"
Evaluating: 0.529430743*360.0
 Parameter: XPHI <- "190.595067"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.714895755"
Evaluating: 0.714895755*360.0
 Parameter: YPHI <- "257.362472"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.732552123"
Evaluating: 0.732552123*360.0
 Parameter: ZPHI <- "263.718764"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.6751998"
 Parameter: YPOS -> "-5.25293979"
 Parameter: ZPOS -> "15.6472502"
 Parameter: XPHI -> "190.595067"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.982951   -0.183867
    0.000000    0.183867   -0.982951

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  169.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.6751998"
 Parameter: YPOS -> "-5.25293979"
 Parameter: ZPOS -> "15.6472502"
 Parameter: YPHI -> "257.362472"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.218782    0.000000    0.975774
    0.000000    1.000000    0.000000
   -0.975774    0.000000   -0.218782

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  102.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.6751998"
 Parameter: YPOS -> "-5.25293979"
 Parameter: ZPOS -> "15.6472502"
 Parameter: ZPHI -> "263.718764"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.109409   -0.993997    0.000000
    0.993997   -0.109409    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   96.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.675200 XMAX =   28.675200 XAVE =   28.675200
    YMIN =   -5.252940 YMAX =   -5.252940 YAVE =   -5.252940
    ZMIN =   15.647250 ZMAX =   15.647250 ZAVE =   15.647250
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.6751998"
Evaluating: 28.6751998+3.5
 Parameter: XMAX <- "32.1751998"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.25293979"
Evaluating: -5.25293979+3.5
 Parameter: YMAX <- "-1.75293979"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.6472502"
Evaluating: 15.6472502+3.5
 Parameter: ZMAX <- "19.1472502"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.6751998"
Evaluating: 28.6751998-3.5
 Parameter: XMIN <- "25.1751998"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.25293979"
Evaluating: -5.25293979-3.5
 Parameter: YMIN <- "-8.75293979"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.6472502"
Evaluating: 15.6472502-3.5
 Parameter: ZMIN <- "12.1472502"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.1751998"
 Parameter: XMIN -> "25.1751998"
 Parameter: YMAX -> "-1.75293979"
 Parameter: YMIN -> "-8.75293979"
 Parameter: ZMAX -> "19.1472502"
 Parameter: ZMIN -> "12.1472502"
 SELRPN>     34 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     16 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35000 POS      SOD      39       SOD     -**** MEMB     POPC     21       O11           3.6416
35000 POS      SOD      39       SOD     -**** MEMB     POPC     21       C1            3.9283
35000 POS      SOD      39       SOD     -**** MEMB     POPC     21       C2            3.4002
35000 POS      SOD      39       SOD     -**** MEMB     POPC     21       O21           3.2731
35000 POS      SOD      39       SOD     -**** MEMB     POPC     21       C3            2.6641
35000 POS      SOD      39       SOD     -**** MEMB     POPC     21       O31           1.6331
35000 POS      SOD      39       SOD     -**** MEMB     POPC     21       C31           0.3851
35000 POS      SOD      39       SOD     -**** MEMB     POPC     21       O32           1.2083
35000 POS      SOD      39       SOD     -**** MEMB     POPC     21       C32           1.3370
35000 POS      SOD      39       SOD     -**** MEMB     POPC     21       C33           2.1859
35000 POS      SOD      39       SOD     -**** MEMB     POPC     21       C34           2.6250
35000 POS      SOD      39       SOD     -**** MEMB     POPC     29       C1            3.3487
35000 POS      SOD      39       SOD     -**** MEMB     POPC     29       C2            3.1621
35000 POS      SOD      39       SOD     -**** MEMB     POPC     29       C3            2.7012
35000 POS      SOD      39       SOD     -**** MEMB     POPC     29       O31           3.3895
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        15
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "15"
 Comparing "15" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "39" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.297771868"
Evaluating: 90.067469*(0.297771868-0.5)
 Parameter: XPOS <- "-18.214176"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.642162518"
Evaluating: 90.067469*(0.642162518-0.5)
 Parameter: YPOS <- "12.8042182"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.260988597"
Evaluating: 143.194738*(0.260988597-0.5)+3.5172451
 Parameter: ZPOS <- "-30.7079301"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.7079301" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.675200 XMAX =   28.675200 XAVE =   28.675200
    YMIN =   -5.252940 YMAX =   -5.252940 YAVE =   -5.252940
    ZMIN =   15.647250 ZMAX =   15.647250 ZAVE =   15.647250
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.214176"
 RDCMND substituted energy or value "?XAVE" to "28.6751998"
Evaluating: -18.214176-28.6751998
 Parameter: XTRAN <- "-46.8893758"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.8042182"
 RDCMND substituted energy or value "?YAVE" to "-5.25293979"
Evaluating: 12.8042182--5.25293979
 Parameter: YTRAN <- "18.057158"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.7079301"
 RDCMND substituted energy or value "?ZAVE" to "15.6472502"
Evaluating: -30.7079301-15.6472502
 Parameter: ZTRAN <- "-46.3551803"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.8893758"
 Parameter: YTRAN -> "18.057158"
 Parameter: ZTRAN -> "-46.3551803"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -46.889376   18.057158  -46.355180
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111799745"
Evaluating: 0.111799745*360.0
 Parameter: XPHI <- "40.2479082"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.454509994"
Evaluating: 0.454509994*360.0
 Parameter: YPHI <- "163.623598"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.670992833"
Evaluating: 0.670992833*360.0
 Parameter: ZPHI <- "241.55742"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.214176"
 Parameter: YPOS -> "12.8042182"
 Parameter: ZPOS -> "-30.7079301"
 Parameter: XPHI -> "40.2479082"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.763256    0.646096
    0.000000   -0.646096    0.763256

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   40.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.214176"
 Parameter: YPOS -> "12.8042182"
 Parameter: ZPOS -> "-30.7079301"
 Parameter: YPHI -> "163.623598"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.959430    0.000000   -0.281946
    0.000000    1.000000    0.000000
    0.281946    0.000000   -0.959430

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  163.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.214176"
 Parameter: YPOS -> "12.8042182"
 Parameter: ZPOS -> "-30.7079301"
 Parameter: ZPHI -> "241.55742"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.476278   -0.879295    0.000000
    0.879295   -0.476278    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  118.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.214176 XMAX =  -18.214176 XAVE =  -18.214176
    YMIN =   12.804218 YMAX =   12.804218 YAVE =   12.804218
    ZMIN =  -30.707930 ZMAX =  -30.707930 ZAVE =  -30.707930
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.214176"
Evaluating: -18.214176+3.5
 Parameter: XMAX <- "-14.714176"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.8042182"
Evaluating: 12.8042182+3.5
 Parameter: YMAX <- "16.3042182"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.7079301"
Evaluating: -30.7079301+3.5
 Parameter: ZMAX <- "-27.2079301"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.214176"
Evaluating: -18.214176-3.5
 Parameter: XMIN <- "-21.714176"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.8042182"
Evaluating: 12.8042182-3.5
 Parameter: YMIN <- "9.3042182"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.7079301"
Evaluating: -30.7079301-3.5
 Parameter: ZMIN <- "-34.2079301"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.714176"
 Parameter: XMIN -> "-21.714176"
 Parameter: YMAX -> "16.3042182"
 Parameter: YMIN -> "9.3042182"
 Parameter: ZMAX -> "-27.2079301"
 Parameter: ZMIN -> "-34.2079301"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "40" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "40" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.825448478"
Evaluating: 90.067469*(0.825448478-0.5)
 Parameter: XPOS <- "29.3123207"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.706311971E-02"
Evaluating: 90.067469*(8.706311971E-02-0.5)
 Parameter: YPOS <- "-37.1921797"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.782764436"
Evaluating: 143.194738*(0.782764436-0.5)+3.5172451
 Parameter: ZPOS <- "44.0076244"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "44.0076244" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "44.0076244" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.3123207"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.3123207-0
 Parameter: XTRAN <- "29.3123207"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.1921797"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.1921797-0
 Parameter: YTRAN <- "-37.1921797"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "44.0076244"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 44.0076244-0
 Parameter: ZTRAN <- "44.0076244"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.3123207"
 Parameter: YTRAN -> "-37.1921797"
 Parameter: ZTRAN -> "44.0076244"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    29.312321  -37.192180   44.007624
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.20162805"
Evaluating: 0.20162805*360.0
 Parameter: XPHI <- "72.586098"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.169857744"
Evaluating: 0.169857744*360.0
 Parameter: YPHI <- "61.1487878"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.139888284"
Evaluating: 0.139888284*360.0
 Parameter: ZPHI <- "50.3597822"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.3123207"
 Parameter: YPOS -> "-37.1921797"
 Parameter: ZPOS -> "44.0076244"
 Parameter: XPHI -> "72.586098"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.299272    0.954168
    0.000000   -0.954168    0.299272

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   72.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.3123207"
 Parameter: YPOS -> "-37.1921797"
 Parameter: ZPOS -> "44.0076244"
 Parameter: YPHI -> "61.1487878"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.482537    0.000000   -0.875876
    0.000000    1.000000    0.000000
    0.875876    0.000000    0.482537

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   61.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.3123207"
 Parameter: YPOS -> "-37.1921797"
 Parameter: ZPOS -> "44.0076244"
 Parameter: ZPHI -> "50.3597822"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.637965    0.770066    0.000000
   -0.770066    0.637965    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   50.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.312321 XMAX =   29.312321 XAVE =   29.312321
    YMIN =  -37.192180 YMAX =  -37.192180 YAVE =  -37.192180
    ZMIN =   44.007624 ZMAX =   44.007624 ZAVE =   44.007624
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.3123207"
Evaluating: 29.3123207+3.5
 Parameter: XMAX <- "32.8123207"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.1921797"
Evaluating: -37.1921797+3.5
 Parameter: YMAX <- "-33.6921797"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "44.0076244"
Evaluating: 44.0076244+3.5
 Parameter: ZMAX <- "47.5076244"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.3123207"
Evaluating: 29.3123207-3.5
 Parameter: XMIN <- "25.8123207"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.1921797"
Evaluating: -37.1921797-3.5
 Parameter: YMIN <- "-40.6921797"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "44.0076244"
Evaluating: 44.0076244-3.5
 Parameter: ZMIN <- "40.5076244"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.8123207"
 Parameter: XMIN -> "25.8123207"
 Parameter: YMAX -> "-33.6921797"
 Parameter: YMIN -> "-40.6921797"
 Parameter: ZMAX -> "47.5076244"
 Parameter: ZMIN -> "40.5076244"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "41" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "41" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.823307211"
Evaluating: 90.067469*(0.823307211-0.5)
 Parameter: XPOS <- "29.1194622"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.640953568"
Evaluating: 90.067469*(0.640953568-0.5)
 Parameter: YPOS <- "12.6953311"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.478240033"
Evaluating: 143.194738*(0.478240033-0.5)+3.5172451
 Parameter: ZPOS <- "0.401332327"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.401332327" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.401332327" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "41" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.826063322"
Evaluating: 90.067469*(0.826063322-0.5)
 Parameter: XPOS <- "29.3676981"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.231147712"
Evaluating: 90.067469*(0.231147712-0.5)
 Parameter: YPOS <- "-24.2148451"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.905754043"
Evaluating: 143.194738*(0.905754043-0.5)+3.5172451
 Parameter: ZPOS <- "61.619089"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "61.619089" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "61.619089" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.3676981"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.3676981-0
 Parameter: XTRAN <- "29.3676981"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.2148451"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -24.2148451-0
 Parameter: YTRAN <- "-24.2148451"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.619089"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 61.619089-0
 Parameter: ZTRAN <- "61.619089"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.3676981"
 Parameter: YTRAN -> "-24.2148451"
 Parameter: ZTRAN -> "61.619089"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    29.367698  -24.214845   61.619089
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.674941671"
Evaluating: 0.674941671*360.0
 Parameter: XPHI <- "242.979002"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.391779059"
Evaluating: 0.391779059*360.0
 Parameter: YPHI <- "141.040461"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.192535805"
Evaluating: 0.192535805*360.0
 Parameter: ZPHI <- "69.3128898"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.3676981"
 Parameter: YPOS -> "-24.2148451"
 Parameter: ZPOS -> "61.619089"
 Parameter: XPHI -> "242.979002"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.454317   -0.890840
    0.000000    0.890840   -0.454317

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  117.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.3676981"
 Parameter: YPOS -> "-24.2148451"
 Parameter: ZPOS -> "61.619089"
 Parameter: YPHI -> "141.040461"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.777590    0.000000   -0.628771
    0.000000    1.000000    0.000000
    0.628771    0.000000   -0.777590

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  141.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.3676981"
 Parameter: YPOS -> "-24.2148451"
 Parameter: ZPOS -> "61.619089"
 Parameter: ZPHI -> "69.3128898"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.353264    0.935524    0.000000
   -0.935524    0.353264    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.367698 XMAX =   29.367698 XAVE =   29.367698
    YMIN =  -24.214845 YMAX =  -24.214845 YAVE =  -24.214845
    ZMIN =   61.619089 ZMAX =   61.619089 ZAVE =   61.619089
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.3676981"
Evaluating: 29.3676981+3.5
 Parameter: XMAX <- "32.8676981"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.2148451"
Evaluating: -24.2148451+3.5
 Parameter: YMAX <- "-20.7148451"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.619089"
Evaluating: 61.619089+3.5
 Parameter: ZMAX <- "65.119089"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.3676981"
Evaluating: 29.3676981-3.5
 Parameter: XMIN <- "25.8676981"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.2148451"
Evaluating: -24.2148451-3.5
 Parameter: YMIN <- "-27.7148451"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.619089"
Evaluating: 61.619089-3.5
 Parameter: ZMIN <- "58.119089"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.8676981"
 Parameter: XMIN -> "25.8676981"
 Parameter: YMAX -> "-20.7148451"
 Parameter: YMIN -> "-27.7148451"
 Parameter: ZMAX -> "65.119089"
 Parameter: ZMIN -> "58.119089"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "42" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "42" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.755311002"
Evaluating: 90.067469*(0.755311002-0.5)
 Parameter: XPOS <- "22.9952158"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "6.91832658E-03"
Evaluating: 90.067469*(6.91832658E-03-0.5)
 Parameter: YPOS <- "-44.4106183"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.5241118"
Evaluating: 143.194738*(0.5241118-0.5)+3.5172451
 Parameter: ZPOS <- "6.96992798"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "6.96992798" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "6.96992798" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "42" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.405946549"
Evaluating: 90.067469*(0.405946549-0.5)
 Parameter: XPOS <- "-8.47115628"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.611205005"
Evaluating: 90.067469*(0.611205005-0.5)
 Parameter: YPOS <- "10.0159533"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.71627652"
Evaluating: 143.194738*(0.71627652-0.5)+3.5172451
 Parameter: ZPOS <- "34.4869047"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.4869047" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.4869047" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.47115628"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.47115628-0
 Parameter: XTRAN <- "-8.47115628"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.0159533"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.0159533-0
 Parameter: YTRAN <- "10.0159533"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.4869047"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.4869047-0
 Parameter: ZTRAN <- "34.4869047"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.47115628"
 Parameter: YTRAN -> "10.0159533"
 Parameter: ZTRAN -> "34.4869047"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -8.471156   10.015953   34.486905
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.121622154"
Evaluating: 0.121622154*360.0
 Parameter: XPHI <- "43.7839754"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.393151998"
Evaluating: 0.393151998*360.0
 Parameter: YPHI <- "141.534719"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.302167525"
Evaluating: 0.302167525*360.0
 Parameter: ZPHI <- "108.780309"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.47115628"
 Parameter: YPOS -> "10.0159533"
 Parameter: ZPOS -> "34.4869047"
 Parameter: XPHI -> "43.7839754"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.721954    0.691941
    0.000000   -0.691941    0.721954

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   43.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.47115628"
 Parameter: YPOS -> "10.0159533"
 Parameter: ZPOS -> "34.4869047"
 Parameter: YPHI -> "141.534719"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.782985    0.000000   -0.622040
    0.000000    1.000000    0.000000
    0.622040    0.000000   -0.782985

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  141.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.47115628"
 Parameter: YPOS -> "10.0159533"
 Parameter: ZPOS -> "34.4869047"
 Parameter: ZPHI -> "108.780309"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.321940    0.946760    0.000000
   -0.946760   -0.321940    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  108.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.471156 XMAX =   -8.471156 XAVE =   -8.471156
    YMIN =   10.015953 YMAX =   10.015953 YAVE =   10.015953
    ZMIN =   34.486905 ZMAX =   34.486905 ZAVE =   34.486905
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.47115628"
Evaluating: -8.47115628+3.5
 Parameter: XMAX <- "-4.97115628"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.0159533"
Evaluating: 10.0159533+3.5
 Parameter: YMAX <- "13.5159533"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.4869047"
Evaluating: 34.4869047+3.5
 Parameter: ZMAX <- "37.9869047"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.47115628"
Evaluating: -8.47115628-3.5
 Parameter: XMIN <- "-11.9711563"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.0159533"
Evaluating: 10.0159533-3.5
 Parameter: YMIN <- "6.5159533"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.4869047"
Evaluating: 34.4869047-3.5
 Parameter: ZMIN <- "30.9869047"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.97115628"
 Parameter: XMIN -> "-11.9711563"
 Parameter: YMAX -> "13.5159533"
 Parameter: YMIN -> "6.5159533"
 Parameter: ZMAX -> "37.9869047"
 Parameter: ZMIN -> "30.9869047"
 SELRPN>     35 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     19 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35003 POS      SOD      42       SOD     - 956 PROA     TYR      87       O             4.5326
35003 POS      SOD      42       SOD     - 969 PROA     THR      88       C             4.7031
35003 POS      SOD      42       SOD     - 970 PROA     THR      88       O             3.7401
35003 POS      SOD      42       SOD     - 984 PROA     THR      89       O             4.1127
35003 POS      SOD      42       SOD     -1004 PROA     TYR      90       C             2.7925
35003 POS      SOD      42       SOD     -1005 PROA     TYR      90       O             2.8851
35003 POS      SOD      42       SOD     -1006 PROA     ILE      91       N             2.0375
35003 POS      SOD      42       SOD     -1008 PROA     ILE      91       CA            1.0831
35003 POS      SOD      42       SOD     -1010 PROA     ILE      91       CB            2.1987
35003 POS      SOD      42       SOD     -1012 PROA     ILE      91       CG2           3.4581
35003 POS      SOD      42       SOD     -1016 PROA     ILE      91       CG1           2.8180
35003 POS      SOD      42       SOD     -1023 PROA     ILE      91       C             0.4905
35003 POS      SOD      42       SOD     -1024 PROA     ILE      91       O             1.6413
35003 POS      SOD      42       SOD     -1025 PROA     LEU      92       N             1.4979
35003 POS      SOD      42       SOD     -1027 PROA     LEU      92       CA            2.7953
35003 POS      SOD      42       SOD     -1038 PROA     LEU      92       CD2           4.7420
35003 POS      SOD      42       SOD     -1042 PROA     LEU      92       C             3.5516
35003 POS      SOD      42       SOD     -1043 PROA     LEU      92       O             4.5126
35003 POS      SOD      42       SOD     -1044 PROA     MET      93       N             3.7053
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        19
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "42" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.315510182"
Evaluating: 90.067469*(0.315510182-0.5)
 Parameter: XPOS <- "-16.616531"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.280491846"
Evaluating: 90.067469*(0.280491846-0.5)
 Parameter: YPOS <- "-19.7705439"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.94550159"
Evaluating: 143.194738*(0.94550159-0.5)+3.5172451
 Parameter: ZPOS <- "67.3107286"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "67.3107286" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "67.3107286" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.471156 XMAX =   -8.471156 XAVE =   -8.471156
    YMIN =   10.015953 YMAX =   10.015953 YAVE =   10.015953
    ZMIN =   34.486905 ZMAX =   34.486905 ZAVE =   34.486905
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.616531"
 RDCMND substituted energy or value "?XAVE" to "-8.47115628"
Evaluating: -16.616531--8.47115628
 Parameter: XTRAN <- "-8.14537472"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.7705439"
 RDCMND substituted energy or value "?YAVE" to "10.0159533"
Evaluating: -19.7705439-10.0159533
 Parameter: YTRAN <- "-29.7864972"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "67.3107286"
 RDCMND substituted energy or value "?ZAVE" to "34.4869047"
Evaluating: 67.3107286-34.4869047
 Parameter: ZTRAN <- "32.8238239"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.14537472"
 Parameter: YTRAN -> "-29.7864972"
 Parameter: ZTRAN -> "32.8238239"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -8.145375  -29.786497   32.823824
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.156980864"
Evaluating: 0.156980864*360.0
 Parameter: XPHI <- "56.513111"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.11616537"
Evaluating: 0.11616537*360.0
 Parameter: YPHI <- "41.8195332"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.868106377"
Evaluating: 0.868106377*360.0
 Parameter: ZPHI <- "312.518296"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.616531"
 Parameter: YPOS -> "-19.7705439"
 Parameter: ZPOS -> "67.3107286"
 Parameter: XPHI -> "56.513111"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.551746    0.834012
    0.000000   -0.834012    0.551746

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   56.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.616531"
 Parameter: YPOS -> "-19.7705439"
 Parameter: ZPOS -> "67.3107286"
 Parameter: YPHI -> "41.8195332"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.745249    0.000000   -0.666787
    0.000000    1.000000    0.000000
    0.666787    0.000000    0.745249

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   41.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.616531"
 Parameter: YPOS -> "-19.7705439"
 Parameter: ZPOS -> "67.3107286"
 Parameter: ZPHI -> "312.518296"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.675826   -0.737062    0.000000
    0.737062    0.675826    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.616531 XMAX =  -16.616531 XAVE =  -16.616531
    YMIN =  -19.770544 YMAX =  -19.770544 YAVE =  -19.770544
    ZMIN =   67.310729 ZMAX =   67.310729 ZAVE =   67.310729
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.616531"
Evaluating: -16.616531+3.5
 Parameter: XMAX <- "-13.116531"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.7705439"
Evaluating: -19.7705439+3.5
 Parameter: YMAX <- "-16.2705439"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "67.3107286"
Evaluating: 67.3107286+3.5
 Parameter: ZMAX <- "70.8107286"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.616531"
Evaluating: -16.616531-3.5
 Parameter: XMIN <- "-20.116531"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.7705439"
Evaluating: -19.7705439-3.5
 Parameter: YMIN <- "-23.2705439"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "67.3107286"
Evaluating: 67.3107286-3.5
 Parameter: ZMIN <- "63.8107286"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.116531"
 Parameter: XMIN -> "-20.116531"
 Parameter: YMAX -> "-16.2705439"
 Parameter: YMIN -> "-23.2705439"
 Parameter: ZMAX -> "70.8107286"
 Parameter: ZMIN -> "63.8107286"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "43" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "43" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.308992038"
Evaluating: 90.067469*(0.308992038-0.5)
 Parameter: XPOS <- "-17.2036037"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.107108852"
Evaluating: 90.067469*(0.107108852-0.5)
 Parameter: YPOS <- "-35.3867113"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.610590225"
Evaluating: 143.194738*(0.610590225-0.5)+3.5172451
 Parameter: ZPOS <- "19.3531834"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.3531834" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.3531834" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.2036037"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -17.2036037-0
 Parameter: XTRAN <- "-17.2036037"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.3867113"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.3867113-0
 Parameter: YTRAN <- "-35.3867113"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.3531834"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.3531834-0
 Parameter: ZTRAN <- "19.3531834"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.2036037"
 Parameter: YTRAN -> "-35.3867113"
 Parameter: ZTRAN -> "19.3531834"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -17.203604  -35.386711   19.353183
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.09935789E-02"
Evaluating: 7.09935789E-02*360.0
 Parameter: XPHI <- "25.5576884"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.433173708"
Evaluating: 0.433173708*360.0
 Parameter: YPHI <- "155.942535"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335787581"
Evaluating: 0.335787581*360.0
 Parameter: ZPHI <- "120.883529"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.2036037"
 Parameter: YPOS -> "-35.3867113"
 Parameter: ZPOS -> "19.3531834"
 Parameter: XPHI -> "25.5576884"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.902151    0.431420
    0.000000   -0.431420    0.902151

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   25.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.2036037"
 Parameter: YPOS -> "-35.3867113"
 Parameter: ZPOS -> "19.3531834"
 Parameter: YPHI -> "155.942535"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.913137    0.000000   -0.407653
    0.000000    1.000000    0.000000
    0.407653    0.000000   -0.913137

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  155.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.2036037"
 Parameter: YPOS -> "-35.3867113"
 Parameter: ZPOS -> "19.3531834"
 Parameter: ZPHI -> "120.883529"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.513295    0.858212    0.000000
   -0.858212   -0.513295    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  120.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.203604 XMAX =  -17.203604 XAVE =  -17.203604
    YMIN =  -35.386711 YMAX =  -35.386711 YAVE =  -35.386711
    ZMIN =   19.353183 ZMAX =   19.353183 ZAVE =   19.353183
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.2036037"
Evaluating: -17.2036037+3.5
 Parameter: XMAX <- "-13.7036037"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.3867113"
Evaluating: -35.3867113+3.5
 Parameter: YMAX <- "-31.8867113"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.3531834"
Evaluating: 19.3531834+3.5
 Parameter: ZMAX <- "22.8531834"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.2036037"
Evaluating: -17.2036037-3.5
 Parameter: XMIN <- "-20.7036037"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.3867113"
Evaluating: -35.3867113-3.5
 Parameter: YMIN <- "-38.8867113"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.3531834"
Evaluating: 19.3531834-3.5
 Parameter: ZMIN <- "15.8531834"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.7036037"
 Parameter: XMIN -> "-20.7036037"
 Parameter: YMAX -> "-31.8867113"
 Parameter: YMIN -> "-38.8867113"
 Parameter: ZMAX -> "22.8531834"
 Parameter: ZMIN -> "15.8531834"
 SELRPN>     21 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      6 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35004 POS      SOD      43       SOD     -**** MEMB     POPC     41       N             3.5584
35004 POS      SOD      43       SOD     -**** MEMB     POPC     41       C12           3.4388
35004 POS      SOD      43       SOD     -**** MEMB     POPC     41       C14           2.6589
35004 POS      SOD      43       SOD     -**** MEMB     POPC     69       O14           2.6619
35004 POS      SOD      43       SOD     -**** MEMB     POPC     69       C1            3.8511
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "43" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.772110363"
Evaluating: 90.067469*(0.772110363-0.5)
 Parameter: XPOS <- "24.5082917"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.828369819"
Evaluating: 90.067469*(0.828369819-0.5)
 Parameter: YPOS <- "29.5754385"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.912096279"
Evaluating: 143.194738*(0.912096279-0.5)+3.5172451
 Parameter: ZPOS <- "62.5272638"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "62.5272638" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "62.5272638" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.203604 XMAX =  -17.203604 XAVE =  -17.203604
    YMIN =  -35.386711 YMAX =  -35.386711 YAVE =  -35.386711
    ZMIN =   19.353183 ZMAX =   19.353183 ZAVE =   19.353183
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.5082917"
 RDCMND substituted energy or value "?XAVE" to "-17.2036037"
Evaluating: 24.5082917--17.2036037
 Parameter: XTRAN <- "41.7118954"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.5754385"
 RDCMND substituted energy or value "?YAVE" to "-35.3867113"
Evaluating: 29.5754385--35.3867113
 Parameter: YTRAN <- "64.9621498"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "62.5272638"
 RDCMND substituted energy or value "?ZAVE" to "19.3531834"
Evaluating: 62.5272638-19.3531834
 Parameter: ZTRAN <- "43.1740804"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.7118954"
 Parameter: YTRAN -> "64.9621498"
 Parameter: ZTRAN -> "43.1740804"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    41.711895   64.962150   43.174080
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.899486536"
Evaluating: 0.899486536*360.0
 Parameter: XPHI <- "323.815153"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.587587724"
Evaluating: 0.587587724*360.0
 Parameter: YPHI <- "211.531581"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.233430946"
Evaluating: 0.233430946*360.0
 Parameter: ZPHI <- "84.0351406"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.5082917"
 Parameter: YPOS -> "29.5754385"
 Parameter: ZPOS -> "62.5272638"
 Parameter: XPHI -> "323.815153"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.807116   -0.590392
    0.000000    0.590392    0.807116

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   36.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.5082917"
 Parameter: YPOS -> "29.5754385"
 Parameter: ZPOS -> "62.5272638"
 Parameter: YPHI -> "211.531581"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.852352    0.000000    0.522968
    0.000000    1.000000    0.000000
   -0.522968    0.000000   -0.852352

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  148.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.5082917"
 Parameter: YPOS -> "29.5754385"
 Parameter: ZPOS -> "62.5272638"
 Parameter: ZPHI -> "84.0351406"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.103918    0.994586    0.000000
   -0.994586    0.103918    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   84.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.508292 XMAX =   24.508292 XAVE =   24.508292
    YMIN =   29.575439 YMAX =   29.575439 YAVE =   29.575439
    ZMIN =   62.527264 ZMAX =   62.527264 ZAVE =   62.527264
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.5082917"
Evaluating: 24.5082917+3.5
 Parameter: XMAX <- "28.0082917"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.5754385"
Evaluating: 29.5754385+3.5
 Parameter: YMAX <- "33.0754385"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "62.5272638"
Evaluating: 62.5272638+3.5
 Parameter: ZMAX <- "66.0272638"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.5082917"
Evaluating: 24.5082917-3.5
 Parameter: XMIN <- "21.0082917"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.5754385"
Evaluating: 29.5754385-3.5
 Parameter: YMIN <- "26.0754385"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "62.5272638"
Evaluating: 62.5272638-3.5
 Parameter: ZMIN <- "59.0272638"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.0082917"
 Parameter: XMIN -> "21.0082917"
 Parameter: YMAX -> "33.0754385"
 Parameter: YMIN -> "26.0754385"
 Parameter: ZMAX -> "66.0272638"
 Parameter: ZMIN -> "59.0272638"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "44" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "44" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.518178673"
Evaluating: 90.067469*(0.518178673-0.5)
 Parameter: XPOS <- "1.63730707"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.612374359"
Evaluating: 90.067469*(0.612374359-0.5)
 Parameter: YPOS <- "10.1212741"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.503951473"
Evaluating: 143.194738*(0.503951473-0.5)+3.5172451
 Parameter: ZPOS <- "4.08307524"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.08307524" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.08307524" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "44" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.977617925"
Evaluating: 90.067469*(0.977617925-0.5)
 Parameter: XPOS <- "43.0178377"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "5.665304422E-02"
Evaluating: 90.067469*(5.665304422E-02-0.5)
 Parameter: YPOS <- "-39.9311382"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.13140213"
Evaluating: 143.194738*(0.13140213-0.5)+3.5172451
 Parameter: ZPOS <- "-49.2640303"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-49.2640303" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.0178377"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 43.0178377-0
 Parameter: XTRAN <- "43.0178377"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.9311382"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.9311382-0
 Parameter: YTRAN <- "-39.9311382"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-49.2640303"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -49.2640303-0
 Parameter: ZTRAN <- "-49.2640303"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "43.0178377"
 Parameter: YTRAN -> "-39.9311382"
 Parameter: ZTRAN -> "-49.2640303"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    43.017838  -39.931138  -49.264030
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.71782684"
Evaluating: 0.71782684*360.0
 Parameter: XPHI <- "258.417662"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.594240507"
Evaluating: 0.594240507*360.0
 Parameter: YPHI <- "213.926583"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.641970077"
Evaluating: 0.641970077*360.0
 Parameter: ZPHI <- "231.109228"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.0178377"
 Parameter: YPOS -> "-39.9311382"
 Parameter: ZPOS -> "-49.2640303"
 Parameter: XPHI -> "258.417662"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.200776   -0.979637
    0.000000    0.979637   -0.200776

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  101.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.0178377"
 Parameter: YPOS -> "-39.9311382"
 Parameter: ZPOS -> "-49.2640303"
 Parameter: YPHI -> "213.926583"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.829753    0.000000    0.558130
    0.000000    1.000000    0.000000
   -0.558130    0.000000   -0.829753

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  146.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.0178377"
 Parameter: YPOS -> "-39.9311382"
 Parameter: ZPOS -> "-49.2640303"
 Parameter: ZPHI -> "231.109228"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.627838   -0.778344    0.000000
    0.778344   -0.627838    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  128.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.017838 XMAX =   43.017838 XAVE =   43.017838
    YMIN =  -39.931138 YMAX =  -39.931138 YAVE =  -39.931138
    ZMIN =  -49.264030 ZMAX =  -49.264030 ZAVE =  -49.264030
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.0178377"
Evaluating: 43.0178377+3.5
 Parameter: XMAX <- "46.5178377"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.9311382"
Evaluating: -39.9311382+3.5
 Parameter: YMAX <- "-36.4311382"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-49.2640303"
Evaluating: -49.2640303+3.5
 Parameter: ZMAX <- "-45.7640303"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.0178377"
Evaluating: 43.0178377-3.5
 Parameter: XMIN <- "39.5178377"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.9311382"
Evaluating: -39.9311382-3.5
 Parameter: YMIN <- "-43.4311382"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-49.2640303"
Evaluating: -49.2640303-3.5
 Parameter: ZMIN <- "-52.7640303"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.5178377"
 Parameter: XMIN -> "39.5178377"
 Parameter: YMAX -> "-36.4311382"
 Parameter: YMIN -> "-43.4311382"
 Parameter: ZMAX -> "-45.7640303"
 Parameter: ZMIN -> "-52.7640303"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "45" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "45" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.76169578"
Evaluating: 90.067469*(0.76169578-0.5)
 Parameter: XPOS <- "23.5702766"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "5.218727272E-02"
Evaluating: 90.067469*(5.218727272E-02-0.5)
 Parameter: YPOS <- "-40.3333589"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.625346612"
Evaluating: 143.194738*(0.625346612-0.5)+3.5172451
 Parameter: ZPOS <- "21.4662204"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "21.4662204" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "21.4662204" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.5702766"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 23.5702766-0
 Parameter: XTRAN <- "23.5702766"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.3333589"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.3333589-0
 Parameter: YTRAN <- "-40.3333589"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.4662204"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 21.4662204-0
 Parameter: ZTRAN <- "21.4662204"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.5702766"
 Parameter: YTRAN -> "-40.3333589"
 Parameter: ZTRAN -> "21.4662204"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    23.570277  -40.333359   21.466220
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.538775942"
Evaluating: 0.538775942*360.0
 Parameter: XPHI <- "193.959339"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.833458113E-02"
Evaluating: 4.833458113E-02*360.0
 Parameter: YPHI <- "17.4004492"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.280402327"
Evaluating: 0.280402327*360.0
 Parameter: ZPHI <- "100.944838"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.5702766"
 Parameter: YPOS -> "-40.3333589"
 Parameter: ZPOS -> "21.4662204"
 Parameter: XPHI -> "193.959339"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.970467   -0.241233
    0.000000    0.241233   -0.970467

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  166.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.5702766"
 Parameter: YPOS -> "-40.3333589"
 Parameter: ZPOS -> "21.4662204"
 Parameter: YPHI -> "17.4004492"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.954238    0.000000   -0.299048
    0.000000    1.000000    0.000000
    0.299048    0.000000    0.954238

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   17.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.5702766"
 Parameter: YPOS -> "-40.3333589"
 Parameter: ZPOS -> "21.4662204"
 Parameter: ZPHI -> "100.944838"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.189864    0.981810    0.000000
   -0.981810   -0.189864    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  100.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.570277 XMAX =   23.570277 XAVE =   23.570277
    YMIN =  -40.333359 YMAX =  -40.333359 YAVE =  -40.333359
    ZMIN =   21.466220 ZMAX =   21.466220 ZAVE =   21.466220
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.5702766"
Evaluating: 23.5702766+3.5
 Parameter: XMAX <- "27.0702766"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.3333589"
Evaluating: -40.3333589+3.5
 Parameter: YMAX <- "-36.8333589"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.4662204"
Evaluating: 21.4662204+3.5
 Parameter: ZMAX <- "24.9662204"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.5702766"
Evaluating: 23.5702766-3.5
 Parameter: XMIN <- "20.0702766"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.3333589"
Evaluating: -40.3333589-3.5
 Parameter: YMIN <- "-43.8333589"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.4662204"
Evaluating: 21.4662204-3.5
 Parameter: ZMIN <- "17.9662204"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.0702766"
 Parameter: XMIN -> "20.0702766"
 Parameter: YMAX -> "-36.8333589"
 Parameter: YMIN -> "-43.8333589"
 Parameter: ZMAX -> "24.9662204"
 Parameter: ZMIN -> "17.9662204"
 SELRPN>     15 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      7 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35006 POS      SOD      45       SOD     -**** MEMB     POPC     71       C12           3.6738
35006 POS      SOD      45       SOD     -**** MEMB     POPC     71       C13           3.3386
35006 POS      SOD      45       SOD     -**** MEMB     POPC     71       C11           3.8901
35006 POS      SOD      45       SOD     -**** MEMB     POPC     90       P             3.9590
35006 POS      SOD      45       SOD     -**** MEMB     POPC     90       O14           2.7498
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "45" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.786971608"
Evaluating: 90.067469*(0.786971608-0.5)
 Parameter: XPOS <- "25.8468064"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.464822562"
Evaluating: 90.067469*(0.464822562-0.5)
 Parameter: YPOS <- "-3.16834281"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.742318906"
Evaluating: 143.194738*(0.742318906-0.5)+3.5172451
 Parameter: ZPOS <- "38.2160374"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.2160374" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.2160374" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.570277 XMAX =   23.570277 XAVE =   23.570277
    YMIN =  -40.333359 YMAX =  -40.333359 YAVE =  -40.333359
    ZMIN =   21.466220 ZMAX =   21.466220 ZAVE =   21.466220
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.8468064"
 RDCMND substituted energy or value "?XAVE" to "23.5702766"
Evaluating: 25.8468064-23.5702766
 Parameter: XTRAN <- "2.2765298"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.16834281"
 RDCMND substituted energy or value "?YAVE" to "-40.3333589"
Evaluating: -3.16834281--40.3333589
 Parameter: YTRAN <- "37.1650161"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.2160374"
 RDCMND substituted energy or value "?ZAVE" to "21.4662204"
Evaluating: 38.2160374-21.4662204
 Parameter: ZTRAN <- "16.749817"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.2765298"
 Parameter: YTRAN -> "37.1650161"
 Parameter: ZTRAN -> "16.749817"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     2.276530   37.165016   16.749817
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.557298482"
Evaluating: 0.557298482*360.0
 Parameter: XPHI <- "200.627454"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.66311645"
Evaluating: 0.66311645*360.0
 Parameter: YPHI <- "238.721922"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.302289809"
Evaluating: 0.302289809*360.0
 Parameter: ZPHI <- "108.824331"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.8468064"
 Parameter: YPOS -> "-3.16834281"
 Parameter: ZPOS -> "38.2160374"
 Parameter: XPHI -> "200.627454"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.935891   -0.352290
    0.000000    0.352290   -0.935891

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  159.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.8468064"
 Parameter: YPOS -> "-3.16834281"
 Parameter: ZPOS -> "38.2160374"
 Parameter: YPHI -> "238.721922"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.519192    0.000000    0.854658
    0.000000    1.000000    0.000000
   -0.854658    0.000000   -0.519192

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  121.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.8468064"
 Parameter: YPOS -> "-3.16834281"
 Parameter: ZPOS -> "38.2160374"
 Parameter: ZPHI -> "108.824331"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.322668    0.946512    0.000000
   -0.946512   -0.322668    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  108.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.846806 XMAX =   25.846806 XAVE =   25.846806
    YMIN =   -3.168343 YMAX =   -3.168343 YAVE =   -3.168343
    ZMIN =   38.216037 ZMAX =   38.216037 ZAVE =   38.216037
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.8468064"
Evaluating: 25.8468064+3.5
 Parameter: XMAX <- "29.3468064"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.16834281"
Evaluating: -3.16834281+3.5
 Parameter: YMAX <- "0.33165719"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.2160374"
Evaluating: 38.2160374+3.5
 Parameter: ZMAX <- "41.7160374"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.8468064"
Evaluating: 25.8468064-3.5
 Parameter: XMIN <- "22.3468064"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.16834281"
Evaluating: -3.16834281-3.5
 Parameter: YMIN <- "-6.66834281"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.2160374"
Evaluating: 38.2160374-3.5
 Parameter: ZMIN <- "34.7160374"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.3468064"
 Parameter: XMIN -> "22.3468064"
 Parameter: YMAX -> "0.33165719"
 Parameter: YMIN -> "-6.66834281"
 Parameter: ZMAX -> "41.7160374"
 Parameter: ZMIN -> "34.7160374"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "46" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "46" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.503312366"
Evaluating: 90.067469*(0.503312366-0.5)
 Parameter: XPOS <- "0.298336422"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.582783563"
Evaluating: 90.067469*(0.582783563-0.5)
 Parameter: YPOS <- "7.45610599"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.33863739"
Evaluating: 143.194738*(0.33863739-0.5)+3.5172451
 Parameter: ZPOS <- "-19.5890316"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.5890316" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.298336422"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 0.298336422-0
 Parameter: XTRAN <- "0.298336422"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.45610599"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.45610599-0
 Parameter: YTRAN <- "7.45610599"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.5890316"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.5890316-0
 Parameter: ZTRAN <- "-19.5890316"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.298336422"
 Parameter: YTRAN -> "7.45610599"
 Parameter: ZTRAN -> "-19.5890316"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     0.298336    7.456106  -19.589032
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.59504461"
Evaluating: 0.59504461*360.0
 Parameter: XPHI <- "214.21606"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.875003837"
Evaluating: 0.875003837*360.0
 Parameter: YPHI <- "315.001381"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.922392629E-04"
Evaluating: 8.922392629E-04*360.0
 Parameter: ZPHI <- "0.321206135"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.298336422"
 Parameter: YPOS -> "7.45610599"
 Parameter: ZPOS -> "-19.5890316"
 Parameter: XPHI -> "214.21606"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.826923   -0.562315
    0.000000    0.562315   -0.826923

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  145.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.298336422"
 Parameter: YPOS -> "7.45610599"
 Parameter: ZPOS -> "-19.5890316"
 Parameter: YPHI -> "315.001381"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.707124    0.000000    0.707090
    0.000000    1.000000    0.000000
   -0.707090    0.000000    0.707124

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   45.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.298336422"
 Parameter: YPOS -> "7.45610599"
 Parameter: ZPOS -> "-19.5890316"
 Parameter: ZPHI -> "0.321206135"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.999984    0.005606    0.000000
   -0.005606    0.999984    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    0.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.298336 XMAX =    0.298336 XAVE =    0.298336
    YMIN =    7.456106 YMAX =    7.456106 YAVE =    7.456106
    ZMIN =  -19.589032 ZMAX =  -19.589032 ZAVE =  -19.589032
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.298336422"
Evaluating: 0.298336422+3.5
 Parameter: XMAX <- "3.79833642"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.45610599"
Evaluating: 7.45610599+3.5
 Parameter: YMAX <- "10.956106"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.5890316"
Evaluating: -19.5890316+3.5
 Parameter: ZMAX <- "-16.0890316"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.298336422"
Evaluating: 0.298336422-3.5
 Parameter: XMIN <- "-3.20166358"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.45610599"
Evaluating: 7.45610599-3.5
 Parameter: YMIN <- "3.95610599"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.5890316"
Evaluating: -19.5890316-3.5
 Parameter: ZMIN <- "-23.0890316"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.79833642"
 Parameter: XMIN -> "-3.20166358"
 Parameter: YMAX -> "10.956106"
 Parameter: YMIN -> "3.95610599"
 Parameter: ZMAX -> "-16.0890316"
 Parameter: ZMIN -> "-23.0890316"
 SELRPN>     41 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     21 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35007 POS      SOD      46       SOD     -4635 PROA     PRO      319      O             4.5484
35007 POS      SOD      46       SOD     -4686 PROA     GLN      322      C             3.4714
35007 POS      SOD      46       SOD     -4687 PROA     GLN      322      O             2.7848
35007 POS      SOD      46       SOD     -4688 PROA     VAL      323      N             3.3401
35007 POS      SOD      46       SOD     -4690 PROA     VAL      323      CA            2.4160
35007 POS      SOD      46       SOD     -4692 PROA     VAL      323      CB            3.6017
35007 POS      SOD      46       SOD     -4702 PROA     VAL      323      C             2.1047
35007 POS      SOD      46       SOD     -4703 PROA     VAL      323      O             3.1073
35007 POS      SOD      46       SOD     -4704 PROA     VAL      324      N             1.6555
35007 POS      SOD      46       SOD     -4706 PROA     VAL      324      CA            2.7150
35007 POS      SOD      46       SOD     -4708 PROA     VAL      324      CB            3.6711
35007 POS      SOD      46       SOD     -4710 PROA     VAL      324      CG1           4.0304
35007 POS      SOD      46       SOD     -4714 PROA     VAL      324      CG2           3.8837
35007 POS      SOD      46       SOD     -4718 PROA     VAL      324      C             2.8703
35007 POS      SOD      46       SOD     -4720 PROA     TYR      325      N             2.2153
35007 POS      SOD      46       SOD     -4722 PROA     TYR      325      CA            3.3468
35007 POS      SOD      46       SOD     -4728 PROA     TYR      325      CD1           4.4186
35007 POS      SOD      46       SOD     -4739 PROA     TYR      325      C             3.8790
35007 POS      SOD      46       SOD     -4741 PROA     LYS      326      N             3.9647
35007 POS      SOD      46       SOD     -4824 PROA     GLU      331      CB            3.9593
35007 POS      SOD      46       SOD     -4827 PROA     GLU      331      CG            4.1482
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        21
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "21"
 Comparing "21" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "46" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.983555209"
Evaluating: 90.067469*(0.983555209-0.5)
 Parameter: XPOS <- "43.5525938"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.320044245"
Evaluating: 90.067469*(0.320044245-0.5)
 Parameter: YPOS <- "-16.2081594"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.820435009"
Evaluating: 143.194738*(0.820435009-0.5)+3.5172451
 Parameter: ZPOS <- "49.4018523"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "49.4018523" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "49.4018523" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.298336 XMAX =    0.298336 XAVE =    0.298336
    YMIN =    7.456106 YMAX =    7.456106 YAVE =    7.456106
    ZMIN =  -19.589032 ZMAX =  -19.589032 ZAVE =  -19.589032
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.5525938"
 RDCMND substituted energy or value "?XAVE" to "0.298336422"
Evaluating: 43.5525938-0.298336422
 Parameter: XTRAN <- "43.2542574"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.2081594"
 RDCMND substituted energy or value "?YAVE" to "7.45610599"
Evaluating: -16.2081594-7.45610599
 Parameter: YTRAN <- "-23.6642654"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "49.4018523"
 RDCMND substituted energy or value "?ZAVE" to "-19.5890316"
Evaluating: 49.4018523--19.5890316
 Parameter: ZTRAN <- "68.9908839"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "43.2542574"
 Parameter: YTRAN -> "-23.6642654"
 Parameter: ZTRAN -> "68.9908839"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    43.254257  -23.664265   68.990884
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.969808287"
Evaluating: 0.969808287*360.0
 Parameter: XPHI <- "349.130983"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.849875015"
Evaluating: 0.849875015*360.0
 Parameter: YPHI <- "305.955005"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.571937077"
Evaluating: 0.571937077*360.0
 Parameter: ZPHI <- "205.897348"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.5525938"
 Parameter: YPOS -> "-16.2081594"
 Parameter: ZPOS -> "49.4018523"
 Parameter: XPHI -> "349.130983"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.982061   -0.188564
    0.000000    0.188564    0.982061

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   10.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.5525938"
 Parameter: YPOS -> "-16.2081594"
 Parameter: ZPOS -> "49.4018523"
 Parameter: YPHI -> "305.955005"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.587150    0.000000    0.809478
    0.000000    1.000000    0.000000
   -0.809478    0.000000    0.587150

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   54.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.5525938"
 Parameter: YPOS -> "-16.2081594"
 Parameter: ZPOS -> "49.4018523"
 Parameter: ZPHI -> "205.897348"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.899578   -0.436760    0.000000
    0.436760   -0.899578    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  154.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.552594 XMAX =   43.552594 XAVE =   43.552594
    YMIN =  -16.208159 YMAX =  -16.208159 YAVE =  -16.208159
    ZMIN =   49.401852 ZMAX =   49.401852 ZAVE =   49.401852
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.5525938"
Evaluating: 43.5525938+3.5
 Parameter: XMAX <- "47.0525938"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.2081594"
Evaluating: -16.2081594+3.5
 Parameter: YMAX <- "-12.7081594"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "49.4018523"
Evaluating: 49.4018523+3.5
 Parameter: ZMAX <- "52.9018523"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.5525938"
Evaluating: 43.5525938-3.5
 Parameter: XMIN <- "40.0525938"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.2081594"
Evaluating: -16.2081594-3.5
 Parameter: YMIN <- "-19.7081594"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "49.4018523"
Evaluating: 49.4018523-3.5
 Parameter: ZMIN <- "45.9018523"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.0525938"
 Parameter: XMIN -> "40.0525938"
 Parameter: YMAX -> "-12.7081594"
 Parameter: YMIN -> "-19.7081594"
 Parameter: ZMAX -> "52.9018523"
 Parameter: ZMIN -> "45.9018523"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "47" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "47" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.452249516"
Evaluating: 90.067469*(0.452249516-0.5)
 Parameter: XPOS <- "-4.30076524"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.198431188"
Evaluating: 90.067469*(0.198431188-0.5)
 Parameter: YPOS <- "-27.1615396"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.79493062"
Evaluating: 143.194738*(0.79493062-0.5)+3.5172451
 Parameter: ZPOS <- "45.749758"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.749758" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.749758" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.30076524"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -4.30076524-0
 Parameter: XTRAN <- "-4.30076524"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.1615396"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.1615396-0
 Parameter: YTRAN <- "-27.1615396"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.749758"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.749758-0
 Parameter: ZTRAN <- "45.749758"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-4.30076524"
 Parameter: YTRAN -> "-27.1615396"
 Parameter: ZTRAN -> "45.749758"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -4.300765  -27.161540   45.749758
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.418306297E-02"
Evaluating: 8.418306297E-02*360.0
 Parameter: XPHI <- "30.3059027"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.867000659"
Evaluating: 0.867000659*360.0
 Parameter: YPHI <- "312.120237"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.848394547"
Evaluating: 0.848394547*360.0
 Parameter: ZPHI <- "305.422037"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.30076524"
 Parameter: YPOS -> "-27.1615396"
 Parameter: ZPOS -> "45.749758"
 Parameter: XPHI -> "30.3059027"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.863344    0.504617
    0.000000   -0.504617    0.863344

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   30.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.30076524"
 Parameter: YPOS -> "-27.1615396"
 Parameter: ZPOS -> "45.749758"
 Parameter: YPHI -> "312.120237"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.670689    0.000000    0.741739
    0.000000    1.000000    0.000000
   -0.741739    0.000000    0.670689

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   47.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.30076524"
 Parameter: YPOS -> "-27.1615396"
 Parameter: ZPOS -> "45.749758"
 Parameter: ZPHI -> "305.422037"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.579595   -0.814905    0.000000
    0.814905    0.579595    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   54.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.300765 XMAX =   -4.300765 XAVE =   -4.300765
    YMIN =  -27.161540 YMAX =  -27.161540 YAVE =  -27.161540
    ZMIN =   45.749758 ZMAX =   45.749758 ZAVE =   45.749758
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.30076524"
Evaluating: -4.30076524+3.5
 Parameter: XMAX <- "-0.80076524"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.1615396"
Evaluating: -27.1615396+3.5
 Parameter: YMAX <- "-23.6615396"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.749758"
Evaluating: 45.749758+3.5
 Parameter: ZMAX <- "49.249758"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.30076524"
Evaluating: -4.30076524-3.5
 Parameter: XMIN <- "-7.80076524"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.1615396"
Evaluating: -27.1615396-3.5
 Parameter: YMIN <- "-30.6615396"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.749758"
Evaluating: 45.749758-3.5
 Parameter: ZMIN <- "42.249758"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.80076524"
 Parameter: XMIN -> "-7.80076524"
 Parameter: YMAX -> "-23.6615396"
 Parameter: YMIN -> "-30.6615396"
 Parameter: ZMAX -> "49.249758"
 Parameter: ZMIN -> "42.249758"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "48" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "48" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.453078776"
Evaluating: 90.067469*(0.453078776-0.5)
 Parameter: XPOS <- "-4.22607589"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.471548224"
Evaluating: 90.067469*(0.471548224-0.5)
 Parameter: YPOS <- "-2.56257945"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.405598755"
Evaluating: 143.194738*(0.405598755-0.5)+3.5172451
 Parameter: ZPOS <- "-10.0005164"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-10.0005164" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-10.0005164" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "48" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "4.075423269E-02"
Evaluating: 90.067469*(4.075423269E-02-0.5)
 Parameter: XPOS <- "-41.3631039"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.165352749"
Evaluating: 90.067469*(0.165352749-0.5)
 Parameter: YPOS <- "-30.1408309"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.579999733"
Evaluating: 143.194738*(0.579999733-0.5)+3.5172451
 Parameter: ZPOS <- "14.9727859"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.9727859" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.9727859" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "48" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.209005133"
Evaluating: 90.067469*(0.209005133-0.5)
 Parameter: XPOS <- "-26.2091712"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.507932131"
Evaluating: 90.067469*(0.507932131-0.5)
 Parameter: YPOS <- "0.714426963"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.254944378"
Evaluating: 143.194738*(0.254944378-0.5)+3.5172451
 Parameter: ZPOS <- "-31.5734305"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.5734305" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.2091712"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -26.2091712-0
 Parameter: XTRAN <- "-26.2091712"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.714426963"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 0.714426963-0
 Parameter: YTRAN <- "0.714426963"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.5734305"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.5734305-0
 Parameter: ZTRAN <- "-31.5734305"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-26.2091712"
 Parameter: YTRAN -> "0.714426963"
 Parameter: ZTRAN -> "-31.5734305"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -26.209171    0.714427  -31.573431
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.484216243"
Evaluating: 0.484216243*360.0
 Parameter: XPHI <- "174.317847"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.947447785"
Evaluating: 0.947447785*360.0
 Parameter: YPHI <- "341.081203"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.8823599"
Evaluating: 0.8823599*360.0
 Parameter: ZPHI <- "317.649564"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.2091712"
 Parameter: YPOS -> "0.714426963"
 Parameter: ZPOS -> "-31.5734305"
 Parameter: XPHI -> "174.317847"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.995086    0.099010
    0.000000   -0.099010   -0.995086

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  174.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.2091712"
 Parameter: YPOS -> "0.714426963"
 Parameter: ZPOS -> "-31.5734305"
 Parameter: YPHI -> "341.081203"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.945979    0.000000    0.324228
    0.000000    1.000000    0.000000
   -0.324228    0.000000    0.945979

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   18.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.2091712"
 Parameter: YPOS -> "0.714426963"
 Parameter: ZPOS -> "-31.5734305"
 Parameter: ZPHI -> "317.649564"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.739038   -0.673663    0.000000
    0.673663    0.739038    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   42.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.209171 XMAX =  -26.209171 XAVE =  -26.209171
    YMIN =    0.714427 YMAX =    0.714427 YAVE =    0.714427
    ZMIN =  -31.573431 ZMAX =  -31.573431 ZAVE =  -31.573431
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.2091712"
Evaluating: -26.2091712+3.5
 Parameter: XMAX <- "-22.7091712"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.714426963"
Evaluating: 0.714426963+3.5
 Parameter: YMAX <- "4.21442696"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.5734305"
Evaluating: -31.5734305+3.5
 Parameter: ZMAX <- "-28.0734305"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.2091712"
Evaluating: -26.2091712-3.5
 Parameter: XMIN <- "-29.7091712"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.714426963"
Evaluating: 0.714426963-3.5
 Parameter: YMIN <- "-2.78557304"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.5734305"
Evaluating: -31.5734305-3.5
 Parameter: ZMIN <- "-35.0734305"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-22.7091712"
 Parameter: XMIN -> "-29.7091712"
 Parameter: YMAX -> "4.21442696"
 Parameter: YMIN -> "-2.78557304"
 Parameter: ZMAX -> "-28.0734305"
 Parameter: ZMIN -> "-35.0734305"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "49" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "49" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.907959734"
Evaluating: 90.067469*(0.907959734-0.5)
 Parameter: XPOS <- "36.7439007"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.56370202"
Evaluating: 90.067469*(0.56370202-0.5)
 Parameter: YPOS <- "5.73747971"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.883056765"
Evaluating: 143.194738*(0.883056765-0.5)+3.5172451
 Parameter: ZPOS <- "58.3689582"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "58.3689582" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "58.3689582" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.7439007"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.7439007-0
 Parameter: XTRAN <- "36.7439007"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.73747971"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.73747971-0
 Parameter: YTRAN <- "5.73747971"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "58.3689582"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 58.3689582-0
 Parameter: ZTRAN <- "58.3689582"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.7439007"
 Parameter: YTRAN -> "5.73747971"
 Parameter: ZTRAN -> "58.3689582"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    36.743901    5.737480   58.368958
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.13007657"
Evaluating: 0.13007657*360.0
 Parameter: XPHI <- "46.8275652"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.923667167"
Evaluating: 0.923667167*360.0
 Parameter: YPHI <- "332.52018"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.180192348E-02"
Evaluating: 2.180192348E-02*360.0
 Parameter: ZPHI <- "7.84869245"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.7439007"
 Parameter: YPOS -> "5.73747971"
 Parameter: ZPOS -> "58.3689582"
 Parameter: XPHI -> "46.8275652"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.684196    0.729298
    0.000000   -0.729298    0.684196

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   46.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.7439007"
 Parameter: YPOS -> "5.73747971"
 Parameter: ZPOS -> "58.3689582"
 Parameter: YPHI -> "332.52018"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.887173    0.000000    0.461436
    0.000000    1.000000    0.000000
   -0.461436    0.000000    0.887173

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   27.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.7439007"
 Parameter: YPOS -> "5.73747971"
 Parameter: ZPOS -> "58.3689582"
 Parameter: ZPHI -> "7.84869245"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.990632    0.136558    0.000000
   -0.136558    0.990632    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    7.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.743901 XMAX =   36.743901 XAVE =   36.743901
    YMIN =    5.737480 YMAX =    5.737480 YAVE =    5.737480
    ZMIN =   58.368958 ZMAX =   58.368958 ZAVE =   58.368958
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.7439007"
Evaluating: 36.7439007+3.5
 Parameter: XMAX <- "40.2439007"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.73747971"
Evaluating: 5.73747971+3.5
 Parameter: YMAX <- "9.23747971"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "58.3689582"
Evaluating: 58.3689582+3.5
 Parameter: ZMAX <- "61.8689582"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.7439007"
Evaluating: 36.7439007-3.5
 Parameter: XMIN <- "33.2439007"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.73747971"
Evaluating: 5.73747971-3.5
 Parameter: YMIN <- "2.23747971"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "58.3689582"
Evaluating: 58.3689582-3.5
 Parameter: ZMIN <- "54.8689582"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.2439007"
 Parameter: XMIN -> "33.2439007"
 Parameter: YMAX -> "9.23747971"
 Parameter: YMIN -> "2.23747971"
 Parameter: ZMAX -> "61.8689582"
 Parameter: ZMIN -> "54.8689582"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "50" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "50" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.812438724"
Evaluating: 90.067469*(0.812438724-0.5)
 Parameter: XPOS <- "28.1405651"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.317138797"
Evaluating: 90.067469*(0.317138797-0.5)
 Parameter: YPOS <- "-16.4698457"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.100279109"
Evaluating: 143.194738*(0.100279109-0.5)+3.5172451
 Parameter: ZPOS <- "-53.7206832"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.7206832" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.1405651"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.1405651-0
 Parameter: XTRAN <- "28.1405651"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.4698457"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -16.4698457-0
 Parameter: YTRAN <- "-16.4698457"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.7206832"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.7206832-0
 Parameter: ZTRAN <- "-53.7206832"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.1405651"
 Parameter: YTRAN -> "-16.4698457"
 Parameter: ZTRAN -> "-53.7206832"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    28.140565  -16.469846  -53.720683
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.534047458"
Evaluating: 0.534047458*360.0
 Parameter: XPHI <- "192.257085"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67539572"
Evaluating: 0.67539572*360.0
 Parameter: YPHI <- "243.142459"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.332136948"
Evaluating: 0.332136948*360.0
 Parameter: ZPHI <- "119.569301"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.1405651"
 Parameter: YPOS -> "-16.4698457"
 Parameter: ZPOS -> "-53.7206832"
 Parameter: XPHI -> "192.257085"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.977205   -0.212299
    0.000000    0.212299   -0.977205

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  167.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.1405651"
 Parameter: YPOS -> "-16.4698457"
 Parameter: ZPOS -> "-53.7206832"
 Parameter: YPHI -> "243.142459"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.451774    0.000000    0.892133
    0.000000    1.000000    0.000000
   -0.892133    0.000000   -0.451774

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  116.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.1405651"
 Parameter: YPOS -> "-16.4698457"
 Parameter: ZPOS -> "-53.7206832"
 Parameter: ZPHI -> "119.569301"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.493476    0.869759    0.000000
   -0.869759   -0.493476    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  119.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.140565 XMAX =   28.140565 XAVE =   28.140565
    YMIN =  -16.469846 YMAX =  -16.469846 YAVE =  -16.469846
    ZMIN =  -53.720683 ZMAX =  -53.720683 ZAVE =  -53.720683
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.1405651"
Evaluating: 28.1405651+3.5
 Parameter: XMAX <- "31.6405651"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.4698457"
Evaluating: -16.4698457+3.5
 Parameter: YMAX <- "-12.9698457"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.7206832"
Evaluating: -53.7206832+3.5
 Parameter: ZMAX <- "-50.2206832"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.1405651"
Evaluating: 28.1405651-3.5
 Parameter: XMIN <- "24.6405651"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.4698457"
Evaluating: -16.4698457-3.5
 Parameter: YMIN <- "-19.9698457"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.7206832"
Evaluating: -53.7206832-3.5
 Parameter: ZMIN <- "-57.2206832"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.6405651"
 Parameter: XMIN -> "24.6405651"
 Parameter: YMAX -> "-12.9698457"
 Parameter: YMIN -> "-19.9698457"
 Parameter: ZMAX -> "-50.2206832"
 Parameter: ZMIN -> "-57.2206832"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "51" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "51" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.177454569"
Evaluating: 90.067469*(0.177454569-0.5)
 Parameter: XPOS <- "-29.0508506"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.686242545"
Evaluating: 90.067469*(0.686242545-0.5)
 Parameter: YPOS <- "16.7743946"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.768552307"
Evaluating: 143.194738*(0.768552307-0.5)+3.5172451
 Parameter: ZPOS <- "41.9725223"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.9725223" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.9725223" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.0508506"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.0508506-0
 Parameter: XTRAN <- "-29.0508506"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.7743946"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 16.7743946-0
 Parameter: YTRAN <- "16.7743946"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.9725223"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.9725223-0
 Parameter: ZTRAN <- "41.9725223"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.0508506"
 Parameter: YTRAN -> "16.7743946"
 Parameter: ZTRAN -> "41.9725223"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -29.050851   16.774395   41.972522
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.428583594"
Evaluating: 0.428583594*360.0
 Parameter: XPHI <- "154.290094"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.667884763"
Evaluating: 0.667884763*360.0
 Parameter: YPHI <- "240.438515"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.994859864"
Evaluating: 0.994859864*360.0
 Parameter: ZPHI <- "358.149551"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.0508506"
 Parameter: YPOS -> "16.7743946"
 Parameter: ZPOS -> "41.9725223"
 Parameter: XPHI -> "154.290094"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.901002    0.433815
    0.000000   -0.433815   -0.901002

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  154.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.0508506"
 Parameter: YPOS -> "16.7743946"
 Parameter: ZPOS -> "41.9725223"
 Parameter: YPHI -> "240.438515"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.493357    0.000000    0.869827
    0.000000    1.000000    0.000000
   -0.869827    0.000000   -0.493357

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  119.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.0508506"
 Parameter: YPOS -> "16.7743946"
 Parameter: ZPOS -> "41.9725223"
 Parameter: ZPHI -> "358.149551"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.999479   -0.032291    0.000000
    0.032291    0.999479    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    1.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.050851 XMAX =  -29.050851 XAVE =  -29.050851
    YMIN =   16.774395 YMAX =   16.774395 YAVE =   16.774395
    ZMIN =   41.972522 ZMAX =   41.972522 ZAVE =   41.972522
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.0508506"
Evaluating: -29.0508506+3.5
 Parameter: XMAX <- "-25.5508506"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.7743946"
Evaluating: 16.7743946+3.5
 Parameter: YMAX <- "20.2743946"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.9725223"
Evaluating: 41.9725223+3.5
 Parameter: ZMAX <- "45.4725223"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.0508506"
Evaluating: -29.0508506-3.5
 Parameter: XMIN <- "-32.5508506"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.7743946"
Evaluating: 16.7743946-3.5
 Parameter: YMIN <- "13.2743946"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.9725223"
Evaluating: 41.9725223-3.5
 Parameter: ZMIN <- "38.4725223"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.5508506"
 Parameter: XMIN -> "-32.5508506"
 Parameter: YMAX -> "20.2743946"
 Parameter: YMIN -> "13.2743946"
 Parameter: ZMAX -> "45.4725223"
 Parameter: ZMIN -> "38.4725223"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "52" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "52" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.615303161"
Evaluating: 90.067469*(0.615303161-0.5)
 Parameter: XPOS <- "10.3850639"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.121523352"
Evaluating: 90.067469*(0.121523352-0.5)
 Parameter: YPOS <- "-34.0884338"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.581138784"
Evaluating: 143.194738*(0.581138784-0.5)+3.5172451
 Parameter: ZPOS <- "15.135892"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "15.135892" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "15.135892" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.3850639"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.3850639-0
 Parameter: XTRAN <- "10.3850639"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.0884338"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -34.0884338-0
 Parameter: YTRAN <- "-34.0884338"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.135892"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 15.135892-0
 Parameter: ZTRAN <- "15.135892"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.3850639"
 Parameter: YTRAN -> "-34.0884338"
 Parameter: ZTRAN -> "15.135892"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    10.385064  -34.088434   15.135892
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.73704062"
Evaluating: 0.73704062*360.0
 Parameter: XPHI <- "265.334623"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.502675754"
Evaluating: 0.502675754*360.0
 Parameter: YPHI <- "180.963271"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.867481875"
Evaluating: 0.867481875*360.0
 Parameter: ZPHI <- "312.293475"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.3850639"
 Parameter: YPOS -> "-34.0884338"
 Parameter: ZPOS -> "15.135892"
 Parameter: XPHI -> "265.334623"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.081336   -0.996687
    0.000000    0.996687   -0.081336

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   94.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.3850639"
 Parameter: YPOS -> "-34.0884338"
 Parameter: ZPOS -> "15.135892"
 Parameter: YPHI -> "180.963271"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.999859    0.000000    0.016811
    0.000000    1.000000    0.000000
   -0.016811    0.000000   -0.999859

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  179.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.3850639"
 Parameter: YPOS -> "-34.0884338"
 Parameter: ZPOS -> "15.135892"
 Parameter: ZPHI -> "312.293475"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.672928   -0.739708    0.000000
    0.739708    0.672928    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.385064 XMAX =   10.385064 XAVE =   10.385064
    YMIN =  -34.088434 YMAX =  -34.088434 YAVE =  -34.088434
    ZMIN =   15.135892 ZMAX =   15.135892 ZAVE =   15.135892
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.3850639"
Evaluating: 10.3850639+3.5
 Parameter: XMAX <- "13.8850639"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.0884338"
Evaluating: -34.0884338+3.5
 Parameter: YMAX <- "-30.5884338"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.135892"
Evaluating: 15.135892+3.5
 Parameter: ZMAX <- "18.635892"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.3850639"
Evaluating: 10.3850639-3.5
 Parameter: XMIN <- "6.8850639"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.0884338"
Evaluating: -34.0884338-3.5
 Parameter: YMIN <- "-37.5884338"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.135892"
Evaluating: 15.135892-3.5
 Parameter: ZMIN <- "11.635892"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.8850639"
 Parameter: XMIN -> "6.8850639"
 Parameter: YMAX -> "-30.5884338"
 Parameter: YMIN -> "-37.5884338"
 Parameter: ZMAX -> "18.635892"
 Parameter: ZMIN -> "11.635892"
 SELRPN>     21 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     13 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35013 POS      SOD      52       SOD     -**** MEMB     POPC     23       P             3.5563
35013 POS      SOD      52       SOD     -**** MEMB     POPC     23       O14           2.9576
35013 POS      SOD      52       SOD     -**** MEMB     POPC     23       O11           2.8831
35013 POS      SOD      52       SOD     -**** MEMB     POPC     23       C21           3.9390
35013 POS      SOD      52       SOD     -**** MEMB     POPC     23       C23           3.4389
35013 POS      SOD      52       SOD     -**** MEMB     POPC     57       O22           3.5918
35013 POS      SOD      52       SOD     -**** MEMB     POPC     60       C22           3.1524
35013 POS      SOD      52       SOD     -**** MEMB     POPC     60       C23           3.6509
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "52" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.590033749"
Evaluating: 90.067469*(0.590033749-0.5)
 Parameter: XPOS <- "8.1091119"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.117583864"
Evaluating: 90.067469*(0.117583864-0.5)
 Parameter: YPOS <- "-34.4432535"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.430859811"
Evaluating: 143.194738*(0.430859811-0.5)+3.5172451
 Parameter: ZPOS <- "-6.38326615"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.38326615" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.38326615" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "52" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.986370263"
Evaluating: 90.067469*(0.986370263-0.5)
 Parameter: XPOS <- "43.8061386"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.499141376"
Evaluating: 90.067469*(0.499141376-0.5)
 Parameter: YPOS <- "-7.73340905E-02"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.781324017"
Evaluating: 143.194738*(0.781324017-0.5)+3.5172451
 Parameter: ZPOS <- "43.801364"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.801364" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.801364" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.385064 XMAX =   10.385064 XAVE =   10.385064
    YMIN =  -34.088434 YMAX =  -34.088434 YAVE =  -34.088434
    ZMIN =   15.135892 ZMAX =   15.135892 ZAVE =   15.135892
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.8061386"
 RDCMND substituted energy or value "?XAVE" to "10.3850639"
Evaluating: 43.8061386-10.3850639
 Parameter: XTRAN <- "33.4210747"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.73340905E-02"
 RDCMND substituted energy or value "?YAVE" to "-34.0884338"
Evaluating: -7.73340905E-02--34.0884338
 Parameter: YTRAN <- "34.0110997"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.801364"
 RDCMND substituted energy or value "?ZAVE" to "15.135892"
Evaluating: 43.801364-15.135892
 Parameter: ZTRAN <- "28.665472"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.4210747"
 Parameter: YTRAN -> "34.0110997"
 Parameter: ZTRAN -> "28.665472"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    33.421075   34.011100   28.665472
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.870496453"
Evaluating: 0.870496453*360.0
 Parameter: XPHI <- "313.378723"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.509214331"
Evaluating: 0.509214331*360.0
 Parameter: YPHI <- "183.317159"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.895625293"
Evaluating: 0.895625293*360.0
 Parameter: ZPHI <- "322.425105"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.8061386"
 Parameter: YPOS -> "-7.73340905E-02"
 Parameter: ZPOS -> "43.801364"
 Parameter: XPHI -> "313.378723"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.686818   -0.726830
    0.000000    0.726830    0.686818

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   46.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.8061386"
 Parameter: YPOS -> "-7.73340905E-02"
 Parameter: ZPOS -> "43.801364"
 Parameter: YPHI -> "183.317159"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.998325    0.000000    0.057863
    0.000000    1.000000    0.000000
   -0.057863    0.000000   -0.998325

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  176.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.8061386"
 Parameter: YPOS -> "-7.73340905E-02"
 Parameter: ZPOS -> "43.801364"
 Parameter: ZPHI -> "322.425105"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.792557   -0.609798    0.000000
    0.609798    0.792557    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   37.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.806139 XMAX =   43.806139 XAVE =   43.806139
    YMIN =   -0.077334 YMAX =   -0.077334 YAVE =   -0.077334
    ZMIN =   43.801364 ZMAX =   43.801364 ZAVE =   43.801364
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.8061386"
Evaluating: 43.8061386+3.5
 Parameter: XMAX <- "47.3061386"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.733409591E-02"
Evaluating: -7.733409591E-02+3.5
 Parameter: YMAX <- "3.4226659"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.801364"
Evaluating: 43.801364+3.5
 Parameter: ZMAX <- "47.301364"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.8061386"
Evaluating: 43.8061386-3.5
 Parameter: XMIN <- "40.3061386"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.733409591E-02"
Evaluating: -7.733409591E-02-3.5
 Parameter: YMIN <- "-3.5773341"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.801364"
Evaluating: 43.801364-3.5
 Parameter: ZMIN <- "40.301364"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.3061386"
 Parameter: XMIN -> "40.3061386"
 Parameter: YMAX -> "3.4226659"
 Parameter: YMIN -> "-3.5773341"
 Parameter: ZMAX -> "47.301364"
 Parameter: ZMIN -> "40.301364"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "53" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "53" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.914499272"
Evaluating: 90.067469*(0.914499272-0.5)
 Parameter: XPOS <- "37.3329003"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.185132202"
Evaluating: 90.067469*(0.185132202-0.5)
 Parameter: YPOS <- "-28.3593456"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.982936014"
Evaluating: 143.194738*(0.982936014-0.5)+3.5172451
 Parameter: ZPOS <- "72.6711411"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "72.6711411" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "72.6711411" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.3329003"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 37.3329003-0
 Parameter: XTRAN <- "37.3329003"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.3593456"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.3593456-0
 Parameter: YTRAN <- "-28.3593456"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "72.6711411"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 72.6711411-0
 Parameter: ZTRAN <- "72.6711411"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.3329003"
 Parameter: YTRAN -> "-28.3593456"
 Parameter: ZTRAN -> "72.6711411"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    37.332900  -28.359346   72.671141
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.608696882E-02"
Evaluating: 4.608696882E-02*360.0
 Parameter: XPHI <- "16.5913088"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.11736797E-02"
Evaluating: 1.11736797E-02*360.0
 Parameter: YPHI <- "4.02252469"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.966624668"
Evaluating: 0.966624668*360.0
 Parameter: ZPHI <- "347.98488"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.3329003"
 Parameter: YPOS -> "-28.3593456"
 Parameter: ZPOS -> "72.6711411"
 Parameter: XPHI -> "16.5913088"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.958366    0.285543
    0.000000   -0.285543    0.958366

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   16.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.3329003"
 Parameter: YPOS -> "-28.3593456"
 Parameter: ZPOS -> "72.6711411"
 Parameter: YPHI -> "4.02252469"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.997537    0.000000   -0.070149
    0.000000    1.000000    0.000000
    0.070149    0.000000    0.997537

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    4.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.3329003"
 Parameter: YPOS -> "-28.3593456"
 Parameter: ZPOS -> "72.6711411"
 Parameter: ZPHI -> "347.98488"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.978093   -0.208170    0.000000
    0.208170    0.978093    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   12.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.332900 XMAX =   37.332900 XAVE =   37.332900
    YMIN =  -28.359346 YMAX =  -28.359346 YAVE =  -28.359346
    ZMIN =   72.671141 ZMAX =   72.671141 ZAVE =   72.671141
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.3329003"
Evaluating: 37.3329003+3.5
 Parameter: XMAX <- "40.8329003"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.3593456"
Evaluating: -28.3593456+3.5
 Parameter: YMAX <- "-24.8593456"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "72.6711411"
Evaluating: 72.6711411+3.5
 Parameter: ZMAX <- "76.1711411"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.3329003"
Evaluating: 37.3329003-3.5
 Parameter: XMIN <- "33.8329003"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.3593456"
Evaluating: -28.3593456-3.5
 Parameter: YMIN <- "-31.8593456"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "72.6711411"
Evaluating: 72.6711411-3.5
 Parameter: ZMIN <- "69.1711411"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.8329003"
 Parameter: XMIN -> "33.8329003"
 Parameter: YMAX -> "-24.8593456"
 Parameter: YMIN -> "-31.8593456"
 Parameter: ZMAX -> "76.1711411"
 Parameter: ZMIN -> "69.1711411"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "54" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "54" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "6.982582914E-02"
Evaluating: 90.067469*(6.982582914E-02-0.5)
 Parameter: XPOS <- "-38.7446988"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.219556897"
Evaluating: 90.067469*(0.219556897-0.5)
 Parameter: YPOS <- "-25.2588005"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "8.691835166E-02"
Evaluating: 143.194738*(8.691835166E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-55.6338733"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.6338733" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.7446988"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.7446988-0
 Parameter: XTRAN <- "-38.7446988"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.2588005"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.2588005-0
 Parameter: YTRAN <- "-25.2588005"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.6338733"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.6338733-0
 Parameter: ZTRAN <- "-55.6338733"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.7446988"
 Parameter: YTRAN -> "-25.2588005"
 Parameter: ZTRAN -> "-55.6338733"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -38.744699  -25.258800  -55.633873
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.949222459"
Evaluating: 0.949222459*360.0
 Parameter: XPHI <- "341.720085"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.569307582"
Evaluating: 0.569307582*360.0
 Parameter: YPHI <- "204.95073"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.827720797"
Evaluating: 0.827720797*360.0
 Parameter: ZPHI <- "297.979487"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.7446988"
 Parameter: YPOS -> "-25.2588005"
 Parameter: ZPOS -> "-55.6338733"
 Parameter: XPHI -> "341.720085"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.949535   -0.313660
    0.000000    0.313660    0.949535

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   18.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.7446988"
 Parameter: YPOS -> "-25.2588005"
 Parameter: ZPOS -> "-55.6338733"
 Parameter: YPHI -> "204.95073"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.906671    0.000000    0.421839
    0.000000    1.000000    0.000000
   -0.421839    0.000000   -0.906671

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  155.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.7446988"
 Parameter: YPOS -> "-25.2588005"
 Parameter: ZPOS -> "-55.6338733"
 Parameter: ZPHI -> "297.979487"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.469155   -0.883116    0.000000
    0.883116    0.469155    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   62.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.744699 XMAX =  -38.744699 XAVE =  -38.744699
    YMIN =  -25.258800 YMAX =  -25.258800 YAVE =  -25.258800
    ZMIN =  -55.633873 ZMAX =  -55.633873 ZAVE =  -55.633873
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.7446988"
Evaluating: -38.7446988+3.5
 Parameter: XMAX <- "-35.2446988"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.2588005"
Evaluating: -25.2588005+3.5
 Parameter: YMAX <- "-21.7588005"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.6338733"
Evaluating: -55.6338733+3.5
 Parameter: ZMAX <- "-52.1338733"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.7446988"
Evaluating: -38.7446988-3.5
 Parameter: XMIN <- "-42.2446988"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.2588005"
Evaluating: -25.2588005-3.5
 Parameter: YMIN <- "-28.7588005"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.6338733"
Evaluating: -55.6338733-3.5
 Parameter: ZMIN <- "-59.1338733"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.2446988"
 Parameter: XMIN -> "-42.2446988"
 Parameter: YMAX -> "-21.7588005"
 Parameter: YMIN -> "-28.7588005"
 Parameter: ZMAX -> "-52.1338733"
 Parameter: ZMIN -> "-59.1338733"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "55" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "55" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.99150755"
Evaluating: 90.067469*(0.99150755-0.5)
 Parameter: XPOS <- "44.268841"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.508638035"
Evaluating: 90.067469*(0.508638035-0.5)
 Parameter: YPOS <- "0.77800595"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.83998123"
Evaluating: 143.194738*(0.83998123-0.5)+3.5172451
 Parameter: ZPOS <- "52.2007683"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.2007683" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.2007683" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.268841"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 44.268841-0
 Parameter: XTRAN <- "44.268841"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.77800595"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 0.77800595-0
 Parameter: YTRAN <- "0.77800595"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.2007683"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 52.2007683-0
 Parameter: ZTRAN <- "52.2007683"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.268841"
 Parameter: YTRAN -> "0.77800595"
 Parameter: ZTRAN -> "52.2007683"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    44.268841    0.778006   52.200768
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.128076965"
Evaluating: 0.128076965*360.0
 Parameter: XPHI <- "46.1077074"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.679098443"
Evaluating: 0.679098443*360.0
 Parameter: YPHI <- "244.475439"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.782196972"
Evaluating: 0.782196972*360.0
 Parameter: ZPHI <- "281.59091"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.268841"
 Parameter: YPOS -> "0.77800595"
 Parameter: ZPOS -> "52.2007683"
 Parameter: XPHI -> "46.1077074"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.693305    0.720644
    0.000000   -0.720644    0.693305

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   46.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.268841"
 Parameter: YPOS -> "0.77800595"
 Parameter: ZPOS -> "52.2007683"
 Parameter: YPHI -> "244.475439"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.430898    0.000000    0.902401
    0.000000    1.000000    0.000000
   -0.902401    0.000000   -0.430898

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  115.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.268841"
 Parameter: YPOS -> "0.77800595"
 Parameter: ZPOS -> "52.2007683"
 Parameter: ZPHI -> "281.59091"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.200923   -0.979607    0.000000
    0.979607    0.200923    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   78.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.268841 XMAX =   44.268841 XAVE =   44.268841
    YMIN =    0.778006 YMAX =    0.778006 YAVE =    0.778006
    ZMIN =   52.200768 ZMAX =   52.200768 ZAVE =   52.200768
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.268841"
Evaluating: 44.268841+3.5
 Parameter: XMAX <- "47.768841"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.77800595"
Evaluating: 0.77800595+3.5
 Parameter: YMAX <- "4.27800595"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.2007683"
Evaluating: 52.2007683+3.5
 Parameter: ZMAX <- "55.7007683"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.268841"
Evaluating: 44.268841-3.5
 Parameter: XMIN <- "40.768841"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.77800595"
Evaluating: 0.77800595-3.5
 Parameter: YMIN <- "-2.72199405"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.2007683"
Evaluating: 52.2007683-3.5
 Parameter: ZMIN <- "48.7007683"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.768841"
 Parameter: XMIN -> "40.768841"
 Parameter: YMAX -> "4.27800595"
 Parameter: YMIN -> "-2.72199405"
 Parameter: ZMAX -> "55.7007683"
 Parameter: ZMIN -> "48.7007683"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "56" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "56" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.953074823"
Evaluating: 90.067469*(0.953074823-0.5)
 Parameter: XPOS <- "40.8073026"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.612365412"
Evaluating: 90.067469*(0.612365412-0.5)
 Parameter: YPOS <- "10.1204683"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.986836161"
Evaluating: 143.194738*(0.986836161-0.5)+3.5172451
 Parameter: ZPOS <- "73.2296216"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "73.2296216" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "73.2296216" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.8073026"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.8073026-0
 Parameter: XTRAN <- "40.8073026"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.1204683"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.1204683-0
 Parameter: YTRAN <- "10.1204683"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "73.2296216"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 73.2296216-0
 Parameter: ZTRAN <- "73.2296216"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.8073026"
 Parameter: YTRAN -> "10.1204683"
 Parameter: ZTRAN -> "73.2296216"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    40.807303   10.120468   73.229622
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.837224464"
Evaluating: 0.837224464*360.0
 Parameter: XPHI <- "301.400807"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.560157222"
Evaluating: 0.560157222*360.0
 Parameter: YPHI <- "201.6566"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.255522692"
Evaluating: 0.255522692*360.0
 Parameter: ZPHI <- "91.9881691"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.8073026"
 Parameter: YPOS -> "10.1204683"
 Parameter: ZPOS -> "73.2296216"
 Parameter: XPHI -> "301.400807"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.521022   -0.853543
    0.000000    0.853543    0.521022

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.8073026"
 Parameter: YPOS -> "10.1204683"
 Parameter: ZPOS -> "73.2296216"
 Parameter: YPHI -> "201.6566"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.929412    0.000000    0.369043
    0.000000    1.000000    0.000000
   -0.369043    0.000000   -0.929412

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  158.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.8073026"
 Parameter: YPOS -> "10.1204683"
 Parameter: ZPOS -> "73.2296216"
 Parameter: ZPHI -> "91.9881691"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.034693    0.999398    0.000000
   -0.999398   -0.034693    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   91.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.807303 XMAX =   40.807303 XAVE =   40.807303
    YMIN =   10.120468 YMAX =   10.120468 YAVE =   10.120468
    ZMIN =   73.229622 ZMAX =   73.229622 ZAVE =   73.229622
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.8073026"
Evaluating: 40.8073026+3.5
 Parameter: XMAX <- "44.3073026"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.1204683"
Evaluating: 10.1204683+3.5
 Parameter: YMAX <- "13.6204683"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "73.2296216"
Evaluating: 73.2296216+3.5
 Parameter: ZMAX <- "76.7296216"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.8073026"
Evaluating: 40.8073026-3.5
 Parameter: XMIN <- "37.3073026"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.1204683"
Evaluating: 10.1204683-3.5
 Parameter: YMIN <- "6.6204683"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "73.2296216"
Evaluating: 73.2296216-3.5
 Parameter: ZMIN <- "69.7296216"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "44.3073026"
 Parameter: XMIN -> "37.3073026"
 Parameter: YMAX -> "13.6204683"
 Parameter: YMIN -> "6.6204683"
 Parameter: ZMAX -> "76.7296216"
 Parameter: ZMIN -> "69.7296216"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "57" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "57" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.183813048"
Evaluating: 90.067469*(0.183813048-0.5)
 Parameter: XPOS <- "-28.4781585"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.117561314E-02"
Evaluating: 90.067469*(8.117561314E-02-0.5)
 Parameter: YPOS <- "-37.7224525"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.10312701"
Evaluating: 143.194738*(0.10312701-0.5)+3.5172451
 Parameter: ZPOS <- "-53.3128787"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.3128787" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.4781585"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -28.4781585-0
 Parameter: XTRAN <- "-28.4781585"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.7224525"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -37.7224525-0
 Parameter: YTRAN <- "-37.7224525"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.3128787"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.3128787-0
 Parameter: ZTRAN <- "-53.3128787"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.4781585"
 Parameter: YTRAN -> "-37.7224525"
 Parameter: ZTRAN -> "-53.3128787"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -28.478158  -37.722453  -53.312879
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.144864893"
Evaluating: 0.144864893*360.0
 Parameter: XPHI <- "52.1513615"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.447888966"
Evaluating: 0.447888966*360.0
 Parameter: YPHI <- "161.240028"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.909943141"
Evaluating: 0.909943141*360.0
 Parameter: ZPHI <- "327.579531"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.4781585"
 Parameter: YPOS -> "-37.7224525"
 Parameter: ZPOS -> "-53.3128787"
 Parameter: XPHI -> "52.1513615"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.613578    0.789634
    0.000000   -0.789634    0.613578

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   52.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.4781585"
 Parameter: YPOS -> "-37.7224525"
 Parameter: ZPOS -> "-53.3128787"
 Parameter: YPHI -> "161.240028"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.946874    0.000000   -0.321604
    0.000000    1.000000    0.000000
    0.321604    0.000000   -0.946874

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  161.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.4781585"
 Parameter: YPOS -> "-37.7224525"
 Parameter: ZPOS -> "-53.3128787"
 Parameter: ZPHI -> "327.579531"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.844136   -0.536128    0.000000
    0.536128    0.844136    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   32.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.478158 XMAX =  -28.478158 XAVE =  -28.478158
    YMIN =  -37.722453 YMAX =  -37.722453 YAVE =  -37.722453
    ZMIN =  -53.312879 ZMAX =  -53.312879 ZAVE =  -53.312879
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.4781585"
Evaluating: -28.4781585+3.5
 Parameter: XMAX <- "-24.9781585"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.7224525"
Evaluating: -37.7224525+3.5
 Parameter: YMAX <- "-34.2224525"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.3128787"
Evaluating: -53.3128787+3.5
 Parameter: ZMAX <- "-49.8128787"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.4781585"
Evaluating: -28.4781585-3.5
 Parameter: XMIN <- "-31.9781585"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.7224525"
Evaluating: -37.7224525-3.5
 Parameter: YMIN <- "-41.2224525"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.3128787"
Evaluating: -53.3128787-3.5
 Parameter: ZMIN <- "-56.8128787"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.9781585"
 Parameter: XMIN -> "-31.9781585"
 Parameter: YMAX -> "-34.2224525"
 Parameter: YMIN -> "-41.2224525"
 Parameter: ZMAX -> "-49.8128787"
 Parameter: ZMIN -> "-56.8128787"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "58"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "58" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "58" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.245412192"
Evaluating: 90.067469*(0.245412192-0.5)
 Parameter: XPOS <- "-22.9300795"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.018945433E-02"
Evaluating: 90.067469*(8.018945433E-02-0.5)
 Parameter: YPOS <- "-37.8112733"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.562510848"
Evaluating: 143.194738*(0.562510848-0.5)+3.5172451
 Parameter: ZPOS <- "12.4684696"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "12.4684696" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "12.4684696" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "58" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.419201454"
Evaluating: 90.067469*(0.419201454-0.5)
 Parameter: XPOS <- "-7.27732054"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.344449865"
Evaluating: 90.067469*(0.344449865-0.5)
 Parameter: YPOS <- "-14.010007"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.633497781"
Evaluating: 143.194738*(0.633497781-0.5)+3.5172451
 Parameter: ZPOS <- "22.6334249"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.6334249" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.6334249" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.27732054"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.27732054-0
 Parameter: XTRAN <- "-7.27732054"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.010007"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.010007-0
 Parameter: YTRAN <- "-14.010007"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.6334249"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.6334249-0
 Parameter: ZTRAN <- "22.6334249"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.27732054"
 Parameter: YTRAN -> "-14.010007"
 Parameter: ZTRAN -> "22.6334249"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -7.277321  -14.010007   22.633425
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.16978183"
Evaluating: 0.16978183*360.0
 Parameter: XPHI <- "61.1214588"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.87939221"
Evaluating: 0.87939221*360.0
 Parameter: YPHI <- "316.581196"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.629122273"
Evaluating: 0.629122273*360.0
 Parameter: ZPHI <- "226.484018"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.27732054"
 Parameter: YPOS -> "-14.010007"
 Parameter: ZPOS -> "22.6334249"
 Parameter: XPHI -> "61.1214588"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.482954    0.875645
    0.000000   -0.875645    0.482954

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   61.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.27732054"
 Parameter: YPOS -> "-14.010007"
 Parameter: ZPOS -> "22.6334249"
 Parameter: YPHI -> "316.581196"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.726349    0.000000    0.687326
    0.000000    1.000000    0.000000
   -0.687326    0.000000    0.726349

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   43.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.27732054"
 Parameter: YPOS -> "-14.010007"
 Parameter: ZPOS -> "22.6334249"
 Parameter: ZPHI -> "226.484018"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.688557   -0.725182    0.000000
    0.725182   -0.688557    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  133.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.277321 XMAX =   -7.277321 XAVE =   -7.277321
    YMIN =  -14.010007 YMAX =  -14.010007 YAVE =  -14.010007
    ZMIN =   22.633425 ZMAX =   22.633425 ZAVE =   22.633425
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.27732054"
Evaluating: -7.27732054+3.5
 Parameter: XMAX <- "-3.77732054"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.010007"
Evaluating: -14.010007+3.5
 Parameter: YMAX <- "-10.510007"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.6334249"
Evaluating: 22.6334249+3.5
 Parameter: ZMAX <- "26.1334249"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.27732054"
Evaluating: -7.27732054-3.5
 Parameter: XMIN <- "-10.7773205"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.010007"
Evaluating: -14.010007-3.5
 Parameter: YMIN <- "-17.510007"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.6334249"
Evaluating: 22.6334249-3.5
 Parameter: ZMIN <- "19.1334249"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.77732054"
 Parameter: XMIN -> "-10.7773205"
 Parameter: YMAX -> "-10.510007"
 Parameter: YMIN -> "-17.510007"
 Parameter: ZMAX -> "26.1334249"
 Parameter: ZMIN -> "19.1334249"
 SELRPN>      2 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      1 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "59"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "59" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "59" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.639619136"
Evaluating: 90.067469*(0.639619136-0.5)
 Parameter: XPOS <- "12.5751422"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.423842526"
Evaluating: 90.067469*(0.423842526-0.5)
 Parameter: YPOS <- "-6.85931093"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.345283157"
Evaluating: 143.194738*(0.345283157-0.5)+3.5172451
 Parameter: ZPOS <- "-18.6373927"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.6373927" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.5751422"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.5751422-0
 Parameter: XTRAN <- "12.5751422"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.85931093"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.85931093-0
 Parameter: YTRAN <- "-6.85931093"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.6373927"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.6373927-0
 Parameter: ZTRAN <- "-18.6373927"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.5751422"
 Parameter: YTRAN -> "-6.85931093"
 Parameter: ZTRAN -> "-18.6373927"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    12.575142   -6.859311  -18.637393
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.847105061"
Evaluating: 0.847105061*360.0
 Parameter: XPHI <- "304.957822"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.976729112"
Evaluating: 0.976729112*360.0
 Parameter: YPHI <- "351.62248"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.997240641"
Evaluating: 0.997240641*360.0
 Parameter: ZPHI <- "359.006631"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.5751422"
 Parameter: YPOS -> "-6.85931093"
 Parameter: ZPOS -> "-18.6373927"
 Parameter: XPHI -> "304.957822"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.572973   -0.819574
    0.000000    0.819574    0.572973

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   55.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.5751422"
 Parameter: YPOS -> "-6.85931093"
 Parameter: ZPOS -> "-18.6373927"
 Parameter: YPHI -> "351.62248"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.989330    0.000000    0.145695
    0.000000    1.000000    0.000000
   -0.145695    0.000000    0.989330

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    8.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.5751422"
 Parameter: YPOS -> "-6.85931093"
 Parameter: ZPOS -> "-18.6373927"
 Parameter: ZPHI -> "359.006631"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.999850   -0.017337    0.000000
    0.017337    0.999850    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    0.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.575142 XMAX =   12.575142 XAVE =   12.575142
    YMIN =   -6.859311 YMAX =   -6.859311 YAVE =   -6.859311
    ZMIN =  -18.637393 ZMAX =  -18.637393 ZAVE =  -18.637393
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.5751422"
Evaluating: 12.5751422+3.5
 Parameter: XMAX <- "16.0751422"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.85931093"
Evaluating: -6.85931093+3.5
 Parameter: YMAX <- "-3.35931093"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.6373927"
Evaluating: -18.6373927+3.5
 Parameter: ZMAX <- "-15.1373927"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.5751422"
Evaluating: 12.5751422-3.5
 Parameter: XMIN <- "9.0751422"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.85931093"
Evaluating: -6.85931093-3.5
 Parameter: YMIN <- "-10.3593109"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.6373927"
Evaluating: -18.6373927-3.5
 Parameter: ZMIN <- "-22.1373927"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.0751422"
 Parameter: XMIN -> "9.0751422"
 Parameter: YMAX -> "-3.35931093"
 Parameter: YMIN -> "-10.3593109"
 Parameter: ZMAX -> "-15.1373927"
 Parameter: ZMIN -> "-22.1373927"
 SELRPN>     23 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      7 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35020 POS      SOD      59       SOD     -3167 PROA     ARG      223      CA            4.4067
35020 POS      SOD      59       SOD     -3169 PROA     ARG      223      CB            2.9869
35020 POS      SOD      59       SOD     -3172 PROA     ARG      223      CG            3.4611
35020 POS      SOD      59       SOD     -3187 PROA     ARG      223      C             4.6352
35020 POS      SOD      59       SOD     -4909 PROA     PHE      337      CZ            4.0945
35020 POS      SOD      59       SOD     -4911 PROA     PHE      337      CD2           4.1413
35020 POS      SOD      59       SOD     -4913 PROA     PHE      337      CE2           3.2800
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "59" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.34406541"
Evaluating: 90.067469*(0.34406541-0.5)
 Parameter: XPOS <- "-14.0446339"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.91349358"
Evaluating: 90.067469*(0.91349358-0.5)
 Parameter: YPOS <- "37.2423202"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.687559902"
Evaluating: 143.194738*(0.687559902-0.5)+3.5172451
 Parameter: ZPOS <- "30.3748361"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "30.3748361" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "30.3748361" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.575142 XMAX =   12.575142 XAVE =   12.575142
    YMIN =   -6.859311 YMAX =   -6.859311 YAVE =   -6.859311
    ZMIN =  -18.637393 ZMAX =  -18.637393 ZAVE =  -18.637393
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.0446339"
 RDCMND substituted energy or value "?XAVE" to "12.5751422"
Evaluating: -14.0446339-12.5751422
 Parameter: XTRAN <- "-26.6197761"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.2423202"
 RDCMND substituted energy or value "?YAVE" to "-6.85931093"
Evaluating: 37.2423202--6.85931093
 Parameter: YTRAN <- "44.1016311"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.3748361"
 RDCMND substituted energy or value "?ZAVE" to "-18.6373927"
Evaluating: 30.3748361--18.6373927
 Parameter: ZTRAN <- "49.0122288"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-26.6197761"
 Parameter: YTRAN -> "44.1016311"
 Parameter: ZTRAN -> "49.0122288"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -26.619776   44.101631   49.012229
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.272223713"
Evaluating: 0.272223713*360.0
 Parameter: XPHI <- "98.0005367"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.837937801"
Evaluating: 0.837937801*360.0
 Parameter: YPHI <- "301.657608"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.636762879"
Evaluating: 0.636762879*360.0
 Parameter: ZPHI <- "229.234636"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.0446339"
 Parameter: YPOS -> "37.2423202"
 Parameter: ZPOS -> "30.3748361"
 Parameter: XPHI -> "98.0005367"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.139182    0.990267
    0.000000   -0.990267   -0.139182

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   98.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.0446339"
 Parameter: YPOS -> "37.2423202"
 Parameter: ZPOS -> "30.3748361"
 Parameter: YPHI -> "301.657608"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.524842    0.000000    0.851200
    0.000000    1.000000    0.000000
   -0.851200    0.000000    0.524842

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   58.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.0446339"
 Parameter: YPOS -> "37.2423202"
 Parameter: ZPOS -> "30.3748361"
 Parameter: ZPHI -> "229.234636"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.652963   -0.757390    0.000000
    0.757390   -0.652963    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  130.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.044634 XMAX =  -14.044634 XAVE =  -14.044634
    YMIN =   37.242320 YMAX =   37.242320 YAVE =   37.242320
    ZMIN =   30.374836 ZMAX =   30.374836 ZAVE =   30.374836
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.0446339"
Evaluating: -14.0446339+3.5
 Parameter: XMAX <- "-10.5446339"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.2423202"
Evaluating: 37.2423202+3.5
 Parameter: YMAX <- "40.7423202"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.3748361"
Evaluating: 30.3748361+3.5
 Parameter: ZMAX <- "33.8748361"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.0446339"
Evaluating: -14.0446339-3.5
 Parameter: XMIN <- "-17.5446339"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.2423202"
Evaluating: 37.2423202-3.5
 Parameter: YMIN <- "33.7423202"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.3748361"
Evaluating: 30.3748361-3.5
 Parameter: ZMIN <- "26.8748361"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.5446339"
 Parameter: XMIN -> "-17.5446339"
 Parameter: YMAX -> "40.7423202"
 Parameter: YMIN -> "33.7423202"
 Parameter: ZMAX -> "33.8748361"
 Parameter: ZMIN -> "26.8748361"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "60"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "60" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "60" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.168290445"
Evaluating: 90.067469*(0.168290445-0.5)
 Parameter: XPOS <- "-29.8762401"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.960576417"
Evaluating: 90.067469*(0.960576417-0.5)
 Parameter: YPOS <- "41.4829522"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.852677151"
Evaluating: 143.194738*(0.852677151-0.5)+3.5172451
 Parameter: ZPOS <- "54.0187573"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.0187573" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.0187573" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.8762401"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -29.8762401-0
 Parameter: XTRAN <- "-29.8762401"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "41.4829522"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 41.4829522-0
 Parameter: YTRAN <- "41.4829522"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.0187573"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 54.0187573-0
 Parameter: ZTRAN <- "54.0187573"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-29.8762401"
 Parameter: YTRAN -> "41.4829522"
 Parameter: ZTRAN -> "54.0187573"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -29.876240   41.482952   54.018757
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.873403746"
Evaluating: 0.873403746*360.0
 Parameter: XPHI <- "314.425349"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.822407337E-02"
Evaluating: 6.822407337E-02*360.0
 Parameter: YPHI <- "24.5606664"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.809747211"
Evaluating: 0.809747211*360.0
 Parameter: ZPHI <- "291.508996"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.8762401"
 Parameter: YPOS -> "41.4829522"
 Parameter: ZPOS -> "54.0187573"
 Parameter: XPHI -> "314.425349"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.699979   -0.714163
    0.000000    0.714163    0.699979

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   45.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.8762401"
 Parameter: YPOS -> "41.4829522"
 Parameter: ZPOS -> "54.0187573"
 Parameter: YPHI -> "24.5606664"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.909522    0.000000   -0.415657
    0.000000    1.000000    0.000000
    0.415657    0.000000    0.909522

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   24.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.8762401"
 Parameter: YPOS -> "41.4829522"
 Parameter: ZPOS -> "54.0187573"
 Parameter: ZPHI -> "291.508996"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.366647   -0.930360    0.000000
    0.930360    0.366647    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.876240 XMAX =  -29.876240 XAVE =  -29.876240
    YMIN =   41.482952 YMAX =   41.482952 YAVE =   41.482952
    ZMIN =   54.018757 ZMAX =   54.018757 ZAVE =   54.018757
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.8762401"
Evaluating: -29.8762401+3.5
 Parameter: XMAX <- "-26.3762401"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "41.4829522"
Evaluating: 41.4829522+3.5
 Parameter: YMAX <- "44.9829522"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.0187573"
Evaluating: 54.0187573+3.5
 Parameter: ZMAX <- "57.5187573"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.8762401"
Evaluating: -29.8762401-3.5
 Parameter: XMIN <- "-33.3762401"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "41.4829522"
Evaluating: 41.4829522-3.5
 Parameter: YMIN <- "37.9829522"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.0187573"
Evaluating: 54.0187573-3.5
 Parameter: ZMIN <- "50.5187573"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.3762401"
 Parameter: XMIN -> "-33.3762401"
 Parameter: YMAX -> "44.9829522"
 Parameter: YMIN -> "37.9829522"
 Parameter: ZMAX -> "57.5187573"
 Parameter: ZMIN -> "50.5187573"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "61"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "61" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "61" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.537736323"
Evaluating: 90.067469*(0.537736323-0.5)
 Parameter: XPOS <- "3.3988151"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.269699825"
Evaluating: 90.067469*(0.269699825-0.5)
 Parameter: YPOS <- "-20.7425539"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.478468218"
Evaluating: 143.194738*(0.478468218-0.5)+3.5172451
 Parameter: ZPOS <- "0.434007218"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "0.434007218" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "0.434007218" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "61" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.339452356"
Evaluating: 90.067469*(0.339452356-0.5)
 Parameter: XPOS <- "-14.4601199"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.467939109"
Evaluating: 90.067469*(0.467939109-0.5)
 Parameter: YPOS <- "-2.88764331"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.345012965"
Evaluating: 143.194738*(0.345012965-0.5)+3.5172451
 Parameter: ZPOS <- "-18.6760828"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.6760828" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.4601199"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.4601199-0
 Parameter: XTRAN <- "-14.4601199"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.88764331"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -2.88764331-0
 Parameter: YTRAN <- "-2.88764331"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.6760828"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.6760828-0
 Parameter: ZTRAN <- "-18.6760828"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.4601199"
 Parameter: YTRAN -> "-2.88764331"
 Parameter: ZTRAN -> "-18.6760828"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -14.460120   -2.887643  -18.676083
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.675946448E-02"
Evaluating: 1.675946448E-02*360.0
 Parameter: XPHI <- "6.03340721"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453206225"
Evaluating: 0.453206225*360.0
 Parameter: YPHI <- "163.154241"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.123428721"
Evaluating: 0.123428721*360.0
 Parameter: ZPHI <- "44.4343396"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.4601199"
 Parameter: YPOS -> "-2.88764331"
 Parameter: ZPOS -> "-18.6760828"
 Parameter: XPHI -> "6.03340721"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.994461    0.105108
    0.000000   -0.105108    0.994461

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    6.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.4601199"
 Parameter: YPOS -> "-2.88764331"
 Parameter: ZPOS -> "-18.6760828"
 Parameter: YPHI -> "163.154241"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.957088    0.000000   -0.289796
    0.000000    1.000000    0.000000
    0.289796    0.000000   -0.957088

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  163.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.4601199"
 Parameter: YPOS -> "-2.88764331"
 Parameter: ZPOS -> "-18.6760828"
 Parameter: ZPHI -> "44.4343396"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.714053    0.700091    0.000000
   -0.700091    0.714053    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   44.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.460120 XMAX =  -14.460120 XAVE =  -14.460120
    YMIN =   -2.887643 YMAX =   -2.887643 YAVE =   -2.887643
    ZMIN =  -18.676083 ZMAX =  -18.676083 ZAVE =  -18.676083
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.4601199"
Evaluating: -14.4601199+3.5
 Parameter: XMAX <- "-10.9601199"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.88764331"
Evaluating: -2.88764331+3.5
 Parameter: YMAX <- "0.61235669"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.6760828"
Evaluating: -18.6760828+3.5
 Parameter: ZMAX <- "-15.1760828"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.4601199"
Evaluating: -14.4601199-3.5
 Parameter: XMIN <- "-17.9601199"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.88764331"
Evaluating: -2.88764331-3.5
 Parameter: YMIN <- "-6.38764331"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.6760828"
Evaluating: -18.6760828-3.5
 Parameter: ZMIN <- "-22.1760828"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.9601199"
 Parameter: XMIN -> "-17.9601199"
 Parameter: YMAX -> "0.61235669"
 Parameter: YMIN -> "-6.38764331"
 Parameter: ZMAX -> "-15.1760828"
 Parameter: ZMIN -> "-22.1760828"
 SELRPN>     14 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      1 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35022 POS      SOD      61       SOD     -5794 PROA     ASN      394      ND2           3.4160
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "61" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.090326041E-02"
Evaluating: 90.067469*(8.090326041E-02-0.5)
 Parameter: XPOS <- "-37.7469826"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.186798134"
Evaluating: 90.067469*(0.186798134-0.5)
 Parameter: YPOS <- "-28.2092994"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.872023054"
Evaluating: 143.194738*(0.872023054-0.5)+3.5172451
 Parameter: ZPOS <- "56.7889888"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.7889888" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.7889888" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.460120 XMAX =  -14.460120 XAVE =  -14.460120
    YMIN =   -2.887643 YMAX =   -2.887643 YAVE =   -2.887643
    ZMIN =  -18.676083 ZMAX =  -18.676083 ZAVE =  -18.676083
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.7469826"
 RDCMND substituted energy or value "?XAVE" to "-14.4601199"
Evaluating: -37.7469826--14.4601199
 Parameter: XTRAN <- "-23.2868627"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.2092994"
 RDCMND substituted energy or value "?YAVE" to "-2.88764331"
Evaluating: -28.2092994--2.88764331
 Parameter: YTRAN <- "-25.3216561"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.7889888"
 RDCMND substituted energy or value "?ZAVE" to "-18.6760828"
Evaluating: 56.7889888--18.6760828
 Parameter: ZTRAN <- "75.4650716"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.2868627"
 Parameter: YTRAN -> "-25.3216561"
 Parameter: ZTRAN -> "75.4650716"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -23.286863  -25.321656   75.465072
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.89439716E-02"
Evaluating: 6.89439716E-02*360.0
 Parameter: XPHI <- "24.8198298"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.113746841E-02"
Evaluating: 1.113746841E-02*360.0
 Parameter: YPHI <- "4.00948863"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.498955604"
Evaluating: 0.498955604*360.0
 Parameter: ZPHI <- "179.624017"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.7469826"
 Parameter: YPOS -> "-28.2092994"
 Parameter: ZPOS -> "56.7889888"
 Parameter: XPHI -> "24.8198298"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.907632    0.419766
    0.000000   -0.419766    0.907632

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   24.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.7469826"
 Parameter: YPOS -> "-28.2092994"
 Parameter: ZPOS -> "56.7889888"
 Parameter: YPHI -> "4.00948863"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.997552    0.000000   -0.069922
    0.000000    1.000000    0.000000
    0.069922    0.000000    0.997552

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    4.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.7469826"
 Parameter: YPOS -> "-28.2092994"
 Parameter: ZPOS -> "56.7889888"
 Parameter: ZPHI -> "179.624017"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.999978    0.006562    0.000000
   -0.006562   -0.999978    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  179.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.746983 XMAX =  -37.746983 XAVE =  -37.746983
    YMIN =  -28.209299 YMAX =  -28.209299 YAVE =  -28.209299
    ZMIN =   56.788989 ZMAX =   56.788989 ZAVE =   56.788989
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.7469826"
Evaluating: -37.7469826+3.5
 Parameter: XMAX <- "-34.2469826"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.2092994"
Evaluating: -28.2092994+3.5
 Parameter: YMAX <- "-24.7092994"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.7889888"
Evaluating: 56.7889888+3.5
 Parameter: ZMAX <- "60.2889888"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.7469826"
Evaluating: -37.7469826-3.5
 Parameter: XMIN <- "-41.2469826"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.2092994"
Evaluating: -28.2092994-3.5
 Parameter: YMIN <- "-31.7092994"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.7889888"
Evaluating: 56.7889888-3.5
 Parameter: ZMIN <- "53.2889888"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.2469826"
 Parameter: XMIN -> "-41.2469826"
 Parameter: YMAX -> "-24.7092994"
 Parameter: YMIN -> "-31.7092994"
 Parameter: ZMAX -> "60.2889888"
 Parameter: ZMIN -> "53.2889888"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "62"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "62" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "62" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.585129198"
Evaluating: 90.067469*(0.585129198-0.5)
 Parameter: XPOS <- "7.6673714"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.633385506"
Evaluating: 90.067469*(0.633385506-0.5)
 Parameter: YPOS <- "12.0136949"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.839947267"
Evaluating: 143.194738*(0.839947267-0.5)+3.5172451
 Parameter: ZPOS <- "52.1959049"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.1959049" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.1959049" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.6673714"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.6673714-0
 Parameter: XTRAN <- "7.6673714"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.0136949"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.0136949-0
 Parameter: YTRAN <- "12.0136949"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.1959049"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 52.1959049-0
 Parameter: ZTRAN <- "52.1959049"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.6673714"
 Parameter: YTRAN -> "12.0136949"
 Parameter: ZTRAN -> "52.1959049"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     7.667371   12.013695   52.195905
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.651612204"
Evaluating: 0.651612204*360.0
 Parameter: XPHI <- "234.580393"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.632438729"
Evaluating: 0.632438729*360.0
 Parameter: YPHI <- "227.677942"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.7502352E-02"
Evaluating: 9.7502352E-02*360.0
 Parameter: ZPHI <- "35.1008467"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.6673714"
 Parameter: YPOS -> "12.0136949"
 Parameter: ZPOS -> "52.1959049"
 Parameter: XPHI -> "234.580393"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.579560   -0.814930
    0.000000    0.814930   -0.579560

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  125.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.6673714"
 Parameter: YPOS -> "12.0136949"
 Parameter: ZPOS -> "52.1959049"
 Parameter: YPHI -> "227.677942"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.673297    0.000000    0.739372
    0.000000    1.000000    0.000000
   -0.739372    0.000000   -0.673297

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  132.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.6673714"
 Parameter: YPOS -> "12.0136949"
 Parameter: ZPOS -> "52.1959049"
 Parameter: ZPHI -> "35.1008467"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.818141    0.575017    0.000000
   -0.575017    0.818141    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   35.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.667371 XMAX =    7.667371 XAVE =    7.667371
    YMIN =   12.013695 YMAX =   12.013695 YAVE =   12.013695
    ZMIN =   52.195905 ZMAX =   52.195905 ZAVE =   52.195905
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.6673714"
Evaluating: 7.6673714+3.5
 Parameter: XMAX <- "11.1673714"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.0136949"
Evaluating: 12.0136949+3.5
 Parameter: YMAX <- "15.5136949"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.1959049"
Evaluating: 52.1959049+3.5
 Parameter: ZMAX <- "55.6959049"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.6673714"
Evaluating: 7.6673714-3.5
 Parameter: XMIN <- "4.1673714"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.0136949"
Evaluating: 12.0136949-3.5
 Parameter: YMIN <- "8.5136949"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.1959049"
Evaluating: 52.1959049-3.5
 Parameter: ZMIN <- "48.6959049"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.1673714"
 Parameter: XMIN -> "4.1673714"
 Parameter: YMAX -> "15.5136949"
 Parameter: YMIN -> "8.5136949"
 Parameter: ZMAX -> "55.6959049"
 Parameter: ZMIN -> "48.6959049"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "63"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "63" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "63" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.516175691"
Evaluating: 90.067469*(0.516175691-0.5)
 Parameter: XPOS <- "1.45690355"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.147832419"
Evaluating: 90.067469*(0.147832419-0.5)
 Parameter: YPOS <- "-31.7188427"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.754608623"
Evaluating: 143.194738*(0.754608623-0.5)+3.5172451
 Parameter: ZPOS <- "39.9758602"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "39.9758602" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "39.9758602" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.45690355"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.45690355-0
 Parameter: XTRAN <- "1.45690355"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.7188427"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -31.7188427-0
 Parameter: YTRAN <- "-31.7188427"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.9758602"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 39.9758602-0
 Parameter: ZTRAN <- "39.9758602"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.45690355"
 Parameter: YTRAN -> "-31.7188427"
 Parameter: ZTRAN -> "39.9758602"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     1.456904  -31.718843   39.975860
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.31675369"
Evaluating: 0.31675369*360.0
 Parameter: XPHI <- "114.031328"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487865677"
Evaluating: 0.487865677*360.0
 Parameter: YPHI <- "175.631644"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.796514611"
Evaluating: 0.796514611*360.0
 Parameter: ZPHI <- "286.74526"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.45690355"
 Parameter: YPOS -> "-31.7188427"
 Parameter: ZPOS -> "39.9758602"
 Parameter: XPHI -> "114.031328"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.407236    0.913323
    0.000000   -0.913323   -0.407236

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.45690355"
 Parameter: YPOS -> "-31.7188427"
 Parameter: ZPOS -> "39.9758602"
 Parameter: YPHI -> "175.631644"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.997095    0.000000   -0.076168
    0.000000    1.000000    0.000000
    0.076168    0.000000   -0.997095

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  175.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.45690355"
 Parameter: YPOS -> "-31.7188427"
 Parameter: ZPOS -> "39.9758602"
 Parameter: ZPHI -> "286.74526"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.288117   -0.957595    0.000000
    0.957595    0.288117    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   73.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.456904 XMAX =    1.456904 XAVE =    1.456904
    YMIN =  -31.718843 YMAX =  -31.718843 YAVE =  -31.718843
    ZMIN =   39.975860 ZMAX =   39.975860 ZAVE =   39.975860
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.45690355"
Evaluating: 1.45690355+3.5
 Parameter: XMAX <- "4.95690355"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.7188427"
Evaluating: -31.7188427+3.5
 Parameter: YMAX <- "-28.2188427"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.9758602"
Evaluating: 39.9758602+3.5
 Parameter: ZMAX <- "43.4758602"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.45690355"
Evaluating: 1.45690355-3.5
 Parameter: XMIN <- "-2.04309645"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.7188427"
Evaluating: -31.7188427-3.5
 Parameter: YMIN <- "-35.2188427"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.9758602"
Evaluating: 39.9758602-3.5
 Parameter: ZMIN <- "36.4758602"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.95690355"
 Parameter: XMIN -> "-2.04309645"
 Parameter: YMAX -> "-28.2188427"
 Parameter: YMIN -> "-35.2188427"
 Parameter: ZMAX -> "43.4758602"
 Parameter: ZMIN -> "36.4758602"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "64"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "64" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "64" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.970470841"
Evaluating: 90.067469*(0.970470841-0.5)
 Parameter: XPOS <- "42.3741179"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.867522946"
Evaluating: 90.067469*(0.867522946-0.5)
 Parameter: YPOS <- "33.1018615"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.361206356"
Evaluating: 143.194738*(0.361206356-0.5)+3.5172451
 Parameter: ZPOS <- "-16.3572744"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.3572744" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "42.3741179"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 42.3741179-0
 Parameter: XTRAN <- "42.3741179"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.1018615"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 33.1018615-0
 Parameter: YTRAN <- "33.1018615"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.3572744"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.3572744-0
 Parameter: ZTRAN <- "-16.3572744"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "42.3741179"
 Parameter: YTRAN -> "33.1018615"
 Parameter: ZTRAN -> "-16.3572744"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    42.374118   33.101861  -16.357274
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.695208828"
Evaluating: 0.695208828*360.0
 Parameter: XPHI <- "250.275178"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.839511964"
Evaluating: 0.839511964*360.0
 Parameter: YPHI <- "302.224307"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.555208377"
Evaluating: 0.555208377*360.0
 Parameter: ZPHI <- "199.875016"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "42.3741179"
 Parameter: YPOS -> "33.1018615"
 Parameter: ZPOS -> "-16.3572744"
 Parameter: XPHI -> "250.275178"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.337503   -0.941324
    0.000000    0.941324   -0.337503

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  109.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "42.3741179"
 Parameter: YPOS -> "33.1018615"
 Parameter: ZPOS -> "-16.3572744"
 Parameter: YPHI -> "302.224307"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.533235    0.000000    0.845967
    0.000000    1.000000    0.000000
   -0.845967    0.000000    0.533235

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   57.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "42.3741179"
 Parameter: YPOS -> "33.1018615"
 Parameter: ZPOS -> "-16.3572744"
 Parameter: ZPHI -> "199.875016"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.940436   -0.339970    0.000000
    0.339970   -0.940436    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  160.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.374118 XMAX =   42.374118 XAVE =   42.374118
    YMIN =   33.101861 YMAX =   33.101861 YAVE =   33.101861
    ZMIN =  -16.357274 ZMAX =  -16.357274 ZAVE =  -16.357274
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "42.3741179"
Evaluating: 42.3741179+3.5
 Parameter: XMAX <- "45.8741179"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.1018615"
Evaluating: 33.1018615+3.5
 Parameter: YMAX <- "36.6018615"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.3572744"
Evaluating: -16.3572744+3.5
 Parameter: ZMAX <- "-12.8572744"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "42.3741179"
Evaluating: 42.3741179-3.5
 Parameter: XMIN <- "38.8741179"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.1018615"
Evaluating: 33.1018615-3.5
 Parameter: YMIN <- "29.6018615"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.3572744"
Evaluating: -16.3572744-3.5
 Parameter: ZMIN <- "-19.8572744"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.8741179"
 Parameter: XMIN -> "38.8741179"
 Parameter: YMAX -> "36.6018615"
 Parameter: YMIN -> "29.6018615"
 Parameter: ZMAX -> "-12.8572744"
 Parameter: ZMIN -> "-19.8572744"
 SELRPN>     25 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     14 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35025 POS      SOD      64       SOD     -**** MEMB     POPC     200      N             3.1226
35025 POS      SOD      64       SOD     -**** MEMB     POPC     200      C13           1.7686
35025 POS      SOD      64       SOD     -**** MEMB     POPC     200      C15           3.6842
35025 POS      SOD      64       SOD     -**** MEMB     POPC     200      C11           3.5538
35025 POS      SOD      64       SOD     -**** MEMB     POPC     200      P             3.9969
35025 POS      SOD      64       SOD     -**** MEMB     POPC     200      O12           3.9889
35025 POS      SOD      64       SOD     -**** MEMB     POPC     200      O11           2.6330
35025 POS      SOD      64       SOD     -**** MEMB     POPC     200      C1            2.4779
35025 POS      SOD      64       SOD     -**** MEMB     POPC     200      C2            3.6828
35025 POS      SOD      64       SOD     -**** MEMB     POPC     200      O21           3.8444
35025 POS      SOD      64       SOD     -**** MEMB     POPC     200      O31           3.9243
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "64" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.607423636"
Evaluating: 90.067469*(0.607423636-0.5)
 Parameter: XPOS <- "9.67537501"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.989202904"
Evaluating: 90.067469*(0.989202904-0.5)
 Parameter: YPOS <- "44.0612674"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.23031221"
Evaluating: 143.194738*(0.23031221-0.5)+3.5172451
 Parameter: ZPOS <- "-35.1006273"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-35.1006273" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   42.374118 XMAX =   42.374118 XAVE =   42.374118
    YMIN =   33.101861 YMAX =   33.101861 YAVE =   33.101861
    ZMIN =  -16.357274 ZMAX =  -16.357274 ZAVE =  -16.357274
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.67537501"
 RDCMND substituted energy or value "?XAVE" to "42.3741179"
Evaluating: 9.67537501-42.3741179
 Parameter: XTRAN <- "-32.6987429"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.0612674"
 RDCMND substituted energy or value "?YAVE" to "33.1018615"
Evaluating: 44.0612674-33.1018615
 Parameter: YTRAN <- "10.9594059"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.1006273"
 RDCMND substituted energy or value "?ZAVE" to "-16.3572744"
Evaluating: -35.1006273--16.3572744
 Parameter: ZTRAN <- "-18.7433529"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.6987429"
 Parameter: YTRAN -> "10.9594059"
 Parameter: ZTRAN -> "-18.7433529"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -32.698743   10.959406  -18.743353
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.677935741"
Evaluating: 0.677935741*360.0
 Parameter: XPHI <- "244.056867"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.684348204"
Evaluating: 0.684348204*360.0
 Parameter: YPHI <- "246.365353"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.300336082"
Evaluating: 0.300336082*360.0
 Parameter: ZPHI <- "108.12099"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.67537501"
 Parameter: YPOS -> "44.0612674"
 Parameter: ZPOS -> "-35.1006273"
 Parameter: XPHI -> "244.056867"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.437479   -0.899229
    0.000000    0.899229   -0.437479

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.67537501"
 Parameter: YPOS -> "44.0612674"
 Parameter: ZPOS -> "-35.1006273"
 Parameter: YPHI -> "246.365353"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.400903    0.000000    0.916120
    0.000000    1.000000    0.000000
   -0.916120    0.000000   -0.400903

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  113.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.67537501"
 Parameter: YPOS -> "44.0612674"
 Parameter: ZPOS -> "-35.1006273"
 Parameter: ZPHI -> "108.12099"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.311025    0.950402    0.000000
   -0.950402   -0.311025    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  108.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.675375 XMAX =    9.675375 XAVE =    9.675375
    YMIN =   44.061267 YMAX =   44.061267 YAVE =   44.061267
    ZMIN =  -35.100627 ZMAX =  -35.100627 ZAVE =  -35.100627
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.67537501"
Evaluating: 9.67537501+3.5
 Parameter: XMAX <- "13.175375"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.0612674"
Evaluating: 44.0612674+3.5
 Parameter: YMAX <- "47.5612674"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.1006273"
Evaluating: -35.1006273+3.5
 Parameter: ZMAX <- "-31.6006273"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.67537501"
Evaluating: 9.67537501-3.5
 Parameter: XMIN <- "6.17537501"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.0612674"
Evaluating: 44.0612674-3.5
 Parameter: YMIN <- "40.5612674"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.1006273"
Evaluating: -35.1006273-3.5
 Parameter: ZMIN <- "-38.6006273"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.175375"
 Parameter: XMIN -> "6.17537501"
 Parameter: YMAX -> "47.5612674"
 Parameter: YMIN -> "40.5612674"
 Parameter: ZMAX -> "-31.6006273"
 Parameter: ZMIN -> "-38.6006273"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "65"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "65" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "65" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.595833958"
Evaluating: 90.067469*(0.595833958-0.5)
 Parameter: XPOS <- "8.63152204"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.356177707"
Evaluating: 90.067469*(0.356177707-0.5)
 Parameter: YPOS <- "-12.9537099"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.602080681"
Evaluating: 143.194738*(0.602080681-0.5)+3.5172451
 Parameter: ZPOS <- "18.1346615"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "18.1346615" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "18.1346615" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.63152204"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.63152204-0
 Parameter: XTRAN <- "8.63152204"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.9537099"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.9537099-0
 Parameter: YTRAN <- "-12.9537099"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.1346615"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 18.1346615-0
 Parameter: ZTRAN <- "18.1346615"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.63152204"
 Parameter: YTRAN -> "-12.9537099"
 Parameter: ZTRAN -> "18.1346615"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     8.631522  -12.953710   18.134661
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.775977959E-02"
Evaluating: 2.775977959E-02*360.0
 Parameter: XPHI <- "9.99352065"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.293202986E-02"
Evaluating: 3.293202986E-02*360.0
 Parameter: YPHI <- "11.8555307"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.840834502"
Evaluating: 0.840834502*360.0
 Parameter: ZPHI <- "302.700421"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.63152204"
 Parameter: YPOS -> "-12.9537099"
 Parameter: ZPOS -> "18.1346615"
 Parameter: XPHI -> "9.99352065"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.984827    0.173537
    0.000000   -0.173537    0.984827

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    9.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.63152204"
 Parameter: YPOS -> "-12.9537099"
 Parameter: ZPOS -> "18.1346615"
 Parameter: YPHI -> "11.8555307"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.978669    0.000000   -0.205445
    0.000000    1.000000    0.000000
    0.205445    0.000000    0.978669

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   11.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.63152204"
 Parameter: YPOS -> "-12.9537099"
 Parameter: ZPOS -> "18.1346615"
 Parameter: ZPHI -> "302.700421"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.540247   -0.841507    0.000000
    0.841507    0.540247    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   57.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.631522 XMAX =    8.631522 XAVE =    8.631522
    YMIN =  -12.953710 YMAX =  -12.953710 YAVE =  -12.953710
    ZMIN =   18.134661 ZMAX =   18.134661 ZAVE =   18.134661
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.63152204"
Evaluating: 8.63152204+3.5
 Parameter: XMAX <- "12.131522"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.9537099"
Evaluating: -12.9537099+3.5
 Parameter: YMAX <- "-9.4537099"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.1346615"
Evaluating: 18.1346615+3.5
 Parameter: ZMAX <- "21.6346615"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.63152204"
Evaluating: 8.63152204-3.5
 Parameter: XMIN <- "5.13152204"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.9537099"
Evaluating: -12.9537099-3.5
 Parameter: YMIN <- "-16.4537099"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.1346615"
Evaluating: 18.1346615-3.5
 Parameter: ZMIN <- "14.6346615"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.131522"
 Parameter: XMIN -> "5.13152204"
 Parameter: YMAX -> "-9.4537099"
 Parameter: YMIN -> "-16.4537099"
 Parameter: ZMAX -> "21.6346615"
 Parameter: ZMIN -> "14.6346615"
 SELRPN>     32 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      6 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35026 POS      SOD      65       SOD     -2011 PROA     LEU      153      CB            4.9373
35026 POS      SOD      65       SOD     -2081 PROA     ILE      157      CA            4.3662
35026 POS      SOD      65       SOD     -2083 PROA     ILE      157      CB            2.8642
35026 POS      SOD      65       SOD     -2085 PROA     ILE      157      CG2           3.0668
35026 POS      SOD      65       SOD     -2089 PROA     ILE      157      CG1           2.6609
35026 POS      SOD      65       SOD     -2092 PROA     ILE      157      CD            1.6210
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "65" and "65".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.179231397"
Evaluating: 90.067469*(0.179231397-0.5)
 Parameter: XPOS <- "-28.8908162"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.62923369"
Evaluating: 90.067469*(0.62923369-0.5)
 Parameter: YPOS <- "11.6397514"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.920030576"
Evaluating: 143.194738*(0.920030576-0.5)+3.5172451
 Parameter: ZPOS <- "63.6634134"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.6634134" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.6634134" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.631522 XMAX =    8.631522 XAVE =    8.631522
    YMIN =  -12.953710 YMAX =  -12.953710 YAVE =  -12.953710
    ZMIN =   18.134661 ZMAX =   18.134661 ZAVE =   18.134661
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.8908162"
 RDCMND substituted energy or value "?XAVE" to "8.63152204"
Evaluating: -28.8908162-8.63152204
 Parameter: XTRAN <- "-37.5223382"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.6397514"
 RDCMND substituted energy or value "?YAVE" to "-12.9537099"
Evaluating: 11.6397514--12.9537099
 Parameter: YTRAN <- "24.5934613"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.6634134"
 RDCMND substituted energy or value "?ZAVE" to "18.1346615"
Evaluating: 63.6634134-18.1346615
 Parameter: ZTRAN <- "45.5287519"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.5223382"
 Parameter: YTRAN -> "24.5934613"
 Parameter: ZTRAN -> "45.5287519"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -37.522338   24.593461   45.528752
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.575466887"
Evaluating: 0.575466887*360.0
 Parameter: XPHI <- "207.168079"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.953196257"
Evaluating: 0.953196257*360.0
 Parameter: YPHI <- "343.150653"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.71407642"
Evaluating: 0.71407642*360.0
 Parameter: ZPHI <- "257.067511"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.8908162"
 Parameter: YPOS -> "11.6397514"
 Parameter: ZPOS -> "63.6634134"
 Parameter: XPHI -> "207.168079"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.889671   -0.456602
    0.000000    0.456602   -0.889671

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  152.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.8908162"
 Parameter: YPOS -> "11.6397514"
 Parameter: ZPOS -> "63.6634134"
 Parameter: YPHI -> "343.150653"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.957070    0.000000    0.289856
    0.000000    1.000000    0.000000
   -0.289856    0.000000    0.957070

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   16.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.8908162"
 Parameter: YPOS -> "11.6397514"
 Parameter: ZPOS -> "63.6634134"
 Parameter: ZPHI -> "257.067511"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.223803   -0.974634    0.000000
    0.974634   -0.223803    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  102.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.890816 XMAX =  -28.890816 XAVE =  -28.890816
    YMIN =   11.639751 YMAX =   11.639751 YAVE =   11.639751
    ZMIN =   63.663413 ZMAX =   63.663413 ZAVE =   63.663413
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.8908162"
Evaluating: -28.8908162+3.5
 Parameter: XMAX <- "-25.3908162"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.6397514"
Evaluating: 11.6397514+3.5
 Parameter: YMAX <- "15.1397514"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.6634134"
Evaluating: 63.6634134+3.5
 Parameter: ZMAX <- "67.1634134"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.8908162"
Evaluating: -28.8908162-3.5
 Parameter: XMIN <- "-32.3908162"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.6397514"
Evaluating: 11.6397514-3.5
 Parameter: YMIN <- "8.1397514"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.6634134"
Evaluating: 63.6634134-3.5
 Parameter: ZMIN <- "60.1634134"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.3908162"
 Parameter: XMIN -> "-32.3908162"
 Parameter: YMAX -> "15.1397514"
 Parameter: YMIN -> "8.1397514"
 Parameter: ZMAX -> "67.1634134"
 Parameter: ZMIN -> "60.1634134"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "66"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "66" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "66" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "66"
 Parameter: NPOS -> "65"
Evaluating: 66-65
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.602522229"
Evaluating: 90.067469*(0.602522229-0.5)
 Parameter: XPOS <- "9.23391768"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.327306385"
Evaluating: 90.067469*(0.327306385-0.5)
 Parameter: YPOS <- "-15.5540768"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.200344915"
Evaluating: 143.194738*(0.200344915-0.5)+3.5172451
 Parameter: ZPOS <- "-39.3917863"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.3917863" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.23391768"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 9.23391768-0
 Parameter: XTRAN <- "9.23391768"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.5540768"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.5540768-0
 Parameter: YTRAN <- "-15.5540768"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.3917863"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.3917863-0
 Parameter: ZTRAN <- "-39.3917863"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.23391768"
 Parameter: YTRAN -> "-15.5540768"
 Parameter: ZTRAN -> "-39.3917863"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     9.233918  -15.554077  -39.391786
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.619477244"
Evaluating: 0.619477244*360.0
 Parameter: XPHI <- "223.011808"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.968660181"
Evaluating: 0.968660181*360.0
 Parameter: YPHI <- "348.717665"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.852757416"
Evaluating: 0.852757416*360.0
 Parameter: ZPHI <- "306.99267"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.23391768"
 Parameter: YPOS -> "-15.5540768"
 Parameter: ZPOS -> "-39.3917863"
 Parameter: XPHI -> "223.011808"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.731213   -0.682149
    0.000000    0.682149   -0.731213

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  136.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.23391768"
 Parameter: YPOS -> "-15.5540768"
 Parameter: ZPOS -> "-39.3917863"
 Parameter: YPHI -> "348.717665"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.980675    0.000000    0.195644
    0.000000    1.000000    0.000000
   -0.195644    0.000000    0.980675

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   11.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.23391768"
 Parameter: YPOS -> "-15.5540768"
 Parameter: ZPOS -> "-39.3917863"
 Parameter: ZPHI -> "306.99267"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.601713   -0.798712    0.000000
    0.798712    0.601713    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   53.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.233918 XMAX =    9.233918 XAVE =    9.233918
    YMIN =  -15.554077 YMAX =  -15.554077 YAVE =  -15.554077
    ZMIN =  -39.391786 ZMAX =  -39.391786 ZAVE =  -39.391786
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.23391768"
Evaluating: 9.23391768+3.5
 Parameter: XMAX <- "12.7339177"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.5540768"
Evaluating: -15.5540768+3.5
 Parameter: YMAX <- "-12.0540768"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.3917863"
Evaluating: -39.3917863+3.5
 Parameter: ZMAX <- "-35.8917863"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.23391768"
Evaluating: 9.23391768-3.5
 Parameter: XMIN <- "5.73391768"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.5540768"
Evaluating: -15.5540768-3.5
 Parameter: YMIN <- "-19.0540768"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.3917863"
Evaluating: -39.3917863-3.5
 Parameter: ZMIN <- "-42.8917863"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.7339177"
 Parameter: XMIN -> "5.73391768"
 Parameter: YMAX -> "-12.0540768"
 Parameter: YMIN -> "-19.0540768"
 Parameter: ZMAX -> "-35.8917863"
 Parameter: ZMIN -> "-42.8917863"
 SELRPN>     19 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     10 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35027 NEG      CLA      1        CLA     -5211 PROA     ASP      357      CG            3.3232
35027 NEG      CLA      1        CLA     -5213 PROA     ASP      357      OD2           2.1590
35027 NEG      CLA      1        CLA     -5460 PROA     GLN      374      N             4.0612
35027 NEG      CLA      1        CLA     -5462 PROA     GLN      374      CA            3.5139
35027 NEG      CLA      1        CLA     -5464 PROA     GLN      374      CB            2.7059
35027 NEG      CLA      1        CLA     -5467 PROA     GLN      374      CG            2.2748
35027 NEG      CLA      1        CLA     -5470 PROA     GLN      374      CD            2.9034
35027 NEG      CLA      1        CLA     -5471 PROA     GLN      374      OE1           4.0757
35027 NEG      CLA      1        CLA     -5472 PROA     GLN      374      NE2           2.7819
35027 NEG      CLA      1        CLA     -5475 PROA     GLN      374      C             4.7321
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "66" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "66"
 Parameter: NPOS -> "65"
Evaluating: 66-65
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.60144517"
Evaluating: 90.067469*(0.60144517-0.5)
 Parameter: XPOS <- "9.1369097"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.297928463"
Evaluating: 90.067469*(0.297928463-0.5)
 Parameter: YPOS <- "-18.2000719"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.934138019"
Evaluating: 143.194738*(0.934138019-0.5)+3.5172451
 Parameter: ZPOS <- "65.683525"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "65.683525" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "65.683525" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.233918 XMAX =    9.233918 XAVE =    9.233918
    YMIN =  -15.554077 YMAX =  -15.554077 YAVE =  -15.554077
    ZMIN =  -39.391786 ZMAX =  -39.391786 ZAVE =  -39.391786
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.1369097"
 RDCMND substituted energy or value "?XAVE" to "9.23391768"
Evaluating: 9.1369097-9.23391768
 Parameter: XTRAN <- "-9.700798E-02"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.2000719"
 RDCMND substituted energy or value "?YAVE" to "-15.5540768"
Evaluating: -18.2000719--15.5540768
 Parameter: YTRAN <- "-2.6459951"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "65.683525"
 RDCMND substituted energy or value "?ZAVE" to "-39.3917863"
Evaluating: 65.683525--39.3917863
 Parameter: ZTRAN <- "105.075311"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.700798E-02"
 Parameter: YTRAN -> "-2.6459951"
 Parameter: ZTRAN -> "105.075311"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -0.097008   -2.645995  105.075311
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.140977695"
Evaluating: 0.140977695*360.0
 Parameter: XPHI <- "50.7519702"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.368828791E-02"
Evaluating: 9.368828791E-02*360.0
 Parameter: YPHI <- "33.7277836"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.328823874"
Evaluating: 0.328823874*360.0
 Parameter: ZPHI <- "118.376595"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.1369097"
 Parameter: YPOS -> "-18.2000719"
 Parameter: ZPOS -> "65.683525"
 Parameter: XPHI -> "50.7519702"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.632679    0.774414
    0.000000   -0.774414    0.632679

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   50.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.1369097"
 Parameter: YPOS -> "-18.2000719"
 Parameter: ZPOS -> "65.683525"
 Parameter: YPHI -> "33.7277836"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.831685    0.000000   -0.555248
    0.000000    1.000000    0.000000
    0.555248    0.000000    0.831685

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   33.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.1369097"
 Parameter: YPOS -> "-18.2000719"
 Parameter: ZPOS -> "65.683525"
 Parameter: ZPHI -> "118.376595"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.475265    0.879843    0.000000
   -0.879843   -0.475265    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  118.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.136909 XMAX =    9.136909 XAVE =    9.136909
    YMIN =  -18.200072 YMAX =  -18.200072 YAVE =  -18.200072
    ZMIN =   65.683525 ZMAX =   65.683525 ZAVE =   65.683525
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.13690945"
Evaluating: 9.13690945+3.5
 Parameter: XMAX <- "12.6369094"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.2000719"
Evaluating: -18.2000719+3.5
 Parameter: YMAX <- "-14.7000719"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "65.6835248"
Evaluating: 65.6835248+3.5
 Parameter: ZMAX <- "69.1835248"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.13690945"
Evaluating: 9.13690945-3.5
 Parameter: XMIN <- "5.63690945"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.2000719"
Evaluating: -18.2000719-3.5
 Parameter: YMIN <- "-21.7000719"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "65.6835248"
Evaluating: 65.6835248-3.5
 Parameter: ZMIN <- "62.1835248"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.6369094"
 Parameter: XMIN -> "5.63690945"
 Parameter: YMAX -> "-14.7000719"
 Parameter: YMIN -> "-21.7000719"
 Parameter: ZMAX -> "69.1835248"
 Parameter: ZMIN -> "62.1835248"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "67"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "67" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "67" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "67"
 Parameter: NPOS -> "65"
Evaluating: 67-65
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.67451421"
Evaluating: 90.067469*(0.67451421-0.5)
 Parameter: XPOS <- "15.7180532"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.617011587"
Evaluating: 90.067469*(0.617011587-0.5)
 Parameter: YPOS <- "10.5389375"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.906617687"
Evaluating: 143.194738*(0.906617687-0.5)+3.5172451
 Parameter: ZPOS <- "61.7427583"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "61.7427583" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "61.7427583" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.7180532"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.7180532-0
 Parameter: XTRAN <- "15.7180532"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.5389375"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.5389375-0
 Parameter: YTRAN <- "10.5389375"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.7427583"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 61.7427583-0
 Parameter: ZTRAN <- "61.7427583"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.7180532"
 Parameter: YTRAN -> "10.5389375"
 Parameter: ZTRAN -> "61.7427583"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    15.718053   10.538937   61.742758
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.920872332"
Evaluating: 0.920872332*360.0
 Parameter: XPHI <- "331.51404"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.139557289"
Evaluating: 0.139557289*360.0
 Parameter: YPHI <- "50.240624"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.795741952"
Evaluating: 0.795741952*360.0
 Parameter: ZPHI <- "286.467103"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.7180532"
 Parameter: YPOS -> "10.5389375"
 Parameter: ZPOS -> "61.7427583"
 Parameter: XPHI -> "331.51404"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.878934   -0.476943
    0.000000    0.476943    0.878934

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   28.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.7180532"
 Parameter: YPOS -> "10.5389375"
 Parameter: ZPOS -> "61.7427583"
 Parameter: YPHI -> "50.240624"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.639565    0.000000   -0.768737
    0.000000    1.000000    0.000000
    0.768737    0.000000    0.639565

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   50.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.7180532"
 Parameter: YPOS -> "10.5389375"
 Parameter: ZPOS -> "61.7427583"
 Parameter: ZPHI -> "286.467103"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.283465   -0.958983    0.000000
    0.958983    0.283465    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   73.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.718053 XMAX =   15.718053 XAVE =   15.718053
    YMIN =   10.538937 YMAX =   10.538937 YAVE =   10.538937
    ZMIN =   61.742758 ZMAX =   61.742758 ZAVE =   61.742758
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.7180532"
Evaluating: 15.7180532+3.5
 Parameter: XMAX <- "19.2180532"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.5389375"
Evaluating: 10.5389375+3.5
 Parameter: YMAX <- "14.0389375"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.7427583"
Evaluating: 61.7427583+3.5
 Parameter: ZMAX <- "65.2427583"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.7180532"
Evaluating: 15.7180532-3.5
 Parameter: XMIN <- "12.2180532"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.5389375"
Evaluating: 10.5389375-3.5
 Parameter: YMIN <- "7.0389375"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.7427583"
Evaluating: 61.7427583-3.5
 Parameter: ZMIN <- "58.2427583"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.2180532"
 Parameter: XMIN -> "12.2180532"
 Parameter: YMAX -> "14.0389375"
 Parameter: YMIN -> "7.0389375"
 Parameter: ZMAX -> "65.2427583"
 Parameter: ZMIN -> "58.2427583"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "68"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "68" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "68" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "68"
 Parameter: NPOS -> "65"
Evaluating: 68-65
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.695719454"
Evaluating: 90.067469*(0.695719454-0.5)
 Parameter: XPOS <- "17.6279559"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.285975488"
Evaluating: 90.067469*(0.285975488-0.5)
 Parameter: YPOS <- "-19.2766461"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.533005904"
Evaluating: 143.194738*(0.533005904-0.5)+3.5172451
 Parameter: ZPOS <- "8.24351688"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.24351688" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.24351688" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "68" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "68"
 Parameter: NPOS -> "65"
Evaluating: 68-65
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.807977873"
Evaluating: 90.067469*(0.807977873-0.5)
 Parameter: XPOS <- "27.7387875"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.217287208"
Evaluating: 90.067469*(0.217287208-0.5)
 Parameter: YPOS <- "-25.4632256"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.104639113"
Evaluating: 143.194738*(0.104639113-0.5)+3.5172451
 Parameter: ZPOS <- "-53.0963535"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-53.0963535" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.7387875"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 27.7387875-0
 Parameter: XTRAN <- "27.7387875"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.4632256"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.4632256-0
 Parameter: YTRAN <- "-25.4632256"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-53.0963535"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -53.0963535-0
 Parameter: ZTRAN <- "-53.0963535"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.7387875"
 Parameter: YTRAN -> "-25.4632256"
 Parameter: ZTRAN -> "-53.0963535"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    27.738788  -25.463226  -53.096353
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.230487161"
Evaluating: 0.230487161*360.0
 Parameter: XPHI <- "82.975378"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.61728635"
Evaluating: 0.61728635*360.0
 Parameter: YPHI <- "222.223086"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.388313621"
Evaluating: 0.388313621*360.0
 Parameter: ZPHI <- "139.792904"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.7387875"
 Parameter: YPOS -> "-25.4632256"
 Parameter: ZPOS -> "-53.0963535"
 Parameter: XPHI -> "82.975378"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.122296    0.992494
    0.000000   -0.992494    0.122296

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   82.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.7387875"
 Parameter: YPOS -> "-25.4632256"
 Parameter: ZPOS -> "-53.0963535"
 Parameter: YPHI -> "222.223086"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.740534    0.000000    0.672019
    0.000000    1.000000    0.000000
   -0.672019    0.000000   -0.740534

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  137.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.7387875"
 Parameter: YPOS -> "-25.4632256"
 Parameter: ZPOS -> "-53.0963535"
 Parameter: ZPHI -> "139.792904"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.763716    0.645552    0.000000
   -0.645552   -0.763716    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  139.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.738788 XMAX =   27.738788 XAVE =   27.738788
    YMIN =  -25.463226 YMAX =  -25.463226 YAVE =  -25.463226
    ZMIN =  -53.096353 ZMAX =  -53.096353 ZAVE =  -53.096353
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.7387875"
Evaluating: 27.7387875+3.5
 Parameter: XMAX <- "31.2387875"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.4632256"
Evaluating: -25.4632256+3.5
 Parameter: YMAX <- "-21.9632256"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-53.0963535"
Evaluating: -53.0963535+3.5
 Parameter: ZMAX <- "-49.5963535"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.7387875"
Evaluating: 27.7387875-3.5
 Parameter: XMIN <- "24.2387875"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.4632256"
Evaluating: -25.4632256-3.5
 Parameter: YMIN <- "-28.9632256"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-53.0963535"
Evaluating: -53.0963535-3.5
 Parameter: ZMIN <- "-56.5963535"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.2387875"
 Parameter: XMIN -> "24.2387875"
 Parameter: YMAX -> "-21.9632256"
 Parameter: YMIN -> "-28.9632256"
 Parameter: ZMAX -> "-49.5963535"
 Parameter: ZMIN -> "-56.5963535"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "69"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "69" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "69" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "69"
 Parameter: NPOS -> "65"
Evaluating: 69-65
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.150162932"
Evaluating: 90.067469*(0.150162932-0.5)
 Parameter: XPOS <- "-31.5089393"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.982692576"
Evaluating: 90.067469*(0.982692576-0.5)
 Parameter: YPOS <- "43.4748986"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.182101612"
Evaluating: 143.194738*(0.182101612-0.5)+3.5172451
 Parameter: ZPOS <- "-42.0041313"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.0041313" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.5089393"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.5089393-0
 Parameter: XTRAN <- "-31.5089393"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "43.4748986"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 43.4748986-0
 Parameter: YTRAN <- "43.4748986"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.0041313"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.0041313-0
 Parameter: ZTRAN <- "-42.0041313"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.5089393"
 Parameter: YTRAN -> "43.4748986"
 Parameter: ZTRAN -> "-42.0041313"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -31.508939   43.474899  -42.004131
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.774470581"
Evaluating: 0.774470581*360.0
 Parameter: XPHI <- "278.809409"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.719233056"
Evaluating: 0.719233056*360.0
 Parameter: YPHI <- "258.9239"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.456850151"
Evaluating: 0.456850151*360.0
 Parameter: ZPHI <- "164.466054"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.5089393"
 Parameter: YPOS -> "43.4748986"
 Parameter: ZPOS -> "-42.0041313"
 Parameter: XPHI -> "278.809409"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.153148   -0.988203
    0.000000    0.988203    0.153148

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   81.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.5089393"
 Parameter: YPOS -> "43.4748986"
 Parameter: ZPOS -> "-42.0041313"
 Parameter: YPHI -> "258.9239"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.192113    0.000000    0.981373
    0.000000    1.000000    0.000000
   -0.981373    0.000000   -0.192113

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  101.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.5089393"
 Parameter: YPOS -> "43.4748986"
 Parameter: ZPOS -> "-42.0041313"
 Parameter: ZPHI -> "164.466054"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.963472    0.267809    0.000000
   -0.267809   -0.963472    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  164.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.508939 XMAX =  -31.508939 XAVE =  -31.508939
    YMIN =   43.474899 YMAX =   43.474899 YAVE =   43.474899
    ZMIN =  -42.004131 ZMAX =  -42.004131 ZAVE =  -42.004131
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.5089393"
Evaluating: -31.5089393+3.5
 Parameter: XMAX <- "-28.0089393"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "43.4748986"
Evaluating: 43.4748986+3.5
 Parameter: YMAX <- "46.9748986"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.0041313"
Evaluating: -42.0041313+3.5
 Parameter: ZMAX <- "-38.5041313"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.5089393"
Evaluating: -31.5089393-3.5
 Parameter: XMIN <- "-35.0089393"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "43.4748986"
Evaluating: 43.4748986-3.5
 Parameter: YMIN <- "39.9748986"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.0041313"
Evaluating: -42.0041313-3.5
 Parameter: ZMIN <- "-45.5041313"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.0089393"
 Parameter: XMIN -> "-35.0089393"
 Parameter: YMAX -> "46.9748986"
 Parameter: YMIN -> "39.9748986"
 Parameter: ZMAX -> "-38.5041313"
 Parameter: ZMIN -> "-45.5041313"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "70"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "70" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "70" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "70"
 Parameter: NPOS -> "65"
Evaluating: 70-65
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.771537078E-02"
Evaluating: 90.067469*(8.771537078E-02-0.5)
 Parameter: XPOS <- "-37.1334331"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.924578985"
Evaluating: 90.067469*(0.924578985-0.5)
 Parameter: YPOS <- "38.2407546"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.630999131"
Evaluating: 143.194738*(0.630999131-0.5)+3.5172451
 Parameter: ZPOS <- "22.2756313"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.2756313" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.2756313" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.1334331"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -37.1334331-0
 Parameter: XTRAN <- "-37.1334331"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.2407546"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 38.2407546-0
 Parameter: YTRAN <- "38.2407546"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.2756313"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.2756313-0
 Parameter: ZTRAN <- "22.2756313"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.1334331"
 Parameter: YTRAN -> "38.2407546"
 Parameter: ZTRAN -> "22.2756313"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -37.133433   38.240755   22.275631
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.723529613"
Evaluating: 0.723529613*360.0
 Parameter: XPHI <- "260.470661"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.420201904E-02"
Evaluating: 1.420201904E-02*360.0
 Parameter: YPHI <- "5.11272685"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.47010111"
Evaluating: 0.47010111*360.0
 Parameter: ZPHI <- "169.2364"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.1334331"
 Parameter: YPOS -> "38.2407546"
 Parameter: ZPOS -> "22.2756313"
 Parameter: XPHI -> "260.470661"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.165553   -0.986201
    0.000000    0.986201   -0.165553

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   99.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.1334331"
 Parameter: YPOS -> "38.2407546"
 Parameter: ZPOS -> "22.2756313"
 Parameter: YPHI -> "5.11272685"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.996021    0.000000   -0.089116
    0.000000    1.000000    0.000000
    0.089116    0.000000    0.996021

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    5.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.1334331"
 Parameter: YPOS -> "38.2407546"
 Parameter: ZPOS -> "22.2756313"
 Parameter: ZPHI -> "169.2364"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.982406    0.186757    0.000000
   -0.186757   -0.982406    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  169.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.133433 XMAX =  -37.133433 XAVE =  -37.133433
    YMIN =   38.240755 YMAX =   38.240755 YAVE =   38.240755
    ZMIN =   22.275631 ZMAX =   22.275631 ZAVE =   22.275631
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.1334331"
Evaluating: -37.1334331+3.5
 Parameter: XMAX <- "-33.6334331"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.2407546"
Evaluating: 38.2407546+3.5
 Parameter: YMAX <- "41.7407546"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.2756313"
Evaluating: 22.2756313+3.5
 Parameter: ZMAX <- "25.7756313"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.1334331"
Evaluating: -37.1334331-3.5
 Parameter: XMIN <- "-40.6334331"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.2407546"
Evaluating: 38.2407546-3.5
 Parameter: YMIN <- "34.7407546"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.2756313"
Evaluating: 22.2756313-3.5
 Parameter: ZMIN <- "18.7756313"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.6334331"
 Parameter: XMIN -> "-40.6334331"
 Parameter: YMAX -> "41.7407546"
 Parameter: YMIN -> "34.7407546"
 Parameter: ZMAX -> "25.7756313"
 Parameter: ZMIN -> "18.7756313"
 SELRPN>      9 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      5 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35031 NEG      CLA      5        CLA     -**** MEMB     POPC     91       C14           3.6425
35031 NEG      CLA      5        CLA     -**** MEMB     POPC     91       C11           3.4895
35031 NEG      CLA      5        CLA     -**** MEMB     POPC     91       P             3.5278
35031 NEG      CLA      5        CLA     -**** MEMB     POPC     91       O14           2.4169
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "70" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "70"
 Parameter: NPOS -> "65"
Evaluating: 70-65
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.91306042"
Evaluating: 90.067469*(0.91306042-0.5)
 Parameter: XPOS <- "37.2033066"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.97836077"
Evaluating: 90.067469*(0.97836077-0.5)
 Parameter: YPOS <- "43.0847438"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.991797588"
Evaluating: 143.194738*(0.991797588-0.5)+3.5172451
 Parameter: ZPOS <- "73.9400719"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "73.9400719" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "73.9400719" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.133433 XMAX =  -37.133433 XAVE =  -37.133433
    YMIN =   38.240755 YMAX =   38.240755 YAVE =   38.240755
    ZMIN =   22.275631 ZMAX =   22.275631 ZAVE =   22.275631
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.2033066"
 RDCMND substituted energy or value "?XAVE" to "-37.1334331"
Evaluating: 37.2033066--37.1334331
 Parameter: XTRAN <- "74.3367397"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "43.0847438"
 RDCMND substituted energy or value "?YAVE" to "38.2407546"
Evaluating: 43.0847438-38.2407546
 Parameter: YTRAN <- "4.8439892"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "73.9400719"
 RDCMND substituted energy or value "?ZAVE" to "22.2756313"
Evaluating: 73.9400719-22.2756313
 Parameter: ZTRAN <- "51.6644406"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "74.3367397"
 Parameter: YTRAN -> "4.8439892"
 Parameter: ZTRAN -> "51.6644406"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    74.336740    4.843989   51.664441
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.793861743"
Evaluating: 0.793861743*360.0
 Parameter: XPHI <- "285.790227"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.784894525"
Evaluating: 0.784894525*360.0
 Parameter: YPHI <- "282.562029"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.898801927"
Evaluating: 0.898801927*360.0
 Parameter: ZPHI <- "323.568694"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.2033066"
 Parameter: YPOS -> "43.0847438"
 Parameter: ZPOS -> "73.9400719"
 Parameter: XPHI -> "285.790227"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.272116   -0.962264
    0.000000    0.962264    0.272116

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   74.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.2033066"
 Parameter: YPOS -> "43.0847438"
 Parameter: ZPOS -> "73.9400719"
 Parameter: YPHI -> "282.562029"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.217496    0.000000    0.976061
    0.000000    1.000000    0.000000
   -0.976061    0.000000    0.217496

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   77.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.2033066"
 Parameter: YPOS -> "43.0847438"
 Parameter: ZPOS -> "73.9400719"
 Parameter: ZPHI -> "323.568694"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.804569   -0.593859    0.000000
    0.593859    0.804569    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   36.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.203307 XMAX =   37.203307 XAVE =   37.203307
    YMIN =   43.084744 YMAX =   43.084744 YAVE =   43.084744
    ZMIN =   73.940072 ZMAX =   73.940072 ZAVE =   73.940072
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.2033066"
Evaluating: 37.2033066+3.5
 Parameter: XMAX <- "40.7033066"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "43.0847438"
Evaluating: 43.0847438+3.5
 Parameter: YMAX <- "46.5847438"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "73.9400719"
Evaluating: 73.9400719+3.5
 Parameter: ZMAX <- "77.4400719"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.2033066"
Evaluating: 37.2033066-3.5
 Parameter: XMIN <- "33.7033066"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "43.0847438"
Evaluating: 43.0847438-3.5
 Parameter: YMIN <- "39.5847438"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "73.9400719"
Evaluating: 73.9400719-3.5
 Parameter: ZMIN <- "70.4400719"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.7033066"
 Parameter: XMIN -> "33.7033066"
 Parameter: YMAX -> "46.5847438"
 Parameter: YMIN -> "39.5847438"
 Parameter: ZMAX -> "77.4400719"
 Parameter: ZMIN -> "70.4400719"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "71"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "71" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "71" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "71"
 Parameter: NPOS -> "65"
Evaluating: 71-65
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.662060378"
Evaluating: 90.067469*(0.662060378-0.5)
 Parameter: XPOS <- "14.5963681"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "5.508026559E-02"
Evaluating: 90.067469*(5.508026559E-02-0.5)
 Parameter: YPOS <- "-40.0727944"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.721625357"
Evaluating: 143.194738*(0.721625357-0.5)+3.5172451
 Parameter: ZPOS <- "35.25283"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "35.25283" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "35.25283" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.5963681"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 14.5963681-0
 Parameter: XTRAN <- "14.5963681"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.0727944"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.0727944-0
 Parameter: YTRAN <- "-40.0727944"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.25283"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 35.25283-0
 Parameter: ZTRAN <- "35.25283"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.5963681"
 Parameter: YTRAN -> "-40.0727944"
 Parameter: ZTRAN -> "35.25283"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    14.596368  -40.072794   35.252830
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.556453785"
Evaluating: 0.556453785*360.0
 Parameter: XPHI <- "200.323363"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.198812512"
Evaluating: 0.198812512*360.0
 Parameter: YPHI <- "71.5725043"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.669367634E-02"
Evaluating: 8.669367634E-02*360.0
 Parameter: ZPHI <- "31.2097235"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.5963681"
 Parameter: YPOS -> "-40.0727944"
 Parameter: ZPOS -> "35.25283"
 Parameter: XPHI -> "200.323363"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.937747   -0.347318
    0.000000    0.347318   -0.937747

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  159.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.5963681"
 Parameter: YPOS -> "-40.0727944"
 Parameter: ZPOS -> "35.25283"
 Parameter: YPHI -> "71.5725043"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.316104    0.000000   -0.948724
    0.000000    1.000000    0.000000
    0.948724    0.000000    0.316104

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   71.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.5963681"
 Parameter: YPOS -> "-40.0727944"
 Parameter: ZPOS -> "35.25283"
 Parameter: ZPHI -> "31.2097235"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.855276    0.518172    0.000000
   -0.518172    0.855276    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   31.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.596368 XMAX =   14.596368 XAVE =   14.596368
    YMIN =  -40.072794 YMAX =  -40.072794 YAVE =  -40.072794
    ZMIN =   35.252830 ZMAX =   35.252830 ZAVE =   35.252830
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.5963681"
Evaluating: 14.5963681+3.5
 Parameter: XMAX <- "18.0963681"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.0727944"
Evaluating: -40.0727944+3.5
 Parameter: YMAX <- "-36.5727944"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.25283"
Evaluating: 35.25283+3.5
 Parameter: ZMAX <- "38.75283"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.5963681"
Evaluating: 14.5963681-3.5
 Parameter: XMIN <- "11.0963681"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.0727944"
Evaluating: -40.0727944-3.5
 Parameter: YMIN <- "-43.5727944"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.25283"
Evaluating: 35.25283-3.5
 Parameter: ZMIN <- "31.75283"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.0963681"
 Parameter: XMIN -> "11.0963681"
 Parameter: YMAX -> "-36.5727944"
 Parameter: YMIN -> "-43.5727944"
 Parameter: ZMAX -> "38.75283"
 Parameter: ZMIN -> "31.75283"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "72"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "72" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "72" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "72"
 Parameter: NPOS -> "65"
Evaluating: 72-65
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.419294933"
Evaluating: 90.067469*(0.419294933-0.5)
 Parameter: XPOS <- "-7.26890112"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.602878225"
Evaluating: 90.067469*(0.602878225-0.5)
 Parameter: YPOS <- "9.26598134"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.973939664"
Evaluating: 143.194738*(0.973939664-0.5)+3.5172451
 Parameter: ZPOS <- "71.3829111"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "71.3829111" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "71.3829111" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.26890112"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.26890112-0
 Parameter: XTRAN <- "-7.26890112"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.26598134"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.26598134-0
 Parameter: YTRAN <- "9.26598134"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "71.3829111"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 71.3829111-0
 Parameter: ZTRAN <- "71.3829111"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.26890112"
 Parameter: YTRAN -> "9.26598134"
 Parameter: ZTRAN -> "71.3829111"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -7.268901    9.265981   71.382911
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.122278387"
Evaluating: 0.122278387*360.0
 Parameter: XPHI <- "44.0202193"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.61499585E-02"
Evaluating: 8.61499585E-02*360.0
 Parameter: YPHI <- "31.0139851"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.513262171"
Evaluating: 0.513262171*360.0
 Parameter: ZPHI <- "184.774382"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.26890112"
 Parameter: YPOS -> "9.26598134"
 Parameter: ZPOS -> "71.3829111"
 Parameter: XPHI -> "44.0202193"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.719095    0.694912
    0.000000   -0.694912    0.719095

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   44.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.26890112"
 Parameter: YPOS -> "9.26598134"
 Parameter: ZPOS -> "71.3829111"
 Parameter: YPHI -> "31.0139851"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.857042    0.000000   -0.515247
    0.000000    1.000000    0.000000
    0.515247    0.000000    0.857042

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   31.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.26890112"
 Parameter: YPOS -> "9.26598134"
 Parameter: ZPOS -> "71.3829111"
 Parameter: ZPHI -> "184.774382"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.996530   -0.083232    0.000000
    0.083232   -0.996530    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  175.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.268901 XMAX =   -7.268901 XAVE =   -7.268901
    YMIN =    9.265981 YMAX =    9.265981 YAVE =    9.265981
    ZMIN =   71.382911 ZMAX =   71.382911 ZAVE =   71.382911
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.26890112"
Evaluating: -7.26890112+3.5
 Parameter: XMAX <- "-3.76890112"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.26598134"
Evaluating: 9.26598134+3.5
 Parameter: YMAX <- "12.7659813"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "71.3829111"
Evaluating: 71.3829111+3.5
 Parameter: ZMAX <- "74.8829111"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.26890112"
Evaluating: -7.26890112-3.5
 Parameter: XMIN <- "-10.7689011"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.26598134"
Evaluating: 9.26598134-3.5
 Parameter: YMIN <- "5.76598134"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "71.3829111"
Evaluating: 71.3829111-3.5
 Parameter: ZMIN <- "67.8829111"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.76890112"
 Parameter: XMIN -> "-10.7689011"
 Parameter: YMAX -> "12.7659813"
 Parameter: YMIN -> "5.76598134"
 Parameter: ZMAX -> "74.8829111"
 Parameter: ZMIN -> "67.8829111"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "73"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "73" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "73"
Evaluating: 73
 Parameter: J <- "73"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "73" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "73"
 Parameter: NPOS -> "65"
Evaluating: 73-65
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.96086731"
Evaluating: 90.067469*(0.96086731-0.5)
 Parameter: XPOS <- "41.5091522"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.84852329"
Evaluating: 90.067469*(0.84852329-0.5)
 Parameter: YPOS <- "31.3906106"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.839378893"
Evaluating: 143.194738*(0.839378893-0.5)+3.5172451
 Parameter: ZPOS <- "52.1145168"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "52.1145168" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "52.1145168" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "41.5091522"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 41.5091522-0
 Parameter: XTRAN <- "41.5091522"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.3906106"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 31.3906106-0
 Parameter: YTRAN <- "31.3906106"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "52.1145168"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 52.1145168-0
 Parameter: ZTRAN <- "52.1145168"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "41.5091522"
 Parameter: YTRAN -> "31.3906106"
 Parameter: ZTRAN -> "52.1145168"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    41.509152   31.390611   52.114517
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.416331739"
Evaluating: 0.416331739*360.0
 Parameter: XPHI <- "149.879426"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.70081971"
Evaluating: 0.70081971*360.0
 Parameter: YPHI <- "252.295096"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.107415672"
Evaluating: 0.107415672*360.0
 Parameter: ZPHI <- "38.6696419"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "41.5091522"
 Parameter: YPOS -> "31.3906106"
 Parameter: ZPOS -> "52.1145168"
 Parameter: XPHI -> "149.879426"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.864971    0.501821
    0.000000   -0.501821   -0.864971

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  149.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "41.5091522"
 Parameter: YPOS -> "31.3906106"
 Parameter: ZPOS -> "52.1145168"
 Parameter: YPHI -> "252.295096"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.304115    0.000000    0.952635
    0.000000    1.000000    0.000000
   -0.952635    0.000000   -0.304115

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  107.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "41.5091522"
 Parameter: YPOS -> "31.3906106"
 Parameter: ZPOS -> "52.1145168"
 Parameter: ZPHI -> "38.6696419"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.780762    0.624829    0.000000
   -0.624829    0.780762    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   38.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   41.509152 XMAX =   41.509152 XAVE =   41.509152
    YMIN =   31.390611 YMAX =   31.390611 YAVE =   31.390611
    ZMIN =   52.114517 ZMAX =   52.114517 ZAVE =   52.114517
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "41.5091522"
Evaluating: 41.5091522+3.5
 Parameter: XMAX <- "45.0091522"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.3906106"
Evaluating: 31.3906106+3.5
 Parameter: YMAX <- "34.8906106"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "52.1145168"
Evaluating: 52.1145168+3.5
 Parameter: ZMAX <- "55.6145168"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "41.5091522"
Evaluating: 41.5091522-3.5
 Parameter: XMIN <- "38.0091522"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.3906106"
Evaluating: 31.3906106-3.5
 Parameter: YMIN <- "27.8906106"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "52.1145168"
Evaluating: 52.1145168-3.5
 Parameter: ZMIN <- "48.6145168"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "45.0091522"
 Parameter: XMIN -> "38.0091522"
 Parameter: YMAX -> "34.8906106"
 Parameter: YMIN -> "27.8906106"
 Parameter: ZMAX -> "55.6145168"
 Parameter: ZMIN -> "48.6145168"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "74"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "74" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "74" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "74"
 Parameter: NPOS -> "65"
Evaluating: 74-65
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.496252961"
Evaluating: 90.067469*(0.496252961-0.5)
 Parameter: XPOS <- "-0.337486319"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.896607379"
Evaluating: 90.067469*(0.896607379-0.5)
 Parameter: YPOS <- "35.7214228"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.647022716"
Evaluating: 143.194738*(0.647022716-0.5)+3.5172451
 Parameter: ZPOS <- "24.5701244"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.5701244" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.5701244" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.337486319"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -0.337486319-0
 Parameter: XTRAN <- "-0.337486319"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.7214228"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.7214228-0
 Parameter: YTRAN <- "35.7214228"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.5701244"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.5701244-0
 Parameter: ZTRAN <- "24.5701244"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.337486319"
 Parameter: YTRAN -> "35.7214228"
 Parameter: ZTRAN -> "24.5701244"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -0.337486   35.721423   24.570124
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487594086"
Evaluating: 0.487594086*360.0
 Parameter: XPHI <- "175.533871"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.205944868E-02"
Evaluating: 2.205944868E-02*360.0
 Parameter: YPHI <- "7.94140152"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.774761425"
Evaluating: 0.774761425*360.0
 Parameter: ZPHI <- "278.914113"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.337486319"
 Parameter: YPOS -> "35.7214228"
 Parameter: ZPOS -> "24.5701244"
 Parameter: XPHI -> "175.533871"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.996964    0.077870
    0.000000   -0.077870   -0.996964

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  175.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.337486319"
 Parameter: YPOS -> "35.7214228"
 Parameter: ZPOS -> "24.5701244"
 Parameter: YPHI -> "7.94140152"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.990410    0.000000   -0.138160
    0.000000    1.000000    0.000000
    0.138160    0.000000    0.990410

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    7.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.337486319"
 Parameter: YPOS -> "35.7214228"
 Parameter: ZPOS -> "24.5701244"
 Parameter: ZPHI -> "278.914113"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.154954   -0.987922    0.000000
    0.987922    0.154954    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   81.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.337486 XMAX =   -0.337486 XAVE =   -0.337486
    YMIN =   35.721423 YMAX =   35.721423 YAVE =   35.721423
    ZMIN =   24.570124 ZMAX =   24.570124 ZAVE =   24.570124
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.337486319"
Evaluating: -0.337486319+3.5
 Parameter: XMAX <- "3.16251368"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.7214228"
Evaluating: 35.7214228+3.5
 Parameter: YMAX <- "39.2214228"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.5701244"
Evaluating: 24.5701244+3.5
 Parameter: ZMAX <- "28.0701244"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.337486319"
Evaluating: -0.337486319-3.5
 Parameter: XMIN <- "-3.83748632"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.7214228"
Evaluating: 35.7214228-3.5
 Parameter: YMIN <- "32.2214228"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.5701244"
Evaluating: 24.5701244-3.5
 Parameter: ZMIN <- "21.0701244"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.16251368"
 Parameter: XMIN -> "-3.83748632"
 Parameter: YMAX -> "39.2214228"
 Parameter: YMIN -> "32.2214228"
 Parameter: ZMAX -> "28.0701244"
 Parameter: ZMIN -> "21.0701244"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "75"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "75" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "75" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "75"
 Parameter: NPOS -> "65"
Evaluating: 75-65
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "5.383980664E-02"
Evaluating: 90.067469*(5.383980664E-02-0.5)
 Parameter: XPOS <- "-40.1845194"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.859336634"
Evaluating: 90.067469*(0.859336634-0.5)
 Parameter: YPOS <- "32.3645411"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.98117584"
Evaluating: 143.194738*(0.98117584-0.5)+3.5172451
 Parameter: ZPOS <- "72.4190934"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "72.4190934" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "72.4190934" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-40.1845194"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -40.1845194-0
 Parameter: XTRAN <- "-40.1845194"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.3645411"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.3645411-0
 Parameter: YTRAN <- "32.3645411"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "72.4190934"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 72.4190934-0
 Parameter: ZTRAN <- "72.4190934"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.1845194"
 Parameter: YTRAN -> "32.3645411"
 Parameter: ZTRAN -> "72.4190934"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -40.184519   32.364541   72.419093
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.784167242"
Evaluating: 0.784167242*360.0
 Parameter: XPHI <- "282.300207"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.653968474"
Evaluating: 0.653968474*360.0
 Parameter: YPHI <- "235.428651"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.869317938"
Evaluating: 0.869317938*360.0
 Parameter: ZPHI <- "312.954458"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-40.1845194"
 Parameter: YPOS -> "32.3645411"
 Parameter: ZPOS -> "72.4190934"
 Parameter: XPHI -> "282.300207"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.213034   -0.977045
    0.000000    0.977045    0.213034

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   77.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-40.1845194"
 Parameter: YPOS -> "32.3645411"
 Parameter: ZPOS -> "72.4190934"
 Parameter: YPHI -> "235.428651"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.567432    0.000000    0.823420
    0.000000    1.000000    0.000000
   -0.823420    0.000000   -0.567432

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  124.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-40.1845194"
 Parameter: YPOS -> "32.3645411"
 Parameter: ZPOS -> "72.4190934"
 Parameter: ZPHI -> "312.954458"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.681417   -0.731896    0.000000
    0.731896    0.681417    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -40.184519 XMAX =  -40.184519 XAVE =  -40.184519
    YMIN =   32.364541 YMAX =   32.364541 YAVE =   32.364541
    ZMIN =   72.419093 ZMAX =   72.419093 ZAVE =   72.419093
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-40.1845194"
Evaluating: -40.1845194+3.5
 Parameter: XMAX <- "-36.6845194"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.3645411"
Evaluating: 32.3645411+3.5
 Parameter: YMAX <- "35.8645411"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "72.4190934"
Evaluating: 72.4190934+3.5
 Parameter: ZMAX <- "75.9190934"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-40.1845194"
Evaluating: -40.1845194-3.5
 Parameter: XMIN <- "-43.6845194"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.3645411"
Evaluating: 32.3645411-3.5
 Parameter: YMIN <- "28.8645411"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "72.4190934"
Evaluating: 72.4190934-3.5
 Parameter: ZMIN <- "68.9190934"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.6845194"
 Parameter: XMIN -> "-43.6845194"
 Parameter: YMAX -> "35.8645411"
 Parameter: YMIN -> "28.8645411"
 Parameter: ZMAX -> "75.9190934"
 Parameter: ZMIN -> "68.9190934"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "76"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "76" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "76" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "76"
 Parameter: NPOS -> "65"
Evaluating: 76-65
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.533966029"
Evaluating: 90.067469*(0.533966029-0.5)
 Parameter: XPOS <- "3.05923426"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.429118799"
Evaluating: 90.067469*(0.429118799-0.5)
 Parameter: YPOS <- "-6.38409037"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.120708508"
Evaluating: 143.194738*(0.120708508-0.5)+3.5172451
 Parameter: ZPOS <- "-50.7953007"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-50.7953007" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.05923426"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 3.05923426-0
 Parameter: XTRAN <- "3.05923426"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.38409037"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -6.38409037-0
 Parameter: YTRAN <- "-6.38409037"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-50.7953007"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -50.7953007-0
 Parameter: ZTRAN <- "-50.7953007"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "3.05923426"
 Parameter: YTRAN -> "-6.38409037"
 Parameter: ZTRAN -> "-50.7953007"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     3.059234   -6.384090  -50.795301
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.244750615"
Evaluating: 0.244750615*360.0
 Parameter: XPHI <- "88.1102214"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.394696854"
Evaluating: 0.394696854*360.0
 Parameter: YPHI <- "142.090867"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.520165477"
Evaluating: 0.520165477*360.0
 Parameter: ZPHI <- "187.259572"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.05923426"
 Parameter: YPOS -> "-6.38409037"
 Parameter: ZPOS -> "-50.7953007"
 Parameter: XPHI -> "88.1102214"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.032977    0.999456
    0.000000   -0.999456    0.032977

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   88.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.05923426"
 Parameter: YPOS -> "-6.38409037"
 Parameter: ZPOS -> "-50.7953007"
 Parameter: YPHI -> "142.090867"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.788986    0.000000   -0.614411
    0.000000    1.000000    0.000000
    0.614411    0.000000   -0.788986

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.05923426"
 Parameter: YPOS -> "-6.38409037"
 Parameter: ZPOS -> "-50.7953007"
 Parameter: ZPHI -> "187.259572"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.991984   -0.126365    0.000000
    0.126365   -0.991984    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  172.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.059234 XMAX =    3.059234 XAVE =    3.059234
    YMIN =   -6.384090 YMAX =   -6.384090 YAVE =   -6.384090
    ZMIN =  -50.795301 ZMAX =  -50.795301 ZAVE =  -50.795301
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.05923426"
Evaluating: 3.05923426+3.5
 Parameter: XMAX <- "6.55923426"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.38409037"
Evaluating: -6.38409037+3.5
 Parameter: YMAX <- "-2.88409037"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-50.7953007"
Evaluating: -50.7953007+3.5
 Parameter: ZMAX <- "-47.2953007"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.05923426"
Evaluating: 3.05923426-3.5
 Parameter: XMIN <- "-0.44076574"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.38409037"
Evaluating: -6.38409037-3.5
 Parameter: YMIN <- "-9.88409037"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-50.7953007"
Evaluating: -50.7953007-3.5
 Parameter: ZMIN <- "-54.2953007"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.55923426"
 Parameter: XMIN -> "-0.44076574"
 Parameter: YMAX -> "-2.88409037"
 Parameter: YMIN -> "-9.88409037"
 Parameter: ZMAX -> "-47.2953007"
 Parameter: ZMIN -> "-54.2953007"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "77"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "77" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "77" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "77"
 Parameter: NPOS -> "65"
Evaluating: 77-65
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.365538955"
Evaluating: 90.067469*(0.365538955-0.5)
 Parameter: XPOS <- "-12.110566"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.191491073"
Evaluating: 90.067469*(0.191491073-0.5)
 Parameter: YPOS <- "-27.7866182"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.849641071"
Evaluating: 143.194738*(0.849641071-0.5)+3.5172451
 Parameter: ZPOS <- "53.5840067"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "53.5840067" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "53.5840067" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.110566"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.110566-0
 Parameter: XTRAN <- "-12.110566"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.7866182"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -27.7866182-0
 Parameter: YTRAN <- "-27.7866182"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "53.5840067"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 53.5840067-0
 Parameter: ZTRAN <- "53.5840067"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.110566"
 Parameter: YTRAN -> "-27.7866182"
 Parameter: ZTRAN -> "53.5840067"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -12.110566  -27.786618   53.584007
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.725118413"
Evaluating: 0.725118413*360.0
 Parameter: XPHI <- "261.042629"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.714992032"
Evaluating: 0.714992032*360.0
 Parameter: YPHI <- "257.397132"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.376081704"
Evaluating: 0.376081704*360.0
 Parameter: ZPHI <- "135.389413"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.110566"
 Parameter: YPOS -> "-27.7866182"
 Parameter: ZPOS -> "53.5840067"
 Parameter: XPHI -> "261.042629"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.155700   -0.987804
    0.000000    0.987804   -0.155700

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   98.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.110566"
 Parameter: YPOS -> "-27.7866182"
 Parameter: ZPOS -> "53.5840067"
 Parameter: YPHI -> "257.397132"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.218192    0.000000    0.975906
    0.000000    1.000000    0.000000
   -0.975906    0.000000   -0.218192

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  102.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.110566"
 Parameter: YPOS -> "-27.7866182"
 Parameter: ZPOS -> "53.5840067"
 Parameter: ZPHI -> "135.389413"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.711896    0.702285    0.000000
   -0.702285   -0.711896    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  135.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.110566 XMAX =  -12.110566 XAVE =  -12.110566
    YMIN =  -27.786618 YMAX =  -27.786618 YAVE =  -27.786618
    ZMIN =   53.584007 ZMAX =   53.584007 ZAVE =   53.584007
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.110566"
Evaluating: -12.110566+3.5
 Parameter: XMAX <- "-8.610566"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.7866182"
Evaluating: -27.7866182+3.5
 Parameter: YMAX <- "-24.2866182"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "53.5840067"
Evaluating: 53.5840067+3.5
 Parameter: ZMAX <- "57.0840067"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.110566"
Evaluating: -12.110566-3.5
 Parameter: XMIN <- "-15.610566"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.7866182"
Evaluating: -27.7866182-3.5
 Parameter: YMIN <- "-31.2866182"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "53.5840067"
Evaluating: 53.5840067-3.5
 Parameter: ZMIN <- "50.0840067"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.610566"
 Parameter: XMIN -> "-15.610566"
 Parameter: YMAX -> "-24.2866182"
 Parameter: YMIN -> "-31.2866182"
 Parameter: ZMAX -> "57.0840067"
 Parameter: ZMIN -> "50.0840067"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "78"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "78" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "78" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "78"
 Parameter: NPOS -> "65"
Evaluating: 78-65
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.500988481"
Evaluating: 90.067469*(0.500988481-0.5)
 Parameter: XPOS <- "8.902998182E-02"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.386932588"
Evaluating: 90.067469*(0.386932588-0.5)
 Parameter: YPOS <- "-10.1836956"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.921538622"
Evaluating: 143.194738*(0.921538622-0.5)+3.5172451
 Parameter: ZPOS <- "63.8793576"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "63.8793576" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "63.8793576" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.902998182E-02"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 8.902998182E-02-0
 Parameter: XTRAN <- "8.902998182E-02"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.1836956"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -10.1836956-0
 Parameter: YTRAN <- "-10.1836956"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "63.8793576"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 63.8793576-0
 Parameter: ZTRAN <- "63.8793576"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.902998182E-02"
 Parameter: YTRAN -> "-10.1836956"
 Parameter: ZTRAN -> "63.8793576"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     0.089030  -10.183696   63.879358
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.233790055"
Evaluating: 0.233790055*360.0
 Parameter: XPHI <- "84.1644198"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.278088656"
Evaluating: 0.278088656*360.0
 Parameter: YPHI <- "100.111916"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.794525365"
Evaluating: 0.794525365*360.0
 Parameter: ZPHI <- "286.029131"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.902998182E-02"
 Parameter: YPOS -> "-10.1836956"
 Parameter: ZPOS -> "63.8793576"
 Parameter: XPHI -> "84.1644198"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.101674    0.994818
    0.000000   -0.994818    0.101674

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   84.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.902998182E-02"
 Parameter: YPOS -> "-10.1836956"
 Parameter: ZPOS -> "63.8793576"
 Parameter: YPHI -> "100.111916"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.175571    0.000000   -0.984467
    0.000000    1.000000    0.000000
    0.984467    0.000000   -0.175571

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  100.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.902998182E-02"
 Parameter: YPOS -> "-10.1836956"
 Parameter: ZPOS -> "63.8793576"
 Parameter: ZPHI -> "286.029131"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.276126   -0.961121    0.000000
    0.961121    0.276126    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   73.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.089030 XMAX =    0.089030 XAVE =    0.089030
    YMIN =  -10.183696 YMAX =  -10.183696 YAVE =  -10.183696
    ZMIN =   63.879358 ZMAX =   63.879358 ZAVE =   63.879358
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.902998182E-02"
Evaluating: 8.902998182E-02+3.5
 Parameter: XMAX <- "3.58902998"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.1836956"
Evaluating: -10.1836956+3.5
 Parameter: YMAX <- "-6.6836956"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "63.8793576"
Evaluating: 63.8793576+3.5
 Parameter: ZMAX <- "67.3793576"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.902998182E-02"
Evaluating: 8.902998182E-02-3.5
 Parameter: XMIN <- "-3.41097002"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.1836956"
Evaluating: -10.1836956-3.5
 Parameter: YMIN <- "-13.6836956"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "63.8793576"
Evaluating: 63.8793576-3.5
 Parameter: ZMIN <- "60.3793576"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.58902998"
 Parameter: XMIN -> "-3.41097002"
 Parameter: YMAX -> "-6.6836956"
 Parameter: YMIN -> "-13.6836956"
 Parameter: ZMAX -> "67.3793576"
 Parameter: ZMIN -> "60.3793576"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "79"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "79" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "79" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "79"
 Parameter: NPOS -> "65"
Evaluating: 79-65
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.365698157"
Evaluating: 90.067469*(0.365698157-0.5)
 Parameter: XPOS <- "-12.0962271"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.557178414"
Evaluating: 90.067469*(0.557178414-0.5)
 Parameter: YPOS <- "5.14991503"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.869118227"
Evaluating: 143.194738*(0.869118227-0.5)+3.5172451
 Parameter: ZPOS <- "56.3730329"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "56.3730329" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "56.3730329" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.0962271"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -12.0962271-0
 Parameter: XTRAN <- "-12.0962271"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.14991503"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 5.14991503-0
 Parameter: YTRAN <- "5.14991503"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "56.3730329"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 56.3730329-0
 Parameter: ZTRAN <- "56.3730329"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.0962271"
 Parameter: YTRAN -> "5.14991503"
 Parameter: ZTRAN -> "56.3730329"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -12.096227    5.149915   56.373033
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.516943305"
Evaluating: 0.516943305*360.0
 Parameter: XPHI <- "186.09959"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.354962336"
Evaluating: 0.354962336*360.0
 Parameter: YPHI <- "127.786441"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.671411803"
Evaluating: 0.671411803*360.0
 Parameter: ZPHI <- "241.708249"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.0962271"
 Parameter: YPOS -> "5.14991503"
 Parameter: ZPOS -> "56.3730329"
 Parameter: XPHI -> "186.09959"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.994339   -0.106257
    0.000000    0.106257   -0.994339

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  173.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.0962271"
 Parameter: YPOS -> "5.14991503"
 Parameter: ZPOS -> "56.3730329"
 Parameter: YPHI -> "127.786441"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.612720    0.000000   -0.790300
    0.000000    1.000000    0.000000
    0.790300    0.000000   -0.612720

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  127.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.0962271"
 Parameter: YPOS -> "5.14991503"
 Parameter: ZPOS -> "56.3730329"
 Parameter: ZPHI -> "241.708249"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.473961   -0.880546    0.000000
    0.880546   -0.473961    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  118.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.096227 XMAX =  -12.096227 XAVE =  -12.096227
    YMIN =    5.149915 YMAX =    5.149915 YAVE =    5.149915
    ZMIN =   56.373033 ZMAX =   56.373033 ZAVE =   56.373033
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.0962271"
Evaluating: -12.0962271+3.5
 Parameter: XMAX <- "-8.5962271"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.14991503"
Evaluating: 5.14991503+3.5
 Parameter: YMAX <- "8.64991503"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "56.3730329"
Evaluating: 56.3730329+3.5
 Parameter: ZMAX <- "59.8730329"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.0962271"
Evaluating: -12.0962271-3.5
 Parameter: XMIN <- "-15.5962271"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.14991503"
Evaluating: 5.14991503-3.5
 Parameter: YMIN <- "1.64991503"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "56.3730329"
Evaluating: 56.3730329-3.5
 Parameter: ZMIN <- "52.8730329"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.5962271"
 Parameter: XMIN -> "-15.5962271"
 Parameter: YMAX -> "8.64991503"
 Parameter: YMIN -> "1.64991503"
 Parameter: ZMAX -> "59.8730329"
 Parameter: ZMIN -> "52.8730329"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "80"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "80" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "80" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "80"
 Parameter: NPOS -> "65"
Evaluating: 80-65
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.814719822"
Evaluating: 90.067469*(0.814719822-0.5)
 Parameter: XPOS <- "28.3460178"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.869399443"
Evaluating: 90.067469*(0.869399443-0.5)
 Parameter: YPOS <- "33.2708729"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.44039616"
Evaluating: 143.194738*(0.44039616-0.5)+3.5172451
 Parameter: ZPOS <- "-5.01771115"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.01771115" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.01771115" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "80" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "80"
 Parameter: NPOS -> "65"
Evaluating: 80-65
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.613482966"
Evaluating: 90.067469*(0.613482966-0.5)
 Parameter: XPOS <- "10.2211235"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.317019828"
Evaluating: 90.067469*(0.317019828-0.5)
 Parameter: YPOS <- "-16.480561"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.776766029"
Evaluating: 143.194738*(0.776766029-0.5)+3.5172451
 Parameter: ZPOS <- "43.1486841"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "43.1486841" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "43.1486841" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.2211235"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.2211235-0
 Parameter: XTRAN <- "10.2211235"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.480561"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -16.480561-0
 Parameter: YTRAN <- "-16.480561"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "43.1486841"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 43.1486841-0
 Parameter: ZTRAN <- "43.1486841"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.2211235"
 Parameter: YTRAN -> "-16.480561"
 Parameter: ZTRAN -> "43.1486841"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    10.221123  -16.480561   43.148684
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.415626465"
Evaluating: 0.415626465*360.0
 Parameter: XPHI <- "149.625527"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499014375"
Evaluating: 0.499014375*360.0
 Parameter: YPHI <- "179.645175"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.129573407"
Evaluating: 0.129573407*360.0
 Parameter: ZPHI <- "46.6464265"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.2211235"
 Parameter: YPOS -> "-16.480561"
 Parameter: ZPOS -> "43.1486841"
 Parameter: XPHI -> "149.625527"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.862739    0.505649
    0.000000   -0.505649   -0.862739

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  149.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.2211235"
 Parameter: YPOS -> "-16.480561"
 Parameter: ZPOS -> "43.1486841"
 Parameter: YPHI -> "179.645175"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.999981    0.000000   -0.006193
    0.000000    1.000000    0.000000
    0.006193    0.000000   -0.999981

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  179.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.2211235"
 Parameter: YPOS -> "-16.480561"
 Parameter: ZPOS -> "43.1486841"
 Parameter: ZPHI -> "46.6464265"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.686499    0.727131    0.000000
   -0.727131    0.686499    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   46.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.221123 XMAX =   10.221123 XAVE =   10.221123
    YMIN =  -16.480561 YMAX =  -16.480561 YAVE =  -16.480561
    ZMIN =   43.148684 ZMAX =   43.148684 ZAVE =   43.148684
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.2211235"
Evaluating: 10.2211235+3.5
 Parameter: XMAX <- "13.7211235"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.480561"
Evaluating: -16.480561+3.5
 Parameter: YMAX <- "-12.980561"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "43.1486841"
Evaluating: 43.1486841+3.5
 Parameter: ZMAX <- "46.6486841"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.2211235"
Evaluating: 10.2211235-3.5
 Parameter: XMIN <- "6.7211235"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.480561"
Evaluating: -16.480561-3.5
 Parameter: YMIN <- "-19.980561"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "43.1486841"
Evaluating: 43.1486841-3.5
 Parameter: ZMIN <- "39.6486841"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.7211235"
 Parameter: XMIN -> "6.7211235"
 Parameter: YMAX -> "-12.980561"
 Parameter: YMIN -> "-19.980561"
 Parameter: ZMAX -> "46.6486841"
 Parameter: ZMIN -> "39.6486841"
 SELRPN>      4 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      1 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35041 NEG      CLA      15       CLA     -2335 PROA     TYR      171      O             4.1829
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "80" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "80"
 Parameter: NPOS -> "65"
Evaluating: 80-65
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.134470128"
Evaluating: 90.067469*(0.134470128-0.5)
 Parameter: XPOS <- "-32.9223504"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.936510259"
Evaluating: 90.067469*(0.936510259-0.5)
 Parameter: YPOS <- "39.3153742"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "7.332776315E-02"
Evaluating: 143.194738*(7.332776315E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-57.5799741"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.5799741" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.221123 XMAX =   10.221123 XAVE =   10.221123
    YMIN =  -16.480561 YMAX =  -16.480561 YAVE =  -16.480561
    ZMIN =   43.148684 ZMAX =   43.148684 ZAVE =   43.148684
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.9223504"
 RDCMND substituted energy or value "?XAVE" to "10.2211235"
Evaluating: -32.9223504-10.2211235
 Parameter: XTRAN <- "-43.1434739"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.3153742"
 RDCMND substituted energy or value "?YAVE" to "-16.480561"
Evaluating: 39.3153742--16.480561
 Parameter: YTRAN <- "55.7959352"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.5799741"
 RDCMND substituted energy or value "?ZAVE" to "43.1486841"
Evaluating: -57.5799741-43.1486841
 Parameter: ZTRAN <- "-100.728658"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.1434739"
 Parameter: YTRAN -> "55.7959352"
 Parameter: ZTRAN -> "-100.728658"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -43.143474   55.795935 -100.728658
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.552528232"
Evaluating: 0.552528232*360.0
 Parameter: XPHI <- "198.910164"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.99072965"
Evaluating: 0.99072965*360.0
 Parameter: YPHI <- "356.662674"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.960422866"
Evaluating: 0.960422866*360.0
 Parameter: ZPHI <- "345.752232"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.9223504"
 Parameter: YPOS -> "39.3153742"
 Parameter: ZPOS -> "-57.5799741"
 Parameter: XPHI -> "198.910164"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.946028   -0.324085
    0.000000    0.324085   -0.946028

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  161.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.9223504"
 Parameter: YPOS -> "39.3153742"
 Parameter: ZPOS -> "-57.5799741"
 Parameter: YPHI -> "356.662674"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.998304    0.000000    0.058214
    0.000000    1.000000    0.000000
   -0.058214    0.000000    0.998304

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    3.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.9223504"
 Parameter: YPOS -> "39.3153742"
 Parameter: ZPOS -> "-57.5799741"
 Parameter: ZPHI -> "345.752232"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.969240   -0.246116    0.000000
    0.246116    0.969240    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   14.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.922350 XMAX =  -32.922350 XAVE =  -32.922350
    YMIN =   39.315374 YMAX =   39.315374 YAVE =   39.315374
    ZMIN =  -57.579974 ZMAX =  -57.579974 ZAVE =  -57.579974
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.9223504"
Evaluating: -32.9223504+3.5
 Parameter: XMAX <- "-29.4223504"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.3153741"
Evaluating: 39.3153741+3.5
 Parameter: YMAX <- "42.8153741"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.5799743"
Evaluating: -57.5799743+3.5
 Parameter: ZMAX <- "-54.0799743"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.9223504"
Evaluating: -32.9223504-3.5
 Parameter: XMIN <- "-36.4223504"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.3153741"
Evaluating: 39.3153741-3.5
 Parameter: YMIN <- "35.8153741"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.5799743"
Evaluating: -57.5799743-3.5
 Parameter: ZMIN <- "-61.0799743"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.4223504"
 Parameter: XMIN -> "-36.4223504"
 Parameter: YMAX -> "42.8153741"
 Parameter: YMIN -> "35.8153741"
 Parameter: ZMAX -> "-54.0799743"
 Parameter: ZMIN -> "-61.0799743"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "81"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "81" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "81" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "65"
Evaluating: 81-65
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.219847833"
Evaluating: 90.067469*(0.219847833-0.5)
 Parameter: XPOS <- "-25.2325966"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.43383973"
Evaluating: 90.067469*(0.43383973-0.5)
 Parameter: YPOS <- "-5.95888807"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.250806172"
Evaluating: 143.194738*(0.250806172-0.5)+3.5172451
 Parameter: ZPOS <- "-32.1659998"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.1659998" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.2325966"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -25.2325966-0
 Parameter: XTRAN <- "-25.2325966"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.95888807"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.95888807-0
 Parameter: YTRAN <- "-5.95888807"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.1659998"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.1659998-0
 Parameter: ZTRAN <- "-32.1659998"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.2325966"
 Parameter: YTRAN -> "-5.95888807"
 Parameter: ZTRAN -> "-32.1659998"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -25.232597   -5.958888  -32.166000
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.410255184"
Evaluating: 0.410255184*360.0
 Parameter: XPHI <- "147.691866"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.891384595"
Evaluating: 0.891384595*360.0
 Parameter: YPHI <- "320.898454"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.153337485"
Evaluating: 0.153337485*360.0
 Parameter: ZPHI <- "55.2014946"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.2325966"
 Parameter: YPOS -> "-5.95888807"
 Parameter: ZPOS -> "-32.1659998"
 Parameter: XPHI -> "147.691866"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.845186    0.534472
    0.000000   -0.534472   -0.845186

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  147.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.2325966"
 Parameter: YPOS -> "-5.95888807"
 Parameter: ZPOS -> "-32.1659998"
 Parameter: YPHI -> "320.898454"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.776029    0.000000    0.630697
    0.000000    1.000000    0.000000
   -0.630697    0.000000    0.776029

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   39.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.2325966"
 Parameter: YPOS -> "-5.95888807"
 Parameter: ZPOS -> "-32.1659998"
 Parameter: ZPHI -> "55.2014946"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.570692    0.821164    0.000000
   -0.821164    0.570692    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   55.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.232597 XMAX =  -25.232597 XAVE =  -25.232597
    YMIN =   -5.958888 YMAX =   -5.958888 YAVE =   -5.958888
    ZMIN =  -32.166000 ZMAX =  -32.166000 ZAVE =  -32.166000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.2325966"
Evaluating: -25.2325966+3.5
 Parameter: XMAX <- "-21.7325966"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.95888807"
Evaluating: -5.95888807+3.5
 Parameter: YMAX <- "-2.45888807"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.1659998"
Evaluating: -32.1659998+3.5
 Parameter: ZMAX <- "-28.6659998"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.2325966"
Evaluating: -25.2325966-3.5
 Parameter: XMIN <- "-28.7325966"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.95888807"
Evaluating: -5.95888807-3.5
 Parameter: YMIN <- "-9.45888807"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.1659998"
Evaluating: -32.1659998-3.5
 Parameter: ZMIN <- "-35.6659998"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.7325966"
 Parameter: XMIN -> "-28.7325966"
 Parameter: YMAX -> "-2.45888807"
 Parameter: YMIN -> "-9.45888807"
 Parameter: ZMAX -> "-28.6659998"
 Parameter: ZMIN -> "-35.6659998"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "82"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "82" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "82" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "82"
 Parameter: NPOS -> "65"
Evaluating: 82-65
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.55087443"
Evaluating: 90.067469*(0.55087443-0.5)
 Parameter: XPOS <- "4.58213115"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "1.992542716E-02"
Evaluating: 90.067469*(1.992542716E-02-0.5)
 Parameter: YPOS <- "-43.2391017"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.304325769"
Evaluating: 143.194738*(0.304325769-0.5)+3.5172451
 Parameter: ZPOS <- "-24.5022751"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-24.5022751" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.58213115"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.58213115-0
 Parameter: XTRAN <- "4.58213115"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-43.2391017"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -43.2391017-0
 Parameter: YTRAN <- "-43.2391017"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.5022751"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -24.5022751-0
 Parameter: ZTRAN <- "-24.5022751"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.58213115"
 Parameter: YTRAN -> "-43.2391017"
 Parameter: ZTRAN -> "-24.5022751"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     4.582131  -43.239102  -24.502275
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.562944823"
Evaluating: 0.562944823*360.0
 Parameter: XPHI <- "202.660136"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882489767"
Evaluating: 0.882489767*360.0
 Parameter: YPHI <- "317.696316"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.605439863"
Evaluating: 0.605439863*360.0
 Parameter: ZPHI <- "217.958351"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.58213115"
 Parameter: YPOS -> "-43.2391017"
 Parameter: ZPOS -> "-24.5022751"
 Parameter: XPHI -> "202.660136"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.922806   -0.385264
    0.000000    0.385264   -0.922806

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  157.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.58213115"
 Parameter: YPOS -> "-43.2391017"
 Parameter: ZPOS -> "-24.5022751"
 Parameter: YPHI -> "317.696316"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.739588    0.000000    0.673060
    0.000000    1.000000    0.000000
   -0.673060    0.000000    0.739588

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   42.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.58213115"
 Parameter: YPOS -> "-43.2391017"
 Parameter: ZPOS -> "-24.5022751"
 Parameter: ZPHI -> "217.958351"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.788458   -0.615088    0.000000
    0.615088   -0.788458    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  142.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.582131 XMAX =    4.582131 XAVE =    4.582131
    YMIN =  -43.239102 YMAX =  -43.239102 YAVE =  -43.239102
    ZMIN =  -24.502275 ZMAX =  -24.502275 ZAVE =  -24.502275
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.58213115"
Evaluating: 4.58213115+3.5
 Parameter: XMAX <- "8.08213115"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-43.2391017"
Evaluating: -43.2391017+3.5
 Parameter: YMAX <- "-39.7391017"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.5022751"
Evaluating: -24.5022751+3.5
 Parameter: ZMAX <- "-21.0022751"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.58213115"
Evaluating: 4.58213115-3.5
 Parameter: XMIN <- "1.08213115"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-43.2391017"
Evaluating: -43.2391017-3.5
 Parameter: YMIN <- "-46.7391017"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.5022751"
Evaluating: -24.5022751-3.5
 Parameter: ZMIN <- "-28.0022751"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.08213115"
 Parameter: XMIN -> "1.08213115"
 Parameter: YMAX -> "-39.7391017"
 Parameter: YMIN -> "-46.7391017"
 Parameter: ZMAX -> "-21.0022751"
 Parameter: ZMIN -> "-28.0022751"
 SELRPN>      2 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "83"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "83" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "83" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "83"
 Parameter: NPOS -> "65"
Evaluating: 83-65
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.574267893"
Evaluating: 90.067469*(0.574267893-0.5)
 Parameter: XPOS <- "6.68912115"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "4.003567739E-02"
Evaluating: 90.067469*(4.003567739E-02-0.5)
 Parameter: YPOS <- "-41.4278224"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.263070784"
Evaluating: 143.194738*(0.263070784-0.5)+3.5172451
 Parameter: ZPOS <- "-30.4097719"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-30.4097719" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.68912115"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.68912115-0
 Parameter: XTRAN <- "6.68912115"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-41.4278224"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -41.4278224-0
 Parameter: YTRAN <- "-41.4278224"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.4097719"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -30.4097719-0
 Parameter: ZTRAN <- "-30.4097719"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.68912115"
 Parameter: YTRAN -> "-41.4278224"
 Parameter: ZTRAN -> "-30.4097719"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     6.689121  -41.427822  -30.409772
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.173227159"
Evaluating: 0.173227159*360.0
 Parameter: XPHI <- "62.3617772"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.466340294"
Evaluating: 0.466340294*360.0
 Parameter: YPHI <- "167.882506"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314780679"
Evaluating: 0.314780679*360.0
 Parameter: ZPHI <- "113.321044"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.68912115"
 Parameter: YPOS -> "-41.4278224"
 Parameter: ZPOS -> "-30.4097719"
 Parameter: XPHI -> "62.3617772"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.463887    0.885894
    0.000000   -0.885894    0.463887

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   62.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.68912115"
 Parameter: YPOS -> "-41.4278224"
 Parameter: ZPOS -> "-30.4097719"
 Parameter: YPHI -> "167.882506"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.977719    0.000000   -0.209917
    0.000000    1.000000    0.000000
    0.209917    0.000000   -0.977719

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  167.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.68912115"
 Parameter: YPOS -> "-41.4278224"
 Parameter: ZPOS -> "-30.4097719"
 Parameter: ZPHI -> "113.321044"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.395883    0.918301    0.000000
   -0.918301   -0.395883    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  113.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.689121 XMAX =    6.689121 XAVE =    6.689121
    YMIN =  -41.427822 YMAX =  -41.427822 YAVE =  -41.427822
    ZMIN =  -30.409772 ZMAX =  -30.409772 ZAVE =  -30.409772
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.68912115"
Evaluating: 6.68912115+3.5
 Parameter: XMAX <- "10.1891212"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-41.4278224"
Evaluating: -41.4278224+3.5
 Parameter: YMAX <- "-37.9278224"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.4097719"
Evaluating: -30.4097719+3.5
 Parameter: ZMAX <- "-26.9097719"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.68912115"
Evaluating: 6.68912115-3.5
 Parameter: XMIN <- "3.18912115"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-41.4278224"
Evaluating: -41.4278224-3.5
 Parameter: YMIN <- "-44.9278224"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.4097719"
Evaluating: -30.4097719-3.5
 Parameter: ZMIN <- "-33.9097719"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.1891212"
 Parameter: XMIN -> "3.18912115"
 Parameter: YMAX -> "-37.9278224"
 Parameter: YMIN -> "-44.9278224"
 Parameter: ZMAX -> "-26.9097719"
 Parameter: ZMIN -> "-33.9097719"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "84"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "84" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "84" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "84"
 Parameter: NPOS -> "65"
Evaluating: 84-65
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.847184614"
Evaluating: 90.067469*(0.847184614-0.5)
 Parameter: XPOS <- "31.2700395"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.15890562"
Evaluating: 90.067469*(0.15890562-0.5)
 Parameter: YPOS <- "-30.7215075"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.648410062"
Evaluating: 143.194738*(0.648410062-0.5)+3.5172451
 Parameter: ZPOS <- "24.768785"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "24.768785" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "24.768785" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.2700395"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 31.2700395-0
 Parameter: XTRAN <- "31.2700395"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.7215075"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -30.7215075-0
 Parameter: YTRAN <- "-30.7215075"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.768785"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 24.768785-0
 Parameter: ZTRAN <- "24.768785"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.2700395"
 Parameter: YTRAN -> "-30.7215075"
 Parameter: ZTRAN -> "24.768785"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    31.270039  -30.721508   24.768785
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.391592725E-02"
Evaluating: 6.391592725E-02*360.0
 Parameter: XPHI <- "23.0097338"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.70515696"
Evaluating: 0.70515696*360.0
 Parameter: YPHI <- "253.856506"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.73895085"
Evaluating: 0.73895085*360.0
 Parameter: ZPHI <- "266.022306"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.2700395"
 Parameter: YPOS -> "-30.7215075"
 Parameter: ZPOS -> "24.768785"
 Parameter: XPHI -> "23.0097338"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.920438    0.390888
    0.000000   -0.390888    0.920438

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   23.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.2700395"
 Parameter: YPOS -> "-30.7215075"
 Parameter: ZPOS -> "24.768785"
 Parameter: YPHI -> "253.856506"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.278044    0.000000    0.960568
    0.000000    1.000000    0.000000
   -0.960568    0.000000   -0.278044

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  106.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.2700395"
 Parameter: YPOS -> "-30.7215075"
 Parameter: ZPOS -> "24.768785"
 Parameter: ZPHI -> "266.022306"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.069368   -0.997591    0.000000
    0.997591   -0.069368    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   93.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.270039 XMAX =   31.270039 XAVE =   31.270039
    YMIN =  -30.721508 YMAX =  -30.721508 YAVE =  -30.721508
    ZMIN =   24.768785 ZMAX =   24.768785 ZAVE =   24.768785
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.2700395"
Evaluating: 31.2700395+3.5
 Parameter: XMAX <- "34.7700395"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.7215075"
Evaluating: -30.7215075+3.5
 Parameter: YMAX <- "-27.2215075"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.768785"
Evaluating: 24.768785+3.5
 Parameter: ZMAX <- "28.268785"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.2700395"
Evaluating: 31.2700395-3.5
 Parameter: XMIN <- "27.7700395"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.7215075"
Evaluating: -30.7215075-3.5
 Parameter: YMIN <- "-34.2215075"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.768785"
Evaluating: 24.768785-3.5
 Parameter: ZMIN <- "21.268785"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.7700395"
 Parameter: XMIN -> "27.7700395"
 Parameter: YMAX -> "-27.2215075"
 Parameter: YMIN -> "-34.2215075"
 Parameter: ZMAX -> "28.268785"
 Parameter: ZMIN -> "21.268785"
 SELRPN>      4 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      1 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35045 NEG      CLA      19       CLA     -**** MEMB     POPC     81       C14           3.7662
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "84" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "84"
 Parameter: NPOS -> "65"
Evaluating: 84-65
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.533216755"
Evaluating: 90.067469*(0.533216755-0.5)
 Parameter: XPOS <- "2.99174905"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.284235462"
Evaluating: 90.067469*(0.284235462-0.5)
 Parameter: YPOS <- "-19.4333658"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.328258373"
Evaluating: 143.194738*(0.328258373-0.5)+3.5172451
 Parameter: ZPOS <- "-21.0752522"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.0752522" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.270039 XMAX =   31.270039 XAVE =   31.270039
    YMIN =  -30.721508 YMAX =  -30.721508 YAVE =  -30.721508
    ZMIN =   24.768785 ZMAX =   24.768785 ZAVE =   24.768785
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.99174905"
 RDCMND substituted energy or value "?XAVE" to "31.2700395"
Evaluating: 2.99174905-31.2700395
 Parameter: XTRAN <- "-28.2782905"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.4333658"
 RDCMND substituted energy or value "?YAVE" to "-30.7215075"
Evaluating: -19.4333658--30.7215075
 Parameter: YTRAN <- "11.2881417"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.0752522"
 RDCMND substituted energy or value "?ZAVE" to "24.768785"
Evaluating: -21.0752522-24.768785
 Parameter: ZTRAN <- "-45.8440372"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.2782905"
 Parameter: YTRAN -> "11.2881417"
 Parameter: ZTRAN -> "-45.8440372"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -28.278291   11.288142  -45.844037
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.898385133"
Evaluating: 0.898385133*360.0
 Parameter: XPHI <- "323.418648"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.157698703"
Evaluating: 0.157698703*360.0
 Parameter: YPHI <- "56.7715331"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.536997327"
Evaluating: 0.536997327*360.0
 Parameter: ZPHI <- "193.319038"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.99174905"
 Parameter: YPOS -> "-19.4333658"
 Parameter: ZPOS -> "-21.0752522"
 Parameter: XPHI -> "323.418648"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.803011   -0.595964
    0.000000    0.595964    0.803011

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   36.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.99174905"
 Parameter: YPOS -> "-19.4333658"
 Parameter: ZPOS -> "-21.0752522"
 Parameter: YPHI -> "56.7715331"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.547979    0.000000   -0.836492
    0.000000    1.000000    0.000000
    0.836492    0.000000    0.547979

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   56.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.99174905"
 Parameter: YPOS -> "-19.4333658"
 Parameter: ZPOS -> "-21.0752522"
 Parameter: ZPHI -> "193.319038"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.973102   -0.230373    0.000000
    0.230373   -0.973102    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  166.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.991749 XMAX =    2.991749 XAVE =    2.991749
    YMIN =  -19.433366 YMAX =  -19.433366 YAVE =  -19.433366
    ZMIN =  -21.075252 ZMAX =  -21.075252 ZAVE =  -21.075252
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.99174908"
Evaluating: 2.99174908+3.5
 Parameter: XMAX <- "6.49174908"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.4333658"
Evaluating: -19.4333658+3.5
 Parameter: YMAX <- "-15.9333658"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.0752522"
Evaluating: -21.0752522+3.5
 Parameter: ZMAX <- "-17.5752522"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.99174908"
Evaluating: 2.99174908-3.5
 Parameter: XMIN <- "-0.50825092"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.4333658"
Evaluating: -19.4333658-3.5
 Parameter: YMIN <- "-22.9333658"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.0752522"
Evaluating: -21.0752522-3.5
 Parameter: ZMIN <- "-24.5752522"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.49174908"
 Parameter: XMIN -> "-0.50825092"
 Parameter: YMAX -> "-15.9333658"
 Parameter: YMIN -> "-22.9333658"
 Parameter: ZMAX -> "-17.5752522"
 Parameter: ZMIN -> "-24.5752522"
 SELRPN>     43 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     22 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35045 NEG      CLA      19       CLA     -5662 PROA     VAL      385      CB            4.5573
35045 NEG      CLA      19       CLA     -5668 PROA     VAL      385      CG2           3.6459
35045 NEG      CLA      19       CLA     -5672 PROA     VAL      385      C             4.1122
35045 NEG      CLA      19       CLA     -5674 PROA     LYS      386      N             4.0122
35045 NEG      CLA      19       CLA     -5676 PROA     LYS      386      CA            3.9944
35045 NEG      CLA      19       CLA     -6023 PROA     VAL      409      CG1           4.3758
35045 NEG      CLA      19       CLA     -6045 PROA     LYS      411      CA            4.1716
35045 NEG      CLA      19       CLA     -6047 PROA     LYS      411      CB            4.2059
35045 NEG      CLA      19       CLA     -6050 PROA     LYS      411      CG            4.3344
35045 NEG      CLA      19       CLA     -6063 PROA     LYS      411      C             3.1528
35045 NEG      CLA      19       CLA     -6064 PROA     LYS      411      O             3.6535
35045 NEG      CLA      19       CLA     -6065 PROA     GLU      412      N             2.2691
35045 NEG      CLA      19       CLA     -6067 PROA     GLU      412      CA            1.8713
35045 NEG      CLA      19       CLA     -6069 PROA     GLU      412      CB            0.7844
35045 NEG      CLA      19       CLA     -6072 PROA     GLU      412      CG            1.4622
35045 NEG      CLA      19       CLA     -6075 PROA     GLU      412      CD            2.8346
35045 NEG      CLA      19       CLA     -6076 PROA     GLU      412      OE1           3.3606
35045 NEG      CLA      19       CLA     -6077 PROA     GLU      412      OE2           3.7768
35045 NEG      CLA      19       CLA     -6078 PROA     GLU      412      C             2.9215
35045 NEG      CLA      19       CLA     -6079 PROA     GLU      412      O             3.3901
35045 NEG      CLA      19       CLA     -6152 PROA     LEU      418      CB            4.8854
35045 NEG      CLA      19       CLA     -6155 PROA     LEU      418      CG            4.3083
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        22
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "22"
 Comparing "22" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "84" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "84"
 Parameter: NPOS -> "65"
Evaluating: 84-65
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.363730629"
Evaluating: 90.067469*(0.363730629-0.5)
 Parameter: XPOS <- "-12.2734373"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.764862015"
Evaluating: 90.067469*(0.764862015-0.5)
 Parameter: YPOS <- "23.8554513"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.856918873"
Evaluating: 143.194738*(0.856918873-0.5)+3.5172451
 Parameter: ZPOS <- "54.6261496"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.6261496" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.6261496" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.991749 XMAX =    2.991749 XAVE =    2.991749
    YMIN =  -19.433366 YMAX =  -19.433366 YAVE =  -19.433366
    ZMIN =  -21.075252 ZMAX =  -21.075252 ZAVE =  -21.075252
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.2734373"
 RDCMND substituted energy or value "?XAVE" to "2.99174908"
Evaluating: -12.2734373-2.99174908
 Parameter: XTRAN <- "-15.2651864"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.8554513"
 RDCMND substituted energy or value "?YAVE" to "-19.4333658"
Evaluating: 23.8554513--19.4333658
 Parameter: YTRAN <- "43.2888171"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.6261496"
 RDCMND substituted energy or value "?ZAVE" to "-21.0752522"
Evaluating: 54.6261496--21.0752522
 Parameter: ZTRAN <- "75.7014018"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.2651864"
 Parameter: YTRAN -> "43.2888171"
 Parameter: ZTRAN -> "75.7014018"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -15.265186   43.288817   75.701402
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.33875536"
Evaluating: 0.33875536*360.0
 Parameter: XPHI <- "121.95193"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.419529761"
Evaluating: 0.419529761*360.0
 Parameter: YPHI <- "151.030714"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.12207938"
Evaluating: 0.12207938*360.0
 Parameter: ZPHI <- "43.9485768"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.2734373"
 Parameter: YPOS -> "23.8554513"
 Parameter: ZPOS -> "54.6261496"
 Parameter: XPHI -> "121.95193"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.529208    0.848492
    0.000000   -0.848492   -0.529208

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  121.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.2734373"
 Parameter: YPOS -> "23.8554513"
 Parameter: ZPOS -> "54.6261496"
 Parameter: YPHI -> "151.030714"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.874879    0.000000   -0.484341
    0.000000    1.000000    0.000000
    0.484341    0.000000   -0.874879

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  151.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.2734373"
 Parameter: YPOS -> "23.8554513"
 Parameter: ZPOS -> "54.6261496"
 Parameter: ZPHI -> "43.9485768"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.719963    0.694012    0.000000
   -0.694012    0.719963    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   43.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.273437 XMAX =  -12.273437 XAVE =  -12.273437
    YMIN =   23.855451 YMAX =   23.855451 YAVE =   23.855451
    ZMIN =   54.626150 ZMAX =   54.626150 ZAVE =   54.626150
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.2734373"
Evaluating: -12.2734373+3.5
 Parameter: XMAX <- "-8.7734373"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.8554513"
Evaluating: 23.8554513+3.5
 Parameter: YMAX <- "27.3554513"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.6261496"
Evaluating: 54.6261496+3.5
 Parameter: ZMAX <- "58.1261496"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.2734373"
Evaluating: -12.2734373-3.5
 Parameter: XMIN <- "-15.7734373"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.8554513"
Evaluating: 23.8554513-3.5
 Parameter: YMIN <- "20.3554513"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.6261496"
Evaluating: 54.6261496-3.5
 Parameter: ZMIN <- "51.1261496"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.7734373"
 Parameter: XMIN -> "-15.7734373"
 Parameter: YMAX -> "27.3554513"
 Parameter: YMIN -> "20.3554513"
 Parameter: ZMAX -> "58.1261496"
 Parameter: ZMIN -> "51.1261496"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "85"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "85" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "85" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "85"
 Parameter: NPOS -> "65"
Evaluating: 85-65
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.694966371"
Evaluating: 90.067469*(0.694966371-0.5)
 Parameter: XPOS <- "17.5601276"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "4.631419702E-02"
Evaluating: 90.067469*(4.631419702E-02-0.5)
 Parameter: YPOS <- "-40.862332"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.499712991"
Evaluating: 143.194738*(0.499712991-0.5)+3.5172451
 Parameter: ZPOS <- "3.47614692"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.47614692" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.47614692" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "85" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "85"
 Parameter: NPOS -> "65"
Evaluating: 85-65
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.518710472"
Evaluating: 90.067469*(0.518710472-0.5)
 Parameter: XPOS <- "1.68520486"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.219361612"
Evaluating: 90.067469*(0.219361612-0.5)
 Parameter: YPOS <- "-25.2763893"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.634628151"
Evaluating: 143.194738*(0.634628151-0.5)+3.5172451
 Parameter: ZPOS <- "22.7952879"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.7952879" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.7952879" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.68520486"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 1.68520486-0
 Parameter: XTRAN <- "1.68520486"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.2763893"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.2763893-0
 Parameter: YTRAN <- "-25.2763893"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.7952879"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.7952879-0
 Parameter: ZTRAN <- "22.7952879"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.68520486"
 Parameter: YTRAN -> "-25.2763893"
 Parameter: ZTRAN -> "22.7952879"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     1.685205  -25.276389   22.795288
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.367491601"
Evaluating: 0.367491601*360.0
 Parameter: XPHI <- "132.296976"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.502171664"
Evaluating: 0.502171664*360.0
 Parameter: YPHI <- "180.781799"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.16570856"
Evaluating: 0.16570856*360.0
 Parameter: ZPHI <- "59.6550816"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.68520486"
 Parameter: YPOS -> "-25.2763893"
 Parameter: ZPOS -> "22.7952879"
 Parameter: XPHI -> "132.296976"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.672973    0.739667
    0.000000   -0.739667   -0.672973

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.68520486"
 Parameter: YPOS -> "-25.2763893"
 Parameter: ZPOS -> "22.7952879"
 Parameter: YPHI -> "180.781799"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.999907    0.000000    0.013645
    0.000000    1.000000    0.000000
   -0.013645    0.000000   -0.999907

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  179.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.68520486"
 Parameter: YPOS -> "-25.2763893"
 Parameter: ZPOS -> "22.7952879"
 Parameter: ZPHI -> "59.6550816"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.505204    0.863000    0.000000
   -0.863000    0.505204    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   59.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.685205 XMAX =    1.685205 XAVE =    1.685205
    YMIN =  -25.276389 YMAX =  -25.276389 YAVE =  -25.276389
    ZMIN =   22.795288 ZMAX =   22.795288 ZAVE =   22.795288
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.68520486"
Evaluating: 1.68520486+3.5
 Parameter: XMAX <- "5.18520486"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.2763893"
Evaluating: -25.2763893+3.5
 Parameter: YMAX <- "-21.7763893"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.7952879"
Evaluating: 22.7952879+3.5
 Parameter: ZMAX <- "26.2952879"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.68520486"
Evaluating: 1.68520486-3.5
 Parameter: XMIN <- "-1.81479514"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.2763893"
Evaluating: -25.2763893-3.5
 Parameter: YMIN <- "-28.7763893"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.7952879"
Evaluating: 22.7952879-3.5
 Parameter: ZMIN <- "19.2952879"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.18520486"
 Parameter: XMIN -> "-1.81479514"
 Parameter: YMAX -> "-21.7763893"
 Parameter: YMIN -> "-28.7763893"
 Parameter: ZMAX -> "26.2952879"
 Parameter: ZMIN -> "19.2952879"
 SELRPN>      6 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      3 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35046 NEG      CLA      20       CLA     -8182 MEMB     POPC     4        O13           2.7040
35046 NEG      CLA      20       CLA     -8183 MEMB     POPC     4        O14           3.5807
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "85" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "85"
 Parameter: NPOS -> "65"
Evaluating: 85-65
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "2.732809357E-02"
Evaluating: 90.067469*(2.732809357E-02-0.5)
 Parameter: XPOS <- "-42.5723623"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.353502123"
Evaluating: 90.067469*(0.353502123-0.5)
 Parameter: YPOS <- "-13.194693"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.629971663"
Evaluating: 143.194738*(0.629971663-0.5)+3.5172451
 Parameter: ZPOS <- "22.1285033"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.1285033" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.1285033" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.685205 XMAX =    1.685205 XAVE =    1.685205
    YMIN =  -25.276389 YMAX =  -25.276389 YAVE =  -25.276389
    ZMIN =   22.795288 ZMAX =   22.795288 ZAVE =   22.795288
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.5723623"
 RDCMND substituted energy or value "?XAVE" to "1.68520486"
Evaluating: -42.5723623-1.68520486
 Parameter: XTRAN <- "-44.2575672"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.194693"
 RDCMND substituted energy or value "?YAVE" to "-25.2763893"
Evaluating: -13.194693--25.2763893
 Parameter: YTRAN <- "12.0816963"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.1285033"
 RDCMND substituted energy or value "?ZAVE" to "22.7952879"
Evaluating: 22.1285033-22.7952879
 Parameter: ZTRAN <- "-0.6667846"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.2575672"
 Parameter: YTRAN -> "12.0816963"
 Parameter: ZTRAN -> "-0.6667846"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -44.257567   12.081696   -0.666785
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.159685864"
Evaluating: 0.159685864*360.0
 Parameter: XPHI <- "57.486911"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.810856492"
Evaluating: 0.810856492*360.0
 Parameter: YPHI <- "291.908337"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.128354358"
Evaluating: 0.128354358*360.0
 Parameter: ZPHI <- "46.2075689"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.5723623"
 Parameter: YPOS -> "-13.194693"
 Parameter: ZPOS -> "22.1285033"
 Parameter: XPHI -> "57.486911"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.537492    0.843269
    0.000000   -0.843269    0.537492

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   57.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.5723623"
 Parameter: YPOS -> "-13.194693"
 Parameter: ZPOS -> "22.1285033"
 Parameter: YPHI -> "291.908337"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.373123    0.000000    0.927782
    0.000000    1.000000    0.000000
   -0.927782    0.000000    0.373123

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   68.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.5723623"
 Parameter: YPOS -> "-13.194693"
 Parameter: ZPOS -> "22.1285033"
 Parameter: ZPHI -> "46.2075689"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.692048    0.721852    0.000000
   -0.721852    0.692048    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   46.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.572362 XMAX =  -42.572362 XAVE =  -42.572362
    YMIN =  -13.194693 YMAX =  -13.194693 YAVE =  -13.194693
    ZMIN =   22.128503 ZMAX =   22.128503 ZAVE =   22.128503
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.5723623"
Evaluating: -42.5723623+3.5
 Parameter: XMAX <- "-39.0723623"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.194693"
Evaluating: -13.194693+3.5
 Parameter: YMAX <- "-9.694693"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.1285033"
Evaluating: 22.1285033+3.5
 Parameter: ZMAX <- "25.6285033"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.5723623"
Evaluating: -42.5723623-3.5
 Parameter: XMIN <- "-46.0723623"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.194693"
Evaluating: -13.194693-3.5
 Parameter: YMIN <- "-16.694693"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.1285033"
Evaluating: 22.1285033-3.5
 Parameter: ZMIN <- "18.6285033"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.0723623"
 Parameter: XMIN -> "-46.0723623"
 Parameter: YMAX -> "-9.694693"
 Parameter: YMIN -> "-16.694693"
 Parameter: ZMAX -> "25.6285033"
 Parameter: ZMIN -> "18.6285033"
 SELRPN>      3 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      1 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "86"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "86" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "86"
Evaluating: 86
 Parameter: J <- "86"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "86" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "86"
 Parameter: NPOS -> "65"
Evaluating: 86-65
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.823285103"
Evaluating: 90.067469*(0.823285103-0.5)
 Parameter: XPOS <- "29.117471"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.105130302"
Evaluating: 90.067469*(0.105130302-0.5)
 Parameter: YPOS <- "-35.5649143"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "4.701309508E-02"
Evaluating: 143.194738*(4.701309508E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-61.3480961"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-61.3480961" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.117471"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 29.117471-0
 Parameter: XTRAN <- "29.117471"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.5649143"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.5649143-0
 Parameter: YTRAN <- "-35.5649143"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-61.3480961"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -61.3480961-0
 Parameter: ZTRAN <- "-61.3480961"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "29.117471"
 Parameter: YTRAN -> "-35.5649143"
 Parameter: ZTRAN -> "-61.3480961"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    29.117471  -35.564914  -61.348096
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.429679031E-02"
Evaluating: 2.429679031E-02*360.0
 Parameter: XPHI <- "8.74684451"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.626138811"
Evaluating: 0.626138811*360.0
 Parameter: YPHI <- "225.409972"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.283169148E-02"
Evaluating: 7.283169148E-02*360.0
 Parameter: ZPHI <- "26.2194089"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.117471"
 Parameter: YPOS -> "-35.5649143"
 Parameter: ZPOS -> "-61.3480961"
 Parameter: XPHI -> "8.74684451"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.988370    0.152069
    0.000000   -0.152069    0.988370

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    8.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.117471"
 Parameter: YPOS -> "-35.5649143"
 Parameter: ZPOS -> "-61.3480961"
 Parameter: YPHI -> "225.409972"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.702029    0.000000    0.712148
    0.000000    1.000000    0.000000
   -0.712148    0.000000   -0.702029

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  134.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.117471"
 Parameter: YPOS -> "-35.5649143"
 Parameter: ZPOS -> "-61.3480961"
 Parameter: ZPHI -> "26.2194089"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.897109    0.441810    0.000000
   -0.441810    0.897109    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   26.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.117471 XMAX =   29.117471 XAVE =   29.117471
    YMIN =  -35.564914 YMAX =  -35.564914 YAVE =  -35.564914
    ZMIN =  -61.348096 ZMAX =  -61.348096 ZAVE =  -61.348096
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.117471"
Evaluating: 29.117471+3.5
 Parameter: XMAX <- "32.617471"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.5649143"
Evaluating: -35.5649143+3.5
 Parameter: YMAX <- "-32.0649143"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-61.3480961"
Evaluating: -61.3480961+3.5
 Parameter: ZMAX <- "-57.8480961"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.117471"
Evaluating: 29.117471-3.5
 Parameter: XMIN <- "25.617471"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.5649143"
Evaluating: -35.5649143-3.5
 Parameter: YMIN <- "-39.0649143"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-61.3480961"
Evaluating: -61.3480961-3.5
 Parameter: ZMIN <- "-64.8480961"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.617471"
 Parameter: XMIN -> "25.617471"
 Parameter: YMAX -> "-32.0649143"
 Parameter: YMIN -> "-39.0649143"
 Parameter: ZMAX -> "-57.8480961"
 Parameter: ZMIN -> "-64.8480961"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "87"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "87" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "87" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "87"
 Parameter: NPOS -> "65"
Evaluating: 87-65
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.816182175"
Evaluating: 90.067469*(0.816182175-0.5)
 Parameter: XPOS <- "28.4777282"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.100370283"
Evaluating: 90.067469*(0.100370283-0.5)
 Parameter: YPOS <- "-35.9936371"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.900780978"
Evaluating: 143.194738*(0.900780978-0.5)+3.5172451
 Parameter: ZPOS <- "60.9069722"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "60.9069722" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "60.9069722" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.4777282"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 28.4777282-0
 Parameter: XTRAN <- "28.4777282"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.9936371"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.9936371-0
 Parameter: YTRAN <- "-35.9936371"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "60.9069722"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 60.9069722-0
 Parameter: ZTRAN <- "60.9069722"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "28.4777282"
 Parameter: YTRAN -> "-35.9936371"
 Parameter: ZTRAN -> "60.9069722"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    28.477728  -35.993637   60.906972
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.666168813"
Evaluating: 0.666168813*360.0
 Parameter: XPHI <- "239.820773"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.272152958"
Evaluating: 0.272152958*360.0
 Parameter: YPHI <- "97.9750649"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.610076077"
Evaluating: 0.610076077*360.0
 Parameter: ZPHI <- "219.627388"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.4777282"
 Parameter: YPOS -> "-35.9936371"
 Parameter: ZPOS -> "60.9069722"
 Parameter: XPHI -> "239.820773"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.502707   -0.864457
    0.000000    0.864457   -0.502707

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  120.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.4777282"
 Parameter: YPOS -> "-35.9936371"
 Parameter: ZPOS -> "60.9069722"
 Parameter: YPHI -> "97.9750649"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.138742    0.000000   -0.990329
    0.000000    1.000000    0.000000
    0.990329    0.000000   -0.138742

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   97.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.4777282"
 Parameter: YPOS -> "-35.9936371"
 Parameter: ZPOS -> "60.9069722"
 Parameter: ZPHI -> "219.627388"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.770208   -0.637792    0.000000
    0.637792   -0.770208    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  140.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.477728 XMAX =   28.477728 XAVE =   28.477728
    YMIN =  -35.993637 YMAX =  -35.993637 YAVE =  -35.993637
    ZMIN =   60.906972 ZMAX =   60.906972 ZAVE =   60.906972
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.4777282"
Evaluating: 28.4777282+3.5
 Parameter: XMAX <- "31.9777282"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.9936371"
Evaluating: -35.9936371+3.5
 Parameter: YMAX <- "-32.4936371"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "60.9069722"
Evaluating: 60.9069722+3.5
 Parameter: ZMAX <- "64.4069722"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.4777282"
Evaluating: 28.4777282-3.5
 Parameter: XMIN <- "24.9777282"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.9936371"
Evaluating: -35.9936371-3.5
 Parameter: YMIN <- "-39.4936371"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "60.9069722"
Evaluating: 60.9069722-3.5
 Parameter: ZMIN <- "57.4069722"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.9777282"
 Parameter: XMIN -> "24.9777282"
 Parameter: YMAX -> "-32.4936371"
 Parameter: YMIN -> "-39.4936371"
 Parameter: ZMAX -> "64.4069722"
 Parameter: ZMIN -> "57.4069722"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "88"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "88" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "88"
Evaluating: 88
 Parameter: J <- "88"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "88" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "88"
 Parameter: NPOS -> "65"
Evaluating: 88-65
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.702895595"
Evaluating: 90.067469*(0.702895595-0.5)
 Parameter: XPOS <- "18.2742927"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.124895729"
Evaluating: 90.067469*(0.124895729-0.5)
 Parameter: YPOS <- "-33.7846923"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.806559144"
Evaluating: 143.194738*(0.806559144-0.5)+3.5172451
 Parameter: ZPOS <- "47.4149014"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.4149014" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.4149014" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.2742927"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.2742927-0
 Parameter: XTRAN <- "18.2742927"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.7846923"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.7846923-0
 Parameter: YTRAN <- "-33.7846923"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.4149014"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.4149014-0
 Parameter: ZTRAN <- "47.4149014"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.2742927"
 Parameter: YTRAN -> "-33.7846923"
 Parameter: ZTRAN -> "47.4149014"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    18.274293  -33.784692   47.414901
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.122779451"
Evaluating: 0.122779451*360.0
 Parameter: XPHI <- "44.2006024"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.816719184"
Evaluating: 0.816719184*360.0
 Parameter: YPHI <- "294.018906"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.14694185"
Evaluating: 0.14694185*360.0
 Parameter: ZPHI <- "52.899066"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.2742927"
 Parameter: YPOS -> "-33.7846923"
 Parameter: ZPOS -> "47.4149014"
 Parameter: XPHI -> "44.2006024"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.716903    0.697173
    0.000000   -0.697173    0.716903

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   44.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.2742927"
 Parameter: YPOS -> "-33.7846923"
 Parameter: ZPOS -> "47.4149014"
 Parameter: YPHI -> "294.018906"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.407038    0.000000    0.913411
    0.000000    1.000000    0.000000
   -0.913411    0.000000    0.407038

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   65.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.2742927"
 Parameter: YPOS -> "-33.7846923"
 Parameter: ZPOS -> "47.4149014"
 Parameter: ZPHI -> "52.899066"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.603221    0.797574    0.000000
   -0.797574    0.603221    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   52.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.274293 XMAX =   18.274293 XAVE =   18.274293
    YMIN =  -33.784692 YMAX =  -33.784692 YAVE =  -33.784692
    ZMIN =   47.414901 ZMAX =   47.414901 ZAVE =   47.414901
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.2742927"
Evaluating: 18.2742927+3.5
 Parameter: XMAX <- "21.7742927"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.7846923"
Evaluating: -33.7846923+3.5
 Parameter: YMAX <- "-30.2846923"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.4149014"
Evaluating: 47.4149014+3.5
 Parameter: ZMAX <- "50.9149014"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.2742927"
Evaluating: 18.2742927-3.5
 Parameter: XMIN <- "14.7742927"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.7846923"
Evaluating: -33.7846923-3.5
 Parameter: YMIN <- "-37.2846923"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.4149014"
Evaluating: 47.4149014-3.5
 Parameter: ZMIN <- "43.9149014"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.7742927"
 Parameter: XMIN -> "14.7742927"
 Parameter: YMAX -> "-30.2846923"
 Parameter: YMIN -> "-37.2846923"
 Parameter: ZMAX -> "50.9149014"
 Parameter: ZMIN -> "43.9149014"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "89"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "89" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "89" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "89"
 Parameter: NPOS -> "65"
Evaluating: 89-65
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.12300052"
Evaluating: 90.067469*(0.12300052-0.5)
 Parameter: XPOS <- "-33.955389"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.416838804"
Evaluating: 90.067469*(0.416838804-0.5)
 Parameter: YPOS <- "-7.49011844"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.505611821"
Evaluating: 143.194738*(0.505611821-0.5)+3.5172451
 Parameter: ZPOS <- "4.32082834"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.32082834" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.32082834" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "89" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "89"
 Parameter: NPOS -> "65"
Evaluating: 89-65
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.648741238"
Evaluating: 90.067469*(0.648741238-0.5)
 Parameter: XPOS <- "13.3967468"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.145313556"
Evaluating: 90.067469*(0.145313556-0.5)
 Parameter: YPOS <- "-31.9457103"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.38868877"
Evaluating: 143.194738*(0.38868877-0.5)+3.5172451
 Parameter: ZPOS <- "-12.4219373"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-12.4219373" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-12.4219373" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "89" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "89"
 Parameter: NPOS -> "65"
Evaluating: 89-65
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.993328767"
Evaluating: 90.067469*(0.993328767-0.5)
 Parameter: XPOS <- "44.4328734"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.501643998"
Evaluating: 90.067469*(0.501643998-0.5)
 Parameter: YPOS <- "0.148070739"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.760525586"
Evaluating: 143.194738*(0.760525586-0.5)+3.5172451
 Parameter: ZPOS <- "40.8231381"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.8231381" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.8231381" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.4328734"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 44.4328734-0
 Parameter: XTRAN <- "44.4328734"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.148070739"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 0.148070739-0
 Parameter: YTRAN <- "0.148070739"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.8231381"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.8231381-0
 Parameter: ZTRAN <- "40.8231381"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.4328734"
 Parameter: YTRAN -> "0.148070739"
 Parameter: ZTRAN -> "40.8231381"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    44.432873    0.148071   40.823138
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.185000855"
Evaluating: 0.185000855*360.0
 Parameter: XPHI <- "66.6003078"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.57789363E-02"
Evaluating: 1.57789363E-02*360.0
 Parameter: YPHI <- "5.68041707"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.672904536"
Evaluating: 0.672904536*360.0
 Parameter: ZPHI <- "242.245633"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.4328734"
 Parameter: YPOS -> "0.148070739"
 Parameter: ZPOS -> "40.8231381"
 Parameter: XPHI -> "66.6003078"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.397143    0.917757
    0.000000   -0.917757    0.397143

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   66.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.4328734"
 Parameter: YPOS -> "0.148070739"
 Parameter: ZPOS -> "40.8231381"
 Parameter: YPHI -> "5.68041707"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.995089    0.000000   -0.098980
    0.000000    1.000000    0.000000
    0.098980    0.000000    0.995089

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    5.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.4328734"
 Parameter: YPOS -> "0.148070739"
 Parameter: ZPOS -> "40.8231381"
 Parameter: ZPHI -> "242.245633"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.465682   -0.884952    0.000000
    0.884952   -0.465682    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  117.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.432873 XMAX =   44.432873 XAVE =   44.432873
    YMIN =    0.148071 YMAX =    0.148071 YAVE =    0.148071
    ZMIN =   40.823138 ZMAX =   40.823138 ZAVE =   40.823138
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.4328734"
Evaluating: 44.4328734+3.5
 Parameter: XMAX <- "47.9328734"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.148070739"
Evaluating: 0.148070739+3.5
 Parameter: YMAX <- "3.64807074"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.8231381"
Evaluating: 40.8231381+3.5
 Parameter: ZMAX <- "44.3231381"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.4328734"
Evaluating: 44.4328734-3.5
 Parameter: XMIN <- "40.9328734"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.148070739"
Evaluating: 0.148070739-3.5
 Parameter: YMIN <- "-3.35192926"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.8231381"
Evaluating: 40.8231381-3.5
 Parameter: ZMIN <- "37.3231381"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "47.9328734"
 Parameter: XMIN -> "40.9328734"
 Parameter: YMAX -> "3.64807074"
 Parameter: YMIN -> "-3.35192926"
 Parameter: ZMAX -> "44.3231381"
 Parameter: ZMIN -> "37.3231381"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      1 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35050 NEG      CLA      24       CLA     -**** POS      SOD      52       SOD           3.0518
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "89" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "89"
 Parameter: NPOS -> "65"
Evaluating: 89-65
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.103412993"
Evaluating: 90.067469*(0.103412993-0.5)
 Parameter: XPOS <- "-35.719588"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.49450132"
Evaluating: 90.067469*(0.49450132-0.5)
 Parameter: YPOS <- "-0.49525219"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.600024704"
Evaluating: 143.194738*(0.600024704-0.5)+3.5172451
 Parameter: ZPOS <- "17.8402564"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "17.8402564" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "17.8402564" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.432873 XMAX =   44.432873 XAVE =   44.432873
    YMIN =    0.148071 YMAX =    0.148071 YAVE =    0.148071
    ZMIN =   40.823138 ZMAX =   40.823138 ZAVE =   40.823138
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.719588"
 RDCMND substituted energy or value "?XAVE" to "44.4328734"
Evaluating: -35.719588-44.4328734
 Parameter: XTRAN <- "-80.1524614"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.49525219"
 RDCMND substituted energy or value "?YAVE" to "0.148070739"
Evaluating: -0.49525219-0.148070739
 Parameter: YTRAN <- "-0.643322929"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "17.8402564"
 RDCMND substituted energy or value "?ZAVE" to "40.8231381"
Evaluating: 17.8402564-40.8231381
 Parameter: ZTRAN <- "-22.9828817"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-80.1524614"
 Parameter: YTRAN -> "-0.643322929"
 Parameter: ZTRAN -> "-22.9828817"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -80.152461   -0.643323  -22.982882
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.673893538"
Evaluating: 0.673893538*360.0
 Parameter: XPHI <- "242.601674"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.272887162"
Evaluating: 0.272887162*360.0
 Parameter: YPHI <- "98.2393783"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882544687"
Evaluating: 0.882544687*360.0
 Parameter: ZPHI <- "317.716087"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.719588"
 Parameter: YPOS -> "-0.49525219"
 Parameter: ZPOS -> "17.8402564"
 Parameter: XPHI -> "242.601674"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.460174   -0.887829
    0.000000    0.887829   -0.460174

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  117.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.719588"
 Parameter: YPOS -> "-0.49525219"
 Parameter: ZPOS -> "17.8402564"
 Parameter: YPHI -> "98.2393783"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.143309    0.000000   -0.989678
    0.000000    1.000000    0.000000
    0.989678    0.000000   -0.143309

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   98.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.719588"
 Parameter: YPOS -> "-0.49525219"
 Parameter: ZPOS -> "17.8402564"
 Parameter: ZPHI -> "317.716087"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.739820   -0.672805    0.000000
    0.672805    0.739820    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   42.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.719588 XMAX =  -35.719588 XAVE =  -35.719588
    YMIN =   -0.495252 YMAX =   -0.495252 YAVE =   -0.495252
    ZMIN =   17.840256 ZMAX =   17.840256 ZAVE =   17.840256
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.719588"
Evaluating: -35.719588+3.5
 Parameter: XMAX <- "-32.219588"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.49525219"
Evaluating: -0.49525219+3.5
 Parameter: YMAX <- "3.00474781"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "17.8402564"
Evaluating: 17.8402564+3.5
 Parameter: ZMAX <- "21.3402564"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.719588"
Evaluating: -35.719588-3.5
 Parameter: XMIN <- "-39.219588"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.49525219"
Evaluating: -0.49525219-3.5
 Parameter: YMIN <- "-3.99525219"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "17.8402564"
Evaluating: 17.8402564-3.5
 Parameter: ZMIN <- "14.3402564"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.219588"
 Parameter: XMIN -> "-39.219588"
 Parameter: YMAX -> "3.00474781"
 Parameter: YMIN -> "-3.99525219"
 Parameter: ZMAX -> "21.3402564"
 Parameter: ZMIN -> "14.3402564"
 SELRPN>     23 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     15 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     19       P             3.8288
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     19       O14           2.9826
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     19       O11           3.7814
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     39       C2            3.5710
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     39       O21           3.6336
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     39       C21           2.8957
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     39       O22           1.7393
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     40       C11           3.0990
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     40       P             3.5752
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     40       O13           2.8135
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     40       O12           3.8052
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     40       O11           3.5948
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "89" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "89"
 Parameter: NPOS -> "65"
Evaluating: 89-65
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.739722149"
Evaluating: 90.067469*(0.739722149-0.5)
 Parameter: XPOS <- "21.5911672"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.742841872"
Evaluating: 90.067469*(0.742841872-0.5)
 Parameter: YPOS <- "21.8721528"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.473296226"
Evaluating: 143.194738*(0.473296226-0.5)+3.5172451
 Parameter: ZPOS <- "-0.306594822"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-0.306594822" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-0.306594822" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "5"
Evaluating: 5+1
 Parameter: CNTRAND <- "6"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "6" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "89" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "89"
 Parameter: NPOS -> "65"
Evaluating: 89-65
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.449699821"
Evaluating: 90.067469*(0.449699821-0.5)
 Parameter: XPOS <- "-4.53040981"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.873551981"
Evaluating: 90.067469*(0.873551981-0.5)
 Parameter: YPOS <- "33.6448815"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.334727871"
Evaluating: 143.194738*(0.334727871-0.5)+3.5172451
 Parameter: ZPOS <- "-20.1488541"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-20.1488541" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.719588 XMAX =  -35.719588 XAVE =  -35.719588
    YMIN =   -0.495252 YMAX =   -0.495252 YAVE =   -0.495252
    ZMIN =   17.840256 ZMAX =   17.840256 ZAVE =   17.840256
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.53040981"
 RDCMND substituted energy or value "?XAVE" to "-35.719588"
Evaluating: -4.53040981--35.719588
 Parameter: XTRAN <- "31.1891782"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.6448815"
 RDCMND substituted energy or value "?YAVE" to "-0.49525219"
Evaluating: 33.6448815--0.49525219
 Parameter: YTRAN <- "34.1401337"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.1488541"
 RDCMND substituted energy or value "?ZAVE" to "17.8402564"
Evaluating: -20.1488541-17.8402564
 Parameter: ZTRAN <- "-37.9891105"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.1891782"
 Parameter: YTRAN -> "34.1401337"
 Parameter: ZTRAN -> "-37.9891105"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    31.189178   34.140134  -37.989111
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.816975398"
Evaluating: 0.816975398*360.0
 Parameter: XPHI <- "294.111143"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.753156817"
Evaluating: 0.753156817*360.0
 Parameter: YPHI <- "271.136454"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.97977732"
Evaluating: 0.97977732*360.0
 Parameter: ZPHI <- "352.719835"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.53040981"
 Parameter: YPOS -> "33.6448815"
 Parameter: ZPOS -> "-20.1488541"
 Parameter: XPHI -> "294.111143"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.408508   -0.912755
    0.000000    0.912755    0.408508

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   65.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.53040981"
 Parameter: YPOS -> "33.6448815"
 Parameter: ZPOS -> "-20.1488541"
 Parameter: YPHI -> "271.136454"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.019834    0.000000    0.999803
    0.000000    1.000000    0.000000
   -0.999803    0.000000    0.019834

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   88.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.53040981"
 Parameter: YPOS -> "33.6448815"
 Parameter: ZPOS -> "-20.1488541"
 Parameter: ZPHI -> "352.719835"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.991938   -0.126721    0.000000
    0.126721    0.991938    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    7.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.530410 XMAX =   -4.530410 XAVE =   -4.530410
    YMIN =   33.644882 YMAX =   33.644882 YAVE =   33.644882
    ZMIN =  -20.148854 ZMAX =  -20.148854 ZAVE =  -20.148854
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.5304098"
Evaluating: -4.5304098+3.5
 Parameter: XMAX <- "-1.0304098"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.6448815"
Evaluating: 33.6448815+3.5
 Parameter: YMAX <- "37.1448815"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.1488541"
Evaluating: -20.1488541+3.5
 Parameter: ZMAX <- "-16.6488541"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.5304098"
Evaluating: -4.5304098-3.5
 Parameter: XMIN <- "-8.0304098"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.6448815"
Evaluating: 33.6448815-3.5
 Parameter: YMIN <- "30.1448815"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.1488541"
Evaluating: -20.1488541-3.5
 Parameter: ZMIN <- "-23.6488541"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.0304098"
 Parameter: XMIN -> "-8.0304098"
 Parameter: YMAX -> "37.1448815"
 Parameter: YMIN -> "30.1448815"
 Parameter: ZMAX -> "-16.6488541"
 Parameter: ZMIN -> "-23.6488541"
 SELRPN>     16 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      5 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     131      O13           3.1007
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     132      N             3.4821
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     132      C13           2.2836
35050 NEG      CLA      24       CLA     -**** MEMB     POPC     132      C14           3.6756
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "6"
Evaluating: 6+1
 Parameter: CNTRAND <- "7"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "7" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "89" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "89"
 Parameter: NPOS -> "65"
Evaluating: 89-65
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "4.275603351E-02"
Evaluating: 90.067469*(4.275603351E-02-0.5)
 Parameter: XPOS <- "-41.1828068"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.55918509E-03"
Evaluating: 90.067469*(8.55918509E-03-0.5)
 Parameter: YPOS <- "-44.2628304"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.234315704"
Evaluating: 143.194738*(0.234315704-0.5)+3.5172451
 Parameter: ZPOS <- "-34.5273481"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-34.5273481" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.530410 XMAX =   -4.530410 XAVE =   -4.530410
    YMIN =   33.644882 YMAX =   33.644882 YAVE =   33.644882
    ZMIN =  -20.148854 ZMAX =  -20.148854 ZAVE =  -20.148854
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.1828068"
 RDCMND substituted energy or value "?XAVE" to "-4.5304098"
Evaluating: -41.1828068--4.5304098
 Parameter: XTRAN <- "-36.652397"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.2628304"
 RDCMND substituted energy or value "?YAVE" to "33.6448815"
Evaluating: -44.2628304-33.6448815
 Parameter: YTRAN <- "-77.9077119"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.5273481"
 RDCMND substituted energy or value "?ZAVE" to "-20.1488541"
Evaluating: -34.5273481--20.1488541
 Parameter: ZTRAN <- "-14.378494"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.652397"
 Parameter: YTRAN -> "-77.9077119"
 Parameter: ZTRAN -> "-14.378494"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -36.652397  -77.907712  -14.378494
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.92621853"
Evaluating: 0.92621853*360.0
 Parameter: XPHI <- "333.438671"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.386459305"
Evaluating: 0.386459305*360.0
 Parameter: YPHI <- "139.12535"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.232255032"
Evaluating: 0.232255032*360.0
 Parameter: ZPHI <- "83.6118115"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.1828068"
 Parameter: YPOS -> "-44.2628304"
 Parameter: ZPOS -> "-34.5273481"
 Parameter: XPHI -> "333.438671"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.894456   -0.447155
    0.000000    0.447155    0.894456

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   26.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.1828068"
 Parameter: YPOS -> "-44.2628304"
 Parameter: ZPOS -> "-34.5273481"
 Parameter: YPHI -> "139.12535"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.756143    0.000000   -0.654406
    0.000000    1.000000    0.000000
    0.654406    0.000000   -0.756143

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  139.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.1828068"
 Parameter: YPOS -> "-44.2628304"
 Parameter: ZPOS -> "-34.5273481"
 Parameter: ZPHI -> "83.6118115"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.111264    0.993791    0.000000
   -0.993791    0.111264    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   83.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.182807 XMAX =  -41.182807 XAVE =  -41.182807
    YMIN =  -44.262830 YMAX =  -44.262830 YAVE =  -44.262830
    ZMIN =  -34.527348 ZMAX =  -34.527348 ZAVE =  -34.527348
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.1828068"
Evaluating: -41.1828068+3.5
 Parameter: XMAX <- "-37.6828068"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.2628304"
Evaluating: -44.2628304+3.5
 Parameter: YMAX <- "-40.7628304"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.5273481"
Evaluating: -34.5273481+3.5
 Parameter: ZMAX <- "-31.0273481"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.1828068"
Evaluating: -41.1828068-3.5
 Parameter: XMIN <- "-44.6828068"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.2628304"
Evaluating: -44.2628304-3.5
 Parameter: YMIN <- "-47.7628304"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.5273481"
Evaluating: -34.5273481-3.5
 Parameter: ZMIN <- "-38.0273481"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.6828068"
 Parameter: XMIN -> "-44.6828068"
 Parameter: YMAX -> "-40.7628304"
 Parameter: YMIN -> "-47.7628304"
 Parameter: ZMAX -> "-31.0273481"
 Parameter: ZMIN -> "-38.0273481"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "90"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "90" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "90" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "90"
 Parameter: NPOS -> "65"
Evaluating: 90-65
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.944160184"
Evaluating: 90.067469*(0.944160184-0.5)
 Parameter: XPOS <- "40.0043836"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.576806988"
Evaluating: 90.067469*(0.576806988-0.5)
 Parameter: YPOS <- "6.91781101"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.799691818"
Evaluating: 143.194738*(0.799691818-0.5)+3.5172451
 Parameter: ZPOS <- "46.4315365"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "46.4315365" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "46.4315365" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.0043836"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 40.0043836-0
 Parameter: XTRAN <- "40.0043836"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.91781101"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 6.91781101-0
 Parameter: YTRAN <- "6.91781101"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "46.4315365"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 46.4315365-0
 Parameter: ZTRAN <- "46.4315365"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "40.0043836"
 Parameter: YTRAN -> "6.91781101"
 Parameter: ZTRAN -> "46.4315365"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    40.004384    6.917811   46.431536
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.451923574E-03"
Evaluating: 9.451923574E-03*360.0
 Parameter: XPHI <- "3.40269249"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.412314401"
Evaluating: 0.412314401*360.0
 Parameter: YPHI <- "148.433184"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.888567992E-02"
Evaluating: 8.888567992E-02*360.0
 Parameter: ZPHI <- "31.9988448"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.0043836"
 Parameter: YPOS -> "6.91781101"
 Parameter: ZPOS -> "46.4315365"
 Parameter: XPHI -> "3.40269249"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998237    0.059353
    0.000000   -0.059353    0.998237

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.0043836"
 Parameter: YPOS -> "6.91781101"
 Parameter: ZPOS -> "46.4315365"
 Parameter: YPHI -> "148.433184"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.852030    0.000000   -0.523493
    0.000000    1.000000    0.000000
    0.523493    0.000000   -0.852030

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  148.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.0043836"
 Parameter: YPOS -> "6.91781101"
 Parameter: ZPOS -> "46.4315365"
 Parameter: ZPHI -> "31.9988448"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.848059    0.529902    0.000000
   -0.529902    0.848059    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   32.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.004384 XMAX =   40.004384 XAVE =   40.004384
    YMIN =    6.917811 YMAX =    6.917811 YAVE =    6.917811
    ZMIN =   46.431536 ZMAX =   46.431536 ZAVE =   46.431536
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.0043836"
Evaluating: 40.0043836+3.5
 Parameter: XMAX <- "43.5043836"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.91781101"
Evaluating: 6.91781101+3.5
 Parameter: YMAX <- "10.417811"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "46.4315365"
Evaluating: 46.4315365+3.5
 Parameter: ZMAX <- "49.9315365"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.0043836"
Evaluating: 40.0043836-3.5
 Parameter: XMIN <- "36.5043836"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.91781101"
Evaluating: 6.91781101-3.5
 Parameter: YMIN <- "3.41781101"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "46.4315365"
Evaluating: 46.4315365-3.5
 Parameter: ZMIN <- "42.9315365"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.5043836"
 Parameter: XMIN -> "36.5043836"
 Parameter: YMAX -> "10.417811"
 Parameter: YMIN -> "3.41781101"
 Parameter: ZMAX -> "49.9315365"
 Parameter: ZMIN -> "42.9315365"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "91"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "91" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "91"
Evaluating: 91
 Parameter: J <- "91"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "91" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "91"
 Parameter: NPOS -> "65"
Evaluating: 91-65
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.571531609"
Evaluating: 90.067469*(0.571531609-0.5)
 Parameter: XPOS <- "6.44267098"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.61279448"
Evaluating: 90.067469*(0.61279448-0.5)
 Parameter: YPOS <- "10.1591133"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.948858697"
Evaluating: 143.194738*(0.948858697-0.5)+3.5172451
 Parameter: ZPOS <- "67.7914486"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "67.7914486" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "67.7914486" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.44267098"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 6.44267098-0
 Parameter: XTRAN <- "6.44267098"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.1591133"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.1591133-0
 Parameter: YTRAN <- "10.1591133"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "67.7914486"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 67.7914486-0
 Parameter: ZTRAN <- "67.7914486"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "6.44267098"
 Parameter: YTRAN -> "10.1591133"
 Parameter: ZTRAN -> "67.7914486"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     6.442671   10.159113   67.791449
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.638338643"
Evaluating: 0.638338643*360.0
 Parameter: XPHI <- "229.801911"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.850405136"
Evaluating: 0.850405136*360.0
 Parameter: YPHI <- "306.145849"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.650833371"
Evaluating: 0.650833371*360.0
 Parameter: ZPHI <- "234.300014"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.44267098"
 Parameter: YPOS -> "10.1591133"
 Parameter: ZPOS -> "67.7914486"
 Parameter: XPHI -> "229.801911"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.645432   -0.763818
    0.000000    0.763818   -0.645432

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  130.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.44267098"
 Parameter: YPOS -> "10.1591133"
 Parameter: ZPOS -> "67.7914486"
 Parameter: YPHI -> "306.145849"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.589843    0.000000    0.807518
    0.000000    1.000000    0.000000
   -0.807518    0.000000    0.589843

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   53.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.44267098"
 Parameter: YPOS -> "10.1591133"
 Parameter: ZPOS -> "67.7914486"
 Parameter: ZPHI -> "234.300014"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.583541   -0.812084    0.000000
    0.812084   -0.583541    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  125.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.442671 XMAX =    6.442671 XAVE =    6.442671
    YMIN =   10.159113 YMAX =   10.159113 YAVE =   10.159113
    ZMIN =   67.791449 ZMAX =   67.791449 ZAVE =   67.791449
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.44267098"
Evaluating: 6.44267098+3.5
 Parameter: XMAX <- "9.94267098"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.1591133"
Evaluating: 10.1591133+3.5
 Parameter: YMAX <- "13.6591133"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "67.7914486"
Evaluating: 67.7914486+3.5
 Parameter: ZMAX <- "71.2914486"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.44267098"
Evaluating: 6.44267098-3.5
 Parameter: XMIN <- "2.94267098"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.1591133"
Evaluating: 10.1591133-3.5
 Parameter: YMIN <- "6.6591133"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "67.7914486"
Evaluating: 67.7914486-3.5
 Parameter: ZMIN <- "64.2914486"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.94267098"
 Parameter: XMIN -> "2.94267098"
 Parameter: YMAX -> "13.6591133"
 Parameter: YMIN -> "6.6591133"
 Parameter: ZMAX -> "71.2914486"
 Parameter: ZMIN -> "64.2914486"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "92"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "92" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "92" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "92"
 Parameter: NPOS -> "65"
Evaluating: 92-65
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "3.350865566E-02"
Evaluating: 90.067469*(3.350865566E-02-0.5)
 Parameter: XPOS <- "-42.0156947"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.482693223"
Evaluating: 90.067469*(0.482693223-0.5)
 Parameter: YPOS <- "-1.5587776"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.507064267"
Evaluating: 143.194738*(0.507064267-0.5)+3.5172451
 Parameter: ZPOS <- "4.52881096"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "4.52881096" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "4.52881096" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "92" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "92"
 Parameter: NPOS -> "65"
Evaluating: 92-65
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.612811979"
Evaluating: 90.067469*(0.612811979-0.5)
 Parameter: XPOS <- "10.1606894"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.344061391"
Evaluating: 90.067469*(0.344061391-0.5)
 Parameter: YPOS <- "-14.0449958"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.639562075"
Evaluating: 143.194738*(0.639562075-0.5)+3.5172451
 Parameter: ZPOS <- "23.5017999"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "23.5017999" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "23.5017999" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.1606894"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.1606894-0
 Parameter: XTRAN <- "10.1606894"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.0449958"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.0449958-0
 Parameter: YTRAN <- "-14.0449958"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.5017999"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 23.5017999-0
 Parameter: ZTRAN <- "23.5017999"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.1606894"
 Parameter: YTRAN -> "-14.0449958"
 Parameter: ZTRAN -> "23.5017999"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    10.160689  -14.044996   23.501800
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.624761231"
Evaluating: 0.624761231*360.0
 Parameter: XPHI <- "224.914043"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.323460093"
Evaluating: 0.323460093*360.0
 Parameter: YPHI <- "116.445633"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.930730172E-02"
Evaluating: 3.930730172E-02*360.0
 Parameter: ZPHI <- "14.1506286"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.1606894"
 Parameter: YPOS -> "-14.0449958"
 Parameter: ZPOS -> "23.5017999"
 Parameter: XPHI -> "224.914043"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.708167   -0.706045
    0.000000    0.706045   -0.708167

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  135.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.1606894"
 Parameter: YPOS -> "-14.0449958"
 Parameter: ZPOS -> "23.5017999"
 Parameter: YPHI -> "116.445633"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.445348    0.000000   -0.895357
    0.000000    1.000000    0.000000
    0.895357    0.000000   -0.445348

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  116.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.1606894"
 Parameter: YPOS -> "-14.0449958"
 Parameter: ZPOS -> "23.5017999"
 Parameter: ZPHI -> "14.1506286"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.969656    0.244472    0.000000
   -0.244472    0.969656    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   14.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.160689 XMAX =   10.160689 XAVE =   10.160689
    YMIN =  -14.044996 YMAX =  -14.044996 YAVE =  -14.044996
    ZMIN =   23.501800 ZMAX =   23.501800 ZAVE =   23.501800
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.1606894"
Evaluating: 10.1606894+3.5
 Parameter: XMAX <- "13.6606894"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.0449958"
Evaluating: -14.0449958+3.5
 Parameter: YMAX <- "-10.5449958"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.5017999"
Evaluating: 23.5017999+3.5
 Parameter: ZMAX <- "27.0017999"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.1606894"
Evaluating: 10.1606894-3.5
 Parameter: XMIN <- "6.6606894"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.0449958"
Evaluating: -14.0449958-3.5
 Parameter: YMIN <- "-17.5449958"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.5017999"
Evaluating: 23.5017999-3.5
 Parameter: ZMIN <- "20.0017999"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.6606894"
 Parameter: XMIN -> "6.6606894"
 Parameter: YMAX -> "-10.5449958"
 Parameter: YMIN -> "-17.5449958"
 Parameter: ZMAX -> "27.0017999"
 Parameter: ZMIN -> "20.0017999"
 SELRPN>     31 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      6 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35053 NEG      CLA      27       CLA     -2083 PROA     ILE      157      CB            4.3029
35053 NEG      CLA      27       CLA     -2085 PROA     ILE      157      CG2           3.4011
35053 NEG      CLA      27       CLA     -2142 PROA     ILE      160      CD            4.0809
35053 NEG      CLA      27       CLA     -2152 PROA     LEU      161      CB            4.9607
35053 NEG      CLA      27       CLA     -2155 PROA     LEU      161      CG            3.5108
35053 NEG      CLA      27       CLA     -2161 PROA     LEU      161      CD2           3.3621
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "92" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "92"
 Parameter: NPOS -> "65"
Evaluating: 92-65
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.103239266"
Evaluating: 90.067469*(0.103239266-0.5)
 Parameter: XPOS <- "-35.7352351"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.509781667"
Evaluating: 90.067469*(0.509781667-0.5)
 Parameter: YPOS <- "0.881009989"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.24295472"
Evaluating: 143.194738*(0.24295472-0.5)+3.5172451
 Parameter: ZPOS <- "-33.2902864"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.2902864" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.160689 XMAX =   10.160689 XAVE =   10.160689
    YMIN =  -14.044996 YMAX =  -14.044996 YAVE =  -14.044996
    ZMIN =   23.501800 ZMAX =   23.501800 ZAVE =   23.501800
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.7352351"
 RDCMND substituted energy or value "?XAVE" to "10.1606894"
Evaluating: -35.7352351-10.1606894
 Parameter: XTRAN <- "-45.8959245"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.881009989"
 RDCMND substituted energy or value "?YAVE" to "-14.0449958"
Evaluating: 0.881009989--14.0449958
 Parameter: YTRAN <- "14.9260058"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.2902864"
 RDCMND substituted energy or value "?ZAVE" to "23.5017999"
Evaluating: -33.2902864-23.5017999
 Parameter: ZTRAN <- "-56.7920863"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.8959245"
 Parameter: YTRAN -> "14.9260058"
 Parameter: ZTRAN -> "-56.7920863"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -45.895924   14.926006  -56.792086
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.374167362"
Evaluating: 0.374167362*360.0
 Parameter: XPHI <- "134.70025"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.461929787"
Evaluating: 0.461929787*360.0
 Parameter: YPHI <- "166.294723"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.242441595E-02"
Evaluating: 2.242441595E-02*360.0
 Parameter: ZPHI <- "8.07278974"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.7352351"
 Parameter: YPOS -> "0.881009989"
 Parameter: ZPOS -> "-33.2902864"
 Parameter: XPHI -> "134.70025"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.703398    0.710796
    0.000000   -0.710796   -0.703398

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  134.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.7352351"
 Parameter: YPOS -> "0.881009989"
 Parameter: ZPOS -> "-33.2902864"
 Parameter: YPHI -> "166.294723"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.971527    0.000000   -0.236928
    0.000000    1.000000    0.000000
    0.236928    0.000000   -0.971527

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  166.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.7352351"
 Parameter: YPOS -> "0.881009989"
 Parameter: ZPOS -> "-33.2902864"
 Parameter: ZPHI -> "8.07278974"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.990090    0.140431    0.000000
   -0.140431    0.990090    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    8.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.735235 XMAX =  -35.735235 XAVE =  -35.735235
    YMIN =    0.881010 YMAX =    0.881010 YAVE =    0.881010
    ZMIN =  -33.290286 ZMAX =  -33.290286 ZAVE =  -33.290286
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.7352351"
Evaluating: -35.7352351+3.5
 Parameter: XMAX <- "-32.2352351"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.881009981"
Evaluating: 0.881009981+3.5
 Parameter: YMAX <- "4.38100998"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.2902864"
Evaluating: -33.2902864+3.5
 Parameter: ZMAX <- "-29.7902864"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.7352351"
Evaluating: -35.7352351-3.5
 Parameter: XMIN <- "-39.2352351"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.881009981"
Evaluating: 0.881009981-3.5
 Parameter: YMIN <- "-2.61899002"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.2902864"
Evaluating: -33.2902864-3.5
 Parameter: ZMIN <- "-36.7902864"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.2352351"
 Parameter: XMIN -> "-39.2352351"
 Parameter: YMAX -> "4.38100998"
 Parameter: YMIN -> "-2.61899002"
 Parameter: ZMAX -> "-29.7902864"
 Parameter: ZMIN -> "-36.7902864"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "93"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "93" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "93" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "65"
Evaluating: 93-65
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.874079834"
Evaluating: 90.067469*(0.874079834-0.5)
 Parameter: XPOS <- "33.6924239"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.510215731"
Evaluating: 90.067469*(0.510215731-0.5)
 Parameter: YPOS <- "0.920105035"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.56990267"
Evaluating: 143.194738*(0.56990267-0.5)+3.5172451
 Parameter: ZPOS <- "13.5269396"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "13.5269396" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "13.5269396" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "93" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "65"
Evaluating: 93-65
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.292592696"
Evaluating: 90.067469*(0.292592696-0.5)
 Parameter: XPOS <- "-18.6806509"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.207415299"
Evaluating: 90.067469*(0.207415299-0.5)
 Parameter: YPOS <- "-26.3523635"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.715098182"
Evaluating: 143.194738*(0.715098182-0.5)+3.5172451
 Parameter: ZPOS <- "34.3181729"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.3181729" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.3181729" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.6806509"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.6806509-0
 Parameter: XTRAN <- "-18.6806509"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.3523635"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.3523635-0
 Parameter: YTRAN <- "-26.3523635"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.3181729"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.3181729-0
 Parameter: ZTRAN <- "34.3181729"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.6806509"
 Parameter: YTRAN -> "-26.3523635"
 Parameter: ZTRAN -> "34.3181729"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -18.680651  -26.352363   34.318173
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.796420662"
Evaluating: 0.796420662*360.0
 Parameter: XPHI <- "286.711438"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.612637234"
Evaluating: 0.612637234*360.0
 Parameter: YPHI <- "220.549404"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.183294426"
Evaluating: 0.183294426*360.0
 Parameter: ZPHI <- "65.9859934"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.6806509"
 Parameter: YPOS -> "-26.3523635"
 Parameter: ZPOS -> "34.3181729"
 Parameter: XPHI -> "286.711438"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.287552   -0.957765
    0.000000    0.957765    0.287552

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   73.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.6806509"
 Parameter: YPOS -> "-26.3523635"
 Parameter: ZPOS -> "34.3181729"
 Parameter: YPHI -> "220.549404"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.759846    0.000000    0.650103
    0.000000    1.000000    0.000000
   -0.650103    0.000000   -0.759846

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  139.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.6806509"
 Parameter: YPOS -> "-26.3523635"
 Parameter: ZPOS -> "34.3181729"
 Parameter: ZPHI -> "65.9859934"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.406960    0.913446    0.000000
   -0.913446    0.406960    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   65.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.680651 XMAX =  -18.680651 XAVE =  -18.680651
    YMIN =  -26.352363 YMAX =  -26.352363 YAVE =  -26.352363
    ZMIN =   34.318173 ZMAX =   34.318173 ZAVE =   34.318173
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.6806509"
Evaluating: -18.6806509+3.5
 Parameter: XMAX <- "-15.1806509"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.3523635"
Evaluating: -26.3523635+3.5
 Parameter: YMAX <- "-22.8523635"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.3181729"
Evaluating: 34.3181729+3.5
 Parameter: ZMAX <- "37.8181729"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.6806509"
Evaluating: -18.6806509-3.5
 Parameter: XMIN <- "-22.1806509"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.3523635"
Evaluating: -26.3523635-3.5
 Parameter: YMIN <- "-29.8523635"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.3181729"
Evaluating: 34.3181729-3.5
 Parameter: ZMIN <- "30.8181729"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.1806509"
 Parameter: XMIN -> "-22.1806509"
 Parameter: YMAX -> "-22.8523635"
 Parameter: YMIN -> "-29.8523635"
 Parameter: ZMAX -> "37.8181729"
 Parameter: ZMIN -> "30.8181729"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "94"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "94" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "94"
Evaluating: 94
 Parameter: J <- "94"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "94" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "94"
 Parameter: NPOS -> "65"
Evaluating: 94-65
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.419853565"
Evaluating: 90.067469*(0.419853565-0.5)
 Parameter: XPOS <- "-7.21858655"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.843613179"
Evaluating: 90.067469*(0.843613179-0.5)
 Parameter: YPOS <- "30.9483693"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.758410525"
Evaluating: 143.194738*(0.758410525-0.5)+3.5172451
 Parameter: ZPOS <- "40.5202725"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "40.5202725" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "40.5202725" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.21858655"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -7.21858655-0
 Parameter: XTRAN <- "-7.21858655"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.9483693"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 30.9483693-0
 Parameter: YTRAN <- "30.9483693"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "40.5202725"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 40.5202725-0
 Parameter: ZTRAN <- "40.5202725"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.21858655"
 Parameter: YTRAN -> "30.9483693"
 Parameter: ZTRAN -> "40.5202725"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -7.218587   30.948369   40.520272
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.427304092"
Evaluating: 0.427304092*360.0
 Parameter: XPHI <- "153.829473"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.442900413"
Evaluating: 0.442900413*360.0
 Parameter: YPHI <- "159.444149"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.280452766"
Evaluating: 0.280452766*360.0
 Parameter: ZPHI <- "100.962996"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.21858655"
 Parameter: YPOS -> "30.9483693"
 Parameter: ZPOS -> "40.5202725"
 Parameter: XPHI -> "153.829473"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.897485    0.441044
    0.000000   -0.441044   -0.897485

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  153.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.21858655"
 Parameter: YPOS -> "30.9483693"
 Parameter: ZPOS -> "40.5202725"
 Parameter: YPHI -> "159.444149"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.936330    0.000000   -0.351120
    0.000000    1.000000    0.000000
    0.351120    0.000000   -0.936330

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  159.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.21858655"
 Parameter: YPOS -> "30.9483693"
 Parameter: ZPOS -> "40.5202725"
 Parameter: ZPHI -> "100.962996"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.190175    0.981750    0.000000
   -0.981750   -0.190175    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  100.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.218587 XMAX =   -7.218587 XAVE =   -7.218587
    YMIN =   30.948369 YMAX =   30.948369 YAVE =   30.948369
    ZMIN =   40.520272 ZMAX =   40.520272 ZAVE =   40.520272
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.21858655"
Evaluating: -7.21858655+3.5
 Parameter: XMAX <- "-3.71858655"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.9483693"
Evaluating: 30.9483693+3.5
 Parameter: YMAX <- "34.4483693"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "40.5202725"
Evaluating: 40.5202725+3.5
 Parameter: ZMAX <- "44.0202725"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.21858655"
Evaluating: -7.21858655-3.5
 Parameter: XMIN <- "-10.7185866"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.9483693"
Evaluating: 30.9483693-3.5
 Parameter: YMIN <- "27.4483693"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "40.5202725"
Evaluating: 40.5202725-3.5
 Parameter: ZMIN <- "37.0202725"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-3.71858655"
 Parameter: XMIN -> "-10.7185866"
 Parameter: YMAX -> "34.4483693"
 Parameter: YMIN -> "27.4483693"
 Parameter: ZMAX -> "44.0202725"
 Parameter: ZMIN -> "37.0202725"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "95"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "95" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "95" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "95"
 Parameter: NPOS -> "65"
Evaluating: 95-65
 Parameter: J <- "30"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.146611047"
Evaluating: 90.067469*(0.146611047-0.5)
 Parameter: XPOS <- "-31.8288486"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.777681205"
Evaluating: 90.067469*(0.777681205-0.5)
 Parameter: YPOS <- "25.0100433"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.930050856"
Evaluating: 143.194738*(0.930050856-0.5)+3.5172451
 Parameter: ZPOS <- "65.0982648"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "65.0982648" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "65.0982648" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.8288486"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.8288486-0
 Parameter: XTRAN <- "-31.8288486"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.0100433"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 25.0100433-0
 Parameter: YTRAN <- "25.0100433"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "65.0982648"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 65.0982648-0
 Parameter: ZTRAN <- "65.0982648"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.8288486"
 Parameter: YTRAN -> "25.0100433"
 Parameter: ZTRAN -> "65.0982648"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -31.828849   25.010043   65.098265
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.919295021"
Evaluating: 0.919295021*360.0
 Parameter: XPHI <- "330.946208"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.385984994"
Evaluating: 0.385984994*360.0
 Parameter: YPHI <- "138.954598"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.834233942"
Evaluating: 0.834233942*360.0
 Parameter: ZPHI <- "300.324219"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.8288486"
 Parameter: YPOS -> "25.0100433"
 Parameter: ZPOS -> "65.0982648"
 Parameter: XPHI -> "330.946208"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.874164   -0.485631
    0.000000    0.485631    0.874164

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   29.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.8288486"
 Parameter: YPOS -> "25.0100433"
 Parameter: ZPOS -> "65.0982648"
 Parameter: YPHI -> "138.954598"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.754189    0.000000   -0.656657
    0.000000    1.000000    0.000000
    0.656657    0.000000   -0.754189

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  138.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.8288486"
 Parameter: YPOS -> "25.0100433"
 Parameter: ZPOS -> "65.0982648"
 Parameter: ZPHI -> "300.324219"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.504893   -0.863182    0.000000
    0.863182    0.504893    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   59.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.828849 XMAX =  -31.828849 XAVE =  -31.828849
    YMIN =   25.010043 YMAX =   25.010043 YAVE =   25.010043
    ZMIN =   65.098265 ZMAX =   65.098265 ZAVE =   65.098265
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.8288486"
Evaluating: -31.8288486+3.5
 Parameter: XMAX <- "-28.3288486"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.0100433"
Evaluating: 25.0100433+3.5
 Parameter: YMAX <- "28.5100433"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "65.0982648"
Evaluating: 65.0982648+3.5
 Parameter: ZMAX <- "68.5982648"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.8288486"
Evaluating: -31.8288486-3.5
 Parameter: XMIN <- "-35.3288486"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.0100433"
Evaluating: 25.0100433-3.5
 Parameter: YMIN <- "21.5100433"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "65.0982648"
Evaluating: 65.0982648-3.5
 Parameter: ZMIN <- "61.5982648"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.3288486"
 Parameter: XMIN -> "-35.3288486"
 Parameter: YMAX -> "28.5100433"
 Parameter: YMIN -> "21.5100433"
 Parameter: ZMAX -> "68.5982648"
 Parameter: ZMIN -> "61.5982648"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "96"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "96" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "96" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "96"
 Parameter: NPOS -> "65"
Evaluating: 96-65
 Parameter: J <- "31"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.686155395"
Evaluating: 90.067469*(0.686155395-0.5)
 Parameter: XPOS <- "16.7665453"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "6.377264166E-03"
Evaluating: 90.067469*(6.377264166E-03-0.5)
 Parameter: YPOS <- "-44.4593505"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.511985021"
Evaluating: 143.194738*(0.511985021-0.5)+3.5172451
 Parameter: ZPOS <- "5.23343704"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "5.23343704" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "5.23343704" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "96" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "96"
 Parameter: NPOS -> "65"
Evaluating: 96-65
 Parameter: J <- "31"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.797192258"
Evaluating: 90.067469*(0.797192258-0.5)
 Parameter: XPOS <- "26.7673545"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.209629348"
Evaluating: 90.067469*(0.209629348-0.5)
 Parameter: YPOS <- "-26.1529497"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.356787274"
Evaluating: 143.194738*(0.356787274-0.5)+3.5172451
 Parameter: ZPOS <- "-16.9900637"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.9900637" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.7673545"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.7673545-0
 Parameter: XTRAN <- "26.7673545"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.1529497"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -26.1529497-0
 Parameter: YTRAN <- "-26.1529497"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.9900637"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.9900637-0
 Parameter: ZTRAN <- "-16.9900637"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.7673545"
 Parameter: YTRAN -> "-26.1529497"
 Parameter: ZTRAN -> "-16.9900637"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    26.767354  -26.152950  -16.990064
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.974008969"
Evaluating: 0.974008969*360.0
 Parameter: XPHI <- "350.643229"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.245476273"
Evaluating: 0.245476273*360.0
 Parameter: YPHI <- "88.3714583"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.970763526"
Evaluating: 0.970763526*360.0
 Parameter: ZPHI <- "349.474869"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.7673545"
 Parameter: YPOS -> "-26.1529497"
 Parameter: ZPOS -> "-16.9900637"
 Parameter: XPHI -> "350.643229"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.986695   -0.162582
    0.000000    0.162582    0.986695

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    9.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.7673545"
 Parameter: YPOS -> "-26.1529497"
 Parameter: ZPOS -> "-16.9900637"
 Parameter: YPHI -> "88.3714583"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.028420    0.000000   -0.999596
    0.000000    1.000000    0.000000
    0.999596    0.000000    0.028420

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   88.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.7673545"
 Parameter: YPOS -> "-26.1529497"
 Parameter: ZPOS -> "-16.9900637"
 Parameter: ZPHI -> "349.474869"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.983175   -0.182667    0.000000
    0.182667    0.983175    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   10.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.767354 XMAX =   26.767354 XAVE =   26.767354
    YMIN =  -26.152950 YMAX =  -26.152950 YAVE =  -26.152950
    ZMIN =  -16.990064 ZMAX =  -16.990064 ZAVE =  -16.990064
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.7673545"
Evaluating: 26.7673545+3.5
 Parameter: XMAX <- "30.2673545"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.1529497"
Evaluating: -26.1529497+3.5
 Parameter: YMAX <- "-22.6529497"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.9900637"
Evaluating: -16.9900637+3.5
 Parameter: ZMAX <- "-13.4900637"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.7673545"
Evaluating: 26.7673545-3.5
 Parameter: XMIN <- "23.2673545"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.1529497"
Evaluating: -26.1529497-3.5
 Parameter: YMIN <- "-29.6529497"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.9900637"
Evaluating: -16.9900637-3.5
 Parameter: ZMIN <- "-20.4900637"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.2673545"
 Parameter: XMIN -> "23.2673545"
 Parameter: YMAX -> "-22.6529497"
 Parameter: YMIN -> "-29.6529497"
 Parameter: ZMAX -> "-13.4900637"
 Parameter: ZMIN -> "-20.4900637"
 SELRPN>     12 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      4 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35057 NEG      CLA      31       CLA     -**** MEMB     POPC     149      C14           3.9386
35057 NEG      CLA      31       CLA     -**** MEMB     POPC     149      O22           3.1387
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "96" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "96"
 Parameter: NPOS -> "65"
Evaluating: 96-65
 Parameter: J <- "31"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.912700363"
Evaluating: 90.067469*(0.912700363-0.5)
 Parameter: XPOS <- "37.1708772"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.265454986"
Evaluating: 90.067469*(0.265454986-0.5)
 Parameter: YPOS <- "-21.1248758"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.899147194"
Evaluating: 143.194738*(0.899147194-0.5)+3.5172451
 Parameter: ZPOS <- "60.673023"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "60.673023" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "60.673023" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.767354 XMAX =   26.767354 XAVE =   26.767354
    YMIN =  -26.152950 YMAX =  -26.152950 YAVE =  -26.152950
    ZMIN =  -16.990064 ZMAX =  -16.990064 ZAVE =  -16.990064
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.1708772"
 RDCMND substituted energy or value "?XAVE" to "26.7673545"
Evaluating: 37.1708772-26.7673545
 Parameter: XTRAN <- "10.4035227"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.1248758"
 RDCMND substituted energy or value "?YAVE" to "-26.1529497"
Evaluating: -21.1248758--26.1529497
 Parameter: YTRAN <- "5.0280739"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "60.673023"
 RDCMND substituted energy or value "?ZAVE" to "-16.9900637"
Evaluating: 60.673023--16.9900637
 Parameter: ZTRAN <- "77.6630867"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.4035227"
 Parameter: YTRAN -> "5.0280739"
 Parameter: ZTRAN -> "77.6630867"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    10.403523    5.028074   77.663087
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.217454776"
Evaluating: 0.217454776*360.0
 Parameter: XPHI <- "78.2837194"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.548028223"
Evaluating: 0.548028223*360.0
 Parameter: YPHI <- "197.29016"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.860214091"
Evaluating: 0.860214091*360.0
 Parameter: ZPHI <- "309.677073"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.1708772"
 Parameter: YPOS -> "-21.1248758"
 Parameter: ZPOS -> "60.673023"
 Parameter: XPHI -> "78.2837194"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.203066    0.979165
    0.000000   -0.979165    0.203066

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   78.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.1708772"
 Parameter: YPOS -> "-21.1248758"
 Parameter: ZPOS -> "60.673023"
 Parameter: YPHI -> "197.29016"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.954812    0.000000    0.297211
    0.000000    1.000000    0.000000
   -0.297211    0.000000   -0.954812

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  162.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.1708772"
 Parameter: YPOS -> "-21.1248758"
 Parameter: ZPOS -> "60.673023"
 Parameter: ZPHI -> "309.677073"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.638460   -0.769655    0.000000
    0.769655    0.638460    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   50.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.170877 XMAX =   37.170877 XAVE =   37.170877
    YMIN =  -21.124876 YMAX =  -21.124876 YAVE =  -21.124876
    ZMIN =   60.673023 ZMAX =   60.673023 ZAVE =   60.673023
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.1708772"
Evaluating: 37.1708772+3.5
 Parameter: XMAX <- "40.6708772"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.1248758"
Evaluating: -21.1248758+3.5
 Parameter: YMAX <- "-17.6248758"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "60.673023"
Evaluating: 60.673023+3.5
 Parameter: ZMAX <- "64.173023"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.1708772"
Evaluating: 37.1708772-3.5
 Parameter: XMIN <- "33.6708772"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.1248758"
Evaluating: -21.1248758-3.5
 Parameter: YMIN <- "-24.6248758"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "60.673023"
Evaluating: 60.673023-3.5
 Parameter: ZMIN <- "57.173023"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.6708772"
 Parameter: XMIN -> "33.6708772"
 Parameter: YMAX -> "-17.6248758"
 Parameter: YMIN -> "-24.6248758"
 Parameter: ZMAX -> "64.173023"
 Parameter: ZMIN -> "57.173023"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "97"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "97" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "97" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "97"
 Parameter: NPOS -> "65"
Evaluating: 97-65
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.817688582"
Evaluating: 90.067469*(0.817688582-0.5)
 Parameter: XPOS <- "28.6134065"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.4726803"
Evaluating: 90.067469*(0.4726803-0.5)
 Parameter: YPOS <- "-2.46061623"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.374440585"
Evaluating: 143.194738*(0.374440585-0.5)+3.5172451
 Parameter: ZPOS <- "-14.4622024"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-14.4622024" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-14.4622024" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "97" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "97"
 Parameter: NPOS -> "65"
Evaluating: 97-65
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.63354868"
Evaluating: 90.067469*(0.63354868-0.5)
 Parameter: XPOS <- "12.0283916"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.720913693"
Evaluating: 90.067469*(0.720913693-0.5)
 Parameter: YPOS <- "19.8971372"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.270407076"
Evaluating: 143.194738*(0.270407076-0.5)+3.5172451
 Parameter: ZPOS <- "-29.3592535"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.3592535" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.0283916"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 12.0283916-0
 Parameter: XTRAN <- "12.0283916"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.8971372"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 19.8971372-0
 Parameter: YTRAN <- "19.8971372"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.3592535"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.3592535-0
 Parameter: ZTRAN <- "-29.3592535"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.0283916"
 Parameter: YTRAN -> "19.8971372"
 Parameter: ZTRAN -> "-29.3592535"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    12.028392   19.897137  -29.359254
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.190999539"
Evaluating: 0.190999539*360.0
 Parameter: XPHI <- "68.759834"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.438371296"
Evaluating: 0.438371296*360.0
 Parameter: YPHI <- "157.813667"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.503114383"
Evaluating: 0.503114383*360.0
 Parameter: ZPHI <- "181.121178"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.0283916"
 Parameter: YPOS -> "19.8971372"
 Parameter: ZPOS -> "-29.3592535"
 Parameter: XPHI -> "68.759834"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.362278    0.932070
    0.000000   -0.932070    0.362278

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   68.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.0283916"
 Parameter: YPOS -> "19.8971372"
 Parameter: ZPOS -> "-29.3592535"
 Parameter: YPHI -> "157.813667"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.925961    0.000000   -0.377620
    0.000000    1.000000    0.000000
    0.377620    0.000000   -0.925961

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  157.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.0283916"
 Parameter: YPOS -> "19.8971372"
 Parameter: ZPOS -> "-29.3592535"
 Parameter: ZPHI -> "181.121178"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.999809   -0.019567    0.000000
    0.019567   -0.999809    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  178.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.028392 XMAX =   12.028392 XAVE =   12.028392
    YMIN =   19.897137 YMAX =   19.897137 YAVE =   19.897137
    ZMIN =  -29.359254 ZMAX =  -29.359254 ZAVE =  -29.359254
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.0283916"
Evaluating: 12.0283916+3.5
 Parameter: XMAX <- "15.5283916"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.8971372"
Evaluating: 19.8971372+3.5
 Parameter: YMAX <- "23.3971372"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.3592535"
Evaluating: -29.3592535+3.5
 Parameter: ZMAX <- "-25.8592535"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.0283916"
Evaluating: 12.0283916-3.5
 Parameter: XMIN <- "8.5283916"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.8971372"
Evaluating: 19.8971372-3.5
 Parameter: YMIN <- "16.3971372"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.3592535"
Evaluating: -29.3592535-3.5
 Parameter: ZMIN <- "-32.8592535"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.5283916"
 Parameter: XMIN -> "8.5283916"
 Parameter: YMAX -> "23.3971372"
 Parameter: YMIN -> "16.3971372"
 Parameter: ZMAX -> "-25.8592535"
 Parameter: ZMIN -> "-32.8592535"
 SELRPN>     27 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     14 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35058 NEG      CLA      32       CLA     -4329 PROA     GLU      298      CA            3.2854
35058 NEG      CLA      32       CLA     -4331 PROA     GLU      298      CB            2.9163
35058 NEG      CLA      32       CLA     -4334 PROA     GLU      298      CG            4.3991
35058 NEG      CLA      32       CLA     -4340 PROA     GLU      298      C             2.7034
35058 NEG      CLA      32       CLA     -4341 PROA     GLU      298      O             3.2588
35058 NEG      CLA      32       CLA     -4342 PROA     GLN      299      N             2.5527
35058 NEG      CLA      32       CLA     -4344 PROA     GLN      299      CA            3.1440
35058 NEG      CLA      32       CLA     -4346 PROA     GLN      299      CB            3.4302
35058 NEG      CLA      32       CLA     -4349 PROA     GLN      299      CG            2.6684
35058 NEG      CLA      32       CLA     -4352 PROA     GLN      299      CD            2.5957
35058 NEG      CLA      32       CLA     -4353 PROA     GLN      299      OE1           3.7845
35058 NEG      CLA      32       CLA     -4354 PROA     GLN      299      NE2           1.8277
35058 NEG      CLA      32       CLA     -4357 PROA     GLN      299      C             4.6254
35058 NEG      CLA      32       CLA     -4413 PROA     CYS      303      SG            4.1264
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        14
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "14"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "97" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "97"
 Parameter: NPOS -> "65"
Evaluating: 97-65
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "2.889868865E-02"
Evaluating: 90.067469*(2.889868865E-02-0.5)
 Parameter: XPOS <- "-42.4309028"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.99411374"
Evaluating: 90.067469*(0.99411374-0.5)
 Parameter: YPOS <- "44.503574"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.576705665"
Evaluating: 143.194738*(0.576705665-0.5)+3.5172451
 Parameter: ZPOS <- "14.5010927"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.5010927" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.5010927" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "97" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "97"
 Parameter: NPOS -> "65"
Evaluating: 97-65
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.249384497"
Evaluating: 90.067469*(0.249384497-0.5)
 Parameter: XPOS <- "-22.572304"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "9.029799607E-02"
Evaluating: 90.067469*(9.029799607E-02-0.5)
 Parameter: YPOS <- "-36.9008225"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.364103281"
Evaluating: 143.194738*(0.364103281-0.5)+3.5172451
 Parameter: ZPOS <- "-15.94245"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-15.94245" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.028392 XMAX =   12.028392 XAVE =   12.028392
    YMIN =   19.897137 YMAX =   19.897137 YAVE =   19.897137
    ZMIN =  -29.359254 ZMAX =  -29.359254 ZAVE =  -29.359254
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.572304"
 RDCMND substituted energy or value "?XAVE" to "12.0283916"
Evaluating: -22.572304-12.0283916
 Parameter: XTRAN <- "-34.6006956"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.9008225"
 RDCMND substituted energy or value "?YAVE" to "19.8971372"
Evaluating: -36.9008225-19.8971372
 Parameter: YTRAN <- "-56.7979597"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.94245"
 RDCMND substituted energy or value "?ZAVE" to "-29.3592535"
Evaluating: -15.94245--29.3592535
 Parameter: ZTRAN <- "13.4168035"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.6006956"
 Parameter: YTRAN -> "-56.7979597"
 Parameter: ZTRAN -> "13.4168035"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -34.600696  -56.797960   13.416804
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.584952521"
Evaluating: 0.584952521*360.0
 Parameter: XPHI <- "210.582908"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.998417735"
Evaluating: 0.998417735*360.0
 Parameter: YPHI <- "359.430385"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.72340394"
Evaluating: 0.72340394*360.0
 Parameter: ZPHI <- "260.425418"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.572304"
 Parameter: YPOS -> "-36.9008225"
 Parameter: ZPOS -> "-15.94245"
 Parameter: XPHI -> "210.582908"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.860894   -0.508785
    0.000000    0.508785   -0.860894

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  149.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.572304"
 Parameter: YPOS -> "-36.9008225"
 Parameter: ZPOS -> "-15.94245"
 Parameter: YPHI -> "359.430385"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.999951    0.000000    0.009941
    0.000000    1.000000    0.000000
   -0.009941    0.000000    0.999951

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    0.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.572304"
 Parameter: YPOS -> "-36.9008225"
 Parameter: ZPOS -> "-15.94245"
 Parameter: ZPHI -> "260.425418"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.166331   -0.986070    0.000000
    0.986070   -0.166331    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   99.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.572304 XMAX =  -22.572304 XAVE =  -22.572304
    YMIN =  -36.900823 YMAX =  -36.900823 YAVE =  -36.900823
    ZMIN =  -15.942450 ZMAX =  -15.942450 ZAVE =  -15.942450
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.572304"
Evaluating: -22.572304+3.5
 Parameter: XMAX <- "-19.072304"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.9008225"
Evaluating: -36.9008225+3.5
 Parameter: YMAX <- "-33.4008225"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.94245"
Evaluating: -15.94245+3.5
 Parameter: ZMAX <- "-12.44245"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.572304"
Evaluating: -22.572304-3.5
 Parameter: XMIN <- "-26.072304"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.9008225"
Evaluating: -36.9008225-3.5
 Parameter: YMIN <- "-40.4008225"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.94245"
Evaluating: -15.94245-3.5
 Parameter: ZMIN <- "-19.44245"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.072304"
 Parameter: XMIN -> "-26.072304"
 Parameter: YMAX -> "-33.4008225"
 Parameter: YMIN -> "-40.4008225"
 Parameter: ZMAX -> "-12.44245"
 Parameter: ZMIN -> "-19.44245"
 SELRPN>     25 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     11 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35058 NEG      CLA      32       CLA     -**** MEMB     POPC     167      N             3.1034
35058 NEG      CLA      32       CLA     -**** MEMB     POPC     167      C13           2.8677
35058 NEG      CLA      32       CLA     -**** MEMB     POPC     167      C14           3.9928
35058 NEG      CLA      32       CLA     -**** MEMB     POPC     167      C15           2.2876
35058 NEG      CLA      32       CLA     -**** MEMB     POPC     167      O12           3.9441
35058 NEG      CLA      32       CLA     -**** MEMB     POPC     167      C3            3.5464
35058 NEG      CLA      32       CLA     -**** MEMB     POPC     167      C24           3.9447
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "97" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "97"
 Parameter: NPOS -> "65"
Evaluating: 97-65
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.393576518"
Evaluating: 90.067469*(0.393576518-0.5)
 Parameter: XPOS <- "-9.58529367"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "9.199811364E-02"
Evaluating: 90.067469*(9.199811364E-02-0.5)
 Parameter: YPOS <- "-36.7476973"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.675321379"
Evaluating: 143.194738*(0.675321379-0.5)+3.5172451
 Parameter: ZPOS <- "28.622344"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.622344" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.622344" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.572304 XMAX =  -22.572304 XAVE =  -22.572304
    YMIN =  -36.900823 YMAX =  -36.900823 YAVE =  -36.900823
    ZMIN =  -15.942450 ZMAX =  -15.942450 ZAVE =  -15.942450
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.58529367"
 RDCMND substituted energy or value "?XAVE" to "-22.572304"
Evaluating: -9.58529367--22.572304
 Parameter: XTRAN <- "12.9870103"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.7476973"
 RDCMND substituted energy or value "?YAVE" to "-36.9008225"
Evaluating: -36.7476973--36.9008225
 Parameter: YTRAN <- "0.1531252"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.622344"
 RDCMND substituted energy or value "?ZAVE" to "-15.94245"
Evaluating: 28.622344--15.94245
 Parameter: ZTRAN <- "44.564794"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.9870103"
 Parameter: YTRAN -> "0.1531252"
 Parameter: ZTRAN -> "44.564794"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    12.987010    0.153125   44.564794
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.244330592"
Evaluating: 0.244330592*360.0
 Parameter: XPHI <- "87.9590131"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.236896041"
Evaluating: 0.236896041*360.0
 Parameter: YPHI <- "85.2825748"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.355937354"
Evaluating: 0.355937354*360.0
 Parameter: ZPHI <- "128.137447"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.58529367"
 Parameter: YPOS -> "-36.7476973"
 Parameter: ZPOS -> "28.622344"
 Parameter: XPHI -> "87.9590131"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.035614    0.999366
    0.000000   -0.999366    0.035614

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   87.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.58529367"
 Parameter: YPOS -> "-36.7476973"
 Parameter: ZPOS -> "28.622344"
 Parameter: YPHI -> "85.2825748"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.082242    0.000000   -0.996612
    0.000000    1.000000    0.000000
    0.996612    0.000000    0.082242

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   85.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.58529367"
 Parameter: YPOS -> "-36.7476973"
 Parameter: ZPOS -> "28.622344"
 Parameter: ZPHI -> "128.137447"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.617550    0.786532    0.000000
   -0.786532   -0.617550    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  128.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.585294 XMAX =   -9.585294 XAVE =   -9.585294
    YMIN =  -36.747697 YMAX =  -36.747697 YAVE =  -36.747697
    ZMIN =   28.622344 ZMAX =   28.622344 ZAVE =   28.622344
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.58529367"
Evaluating: -9.58529367+3.5
 Parameter: XMAX <- "-6.08529367"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.7476973"
Evaluating: -36.7476973+3.5
 Parameter: YMAX <- "-33.2476973"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.622344"
Evaluating: 28.622344+3.5
 Parameter: ZMAX <- "32.122344"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.58529367"
Evaluating: -9.58529367-3.5
 Parameter: XMIN <- "-13.0852937"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.7476973"
Evaluating: -36.7476973-3.5
 Parameter: YMIN <- "-40.2476973"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.622344"
Evaluating: 28.622344-3.5
 Parameter: ZMIN <- "25.122344"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.08529367"
 Parameter: XMIN -> "-13.0852937"
 Parameter: YMAX -> "-33.2476973"
 Parameter: YMIN -> "-40.2476973"
 Parameter: ZMAX -> "32.122344"
 Parameter: ZMIN -> "25.122344"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "98"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "98" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "98" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "98"
 Parameter: NPOS -> "65"
Evaluating: 98-65
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "9.227070415E-02"
Evaluating: 90.067469*(9.227070415E-02-0.5)
 Parameter: XPOS <- "-36.7231457"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.954478499"
Evaluating: 90.067469*(0.954478499-0.5)
 Parameter: YPOS <- "40.9337281"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.54190929"
Evaluating: 143.194738*(0.54190929-0.5)+3.5172451
 Parameter: ZPOS <- "9.5184349"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.5184349" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.5184349" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "98" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "98"
 Parameter: NPOS -> "65"
Evaluating: 98-65
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.840186893"
Evaluating: 90.067469*(0.840186893-0.5)
 Parameter: XPOS <- "30.6397724"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.32100659"
Evaluating: 90.067469*(0.32100659-0.5)
 Parameter: YPOS <- "-16.1214834"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.411250333"
Evaluating: 143.194738*(0.411250333-0.5)+3.5172451
 Parameter: ZPOS <- "-9.19124021"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-9.19124021" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-9.19124021" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "98" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "98"
 Parameter: NPOS -> "65"
Evaluating: 98-65
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.875712161"
Evaluating: 90.067469*(0.875712161-0.5)
 Parameter: XPOS <- "33.8394434"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.61996499"
Evaluating: 90.067469*(0.61996499-0.5)
 Parameter: YPOS <- "10.804943"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.158242757"
Evaluating: 143.194738*(0.158242757-0.5)+3.5172451
 Parameter: ZPOS <- "-45.4205938"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-45.4205938" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.8394434"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 33.8394434-0
 Parameter: XTRAN <- "33.8394434"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.804943"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.804943-0
 Parameter: YTRAN <- "10.804943"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-45.4205938"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -45.4205938-0
 Parameter: ZTRAN <- "-45.4205938"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "33.8394434"
 Parameter: YTRAN -> "10.804943"
 Parameter: ZTRAN -> "-45.4205938"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    33.839443   10.804943  -45.420594
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.84768481"
Evaluating: 0.84768481*360.0
 Parameter: XPHI <- "305.166532"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.233344104"
Evaluating: 0.233344104*360.0
 Parameter: YPHI <- "84.0038774"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.824960201"
Evaluating: 0.824960201*360.0
 Parameter: ZPHI <- "296.985672"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.8394434"
 Parameter: YPOS -> "10.804943"
 Parameter: ZPOS -> "-45.4205938"
 Parameter: XPHI -> "305.166532"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.575955   -0.817481
    0.000000    0.817481    0.575955

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   54.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.8394434"
 Parameter: YPOS -> "10.804943"
 Parameter: ZPOS -> "-45.4205938"
 Parameter: YPHI -> "84.0038774"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.104461    0.000000   -0.994529
    0.000000    1.000000    0.000000
    0.994529    0.000000    0.104461

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   84.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.8394434"
 Parameter: YPOS -> "10.804943"
 Parameter: ZPOS -> "-45.4205938"
 Parameter: ZPHI -> "296.985672"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.453768   -0.891120    0.000000
    0.891120    0.453768    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   63.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.839443 XMAX =   33.839443 XAVE =   33.839443
    YMIN =   10.804943 YMAX =   10.804943 YAVE =   10.804943
    ZMIN =  -45.420594 ZMAX =  -45.420594 ZAVE =  -45.420594
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.8394434"
Evaluating: 33.8394434+3.5
 Parameter: XMAX <- "37.3394434"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.804943"
Evaluating: 10.804943+3.5
 Parameter: YMAX <- "14.304943"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-45.4205938"
Evaluating: -45.4205938+3.5
 Parameter: ZMAX <- "-41.9205938"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.8394434"
Evaluating: 33.8394434-3.5
 Parameter: XMIN <- "30.3394434"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.804943"
Evaluating: 10.804943-3.5
 Parameter: YMIN <- "7.304943"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-45.4205938"
Evaluating: -45.4205938-3.5
 Parameter: ZMIN <- "-48.9205938"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.3394434"
 Parameter: XMIN -> "30.3394434"
 Parameter: YMAX -> "14.304943"
 Parameter: YMIN -> "7.304943"
 Parameter: ZMAX -> "-41.9205938"
 Parameter: ZMIN -> "-48.9205938"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "99"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "99" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "99" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "99"
 Parameter: NPOS -> "65"
Evaluating: 99-65
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.946928713"
Evaluating: 90.067469*(0.946928713-0.5)
 Parameter: XPOS <- "40.253738"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.490440507"
Evaluating: 90.067469*(0.490440507-0.5)
 Parameter: YPOS <- "-0.860999339"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.536604058"
Evaluating: 143.194738*(0.536604058-0.5)+3.5172451
 Parameter: ZPOS <- "8.7587536"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.7587536" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.7587536" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "99" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "99"
 Parameter: NPOS -> "65"
Evaluating: 99-65
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.628571363"
Evaluating: 90.067469*(0.628571363-0.5)
 Parameter: XPOS <- "11.5800973"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.435073764"
Evaluating: 90.067469*(0.435073764-0.5)
 Parameter: YPOS <- "-5.84774175"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.362529278"
Evaluating: 143.194738*(0.362529278-0.5)+3.5172451
 Parameter: ZPOS <- "-16.1678389"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.1678389" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.5800973"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.5800973-0
 Parameter: XTRAN <- "11.5800973"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.84774175"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.84774175-0
 Parameter: YTRAN <- "-5.84774175"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.1678389"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.1678389-0
 Parameter: ZTRAN <- "-16.1678389"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.5800973"
 Parameter: YTRAN -> "-5.84774175"
 Parameter: ZTRAN -> "-16.1678389"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    11.580097   -5.847742  -16.167839
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.270270599"
Evaluating: 0.270270599*360.0
 Parameter: XPHI <- "97.2974156"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.973562056"
Evaluating: 0.973562056*360.0
 Parameter: YPHI <- "350.48234"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.878942712"
Evaluating: 0.878942712*360.0
 Parameter: ZPHI <- "316.419376"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.5800973"
 Parameter: YPOS -> "-5.84774175"
 Parameter: ZPOS -> "-16.1678389"
 Parameter: XPHI -> "97.2974156"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.127020    0.991900
    0.000000   -0.991900   -0.127020

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   97.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.5800973"
 Parameter: YPOS -> "-5.84774175"
 Parameter: ZPOS -> "-16.1678389"
 Parameter: YPHI -> "350.48234"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.986235    0.000000    0.165352
    0.000000    1.000000    0.000000
   -0.165352    0.000000    0.986235

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    9.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.5800973"
 Parameter: YPOS -> "-5.84774175"
 Parameter: ZPOS -> "-16.1678389"
 Parameter: ZPHI -> "316.419376"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.724405   -0.689375    0.000000
    0.689375    0.724405    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   43.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.580097 XMAX =   11.580097 XAVE =   11.580097
    YMIN =   -5.847742 YMAX =   -5.847742 YAVE =   -5.847742
    ZMIN =  -16.167839 ZMAX =  -16.167839 ZAVE =  -16.167839
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.5800973"
Evaluating: 11.5800973+3.5
 Parameter: XMAX <- "15.0800973"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.84774175"
Evaluating: -5.84774175+3.5
 Parameter: YMAX <- "-2.34774175"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.1678389"
Evaluating: -16.1678389+3.5
 Parameter: ZMAX <- "-12.6678389"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.5800973"
Evaluating: 11.5800973-3.5
 Parameter: XMIN <- "8.0800973"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.84774175"
Evaluating: -5.84774175-3.5
 Parameter: YMIN <- "-9.34774175"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.1678389"
Evaluating: -16.1678389-3.5
 Parameter: ZMIN <- "-19.6678389"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.0800973"
 Parameter: XMIN -> "8.0800973"
 Parameter: YMAX -> "-2.34774175"
 Parameter: YMIN -> "-9.34774175"
 Parameter: ZMAX -> "-12.6678389"
 Parameter: ZMIN -> "-19.6678389"
 SELRPN>     20 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      9 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35060 NEG      CLA      34       CLA     -3165 PROA     ARG      223      N             2.7106
35060 NEG      CLA      34       CLA     -3167 PROA     ARG      223      CA            2.4714
35060 NEG      CLA      34       CLA     -3169 PROA     ARG      223      CB            1.8711
35060 NEG      CLA      34       CLA     -3172 PROA     ARG      223      CG            2.9591
35060 NEG      CLA      34       CLA     -3175 PROA     ARG      223      CD            4.3147
35060 NEG      CLA      34       CLA     -3187 PROA     ARG      223      C             2.7666
35060 NEG      CLA      34       CLA     -3188 PROA     ARG      223      O             3.7591
35060 NEG      CLA      34       CLA     -3189 PROA     THR      224      N             2.7381
35060 NEG      CLA      34       CLA     -3195 PROA     THR      224      OG1           3.6419
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "99" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "99"
 Parameter: NPOS -> "65"
Evaluating: 99-65
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.361889932"
Evaluating: 90.067469*(0.361889932-0.5)
 Parameter: XPOS <- "-12.4392243"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.350976469"
Evaluating: 90.067469*(0.350976469-0.5)
 Parameter: YPOS <- "-13.4221723"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.36220845"
Evaluating: 143.194738*(0.36220845-0.5)+3.5172451
 Parameter: ZPOS <- "-16.2137798"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.2137798" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.580097 XMAX =   11.580097 XAVE =   11.580097
    YMIN =   -5.847742 YMAX =   -5.847742 YAVE =   -5.847742
    ZMIN =  -16.167839 ZMAX =  -16.167839 ZAVE =  -16.167839
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-12.4392243"
 RDCMND substituted energy or value "?XAVE" to "11.5800973"
Evaluating: -12.4392243-11.5800973
 Parameter: XTRAN <- "-24.0193216"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.4221723"
 RDCMND substituted energy or value "?YAVE" to "-5.84774175"
Evaluating: -13.4221723--5.84774175
 Parameter: YTRAN <- "-7.57443055"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.2137798"
 RDCMND substituted energy or value "?ZAVE" to "-16.1678389"
Evaluating: -16.2137798--16.1678389
 Parameter: ZTRAN <- "-4.59409E-02"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.0193216"
 Parameter: YTRAN -> "-7.57443055"
 Parameter: ZTRAN -> "-4.59409E-02"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -24.019322   -7.574431   -0.045941
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.532456391"
Evaluating: 0.532456391*360.0
 Parameter: XPHI <- "191.684301"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.872050333"
Evaluating: 0.872050333*360.0
 Parameter: YPHI <- "313.93812"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.815342243"
Evaluating: 0.815342243*360.0
 Parameter: ZPHI <- "293.523207"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-12.4392243"
 Parameter: YPOS -> "-13.4221723"
 Parameter: ZPOS -> "-16.2137798"
 Parameter: XPHI -> "191.684301"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.979278   -0.202519
    0.000000    0.202519   -0.979278

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  168.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-12.4392243"
 Parameter: YPOS -> "-13.4221723"
 Parameter: ZPOS -> "-16.2137798"
 Parameter: YPHI -> "313.93812"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.693881    0.000000    0.720090
    0.000000    1.000000    0.000000
   -0.720090    0.000000    0.693881

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   46.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-12.4392243"
 Parameter: YPOS -> "-13.4221723"
 Parameter: ZPOS -> "-16.2137798"
 Parameter: ZPHI -> "293.523207"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.399120   -0.916898    0.000000
    0.916898    0.399120    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   66.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.439224 XMAX =  -12.439224 XAVE =  -12.439224
    YMIN =  -13.422172 YMAX =  -13.422172 YAVE =  -13.422172
    ZMIN =  -16.213780 ZMAX =  -16.213780 ZAVE =  -16.213780
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-12.4392243"
Evaluating: -12.4392243+3.5
 Parameter: XMAX <- "-8.9392243"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.4221723"
Evaluating: -13.4221723+3.5
 Parameter: YMAX <- "-9.9221723"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.2137798"
Evaluating: -16.2137798+3.5
 Parameter: ZMAX <- "-12.7137798"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-12.4392243"
Evaluating: -12.4392243-3.5
 Parameter: XMIN <- "-15.9392243"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.4221723"
Evaluating: -13.4221723-3.5
 Parameter: YMIN <- "-16.9221723"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.2137798"
Evaluating: -16.2137798-3.5
 Parameter: ZMIN <- "-19.7137798"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.9392243"
 Parameter: XMIN -> "-15.9392243"
 Parameter: YMAX -> "-9.9221723"
 Parameter: YMIN -> "-16.9221723"
 Parameter: ZMAX -> "-12.7137798"
 Parameter: ZMIN -> "-19.7137798"
 SELRPN>     34 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      4 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35060 NEG      CLA      34       CLA     -5768 PROA     GLU      392      OE2           3.5895
35060 NEG      CLA      34       CLA     -5864 PROA     LYS      399      NZ            4.0747
35060 NEG      CLA      34       CLA     -5914 PROA     ILE      402      CG2           3.7911
35060 NEG      CLA      34       CLA     -5926 PROA     ILE      402      O             4.4532
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "99" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "99"
 Parameter: NPOS -> "65"
Evaluating: 99-65
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.203819271"
Evaluating: 90.067469*(0.203819271-0.5)
 Parameter: XPOS <- "-26.6762486"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.196395859"
Evaluating: 90.067469*(0.196395859-0.5)
 Parameter: YPOS <- "-27.3448566"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.962055318"
Evaluating: 143.194738*(0.962055318-0.5)+3.5172451
 Parameter: ZPOS <- "69.6811353"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.6811353" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.6811353" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -12.439224 XMAX =  -12.439224 XAVE =  -12.439224
    YMIN =  -13.422172 YMAX =  -13.422172 YAVE =  -13.422172
    ZMIN =  -16.213780 ZMAX =  -16.213780 ZAVE =  -16.213780
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.6762486"
 RDCMND substituted energy or value "?XAVE" to "-12.4392243"
Evaluating: -26.6762486--12.4392243
 Parameter: XTRAN <- "-14.2370243"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.3448566"
 RDCMND substituted energy or value "?YAVE" to "-13.4221723"
Evaluating: -27.3448566--13.4221723
 Parameter: YTRAN <- "-13.9226843"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.6811353"
 RDCMND substituted energy or value "?ZAVE" to "-16.2137798"
Evaluating: 69.6811353--16.2137798
 Parameter: ZTRAN <- "85.8949151"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.2370243"
 Parameter: YTRAN -> "-13.9226843"
 Parameter: ZTRAN -> "85.8949151"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -14.237024  -13.922684   85.894915
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.552280495E-02"
Evaluating: 6.552280495E-02*360.0
 Parameter: XPHI <- "23.5882098"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.263962734"
Evaluating: 0.263962734*360.0
 Parameter: YPHI <- "95.0265842"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.511254065"
Evaluating: 0.511254065*360.0
 Parameter: ZPHI <- "184.051463"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.6762486"
 Parameter: YPOS -> "-27.3448566"
 Parameter: ZPOS -> "69.6811353"
 Parameter: XPHI -> "23.5882098"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.916445    0.400160
    0.000000   -0.400160    0.916445

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   23.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.6762486"
 Parameter: YPOS -> "-27.3448566"
 Parameter: ZPOS -> "69.6811353"
 Parameter: YPHI -> "95.0265842"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.087618    0.000000   -0.996154
    0.000000    1.000000    0.000000
    0.996154    0.000000   -0.087618

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   95.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.6762486"
 Parameter: YPOS -> "-27.3448566"
 Parameter: ZPOS -> "69.6811353"
 Parameter: ZPHI -> "184.051463"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.997501   -0.070652    0.000000
    0.070652   -0.997501    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  175.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.676249 XMAX =  -26.676249 XAVE =  -26.676249
    YMIN =  -27.344857 YMAX =  -27.344857 YAVE =  -27.344857
    ZMIN =   69.681135 ZMAX =   69.681135 ZAVE =   69.681135
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.6762486"
Evaluating: -26.6762486+3.5
 Parameter: XMAX <- "-23.1762486"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.3448566"
Evaluating: -27.3448566+3.5
 Parameter: YMAX <- "-23.8448566"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.6811353"
Evaluating: 69.6811353+3.5
 Parameter: ZMAX <- "73.1811353"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.6762486"
Evaluating: -26.6762486-3.5
 Parameter: XMIN <- "-30.1762486"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.3448566"
Evaluating: -27.3448566-3.5
 Parameter: YMIN <- "-30.8448566"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.6811353"
Evaluating: 69.6811353-3.5
 Parameter: ZMIN <- "66.1811353"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.1762486"
 Parameter: XMIN -> "-30.1762486"
 Parameter: YMAX -> "-23.8448566"
 Parameter: YMIN -> "-30.8448566"
 Parameter: ZMAX -> "73.1811353"
 Parameter: ZMIN -> "66.1811353"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "100"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "100" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "100"
Evaluating: 100
 Parameter: J <- "100"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "100" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "100"
 Parameter: NPOS -> "65"
Evaluating: 100-65
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.437296202"
Evaluating: 90.067469*(0.437296202-0.5)
 Parameter: XPOS <- "-5.64757238"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "5.025235838E-02"
Evaluating: 90.067469*(5.025235838E-02-0.5)
 Parameter: YPOS <- "-40.5076318"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.859337325"
Evaluating: 143.194738*(0.859337325-0.5)+3.5172451
 Parameter: ZPOS <- "54.9724592"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.9724592" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.9724592" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.64757238"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -5.64757238-0
 Parameter: XTRAN <- "-5.64757238"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.5076318"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -40.5076318-0
 Parameter: YTRAN <- "-40.5076318"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.9724592"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 54.9724592-0
 Parameter: ZTRAN <- "54.9724592"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.64757238"
 Parameter: YTRAN -> "-40.5076318"
 Parameter: ZTRAN -> "54.9724592"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -5.647572  -40.507632   54.972459
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.258123576"
Evaluating: 0.258123576*360.0
 Parameter: XPHI <- "92.9244874"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.840219961"
Evaluating: 0.840219961*360.0
 Parameter: YPHI <- "302.479186"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.388392281"
Evaluating: 0.388392281*360.0
 Parameter: ZPHI <- "139.821221"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.64757238"
 Parameter: YPOS -> "-40.5076318"
 Parameter: ZPOS -> "54.9724592"
 Parameter: XPHI -> "92.9244874"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.051020    0.998698
    0.000000   -0.998698   -0.051020

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   92.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.64757238"
 Parameter: YPOS -> "-40.5076318"
 Parameter: ZPOS -> "54.9724592"
 Parameter: YPHI -> "302.479186"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.536993    0.000000    0.843587
    0.000000    1.000000    0.000000
   -0.843587    0.000000    0.536993

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   57.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.64757238"
 Parameter: YPOS -> "-40.5076318"
 Parameter: ZPOS -> "54.9724592"
 Parameter: ZPHI -> "139.821221"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.764035    0.645175    0.000000
   -0.645175   -0.764035    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  139.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.647572 XMAX =   -5.647572 XAVE =   -5.647572
    YMIN =  -40.507632 YMAX =  -40.507632 YAVE =  -40.507632
    ZMIN =   54.972459 ZMAX =   54.972459 ZAVE =   54.972459
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.64757238"
Evaluating: -5.64757238+3.5
 Parameter: XMAX <- "-2.14757238"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.5076318"
Evaluating: -40.5076318+3.5
 Parameter: YMAX <- "-37.0076318"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.9724592"
Evaluating: 54.9724592+3.5
 Parameter: ZMAX <- "58.4724592"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.64757238"
Evaluating: -5.64757238-3.5
 Parameter: XMIN <- "-9.14757238"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.5076318"
Evaluating: -40.5076318-3.5
 Parameter: YMIN <- "-44.0076318"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.9724592"
Evaluating: 54.9724592-3.5
 Parameter: ZMIN <- "51.4724592"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.14757238"
 Parameter: XMIN -> "-9.14757238"
 Parameter: YMAX -> "-37.0076318"
 Parameter: YMIN -> "-44.0076318"
 Parameter: ZMAX -> "58.4724592"
 Parameter: ZMIN -> "51.4724592"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "101"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "101" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "101" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "101"
 Parameter: NPOS -> "65"
Evaluating: 101-65
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.801875066"
Evaluating: 90.067469*(0.801875066-0.5)
 Parameter: XPOS <- "27.1891231"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.653623261"
Evaluating: 90.067469*(0.653623261-0.5)
 Parameter: YPOS <- "13.8364583"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.20994808"
Evaluating: 143.194738*(0.20994808-0.5)+3.5172451
 Parameter: ZPOS <- "-38.0166636"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-38.0166636" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.1891231"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 27.1891231-0
 Parameter: XTRAN <- "27.1891231"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.8364583"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 13.8364583-0
 Parameter: YTRAN <- "13.8364583"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.0166636"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -38.0166636-0
 Parameter: ZTRAN <- "-38.0166636"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "27.1891231"
 Parameter: YTRAN -> "13.8364583"
 Parameter: ZTRAN -> "-38.0166636"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    27.189123   13.836458  -38.016664
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.647996402"
Evaluating: 0.647996402*360.0
 Parameter: XPHI <- "233.278705"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.240287125"
Evaluating: 0.240287125*360.0
 Parameter: YPHI <- "86.503365"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.146696334"
Evaluating: 0.146696334*360.0
 Parameter: ZPHI <- "52.8106802"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.1891231"
 Parameter: YPOS -> "13.8364583"
 Parameter: ZPOS -> "-38.0166636"
 Parameter: XPHI -> "233.278705"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.597923   -0.801553
    0.000000    0.801553   -0.597923

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  126.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.1891231"
 Parameter: YPOS -> "13.8364583"
 Parameter: ZPOS -> "-38.0166636"
 Parameter: YPHI -> "86.503365"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.060990    0.000000   -0.998138
    0.000000    1.000000    0.000000
    0.998138    0.000000    0.060990

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   86.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.1891231"
 Parameter: YPOS -> "13.8364583"
 Parameter: ZPOS -> "-38.0166636"
 Parameter: ZPHI -> "52.8106802"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.604451    0.796643    0.000000
   -0.796643    0.604451    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   52.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.189123 XMAX =   27.189123 XAVE =   27.189123
    YMIN =   13.836458 YMAX =   13.836458 YAVE =   13.836458
    ZMIN =  -38.016664 ZMAX =  -38.016664 ZAVE =  -38.016664
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.1891231"
Evaluating: 27.1891231+3.5
 Parameter: XMAX <- "30.6891231"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.8364583"
Evaluating: 13.8364583+3.5
 Parameter: YMAX <- "17.3364583"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.0166636"
Evaluating: -38.0166636+3.5
 Parameter: ZMAX <- "-34.5166636"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.1891231"
Evaluating: 27.1891231-3.5
 Parameter: XMIN <- "23.6891231"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.8364583"
Evaluating: 13.8364583-3.5
 Parameter: YMIN <- "10.3364583"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.0166636"
Evaluating: -38.0166636-3.5
 Parameter: ZMIN <- "-41.5166636"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.6891231"
 Parameter: XMIN -> "23.6891231"
 Parameter: YMAX -> "17.3364583"
 Parameter: YMIN -> "10.3364583"
 Parameter: ZMAX -> "-34.5166636"
 Parameter: ZMIN -> "-41.5166636"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "102"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "102" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "102" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "102"
 Parameter: NPOS -> "65"
Evaluating: 102-65
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.335933575"
Evaluating: 90.067469*(0.335933575-0.5)
 Parameter: XPOS <- "-14.7770476"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "1.16133599E-03"
Evaluating: 90.067469*(1.16133599E-03-0.5)
 Parameter: YPOS <- "-44.9291359"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.729629317"
Evaluating: 143.194738*(0.729629317-0.5)+3.5172451
 Parameter: ZPOS <- "36.398955"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.398955" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.398955" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.7770476"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -14.7770476-0
 Parameter: XTRAN <- "-14.7770476"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.9291359"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -44.9291359-0
 Parameter: YTRAN <- "-44.9291359"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.398955"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.398955-0
 Parameter: ZTRAN <- "36.398955"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.7770476"
 Parameter: YTRAN -> "-44.9291359"
 Parameter: ZTRAN -> "36.398955"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -14.777048  -44.929136   36.398955
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.549396761"
Evaluating: 0.549396761*360.0
 Parameter: XPHI <- "197.782834"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.374214837"
Evaluating: 0.374214837*360.0
 Parameter: YPHI <- "134.717341"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.582228899"
Evaluating: 0.582228899*360.0
 Parameter: ZPHI <- "209.602404"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.7770476"
 Parameter: YPOS -> "-44.9291359"
 Parameter: ZPOS -> "36.398955"
 Parameter: XPHI -> "197.782834"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.952221   -0.305410
    0.000000    0.305410   -0.952221

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.7770476"
 Parameter: YPOS -> "-44.9291359"
 Parameter: ZPOS -> "36.398955"
 Parameter: YPHI -> "134.717341"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.703610    0.000000   -0.710587
    0.000000    1.000000    0.000000
    0.710587    0.000000   -0.703610

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  134.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.7770476"
 Parameter: YPOS -> "-44.9291359"
 Parameter: ZPOS -> "36.398955"
 Parameter: ZPHI -> "209.602404"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.869474   -0.493978    0.000000
    0.493978   -0.869474    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  150.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.777048 XMAX =  -14.777048 XAVE =  -14.777048
    YMIN =  -44.929136 YMAX =  -44.929136 YAVE =  -44.929136
    ZMIN =   36.398955 ZMAX =   36.398955 ZAVE =   36.398955
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.7770476"
Evaluating: -14.7770476+3.5
 Parameter: XMAX <- "-11.2770476"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.9291359"
Evaluating: -44.9291359+3.5
 Parameter: YMAX <- "-41.4291359"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.398955"
Evaluating: 36.398955+3.5
 Parameter: ZMAX <- "39.898955"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.7770476"
Evaluating: -14.7770476-3.5
 Parameter: XMIN <- "-18.2770476"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.9291359"
Evaluating: -44.9291359-3.5
 Parameter: YMIN <- "-48.4291359"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.398955"
Evaluating: 36.398955-3.5
 Parameter: ZMIN <- "32.898955"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.2770476"
 Parameter: XMIN -> "-18.2770476"
 Parameter: YMAX -> "-41.4291359"
 Parameter: YMIN -> "-48.4291359"
 Parameter: ZMAX -> "39.898955"
 Parameter: ZMIN -> "32.898955"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "103"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "103" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "103"
Evaluating: 103
 Parameter: J <- "103"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "103" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "103"
 Parameter: NPOS -> "65"
Evaluating: 103-65
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.556899522"
Evaluating: 90.067469*(0.556899522-0.5)
 Parameter: XPOS <- "5.12479593"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.362785769"
Evaluating: 90.067469*(0.362785769-0.5)
 Parameter: YPOS <- "-12.3585385"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.433152867"
Evaluating: 143.194738*(0.433152867-0.5)+3.5172451
 Parameter: ZPOS <- "-6.0549126"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-6.0549126" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-6.0549126" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "103"
Evaluating: 103
 Parameter: J <- "103"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "103" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "103"
 Parameter: NPOS -> "65"
Evaluating: 103-65
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.203175737"
Evaluating: 90.067469*(0.203175737-0.5)
 Parameter: XPOS <- "-26.7342101"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.85639607"
Evaluating: 90.067469*(0.85639607-0.5)
 Parameter: YPOS <- "32.099692"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.768104121"
Evaluating: 143.194738*(0.768104121-0.5)+3.5172451
 Parameter: ZPOS <- "41.9083445"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "41.9083445" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "41.9083445" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.7342101"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -26.7342101-0
 Parameter: XTRAN <- "-26.7342101"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.099692"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.099692-0
 Parameter: YTRAN <- "32.099692"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "41.9083445"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 41.9083445-0
 Parameter: ZTRAN <- "41.9083445"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-26.7342101"
 Parameter: YTRAN -> "32.099692"
 Parameter: ZTRAN -> "41.9083445"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -26.734210   32.099692   41.908344
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.226636329"
Evaluating: 0.226636329*360.0
 Parameter: XPHI <- "81.5890784"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.161983024"
Evaluating: 0.161983024*360.0
 Parameter: YPHI <- "58.3138886"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.173368577"
Evaluating: 0.173368577*360.0
 Parameter: ZPHI <- "62.4126877"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.7342101"
 Parameter: YPOS -> "32.099692"
 Parameter: ZPOS -> "41.9083445"
 Parameter: XPHI -> "81.5890784"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.146272    0.989244
    0.000000   -0.989244    0.146272

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   81.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.7342101"
 Parameter: YPOS -> "32.099692"
 Parameter: ZPOS -> "41.9083445"
 Parameter: YPHI -> "58.3138886"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.525265    0.000000   -0.850938
    0.000000    1.000000    0.000000
    0.850938    0.000000    0.525265

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   58.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.7342101"
 Parameter: YPOS -> "32.099692"
 Parameter: ZPOS -> "41.9083445"
 Parameter: ZPHI -> "62.4126877"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.463100    0.886306    0.000000
   -0.886306    0.463100    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   62.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.734210 XMAX =  -26.734210 XAVE =  -26.734210
    YMIN =   32.099692 YMAX =   32.099692 YAVE =   32.099692
    ZMIN =   41.908344 ZMAX =   41.908344 ZAVE =   41.908344
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.7342101"
Evaluating: -26.7342101+3.5
 Parameter: XMAX <- "-23.2342101"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.099692"
Evaluating: 32.099692+3.5
 Parameter: YMAX <- "35.599692"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "41.9083445"
Evaluating: 41.9083445+3.5
 Parameter: ZMAX <- "45.4083445"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.7342101"
Evaluating: -26.7342101-3.5
 Parameter: XMIN <- "-30.2342101"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.099692"
Evaluating: 32.099692-3.5
 Parameter: YMIN <- "28.599692"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "41.9083445"
Evaluating: 41.9083445-3.5
 Parameter: ZMIN <- "38.4083445"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.2342101"
 Parameter: XMIN -> "-30.2342101"
 Parameter: YMAX -> "35.599692"
 Parameter: YMIN -> "28.599692"
 Parameter: ZMAX -> "45.4083445"
 Parameter: ZMIN -> "38.4083445"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "104"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "104" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "104"
Evaluating: 104
 Parameter: J <- "104"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "104" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "104"
 Parameter: NPOS -> "65"
Evaluating: 104-65
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.646844192"
Evaluating: 90.067469*(0.646844192-0.5)
 Parameter: XPOS <- "13.2258847"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.674735475"
Evaluating: 90.067469*(0.674735475-0.5)
 Parameter: YPOS <- "15.737982"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "7.864441226E-02"
Evaluating: 143.194738*(7.864441226E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-56.8186579"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.8186579" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.2258847"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.2258847-0
 Parameter: XTRAN <- "13.2258847"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.737982"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 15.737982-0
 Parameter: YTRAN <- "15.737982"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.8186579"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -56.8186579-0
 Parameter: ZTRAN <- "-56.8186579"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.2258847"
 Parameter: YTRAN -> "15.737982"
 Parameter: ZTRAN -> "-56.8186579"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    13.225885   15.737982  -56.818658
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.595119698"
Evaluating: 0.595119698*360.0
 Parameter: XPHI <- "214.243091"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.751652593"
Evaluating: 0.751652593*360.0
 Parameter: YPHI <- "270.594933"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.211917634"
Evaluating: 0.211917634*360.0
 Parameter: ZPHI <- "76.2903482"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.2258847"
 Parameter: YPOS -> "15.737982"
 Parameter: ZPOS -> "-56.8186579"
 Parameter: XPHI -> "214.243091"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.826658   -0.562705
    0.000000    0.562705   -0.826658

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  145.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.2258847"
 Parameter: YPOS -> "15.737982"
 Parameter: ZPOS -> "-56.8186579"
 Parameter: YPHI -> "270.594933"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.010383    0.000000    0.999946
    0.000000    1.000000    0.000000
   -0.999946    0.000000    0.010383

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   89.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.2258847"
 Parameter: YPOS -> "15.737982"
 Parameter: ZPOS -> "-56.8186579"
 Parameter: ZPHI -> "76.2903482"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.237002    0.971509    0.000000
   -0.971509    0.237002    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   76.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.225885 XMAX =   13.225885 XAVE =   13.225885
    YMIN =   15.737982 YMAX =   15.737982 YAVE =   15.737982
    ZMIN =  -56.818658 ZMAX =  -56.818658 ZAVE =  -56.818658
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.2258847"
Evaluating: 13.2258847+3.5
 Parameter: XMAX <- "16.7258847"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.737982"
Evaluating: 15.737982+3.5
 Parameter: YMAX <- "19.237982"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.8186579"
Evaluating: -56.8186579+3.5
 Parameter: ZMAX <- "-53.3186579"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.2258847"
Evaluating: 13.2258847-3.5
 Parameter: XMIN <- "9.7258847"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.737982"
Evaluating: 15.737982-3.5
 Parameter: YMIN <- "12.237982"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.8186579"
Evaluating: -56.8186579-3.5
 Parameter: ZMIN <- "-60.3186579"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.7258847"
 Parameter: XMIN -> "9.7258847"
 Parameter: YMAX -> "19.237982"
 Parameter: YMIN -> "12.237982"
 Parameter: ZMAX -> "-53.3186579"
 Parameter: ZMIN -> "-60.3186579"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "105"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "105" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "105" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "105"
 Parameter: NPOS -> "65"
Evaluating: 105-65
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.935199889"
Evaluating: 90.067469*(0.935199889-0.5)
 Parameter: XPOS <- "39.1973525"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.80761281"
Evaluating: 90.067469*(0.80761281-0.5)
 Parameter: YPOS <- "27.7059072"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.239590584"
Evaluating: 143.194738*(0.239590584-0.5)+3.5172451
 Parameter: ZPOS <- "-33.772013"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-33.772013" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.1973525"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.1973525-0
 Parameter: XTRAN <- "39.1973525"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.7059072"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.7059072-0
 Parameter: YTRAN <- "27.7059072"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.772013"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -33.772013-0
 Parameter: ZTRAN <- "-33.772013"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.1973525"
 Parameter: YTRAN -> "27.7059072"
 Parameter: ZTRAN -> "-33.772013"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    39.197353   27.705907  -33.772013
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.319095863"
Evaluating: 0.319095863*360.0
 Parameter: XPHI <- "114.874511"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.746997439"
Evaluating: 0.746997439*360.0
 Parameter: YPHI <- "268.919078"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.575014214E-03"
Evaluating: 2.575014214E-03*360.0
 Parameter: ZPHI <- "0.927005117"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.1973525"
 Parameter: YPOS -> "27.7059072"
 Parameter: ZPOS -> "-33.772013"
 Parameter: XPHI -> "114.874511"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.420632    0.907231
    0.000000   -0.907231   -0.420632

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.1973525"
 Parameter: YPOS -> "27.7059072"
 Parameter: ZPOS -> "-33.772013"
 Parameter: YPHI -> "268.919078"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.018865    0.000000    0.999822
    0.000000    1.000000    0.000000
   -0.999822    0.000000   -0.018865

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.1973525"
 Parameter: YPOS -> "27.7059072"
 Parameter: ZPOS -> "-33.772013"
 Parameter: ZPHI -> "0.927005117"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.999869    0.016179    0.000000
   -0.016179    0.999869    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    0.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.197353 XMAX =   39.197353 XAVE =   39.197353
    YMIN =   27.705907 YMAX =   27.705907 YAVE =   27.705907
    ZMIN =  -33.772013 ZMAX =  -33.772013 ZAVE =  -33.772013
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.1973525"
Evaluating: 39.1973525+3.5
 Parameter: XMAX <- "42.6973525"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.7059072"
Evaluating: 27.7059072+3.5
 Parameter: YMAX <- "31.2059072"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.772013"
Evaluating: -33.772013+3.5
 Parameter: ZMAX <- "-30.272013"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.1973525"
Evaluating: 39.1973525-3.5
 Parameter: XMIN <- "35.6973525"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.7059072"
Evaluating: 27.7059072-3.5
 Parameter: YMIN <- "24.2059072"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.772013"
Evaluating: -33.772013-3.5
 Parameter: ZMIN <- "-37.272013"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.6973525"
 Parameter: XMIN -> "35.6973525"
 Parameter: YMAX -> "31.2059072"
 Parameter: YMIN -> "24.2059072"
 Parameter: ZMAX -> "-30.272013"
 Parameter: ZMIN -> "-37.272013"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "106"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "106" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "106" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "106"
 Parameter: NPOS -> "65"
Evaluating: 106-65
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.611662878"
Evaluating: 90.067469*(0.611662878-0.5)
 Parameter: XPOS <- "10.0571928"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.63976807"
Evaluating: 90.067469*(0.63976807-0.5)
 Parameter: YPOS <- "12.5885563"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.610187663"
Evaluating: 143.194738*(0.610187663-0.5)+3.5172451
 Parameter: ZPOS <- "19.2955386"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.2955386" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.2955386" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.0571928"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 10.0571928-0
 Parameter: XTRAN <- "10.0571928"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.5885563"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 12.5885563-0
 Parameter: YTRAN <- "12.5885563"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.2955386"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.2955386-0
 Parameter: ZTRAN <- "19.2955386"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.0571928"
 Parameter: YTRAN -> "12.5885563"
 Parameter: ZTRAN -> "19.2955386"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    10.057193   12.588556   19.295539
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.395977869"
Evaluating: 0.395977869*360.0
 Parameter: XPHI <- "142.552033"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.36098828"
Evaluating: 0.36098828*360.0
 Parameter: YPHI <- "129.955781"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.673323361"
Evaluating: 0.673323361*360.0
 Parameter: ZPHI <- "242.39641"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.0571928"
 Parameter: YPOS -> "12.5885563"
 Parameter: ZPOS -> "19.2955386"
 Parameter: XPHI -> "142.552033"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.793906    0.608041
    0.000000   -0.608041   -0.793906

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  142.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.0571928"
 Parameter: YPOS -> "12.5885563"
 Parameter: ZPOS -> "19.2955386"
 Parameter: YPHI -> "129.955781"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.642196    0.000000   -0.766540
    0.000000    1.000000    0.000000
    0.766540    0.000000   -0.642196

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  129.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.0571928"
 Parameter: YPOS -> "12.5885563"
 Parameter: ZPOS -> "19.2955386"
 Parameter: ZPHI -> "242.39641"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.463352   -0.886175    0.000000
    0.886175   -0.463352    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  117.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.057193 XMAX =   10.057193 XAVE =   10.057193
    YMIN =   12.588556 YMAX =   12.588556 YAVE =   12.588556
    ZMIN =   19.295539 ZMAX =   19.295539 ZAVE =   19.295539
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.0571928"
Evaluating: 10.0571928+3.5
 Parameter: XMAX <- "13.5571928"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.5885563"
Evaluating: 12.5885563+3.5
 Parameter: YMAX <- "16.0885563"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.2955386"
Evaluating: 19.2955386+3.5
 Parameter: ZMAX <- "22.7955386"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.0571928"
Evaluating: 10.0571928-3.5
 Parameter: XMIN <- "6.5571928"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.5885563"
Evaluating: 12.5885563-3.5
 Parameter: YMIN <- "9.0885563"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.2955386"
Evaluating: 19.2955386-3.5
 Parameter: ZMIN <- "15.7955386"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.5571928"
 Parameter: XMIN -> "6.5571928"
 Parameter: YMAX -> "16.0885563"
 Parameter: YMIN -> "9.0885563"
 Parameter: ZMAX -> "22.7955386"
 Parameter: ZMIN -> "15.7955386"
 SELRPN>     46 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      8 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35067 NEG      CLA      41       CLA     -6797 PROA     THR      456      CA            4.3761
35067 NEG      CLA      41       CLA     -6799 PROA     THR      456      CB            3.7809
35067 NEG      CLA      41       CLA     -6803 PROA     THR      456      CG2           2.3663
35067 NEG      CLA      41       CLA     -6807 PROA     THR      456      C             3.8149
35067 NEG      CLA      41       CLA     -6808 PROA     THR      456      O             3.5758
35067 NEG      CLA      41       CLA     -6862 PROA     ILE      460      CB            3.3185
35067 NEG      CLA      41       CLA     -6868 PROA     ILE      460      CG1           2.2823
35067 NEG      CLA      41       CLA     -6871 PROA     ILE      460      CD            1.2532
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "106" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "106"
 Parameter: NPOS -> "65"
Evaluating: 106-65
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.547158093"
Evaluating: 90.067469*(0.547158093-0.5)
 Parameter: XPOS <- "4.24741008"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.984795473"
Evaluating: 90.067469*(0.984795473-0.5)
 Parameter: YPOS <- "43.6643012"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.85675799"
Evaluating: 143.194738*(0.85675799-0.5)+3.5172451
 Parameter: ZPOS <- "54.603112"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.603112" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.603112" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.057193 XMAX =   10.057193 XAVE =   10.057193
    YMIN =   12.588556 YMAX =   12.588556 YAVE =   12.588556
    ZMIN =   19.295539 ZMAX =   19.295539 ZAVE =   19.295539
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.24741008"
 RDCMND substituted energy or value "?XAVE" to "10.0571928"
Evaluating: 4.24741008-10.0571928
 Parameter: XTRAN <- "-5.80978272"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "43.6643012"
 RDCMND substituted energy or value "?YAVE" to "12.5885563"
Evaluating: 43.6643012-12.5885563
 Parameter: YTRAN <- "31.0757449"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.603112"
 RDCMND substituted energy or value "?ZAVE" to "19.2955386"
Evaluating: 54.603112-19.2955386
 Parameter: ZTRAN <- "35.3075734"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-5.80978272"
 Parameter: YTRAN -> "31.0757449"
 Parameter: ZTRAN -> "35.3075734"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -5.809783   31.075745   35.307573
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.250120379"
Evaluating: 0.250120379*360.0
 Parameter: XPHI <- "90.0433364"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.572783345"
Evaluating: 0.572783345*360.0
 Parameter: YPHI <- "206.202004"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.646807234E-02"
Evaluating: 4.646807234E-02*360.0
 Parameter: ZPHI <- "16.728506"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.24741008"
 Parameter: YPOS -> "43.6643012"
 Parameter: ZPOS -> "54.603112"
 Parameter: XPHI -> "90.0433364"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.000756    1.000000
    0.000000   -1.000000   -0.000756

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   90.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.24741008"
 Parameter: YPOS -> "43.6643012"
 Parameter: ZPOS -> "54.603112"
 Parameter: YPHI -> "206.202004"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.897243    0.000000    0.441537
    0.000000    1.000000    0.000000
   -0.441537    0.000000   -0.897243

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  153.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.24741008"
 Parameter: YPOS -> "43.6643012"
 Parameter: ZPOS -> "54.603112"
 Parameter: ZPHI -> "16.728506"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.957679    0.287837    0.000000
   -0.287837    0.957679    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   16.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.247410 XMAX =    4.247410 XAVE =    4.247410
    YMIN =   43.664301 YMAX =   43.664301 YAVE =   43.664301
    ZMIN =   54.603112 ZMAX =   54.603112 ZAVE =   54.603112
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.24741008"
Evaluating: 4.24741008+3.5
 Parameter: XMAX <- "7.74741008"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "43.6643012"
Evaluating: 43.6643012+3.5
 Parameter: YMAX <- "47.1643012"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.603112"
Evaluating: 54.603112+3.5
 Parameter: ZMAX <- "58.103112"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.24741008"
Evaluating: 4.24741008-3.5
 Parameter: XMIN <- "0.74741008"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "43.6643012"
Evaluating: 43.6643012-3.5
 Parameter: YMIN <- "40.1643012"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.603112"
Evaluating: 54.603112-3.5
 Parameter: ZMIN <- "51.103112"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.74741008"
 Parameter: XMIN -> "0.74741008"
 Parameter: YMAX -> "47.1643012"
 Parameter: YMIN -> "40.1643012"
 Parameter: ZMAX -> "58.103112"
 Parameter: ZMIN -> "51.103112"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "107"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "107" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "107" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "107"
 Parameter: NPOS -> "65"
Evaluating: 107-65
 Parameter: J <- "42"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.353905846"
Evaluating: 90.067469*(0.353905846-0.5)
 Parameter: XPOS <- "-13.1583307"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.803233309"
Evaluating: 90.067469*(0.803233309-0.5)
 Parameter: YPOS <- "27.3114567"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.633392316"
Evaluating: 143.194738*(0.633392316-0.5)+3.5172451
 Parameter: ZPOS <- "22.6183228"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.6183228" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.6183228" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.1583307"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.1583307-0
 Parameter: XTRAN <- "-13.1583307"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.3114567"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 27.3114567-0
 Parameter: YTRAN <- "27.3114567"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.6183228"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.6183228-0
 Parameter: ZTRAN <- "22.6183228"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.1583307"
 Parameter: YTRAN -> "27.3114567"
 Parameter: ZTRAN -> "22.6183228"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -13.158331   27.311457   22.618323
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.478249619"
Evaluating: 0.478249619*360.0
 Parameter: XPHI <- "172.169863"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.735564175"
Evaluating: 0.735564175*360.0
 Parameter: YPHI <- "264.803103"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.389634378E-02"
Evaluating: 6.389634378E-02*360.0
 Parameter: ZPHI <- "23.0026838"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.1583307"
 Parameter: YPOS -> "27.3114567"
 Parameter: ZPOS -> "22.6183228"
 Parameter: XPHI -> "172.169863"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.990676    0.136237
    0.000000   -0.136237   -0.990676

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  172.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.1583307"
 Parameter: YPOS -> "27.3114567"
 Parameter: ZPOS -> "22.6183228"
 Parameter: YPHI -> "264.803103"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.090579    0.000000    0.995889
    0.000000    1.000000    0.000000
   -0.995889    0.000000   -0.090579

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   95.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.1583307"
 Parameter: YPOS -> "27.3114567"
 Parameter: ZPOS -> "22.6183228"
 Parameter: ZPHI -> "23.0026838"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.920487    0.390774    0.000000
   -0.390774    0.920487    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   23.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.158331 XMAX =  -13.158331 XAVE =  -13.158331
    YMIN =   27.311457 YMAX =   27.311457 YAVE =   27.311457
    ZMIN =   22.618323 ZMAX =   22.618323 ZAVE =   22.618323
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.1583307"
Evaluating: -13.1583307+3.5
 Parameter: XMAX <- "-9.6583307"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.3114567"
Evaluating: 27.3114567+3.5
 Parameter: YMAX <- "30.8114567"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.6183228"
Evaluating: 22.6183228+3.5
 Parameter: ZMAX <- "26.1183228"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.1583307"
Evaluating: -13.1583307-3.5
 Parameter: XMIN <- "-16.6583307"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.3114567"
Evaluating: 27.3114567-3.5
 Parameter: YMIN <- "23.8114567"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.6183228"
Evaluating: 22.6183228-3.5
 Parameter: ZMIN <- "19.1183228"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.6583307"
 Parameter: XMIN -> "-16.6583307"
 Parameter: YMAX -> "30.8114567"
 Parameter: YMIN -> "23.8114567"
 Parameter: ZMAX -> "26.1183228"
 Parameter: ZMIN -> "19.1183228"
 SELRPN>     12 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      5 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35068 NEG      CLA      42       CLA     -**** MEMB     POPC     42       N             3.5436
35068 NEG      CLA      42       CLA     -**** MEMB     POPC     42       C13           3.8131
35068 NEG      CLA      42       CLA     -**** MEMB     POPC     42       C14           2.1282
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "107" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "107"
 Parameter: NPOS -> "65"
Evaluating: 107-65
 Parameter: J <- "42"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.848518572"
Evaluating: 90.067469*(0.848518572-0.5)
 Parameter: XPOS <- "31.3901857"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.804725237"
Evaluating: 90.067469*(0.804725237-0.5)
 Parameter: YPOS <- "27.4458308"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.683513902"
Evaluating: 143.194738*(0.683513902-0.5)+3.5172451
 Parameter: ZPOS <- "29.7954702"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "29.7954702" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "29.7954702" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.158331 XMAX =  -13.158331 XAVE =  -13.158331
    YMIN =   27.311457 YMAX =   27.311457 YAVE =   27.311457
    ZMIN =   22.618323 ZMAX =   22.618323 ZAVE =   22.618323
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.3901857"
 RDCMND substituted energy or value "?XAVE" to "-13.1583307"
Evaluating: 31.3901857--13.1583307
 Parameter: XTRAN <- "44.5485164"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.4458308"
 RDCMND substituted energy or value "?YAVE" to "27.3114567"
Evaluating: 27.4458308-27.3114567
 Parameter: YTRAN <- "0.1343741"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.7954702"
 RDCMND substituted energy or value "?ZAVE" to "22.6183228"
Evaluating: 29.7954702-22.6183228
 Parameter: ZTRAN <- "7.1771474"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.5485164"
 Parameter: YTRAN -> "0.1343741"
 Parameter: ZTRAN -> "7.1771474"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    44.548516    0.134374    7.177147
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.99766483"
Evaluating: 0.99766483*360.0
 Parameter: XPHI <- "359.159339"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.296212923"
Evaluating: 0.296212923*360.0
 Parameter: YPHI <- "106.636652"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877891845"
Evaluating: 0.877891845*360.0
 Parameter: ZPHI <- "316.041064"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.3901857"
 Parameter: YPOS -> "27.4458308"
 Parameter: ZPOS -> "29.7954702"
 Parameter: XPHI -> "359.159339"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999892   -0.014672
    0.000000    0.014672    0.999892

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    0.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.3901857"
 Parameter: YPOS -> "27.4458308"
 Parameter: ZPOS -> "29.7954702"
 Parameter: YPHI -> "106.636652"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.286301    0.000000   -0.958140
    0.000000    1.000000    0.000000
    0.958140    0.000000   -0.286301

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  106.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.3901857"
 Parameter: YPOS -> "27.4458308"
 Parameter: ZPOS -> "29.7954702"
 Parameter: ZPHI -> "316.041064"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.719837   -0.694143    0.000000
    0.694143    0.719837    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   43.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.390186 XMAX =   31.390186 XAVE =   31.390186
    YMIN =   27.445831 YMAX =   27.445831 YAVE =   27.445831
    ZMIN =   29.795470 ZMAX =   29.795470 ZAVE =   29.795470
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.3901857"
Evaluating: 31.3901857+3.5
 Parameter: XMAX <- "34.8901857"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.4458308"
Evaluating: 27.4458308+3.5
 Parameter: YMAX <- "30.9458308"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.7954702"
Evaluating: 29.7954702+3.5
 Parameter: ZMAX <- "33.2954702"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.3901857"
Evaluating: 31.3901857-3.5
 Parameter: XMIN <- "27.8901857"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.4458308"
Evaluating: 27.4458308-3.5
 Parameter: YMIN <- "23.9458308"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.7954702"
Evaluating: 29.7954702-3.5
 Parameter: ZMIN <- "26.2954702"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.8901857"
 Parameter: XMIN -> "27.8901857"
 Parameter: YMAX -> "30.9458308"
 Parameter: YMIN -> "23.9458308"
 Parameter: ZMAX -> "33.2954702"
 Parameter: ZMIN -> "26.2954702"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "108"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "108" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "108"
Evaluating: 108
 Parameter: J <- "108"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "108" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "108"
 Parameter: NPOS -> "65"
Evaluating: 108-65
 Parameter: J <- "43"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "3.678085802E-02"
Evaluating: 90.067469*(3.678085802E-02-0.5)
 Parameter: XPOS <- "-41.7209757"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "7.521159684E-02"
Evaluating: 90.067469*(7.521159684E-02-0.5)
 Parameter: YPOS <- "-38.2596163"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.855107152"
Evaluating: 143.194738*(0.855107152-0.5)+3.5172451
 Parameter: ZPOS <- "54.3667207"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.3667207" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.3667207" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.7209757"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.7209757-0
 Parameter: XTRAN <- "-41.7209757"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.2596163"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.2596163-0
 Parameter: YTRAN <- "-38.2596163"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.3667207"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 54.3667207-0
 Parameter: ZTRAN <- "54.3667207"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.7209757"
 Parameter: YTRAN -> "-38.2596163"
 Parameter: ZTRAN -> "54.3667207"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -41.720976  -38.259616   54.366721
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.487137975"
Evaluating: 0.487137975*360.0
 Parameter: XPHI <- "175.369671"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.119833312E-02"
Evaluating: 6.119833312E-02*360.0
 Parameter: YPHI <- "22.0313999"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.666373199E-02"
Evaluating: 6.666373199E-02*360.0
 Parameter: ZPHI <- "23.9989435"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.7209757"
 Parameter: YPOS -> "-38.2596163"
 Parameter: ZPOS -> "54.3667207"
 Parameter: XPHI -> "175.369671"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.996736    0.080727
    0.000000   -0.080727   -0.996736

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  175.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.7209757"
 Parameter: YPOS -> "-38.2596163"
 Parameter: ZPOS -> "54.3667207"
 Parameter: YPHI -> "22.0313999"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.926978    0.000000   -0.375115
    0.000000    1.000000    0.000000
    0.375115    0.000000    0.926978

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   22.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.7209757"
 Parameter: YPOS -> "-38.2596163"
 Parameter: ZPOS -> "54.3667207"
 Parameter: ZPHI -> "23.9989435"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.913553    0.406720    0.000000
   -0.406720    0.913553    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   24.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.720976 XMAX =  -41.720976 XAVE =  -41.720976
    YMIN =  -38.259616 YMAX =  -38.259616 YAVE =  -38.259616
    ZMIN =   54.366721 ZMAX =   54.366721 ZAVE =   54.366721
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.7209757"
Evaluating: -41.7209757+3.5
 Parameter: XMAX <- "-38.2209757"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.2596163"
Evaluating: -38.2596163+3.5
 Parameter: YMAX <- "-34.7596163"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.3667207"
Evaluating: 54.3667207+3.5
 Parameter: ZMAX <- "57.8667207"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.7209757"
Evaluating: -41.7209757-3.5
 Parameter: XMIN <- "-45.2209757"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.2596163"
Evaluating: -38.2596163-3.5
 Parameter: YMIN <- "-41.7596163"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.3667207"
Evaluating: 54.3667207-3.5
 Parameter: ZMIN <- "50.8667207"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-38.2209757"
 Parameter: XMIN -> "-45.2209757"
 Parameter: YMAX -> "-34.7596163"
 Parameter: YMIN -> "-41.7596163"
 Parameter: ZMAX -> "57.8667207"
 Parameter: ZMIN -> "50.8667207"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "109"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "109" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "109" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "109"
 Parameter: NPOS -> "65"
Evaluating: 109-65
 Parameter: J <- "44"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.85719479"
Evaluating: 90.067469*(0.85719479-0.5)
 Parameter: XPOS <- "32.1716307"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.994240018"
Evaluating: 90.067469*(0.994240018-0.5)
 Parameter: YPOS <- "44.5149475"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.677601205"
Evaluating: 143.194738*(0.677601205-0.5)+3.5172451
 Parameter: ZPOS <- "28.9488031"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.9488031" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.9488031" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.1716307"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 32.1716307-0
 Parameter: XTRAN <- "32.1716307"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.5149475"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.5149475-0
 Parameter: YTRAN <- "44.5149475"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.9488031"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.9488031-0
 Parameter: ZTRAN <- "28.9488031"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.1716307"
 Parameter: YTRAN -> "44.5149475"
 Parameter: ZTRAN -> "28.9488031"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    32.171631   44.514947   28.948803
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.829095894"
Evaluating: 0.829095894*360.0
 Parameter: XPHI <- "298.474522"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.478067212"
Evaluating: 0.478067212*360.0
 Parameter: YPHI <- "172.104196"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.646103321E-02"
Evaluating: 9.646103321E-02*360.0
 Parameter: ZPHI <- "34.725972"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.1716307"
 Parameter: YPOS -> "44.5149475"
 Parameter: ZPOS -> "28.9488031"
 Parameter: XPHI -> "298.474522"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.476768   -0.879029
    0.000000    0.879029    0.476768

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   61.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.1716307"
 Parameter: YPOS -> "44.5149475"
 Parameter: ZPOS -> "28.9488031"
 Parameter: YPHI -> "172.104196"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.990520    0.000000   -0.137372
    0.000000    1.000000    0.000000
    0.137372    0.000000   -0.990520

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  172.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.1716307"
 Parameter: YPOS -> "44.5149475"
 Parameter: ZPOS -> "28.9488031"
 Parameter: ZPHI -> "34.725972"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.821886    0.569652    0.000000
   -0.569652    0.821886    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   34.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.171631 XMAX =   32.171631 XAVE =   32.171631
    YMIN =   44.514947 YMAX =   44.514947 YAVE =   44.514947
    ZMIN =   28.948803 ZMAX =   28.948803 ZAVE =   28.948803
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.1716307"
Evaluating: 32.1716307+3.5
 Parameter: XMAX <- "35.6716307"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.5149475"
Evaluating: 44.5149475+3.5
 Parameter: YMAX <- "48.0149475"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.9488031"
Evaluating: 28.9488031+3.5
 Parameter: ZMAX <- "32.4488031"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.1716307"
Evaluating: 32.1716307-3.5
 Parameter: XMIN <- "28.6716307"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.5149475"
Evaluating: 44.5149475-3.5
 Parameter: YMIN <- "41.0149475"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.9488031"
Evaluating: 28.9488031-3.5
 Parameter: ZMIN <- "25.4488031"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.6716307"
 Parameter: XMIN -> "28.6716307"
 Parameter: YMAX -> "48.0149475"
 Parameter: YMIN -> "41.0149475"
 Parameter: ZMAX -> "32.4488031"
 Parameter: ZMIN -> "25.4488031"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "110"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "110" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "110" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "110"
 Parameter: NPOS -> "65"
Evaluating: 110-65
 Parameter: J <- "45"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.298744895"
Evaluating: 90.067469*(0.298744895-0.5)
 Parameter: XPOS <- "-18.1265379"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.136146386"
Evaluating: 90.067469*(0.136146386-0.5)
 Parameter: YPOS <- "-32.7713741"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.579772786"
Evaluating: 143.194738*(0.579772786-0.5)+3.5172451
 Parameter: ZPOS <- "14.9402883"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "14.9402883" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "14.9402883" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "110" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "110"
 Parameter: NPOS -> "65"
Evaluating: 110-65
 Parameter: J <- "45"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.398205591"
Evaluating: 90.067469*(0.398205591-0.5)
 Parameter: XPOS <- "-9.16836478"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.188743713"
Evaluating: 90.067469*(0.188743713-0.5)
 Parameter: YPOS <- "-28.034066"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.716083045"
Evaluating: 143.194738*(0.716083045-0.5)+3.5172451
 Parameter: ZPOS <- "34.4592001"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "34.4592001" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "34.4592001" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.16836478"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.16836478-0
 Parameter: XTRAN <- "-9.16836478"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.034066"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -28.034066-0
 Parameter: YTRAN <- "-28.034066"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.4592001"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 34.4592001-0
 Parameter: ZTRAN <- "34.4592001"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.16836478"
 Parameter: YTRAN -> "-28.034066"
 Parameter: ZTRAN -> "34.4592001"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -9.168365  -28.034066   34.459200
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.656835135"
Evaluating: 0.656835135*360.0
 Parameter: XPHI <- "236.460649"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.7641165"
Evaluating: 0.7641165*360.0
 Parameter: YPHI <- "275.08194"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.406658828"
Evaluating: 0.406658828*360.0
 Parameter: ZPHI <- "146.397178"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.16836478"
 Parameter: YPOS -> "-28.034066"
 Parameter: ZPOS -> "34.4592001"
 Parameter: XPHI -> "236.460649"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.552510   -0.833507
    0.000000    0.833507   -0.552510

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  123.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.16836478"
 Parameter: YPOS -> "-28.034066"
 Parameter: ZPOS -> "34.4592001"
 Parameter: YPHI -> "275.08194"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.088580    0.000000    0.996069
    0.000000    1.000000    0.000000
   -0.996069    0.000000    0.088580

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   84.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.16836478"
 Parameter: YPOS -> "-28.034066"
 Parameter: ZPOS -> "34.4592001"
 Parameter: ZPHI -> "146.397178"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.832894    0.553433    0.000000
   -0.553433   -0.832894    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  146.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.168365 XMAX =   -9.168365 XAVE =   -9.168365
    YMIN =  -28.034066 YMAX =  -28.034066 YAVE =  -28.034066
    ZMIN =   34.459200 ZMAX =   34.459200 ZAVE =   34.459200
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.16836478"
Evaluating: -9.16836478+3.5
 Parameter: XMAX <- "-5.66836478"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.034066"
Evaluating: -28.034066+3.5
 Parameter: YMAX <- "-24.534066"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.4592001"
Evaluating: 34.4592001+3.5
 Parameter: ZMAX <- "37.9592001"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.16836478"
Evaluating: -9.16836478-3.5
 Parameter: XMIN <- "-12.6683648"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.034066"
Evaluating: -28.034066-3.5
 Parameter: YMIN <- "-31.534066"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.4592001"
Evaluating: 34.4592001-3.5
 Parameter: ZMIN <- "30.9592001"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.66836478"
 Parameter: XMIN -> "-12.6683648"
 Parameter: YMAX -> "-24.534066"
 Parameter: YMIN -> "-31.534066"
 Parameter: ZMAX -> "37.9592001"
 Parameter: ZMIN -> "30.9592001"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "111"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "111" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "111" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "111"
 Parameter: NPOS -> "65"
Evaluating: 111-65
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.586441546"
Evaluating: 90.067469*(0.586441546-0.5)
 Parameter: XPOS <- "7.78557126"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.479296512"
Evaluating: 90.067469*(0.479296512-0.5)
 Parameter: YPOS <- "-1.86471076"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.34631973"
Evaluating: 143.194738*(0.34631973-0.5)+3.5172451
 Parameter: ZPOS <- "-18.4889609"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-18.4889609" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.78557126"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.78557126-0
 Parameter: XTRAN <- "7.78557126"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.86471076"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.86471076-0
 Parameter: YTRAN <- "-1.86471076"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.4889609"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -18.4889609-0
 Parameter: ZTRAN <- "-18.4889609"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.78557126"
 Parameter: YTRAN -> "-1.86471076"
 Parameter: ZTRAN -> "-18.4889609"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     7.785571   -1.864711  -18.488961
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.582723905"
Evaluating: 0.582723905*360.0
 Parameter: XPHI <- "209.780606"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.945527889E-02"
Evaluating: 2.945527889E-02*360.0
 Parameter: YPHI <- "10.6039004"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.32742339E-02"
Evaluating: 1.32742339E-02*360.0
 Parameter: ZPHI <- "4.7787242"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.78557126"
 Parameter: YPOS -> "-1.86471076"
 Parameter: ZPOS -> "-18.4889609"
 Parameter: XPHI -> "209.780606"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.867934   -0.496680
    0.000000    0.496680   -0.867934

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  150.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.78557126"
 Parameter: YPOS -> "-1.86471076"
 Parameter: ZPOS -> "-18.4889609"
 Parameter: YPHI -> "10.6039004"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.982923    0.000000   -0.184018
    0.000000    1.000000    0.000000
    0.184018    0.000000    0.982923

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   10.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.78557126"
 Parameter: YPOS -> "-1.86471076"
 Parameter: ZPOS -> "-18.4889609"
 Parameter: ZPHI -> "4.7787242"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.996524    0.083308    0.000000
   -0.083308    0.996524    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    4.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.785571 XMAX =    7.785571 XAVE =    7.785571
    YMIN =   -1.864711 YMAX =   -1.864711 YAVE =   -1.864711
    ZMIN =  -18.488961 ZMAX =  -18.488961 ZAVE =  -18.488961
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.78557126"
Evaluating: 7.78557126+3.5
 Parameter: XMAX <- "11.2855713"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.86471076"
Evaluating: -1.86471076+3.5
 Parameter: YMAX <- "1.63528924"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.4889609"
Evaluating: -18.4889609+3.5
 Parameter: ZMAX <- "-14.9889609"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.78557126"
Evaluating: 7.78557126-3.5
 Parameter: XMIN <- "4.28557126"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.86471076"
Evaluating: -1.86471076-3.5
 Parameter: YMIN <- "-5.36471076"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.4889609"
Evaluating: -18.4889609-3.5
 Parameter: ZMIN <- "-21.9889609"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.2855713"
 Parameter: XMIN -> "4.28557126"
 Parameter: YMAX -> "1.63528924"
 Parameter: YMIN -> "-5.36471076"
 Parameter: ZMAX -> "-14.9889609"
 Parameter: ZMIN -> "-21.9889609"
 SELRPN>     17 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      9 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35072 NEG      CLA      46       CLA     -3167 PROA     ARG      223      CA            4.1202
35072 NEG      CLA      46       CLA     -3187 PROA     ARG      223      C             3.3787
35072 NEG      CLA      46       CLA     -3188 PROA     ARG      223      O             2.2915
35072 NEG      CLA      46       CLA     -3189 PROA     THR      224      N             4.3287
35072 NEG      CLA      46       CLA     -3201 PROA     THR      224      C             4.1957
35072 NEG      CLA      46       CLA     -3203 PROA     LYS      225      N             3.6047
35072 NEG      CLA      46       CLA     -3205 PROA     LYS      225      CA            3.9153
35072 NEG      CLA      46       CLA     -3210 PROA     LYS      225      CG            3.1388
35072 NEG      CLA      46       CLA     -3216 PROA     LYS      225      CE            4.2435
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "111" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "111"
 Parameter: NPOS -> "65"
Evaluating: 111-65
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.171638294"
Evaluating: 90.067469*(0.171638294-0.5)
 Parameter: XPOS <- "-29.5747078"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.117923627"
Evaluating: 90.067469*(0.117923627-0.5)
 Parameter: YPOS <- "-34.4126519"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.488469371"
Evaluating: 143.194738*(0.488469371-0.5)+3.5172451
 Parameter: ZPOS <- "1.8661197"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.8661197" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.8661197" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "111" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "111"
 Parameter: NPOS -> "65"
Evaluating: 111-65
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.94405127"
Evaluating: 90.067469*(0.94405127-0.5)
 Parameter: XPOS <- "39.994574"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "6.566577605E-03"
Evaluating: 90.067469*(6.566577605E-03-0.5)
 Parameter: YPOS <- "-44.4422995"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.594005549"
Evaluating: 143.194738*(0.594005549-0.5)+3.5172451
 Parameter: ZPOS <- "16.9783451"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "16.9783451" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "16.9783451" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.785571 XMAX =    7.785571 XAVE =    7.785571
    YMIN =   -1.864711 YMAX =   -1.864711 YAVE =   -1.864711
    ZMIN =  -18.488961 ZMAX =  -18.488961 ZAVE =  -18.488961
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.994574"
 RDCMND substituted energy or value "?XAVE" to "7.78557126"
Evaluating: 39.994574-7.78557126
 Parameter: XTRAN <- "32.2090027"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.4422995"
 RDCMND substituted energy or value "?YAVE" to "-1.86471076"
Evaluating: -44.4422995--1.86471076
 Parameter: YTRAN <- "-42.5775887"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.9783451"
 RDCMND substituted energy or value "?ZAVE" to "-18.4889609"
Evaluating: 16.9783451--18.4889609
 Parameter: ZTRAN <- "35.467306"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.2090027"
 Parameter: YTRAN -> "-42.5775887"
 Parameter: ZTRAN -> "35.467306"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    32.209003  -42.577589   35.467306
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.112964167E-02"
Evaluating: 3.112964167E-02*360.0
 Parameter: XPHI <- "11.206671"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.489678455"
Evaluating: 0.489678455*360.0
 Parameter: YPHI <- "176.284244"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.854680075"
Evaluating: 0.854680075*360.0
 Parameter: ZPHI <- "307.684827"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.994574"
 Parameter: YPOS -> "-44.4422995"
 Parameter: ZPOS -> "16.9783451"
 Parameter: XPHI -> "11.206671"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.980933    0.194349
    0.000000   -0.194349    0.980933

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   11.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.994574"
 Parameter: YPOS -> "-44.4422995"
 Parameter: ZPOS -> "16.9783451"
 Parameter: YPHI -> "176.284244"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.997898    0.000000   -0.064807
    0.000000    1.000000    0.000000
    0.064807    0.000000   -0.997898

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  176.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.994574"
 Parameter: YPOS -> "-44.4422995"
 Parameter: ZPOS -> "16.9783451"
 Parameter: ZPHI -> "307.684827"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.611317   -0.791385    0.000000
    0.791385    0.611317    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   52.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.994574 XMAX =   39.994574 XAVE =   39.994574
    YMIN =  -44.442299 YMAX =  -44.442299 YAVE =  -44.442299
    ZMIN =   16.978345 ZMAX =   16.978345 ZAVE =   16.978345
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.994574"
Evaluating: 39.994574+3.5
 Parameter: XMAX <- "43.494574"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.4422994"
Evaluating: -44.4422994+3.5
 Parameter: YMAX <- "-40.9422994"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.9783451"
Evaluating: 16.9783451+3.5
 Parameter: ZMAX <- "20.4783451"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.994574"
Evaluating: 39.994574-3.5
 Parameter: XMIN <- "36.494574"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.4422994"
Evaluating: -44.4422994-3.5
 Parameter: YMIN <- "-47.9422994"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.9783451"
Evaluating: 16.9783451-3.5
 Parameter: ZMIN <- "13.4783451"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.494574"
 Parameter: XMIN -> "36.494574"
 Parameter: YMAX -> "-40.9422994"
 Parameter: YMIN -> "-47.9422994"
 Parameter: ZMAX -> "20.4783451"
 Parameter: ZMIN -> "13.4783451"
 SELRPN>      9 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      3 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35072 NEG      CLA      46       CLA     -**** MEMB     POPC     100      C3            3.7861
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "111" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "111"
 Parameter: NPOS -> "65"
Evaluating: 111-65
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.523442114"
Evaluating: 90.067469*(0.523442114-0.5)
 Parameter: XPOS <- "2.11137188"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.894010614"
Evaluating: 90.067469*(0.894010614-0.5)
 Parameter: YPOS <- "35.4875388"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.704574261"
Evaluating: 143.194738*(0.704574261-0.5)+3.5172451
 Parameter: ZPOS <- "32.8112028"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.8112028" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.8112028" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.994574 XMAX =   39.994574 XAVE =   39.994574
    YMIN =  -44.442299 YMAX =  -44.442299 YAVE =  -44.442299
    ZMIN =   16.978345 ZMAX =   16.978345 ZAVE =   16.978345
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.11137188"
 RDCMND substituted energy or value "?XAVE" to "39.994574"
Evaluating: 2.11137188-39.994574
 Parameter: XTRAN <- "-37.8832021"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.4875388"
 RDCMND substituted energy or value "?YAVE" to "-44.4422994"
Evaluating: 35.4875388--44.4422994
 Parameter: YTRAN <- "79.9298382"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.8112028"
 RDCMND substituted energy or value "?ZAVE" to "16.9783451"
Evaluating: 32.8112028-16.9783451
 Parameter: ZTRAN <- "15.8328577"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.8832021"
 Parameter: YTRAN -> "79.9298382"
 Parameter: ZTRAN -> "15.8328577"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -37.883202   79.929838   15.832858
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.964279906"
Evaluating: 0.964279906*360.0
 Parameter: XPHI <- "347.140766"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.509221143"
Evaluating: 0.509221143*360.0
 Parameter: YPHI <- "183.319611"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.890765917"
Evaluating: 0.890765917*360.0
 Parameter: ZPHI <- "320.67573"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.11137188"
 Parameter: YPOS -> "35.4875388"
 Parameter: ZPOS -> "32.8112028"
 Parameter: XPHI -> "347.140766"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.974920   -0.222557
    0.000000    0.222557    0.974920

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   12.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.11137188"
 Parameter: YPOS -> "35.4875388"
 Parameter: ZPOS -> "32.8112028"
 Parameter: YPHI -> "183.319611"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.998322    0.000000    0.057906
    0.000000    1.000000    0.000000
   -0.057906    0.000000   -0.998322

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  176.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.11137188"
 Parameter: YPOS -> "35.4875388"
 Parameter: ZPOS -> "32.8112028"
 Parameter: ZPHI -> "320.67573"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.773572   -0.633709    0.000000
    0.633709    0.773572    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   39.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.111372 XMAX =    2.111372 XAVE =    2.111372
    YMIN =   35.487539 YMAX =   35.487539 YAVE =   35.487539
    ZMIN =   32.811203 ZMAX =   32.811203 ZAVE =   32.811203
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.1113719"
Evaluating: 2.1113719+3.5
 Parameter: XMAX <- "5.6113719"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.4875388"
Evaluating: 35.4875388+3.5
 Parameter: YMAX <- "38.9875388"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.8112028"
Evaluating: 32.8112028+3.5
 Parameter: ZMAX <- "36.3112028"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.1113719"
Evaluating: 2.1113719-3.5
 Parameter: XMIN <- "-1.3886281"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.4875388"
Evaluating: 35.4875388-3.5
 Parameter: YMIN <- "31.9875388"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.8112028"
Evaluating: 32.8112028-3.5
 Parameter: ZMIN <- "29.3112028"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.6113719"
 Parameter: XMIN -> "-1.3886281"
 Parameter: YMAX -> "38.9875388"
 Parameter: YMIN -> "31.9875388"
 Parameter: ZMAX -> "36.3112028"
 Parameter: ZMIN -> "29.3112028"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "112"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "112" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "112"
Evaluating: 112
 Parameter: J <- "112"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "112" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "112"
 Parameter: NPOS -> "65"
Evaluating: 112-65
 Parameter: J <- "47"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.39054569"
Evaluating: 90.067469*(0.39054569-0.5)
 Parameter: XPOS <- "-9.85827267"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.610758482"
Evaluating: 90.067469*(0.610758482-0.5)
 Parameter: YPOS <- "9.97573614"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.699564852"
Evaluating: 143.194738*(0.699564852-0.5)+3.5172451
 Parameter: ZPOS <- "32.0938818"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.0938818" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.0938818" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.85827267"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.85827267-0
 Parameter: XTRAN <- "-9.85827267"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.97573614"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.97573614-0
 Parameter: YTRAN <- "9.97573614"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.0938818"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.0938818-0
 Parameter: ZTRAN <- "32.0938818"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.85827267"
 Parameter: YTRAN -> "9.97573614"
 Parameter: ZTRAN -> "32.0938818"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -9.858273    9.975736   32.093882
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.270975364"
Evaluating: 0.270975364*360.0
 Parameter: XPHI <- "97.551131"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.500399949E-02"
Evaluating: 2.500399949E-02*360.0
 Parameter: YPHI <- "9.00143982"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.738240827"
Evaluating: 0.738240827*360.0
 Parameter: ZPHI <- "265.766698"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.85827267"
 Parameter: YPOS -> "9.97573614"
 Parameter: ZPOS -> "32.0938818"
 Parameter: XPHI -> "97.551131"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.131411    0.991328
    0.000000   -0.991328   -0.131411

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   97.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.85827267"
 Parameter: YPOS -> "9.97573614"
 Parameter: ZPOS -> "32.0938818"
 Parameter: YPHI -> "9.00143982"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.987684    0.000000   -0.156459
    0.000000    1.000000    0.000000
    0.156459    0.000000    0.987684

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    9.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.85827267"
 Parameter: YPOS -> "9.97573614"
 Parameter: ZPOS -> "32.0938818"
 Parameter: ZPHI -> "265.766698"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.073818   -0.997272    0.000000
    0.997272   -0.073818    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   94.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.858273 XMAX =   -9.858273 XAVE =   -9.858273
    YMIN =    9.975736 YMAX =    9.975736 YAVE =    9.975736
    ZMIN =   32.093882 ZMAX =   32.093882 ZAVE =   32.093882
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.85827267"
Evaluating: -9.85827267+3.5
 Parameter: XMAX <- "-6.35827267"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.97573614"
Evaluating: 9.97573614+3.5
 Parameter: YMAX <- "13.4757361"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.0938818"
Evaluating: 32.0938818+3.5
 Parameter: ZMAX <- "35.5938818"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.85827267"
Evaluating: -9.85827267-3.5
 Parameter: XMIN <- "-13.3582727"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.97573614"
Evaluating: 9.97573614-3.5
 Parameter: YMIN <- "6.47573614"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.0938818"
Evaluating: 32.0938818-3.5
 Parameter: ZMIN <- "28.5938818"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.35827267"
 Parameter: XMIN -> "-13.3582727"
 Parameter: YMAX -> "13.4757361"
 Parameter: YMIN -> "6.47573614"
 Parameter: ZMAX -> "35.5938818"
 Parameter: ZMIN -> "28.5938818"
 SELRPN>     43 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     21 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35073 NEG      CLA      47       CLA     -  97 PROA     ILE      33       CG2           4.7465
35073 NEG      CLA      47       CLA     - 956 PROA     TYR      87       O             3.9399
35073 NEG      CLA      47       CLA     - 959 PROA     THR      88       CA            3.2784
35073 NEG      CLA      47       CLA     - 961 PROA     THR      88       CB            3.9916
35073 NEG      CLA      47       CLA     - 969 PROA     THR      88       C             2.8364
35073 NEG      CLA      47       CLA     - 970 PROA     THR      88       O             1.8378
35073 NEG      CLA      47       CLA     - 984 PROA     THR      89       O             4.4765
35073 NEG      CLA      47       CLA     -1004 PROA     TYR      90       C             4.4011
35073 NEG      CLA      47       CLA     -1006 PROA     ILE      91       N             3.3593
35073 NEG      CLA      47       CLA     -1008 PROA     ILE      91       CA            3.1616
35073 NEG      CLA      47       CLA     -1010 PROA     ILE      91       CB            3.0977
35073 NEG      CLA      47       CLA     -1016 PROA     ILE      91       CG1           2.0624
35073 NEG      CLA      47       CLA     -1019 PROA     ILE      91       CD            3.2245
35073 NEG      CLA      47       CLA     -1023 PROA     ILE      91       C             2.9061
35073 NEG      CLA      47       CLA     -1024 PROA     ILE      91       O             3.9327
35073 NEG      CLA      47       CLA     -1025 PROA     LEU      92       N             2.2106
35073 NEG      CLA      47       CLA     -1027 PROA     LEU      92       CA            3.0833
35073 NEG      CLA      47       CLA     -1029 PROA     LEU      92       CB            3.0913
35073 NEG      CLA      47       CLA     -1032 PROA     LEU      92       CG            2.6082
35073 NEG      CLA      47       CLA     -1034 PROA     LEU      92       CD1           3.6861
35073 NEG      CLA      47       CLA     -1038 PROA     LEU      92       CD2           3.3697
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        21
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "21"
 Comparing "21" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "112"
Evaluating: 112
 Parameter: J <- "112"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "112" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "112"
 Parameter: NPOS -> "65"
Evaluating: 112-65
 Parameter: J <- "47"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.312020276"
Evaluating: 90.067469*(0.312020276-0.5)
 Parameter: XPOS <- "-16.930858"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.542095813"
Evaluating: 90.067469*(0.542095813-0.5)
 Parameter: YPOS <- "3.79146333"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.880338143"
Evaluating: 143.194738*(0.880338143-0.5)+3.5172451
 Parameter: ZPOS <- "57.9796658"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "57.9796658" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "57.9796658" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.858273 XMAX =   -9.858273 XAVE =   -9.858273
    YMIN =    9.975736 YMAX =    9.975736 YAVE =    9.975736
    ZMIN =   32.093882 ZMAX =   32.093882 ZAVE =   32.093882
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.930858"
 RDCMND substituted energy or value "?XAVE" to "-9.85827267"
Evaluating: -16.930858--9.85827267
 Parameter: XTRAN <- "-7.07258533"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.79146333"
 RDCMND substituted energy or value "?YAVE" to "9.97573614"
Evaluating: 3.79146333-9.97573614
 Parameter: YTRAN <- "-6.18427281"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "57.9796658"
 RDCMND substituted energy or value "?ZAVE" to "32.0938818"
Evaluating: 57.9796658-32.0938818
 Parameter: ZTRAN <- "25.885784"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.07258533"
 Parameter: YTRAN -> "-6.18427281"
 Parameter: ZTRAN -> "25.885784"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -7.072585   -6.184273   25.885784
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.816891131"
Evaluating: 0.816891131*360.0
 Parameter: XPHI <- "294.080807"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.29329059"
Evaluating: 0.29329059*360.0
 Parameter: YPHI <- "105.584612"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.188158813"
Evaluating: 0.188158813*360.0
 Parameter: ZPHI <- "67.7371727"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.930858"
 Parameter: YPOS -> "3.79146333"
 Parameter: ZPOS -> "57.9796658"
 Parameter: XPHI -> "294.080807"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.408025   -0.912971
    0.000000    0.912971    0.408025

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   65.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.930858"
 Parameter: YPOS -> "3.79146333"
 Parameter: ZPOS -> "57.9796658"
 Parameter: YPHI -> "105.584612"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.268661    0.000000   -0.963235
    0.000000    1.000000    0.000000
    0.963235    0.000000   -0.268661

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  105.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.930858"
 Parameter: YPOS -> "3.79146333"
 Parameter: ZPOS -> "57.9796658"
 Parameter: ZPHI -> "67.7371727"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.378856    0.925456    0.000000
   -0.925456    0.378856    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   67.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.930858 XMAX =  -16.930858 XAVE =  -16.930858
    YMIN =    3.791463 YMAX =    3.791463 YAVE =    3.791463
    ZMIN =   57.979666 ZMAX =   57.979666 ZAVE =   57.979666
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.930858"
Evaluating: -16.930858+3.5
 Parameter: XMAX <- "-13.430858"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.79146333"
Evaluating: 3.79146333+3.5
 Parameter: YMAX <- "7.29146333"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "57.9796658"
Evaluating: 57.9796658+3.5
 Parameter: ZMAX <- "61.4796658"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.930858"
Evaluating: -16.930858-3.5
 Parameter: XMIN <- "-20.430858"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.79146333"
Evaluating: 3.79146333-3.5
 Parameter: YMIN <- "0.29146333"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "57.9796658"
Evaluating: 57.9796658-3.5
 Parameter: ZMIN <- "54.4796658"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.430858"
 Parameter: XMIN -> "-20.430858"
 Parameter: YMAX -> "7.29146333"
 Parameter: YMIN -> "0.29146333"
 Parameter: ZMAX -> "61.4796658"
 Parameter: ZMIN -> "54.4796658"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "113"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "113" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "113"
Evaluating: 113
 Parameter: J <- "113"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "113" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "113"
 Parameter: NPOS -> "65"
Evaluating: 113-65
 Parameter: J <- "48"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.760703859"
Evaluating: 90.067469*(0.760703859-0.5)
 Parameter: XPOS <- "23.4809367"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.864932696"
Evaluating: 90.067469*(0.864932696-0.5)
 Parameter: YPOS <- "32.8685643"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.650454651"
Evaluating: 143.194738*(0.650454651-0.5)+3.5172451
 Parameter: ZPOS <- "25.0615594"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "25.0615594" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "25.0615594" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.4809367"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 23.4809367-0
 Parameter: XTRAN <- "23.4809367"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.8685643"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 32.8685643-0
 Parameter: YTRAN <- "32.8685643"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.0615594"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 25.0615594-0
 Parameter: ZTRAN <- "25.0615594"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.4809367"
 Parameter: YTRAN -> "32.8685643"
 Parameter: ZTRAN -> "25.0615594"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    23.480937   32.868564   25.061559
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.327055991"
Evaluating: 0.327055991*360.0
 Parameter: XPHI <- "117.740157"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.452929495"
Evaluating: 0.452929495*360.0
 Parameter: YPHI <- "163.054618"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.979877724"
Evaluating: 0.979877724*360.0
 Parameter: ZPHI <- "352.755981"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.4809367"
 Parameter: YPOS -> "32.8685643"
 Parameter: ZPOS -> "25.0615594"
 Parameter: XPHI -> "117.740157"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.465462    0.885068
    0.000000   -0.885068   -0.465462

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  117.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.4809367"
 Parameter: YPOS -> "32.8685643"
 Parameter: ZPOS -> "25.0615594"
 Parameter: YPHI -> "163.054618"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.956583    0.000000   -0.291460
    0.000000    1.000000    0.000000
    0.291460    0.000000   -0.956583

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  163.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.4809367"
 Parameter: YPOS -> "32.8685643"
 Parameter: ZPOS -> "25.0615594"
 Parameter: ZPHI -> "352.755981"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.992018   -0.126095    0.000000
    0.126095    0.992018    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    7.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.480937 XMAX =   23.480937 XAVE =   23.480937
    YMIN =   32.868564 YMAX =   32.868564 YAVE =   32.868564
    ZMIN =   25.061559 ZMAX =   25.061559 ZAVE =   25.061559
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.4809367"
Evaluating: 23.4809367+3.5
 Parameter: XMAX <- "26.9809367"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.8685643"
Evaluating: 32.8685643+3.5
 Parameter: YMAX <- "36.3685643"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.0615594"
Evaluating: 25.0615594+3.5
 Parameter: ZMAX <- "28.5615594"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.4809367"
Evaluating: 23.4809367-3.5
 Parameter: XMIN <- "19.9809367"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.8685643"
Evaluating: 32.8685643-3.5
 Parameter: YMIN <- "29.3685643"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.0615594"
Evaluating: 25.0615594-3.5
 Parameter: ZMIN <- "21.5615594"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "26.9809367"
 Parameter: XMIN -> "19.9809367"
 Parameter: YMAX -> "36.3685643"
 Parameter: YMIN -> "29.3685643"
 Parameter: ZMAX -> "28.5615594"
 Parameter: ZMIN -> "21.5615594"
 SELRPN>      2 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "114"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "114" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "114"
Evaluating: 114
 Parameter: J <- "114"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "114" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "114"
 Parameter: NPOS -> "65"
Evaluating: 114-65
 Parameter: J <- "49"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.346082402"
Evaluating: 90.067469*(0.346082402-0.5)
 Parameter: XPOS <- "-13.8629685"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.269039738"
Evaluating: 90.067469*(0.269039738-0.5)
 Parameter: YPOS <- "-20.8020062"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.998691095"
Evaluating: 143.194738*(0.998691095-0.5)+3.5172451
 Parameter: ZPOS <- "74.9271858"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "74.9271858" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "74.9271858" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.8629685"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -13.8629685-0
 Parameter: XTRAN <- "-13.8629685"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.8020062"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.8020062-0
 Parameter: YTRAN <- "-20.8020062"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "74.9271858"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 74.9271858-0
 Parameter: ZTRAN <- "74.9271858"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.8629685"
 Parameter: YTRAN -> "-20.8020062"
 Parameter: ZTRAN -> "74.9271858"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -13.862968  -20.802006   74.927186
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.417403307"
Evaluating: 0.417403307*360.0
 Parameter: XPHI <- "150.265191"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.400560923"
Evaluating: 0.400560923*360.0
 Parameter: YPHI <- "144.201932"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.385103127"
Evaluating: 0.385103127*360.0
 Parameter: ZPHI <- "138.637126"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.8629685"
 Parameter: YPOS -> "-20.8020062"
 Parameter: ZPOS -> "74.9271858"
 Parameter: XPHI -> "150.265191"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.868330    0.495986
    0.000000   -0.495986   -0.868330

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  150.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.8629685"
 Parameter: YPOS -> "-20.8020062"
 Parameter: ZPOS -> "74.9271858"
 Parameter: YPHI -> "144.201932"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.811084    0.000000   -0.584930
    0.000000    1.000000    0.000000
    0.584930    0.000000   -0.811084

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  144.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.8629685"
 Parameter: YPOS -> "-20.8020062"
 Parameter: ZPOS -> "74.9271858"
 Parameter: ZPHI -> "138.637126"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.750539    0.660826    0.000000
   -0.660826   -0.750539    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  138.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.862968 XMAX =  -13.862968 XAVE =  -13.862968
    YMIN =  -20.802006 YMAX =  -20.802006 YAVE =  -20.802006
    ZMIN =   74.927186 ZMAX =   74.927186 ZAVE =   74.927186
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.8629685"
Evaluating: -13.8629685+3.5
 Parameter: XMAX <- "-10.3629685"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.8020062"
Evaluating: -20.8020062+3.5
 Parameter: YMAX <- "-17.3020062"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "74.9271858"
Evaluating: 74.9271858+3.5
 Parameter: ZMAX <- "78.4271858"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.8629685"
Evaluating: -13.8629685-3.5
 Parameter: XMIN <- "-17.3629685"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.8020062"
Evaluating: -20.8020062-3.5
 Parameter: YMIN <- "-24.3020062"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "74.9271858"
Evaluating: 74.9271858-3.5
 Parameter: ZMIN <- "71.4271858"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.3629685"
 Parameter: XMIN -> "-17.3629685"
 Parameter: YMAX -> "-17.3020062"
 Parameter: YMIN -> "-24.3020062"
 Parameter: ZMAX -> "78.4271858"
 Parameter: ZMIN -> "71.4271858"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "115"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "115" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "115"
Evaluating: 115
 Parameter: J <- "115"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "115" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "115"
 Parameter: NPOS -> "65"
Evaluating: 115-65
 Parameter: J <- "50"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.607716187"
Evaluating: 90.067469*(0.607716187-0.5)
 Parameter: XPOS <- "9.70172433"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.826060959"
Evaluating: 90.067469*(0.826060959-0.5)
 Parameter: YPOS <- "29.3674853"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.711109661"
Evaluating: 143.194738*(0.711109661-0.5)+3.5172451
 Parameter: ZPOS <- "33.7470377"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.7470377" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.7470377" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.70172433"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 9.70172433-0
 Parameter: XTRAN <- "9.70172433"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.3674853"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.3674853-0
 Parameter: YTRAN <- "29.3674853"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.7470377"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.7470377-0
 Parameter: ZTRAN <- "33.7470377"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "9.70172433"
 Parameter: YTRAN -> "29.3674853"
 Parameter: ZTRAN -> "33.7470377"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     9.701724   29.367485   33.747038
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.507965631E-02"
Evaluating: 8.507965631E-02*360.0
 Parameter: XPHI <- "30.6286763"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111169971"
Evaluating: 0.111169971*360.0
 Parameter: YPHI <- "40.0211896"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.361457885"
Evaluating: 0.361457885*360.0
 Parameter: ZPHI <- "130.124839"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.70172433"
 Parameter: YPOS -> "29.3674853"
 Parameter: ZPOS -> "33.7470377"
 Parameter: XPHI -> "30.6286763"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.860487    0.509472
    0.000000   -0.509472    0.860487

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   30.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.70172433"
 Parameter: YPOS -> "29.3674853"
 Parameter: ZPOS -> "33.7470377"
 Parameter: YPHI -> "40.0211896"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.765807    0.000000   -0.643071
    0.000000    1.000000    0.000000
    0.643071    0.000000    0.765807

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   40.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.70172433"
 Parameter: YPOS -> "29.3674853"
 Parameter: ZPOS -> "33.7470377"
 Parameter: ZPHI -> "130.124839"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.644455    0.764642    0.000000
   -0.764642   -0.644455    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  130.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.701724 XMAX =    9.701724 XAVE =    9.701724
    YMIN =   29.367485 YMAX =   29.367485 YAVE =   29.367485
    ZMIN =   33.747038 ZMAX =   33.747038 ZAVE =   33.747038
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.70172433"
Evaluating: 9.70172433+3.5
 Parameter: XMAX <- "13.2017243"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.3674853"
Evaluating: 29.3674853+3.5
 Parameter: YMAX <- "32.8674853"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.7470377"
Evaluating: 33.7470377+3.5
 Parameter: ZMAX <- "37.2470377"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.70172433"
Evaluating: 9.70172433-3.5
 Parameter: XMIN <- "6.20172433"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.3674853"
Evaluating: 29.3674853-3.5
 Parameter: YMIN <- "25.8674853"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.7470377"
Evaluating: 33.7470377-3.5
 Parameter: ZMIN <- "30.2470377"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.2017243"
 Parameter: XMIN -> "6.20172433"
 Parameter: YMAX -> "32.8674853"
 Parameter: YMIN -> "25.8674853"
 Parameter: ZMAX -> "37.2470377"
 Parameter: ZMIN -> "30.2470377"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "116"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "116" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "116"
Evaluating: 116
 Parameter: J <- "116"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "116" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "116"
 Parameter: NPOS -> "65"
Evaluating: 116-65
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.904398206"
Evaluating: 90.067469*(0.904398206-0.5)
 Parameter: XPOS <- "36.4231229"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.12404926"
Evaluating: 90.067469*(0.12404926-0.5)
 Parameter: YPOS <- "-33.8609316"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.200487228"
Evaluating: 143.194738*(0.200487228-0.5)+3.5172451
 Parameter: ZPOS <- "-39.3714078"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-39.3714078" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.4231229"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.4231229-0
 Parameter: XTRAN <- "36.4231229"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.8609316"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.8609316-0
 Parameter: YTRAN <- "-33.8609316"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.3714078"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -39.3714078-0
 Parameter: ZTRAN <- "-39.3714078"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.4231229"
 Parameter: YTRAN -> "-33.8609316"
 Parameter: ZTRAN -> "-39.3714078"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    36.423123  -33.860932  -39.371408
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.648886391"
Evaluating: 0.648886391*360.0
 Parameter: XPHI <- "233.599101"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.862061697"
Evaluating: 0.862061697*360.0
 Parameter: YPHI <- "310.342211"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.820043133"
Evaluating: 0.820043133*360.0
 Parameter: ZPHI <- "295.215528"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.4231229"
 Parameter: YPOS -> "-33.8609316"
 Parameter: ZPOS -> "-39.3714078"
 Parameter: XPHI -> "233.599101"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.593432   -0.804884
    0.000000    0.804884   -0.593432

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  126.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.4231229"
 Parameter: YPOS -> "-33.8609316"
 Parameter: ZPOS -> "-39.3714078"
 Parameter: YPHI -> "310.342211"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.647351    0.000000    0.762192
    0.000000    1.000000    0.000000
   -0.762192    0.000000    0.647351

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   49.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.4231229"
 Parameter: YPOS -> "-33.8609316"
 Parameter: ZPOS -> "-39.3714078"
 Parameter: ZPHI -> "295.215528"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.426024   -0.904712    0.000000
    0.904712    0.426024    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   64.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.423123 XMAX =   36.423123 XAVE =   36.423123
    YMIN =  -33.860932 YMAX =  -33.860932 YAVE =  -33.860932
    ZMIN =  -39.371408 ZMAX =  -39.371408 ZAVE =  -39.371408
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.4231229"
Evaluating: 36.4231229+3.5
 Parameter: XMAX <- "39.9231229"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.8609316"
Evaluating: -33.8609316+3.5
 Parameter: YMAX <- "-30.3609316"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.3714078"
Evaluating: -39.3714078+3.5
 Parameter: ZMAX <- "-35.8714078"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.4231229"
Evaluating: 36.4231229-3.5
 Parameter: XMIN <- "32.9231229"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.8609316"
Evaluating: -33.8609316-3.5
 Parameter: YMIN <- "-37.3609316"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.3714078"
Evaluating: -39.3714078-3.5
 Parameter: ZMIN <- "-42.8714078"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.9231229"
 Parameter: XMIN -> "32.9231229"
 Parameter: YMAX -> "-30.3609316"
 Parameter: YMIN -> "-37.3609316"
 Parameter: ZMAX -> "-35.8714078"
 Parameter: ZMIN -> "-42.8714078"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "117"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "117" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "117" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "117"
 Parameter: NPOS -> "65"
Evaluating: 117-65
 Parameter: J <- "52"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.68789371"
Evaluating: 90.067469*(0.68789371-0.5)
 Parameter: XPOS <- "16.9231109"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.486203281"
Evaluating: 90.067469*(0.486203281-0.5)
 Parameter: YPOS <- "-1.24263556"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.746980572"
Evaluating: 143.194738*(0.746980572-0.5)+3.5172451
 Parameter: ZPOS <- "38.8835634"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "38.8835634" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "38.8835634" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.9231109"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 16.9231109-0
 Parameter: XTRAN <- "16.9231109"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.24263556"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -1.24263556-0
 Parameter: YTRAN <- "-1.24263556"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.8835634"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 38.8835634-0
 Parameter: ZTRAN <- "38.8835634"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.9231109"
 Parameter: YTRAN -> "-1.24263556"
 Parameter: ZTRAN -> "38.8835634"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    16.923111   -1.242636   38.883563
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.231861152"
Evaluating: 0.231861152*360.0
 Parameter: XPHI <- "83.4700147"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.945410202"
Evaluating: 0.945410202*360.0
 Parameter: YPHI <- "340.347673"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.224624127"
Evaluating: 0.224624127*360.0
 Parameter: ZPHI <- "80.8646857"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.9231109"
 Parameter: YPOS -> "-1.24263556"
 Parameter: ZPOS -> "38.8835634"
 Parameter: XPHI -> "83.4700147"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.113723    0.993512
    0.000000   -0.993512    0.113723

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   83.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.9231109"
 Parameter: YPOS -> "-1.24263556"
 Parameter: ZPOS -> "38.8835634"
 Parameter: YPHI -> "340.347673"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.941751    0.000000    0.336312
    0.000000    1.000000    0.000000
   -0.336312    0.000000    0.941751

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   19.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.9231109"
 Parameter: YPOS -> "-1.24263556"
 Parameter: ZPOS -> "38.8835634"
 Parameter: ZPHI -> "80.8646857"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.158767    0.987316    0.000000
   -0.987316    0.158767    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   80.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.923111 XMAX =   16.923111 XAVE =   16.923111
    YMIN =   -1.242636 YMAX =   -1.242636 YAVE =   -1.242636
    ZMIN =   38.883563 ZMAX =   38.883563 ZAVE =   38.883563
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.9231109"
Evaluating: 16.9231109+3.5
 Parameter: XMAX <- "20.4231109"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.24263556"
Evaluating: -1.24263556+3.5
 Parameter: YMAX <- "2.25736444"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.8835634"
Evaluating: 38.8835634+3.5
 Parameter: ZMAX <- "42.3835634"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.9231109"
Evaluating: 16.9231109-3.5
 Parameter: XMIN <- "13.4231109"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.24263556"
Evaluating: -1.24263556-3.5
 Parameter: YMIN <- "-4.74263556"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.8835634"
Evaluating: 38.8835634-3.5
 Parameter: ZMIN <- "35.3835634"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.4231109"
 Parameter: XMIN -> "13.4231109"
 Parameter: YMAX -> "2.25736444"
 Parameter: YMIN -> "-4.74263556"
 Parameter: ZMAX -> "42.3835634"
 Parameter: ZMIN -> "35.3835634"
 SELRPN>      8 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      4 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35078 NEG      CLA      52       CLA     -2631 PROA     GLU      190      CB            4.3781
35078 NEG      CLA      52       CLA     -2637 PROA     GLU      190      CD            2.7559
35078 NEG      CLA      52       CLA     -2638 PROA     GLU      190      OE1           1.6803
35078 NEG      CLA      52       CLA     -2639 PROA     GLU      190      OE2           3.3074
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "117" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "117"
 Parameter: NPOS -> "65"
Evaluating: 117-65
 Parameter: J <- "52"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.564265846"
Evaluating: 90.067469*(0.564265846-0.5)
 Parameter: XPOS <- "5.78826209"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.353120536"
Evaluating: 90.067469*(0.353120536-0.5)
 Parameter: YPOS <- "-13.2290616"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.860638726"
Evaluating: 143.194738*(0.860638726-0.5)+3.5172451
 Parameter: ZPOS <- "55.158813"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "55.158813" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "55.158813" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.923111 XMAX =   16.923111 XAVE =   16.923111
    YMIN =   -1.242636 YMAX =   -1.242636 YAVE =   -1.242636
    ZMIN =   38.883563 ZMAX =   38.883563 ZAVE =   38.883563
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.78826209"
 RDCMND substituted energy or value "?XAVE" to "16.9231109"
Evaluating: 5.78826209-16.9231109
 Parameter: XTRAN <- "-11.1348488"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.2290616"
 RDCMND substituted energy or value "?YAVE" to "-1.24263556"
Evaluating: -13.2290616--1.24263556
 Parameter: YTRAN <- "-11.986426"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "55.158813"
 RDCMND substituted energy or value "?ZAVE" to "38.8835634"
Evaluating: 55.158813-38.8835634
 Parameter: ZTRAN <- "16.2752496"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-11.1348488"
 Parameter: YTRAN -> "-11.986426"
 Parameter: ZTRAN -> "16.2752496"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -11.134849  -11.986426   16.275250
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.696207318"
Evaluating: 0.696207318*360.0
 Parameter: XPHI <- "250.634634"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.991424809"
Evaluating: 0.991424809*360.0
 Parameter: YPHI <- "356.912931"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.648516504"
Evaluating: 0.648516504*360.0
 Parameter: ZPHI <- "233.465941"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.78826209"
 Parameter: YPOS -> "-13.2290616"
 Parameter: ZPOS -> "55.158813"
 Parameter: XPHI -> "250.634634"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.331591   -0.943423
    0.000000    0.943423   -0.331591

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  109.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.78826209"
 Parameter: YPOS -> "-13.2290616"
 Parameter: ZPOS -> "55.158813"
 Parameter: YPHI -> "356.912931"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.998549    0.000000    0.053853
    0.000000    1.000000    0.000000
   -0.053853    0.000000    0.998549

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    3.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.78826209"
 Parameter: YPOS -> "-13.2290616"
 Parameter: ZPOS -> "55.158813"
 Parameter: ZPHI -> "233.465941"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.595301   -0.803503    0.000000
    0.803503   -0.595301    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  126.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.788262 XMAX =    5.788262 XAVE =    5.788262
    YMIN =  -13.229062 YMAX =  -13.229062 YAVE =  -13.229062
    ZMIN =   55.158813 ZMAX =   55.158813 ZAVE =   55.158813
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.78826209"
Evaluating: 5.78826209+3.5
 Parameter: XMAX <- "9.28826209"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.2290616"
Evaluating: -13.2290616+3.5
 Parameter: YMAX <- "-9.7290616"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "55.158813"
Evaluating: 55.158813+3.5
 Parameter: ZMAX <- "58.658813"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.78826209"
Evaluating: 5.78826209-3.5
 Parameter: XMIN <- "2.28826209"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.2290616"
Evaluating: -13.2290616-3.5
 Parameter: YMIN <- "-16.7290616"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "55.158813"
Evaluating: 55.158813-3.5
 Parameter: ZMIN <- "51.658813"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.28826209"
 Parameter: XMIN -> "2.28826209"
 Parameter: YMAX -> "-9.7290616"
 Parameter: YMIN -> "-16.7290616"
 Parameter: ZMAX -> "58.658813"
 Parameter: ZMIN -> "51.658813"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "118"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "118" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "118" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "118"
 Parameter: NPOS -> "65"
Evaluating: 118-65
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.650486281"
Evaluating: 90.067469*(0.650486281-0.5)
 Parameter: XPOS <- "13.5539184"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.902212346"
Evaluating: 90.067469*(0.902212346-0.5)
 Parameter: YPOS <- "36.226248"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.849380793"
Evaluating: 143.194738*(0.849380793-0.5)+3.5172451
 Parameter: ZPOS <- "53.5467362"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "53.5467362" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "53.5467362" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.5539184"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.5539184-0
 Parameter: XTRAN <- "13.5539184"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.226248"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 36.226248-0
 Parameter: YTRAN <- "36.226248"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "53.5467362"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 53.5467362-0
 Parameter: ZTRAN <- "53.5467362"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.5539184"
 Parameter: YTRAN -> "36.226248"
 Parameter: ZTRAN -> "53.5467362"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    13.553918   36.226248   53.546736
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.180374891"
Evaluating: 0.180374891*360.0
 Parameter: XPHI <- "64.9349608"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.915980883"
Evaluating: 0.915980883*360.0
 Parameter: YPHI <- "329.753118"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.524375698"
Evaluating: 0.524375698*360.0
 Parameter: ZPHI <- "188.775251"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.5539184"
 Parameter: YPOS -> "36.226248"
 Parameter: ZPOS -> "53.5467362"
 Parameter: XPHI -> "64.9349608"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.423647    0.905827
    0.000000   -0.905827    0.423647

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.5539184"
 Parameter: YPOS -> "36.226248"
 Parameter: ZPOS -> "53.5467362"
 Parameter: YPHI -> "329.753118"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.863863    0.000000    0.503727
    0.000000    1.000000    0.000000
   -0.503727    0.000000    0.863863

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   30.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.5539184"
 Parameter: YPOS -> "36.226248"
 Parameter: ZPOS -> "53.5467362"
 Parameter: ZPHI -> "188.775251"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.988294   -0.152559    0.000000
    0.152559   -0.988294    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  171.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.553918 XMAX =   13.553918 XAVE =   13.553918
    YMIN =   36.226248 YMAX =   36.226248 YAVE =   36.226248
    ZMIN =   53.546736 ZMAX =   53.546736 ZAVE =   53.546736
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.5539184"
Evaluating: 13.5539184+3.5
 Parameter: XMAX <- "17.0539184"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.226248"
Evaluating: 36.226248+3.5
 Parameter: YMAX <- "39.726248"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "53.5467362"
Evaluating: 53.5467362+3.5
 Parameter: ZMAX <- "57.0467362"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.5539184"
Evaluating: 13.5539184-3.5
 Parameter: XMIN <- "10.0539184"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.226248"
Evaluating: 36.226248-3.5
 Parameter: YMIN <- "32.726248"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "53.5467362"
Evaluating: 53.5467362-3.5
 Parameter: ZMIN <- "50.0467362"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.0539184"
 Parameter: XMIN -> "10.0539184"
 Parameter: YMAX -> "39.726248"
 Parameter: YMIN -> "32.726248"
 Parameter: ZMAX -> "57.0467362"
 Parameter: ZMIN -> "50.0467362"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "119"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "119" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "119" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "119"
 Parameter: NPOS -> "65"
Evaluating: 119-65
 Parameter: J <- "54"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.248696431"
Evaluating: 90.067469*(0.248696431-0.5)
 Parameter: XPOS <- "-22.6342764"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.746723056"
Evaluating: 90.067469*(0.746723056-0.5)
 Parameter: YPOS <- "22.2217212"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.663916786"
Evaluating: 143.194738*(0.663916786-0.5)+3.5172451
 Parameter: ZPOS <- "26.9892663"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "26.9892663" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "26.9892663" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.6342764"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -22.6342764-0
 Parameter: XTRAN <- "-22.6342764"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.2217212"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 22.2217212-0
 Parameter: YTRAN <- "22.2217212"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.9892663"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 26.9892663-0
 Parameter: ZTRAN <- "26.9892663"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.6342764"
 Parameter: YTRAN -> "22.2217212"
 Parameter: ZTRAN -> "26.9892663"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -22.634276   22.221721   26.989266
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.986783515"
Evaluating: 0.986783515*360.0
 Parameter: XPHI <- "355.242065"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.409784052"
Evaluating: 0.409784052*360.0
 Parameter: YPHI <- "147.522259"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.307422047"
Evaluating: 0.307422047*360.0
 Parameter: ZPHI <- "110.671937"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.6342764"
 Parameter: YPOS -> "22.2217212"
 Parameter: ZPOS -> "26.9892663"
 Parameter: XPHI -> "355.242065"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.996554   -0.082946
    0.000000    0.082946    0.996554

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    4.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.6342764"
 Parameter: YPOS -> "22.2217212"
 Parameter: ZPOS -> "26.9892663"
 Parameter: YPHI -> "147.522259"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.843600    0.000000   -0.536972
    0.000000    1.000000    0.000000
    0.536972    0.000000   -0.843600

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  147.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.6342764"
 Parameter: YPOS -> "22.2217212"
 Parameter: ZPOS -> "26.9892663"
 Parameter: ZPHI -> "110.671937"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.353017    0.935617    0.000000
   -0.935617   -0.353017    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  110.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.634276 XMAX =  -22.634276 XAVE =  -22.634276
    YMIN =   22.221721 YMAX =   22.221721 YAVE =   22.221721
    ZMIN =   26.989266 ZMAX =   26.989266 ZAVE =   26.989266
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.6342764"
Evaluating: -22.6342764+3.5
 Parameter: XMAX <- "-19.1342764"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.2217212"
Evaluating: 22.2217212+3.5
 Parameter: YMAX <- "25.7217212"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.9892663"
Evaluating: 26.9892663+3.5
 Parameter: ZMAX <- "30.4892663"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.6342764"
Evaluating: -22.6342764-3.5
 Parameter: XMIN <- "-26.1342764"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.2217212"
Evaluating: 22.2217212-3.5
 Parameter: YMIN <- "18.7217212"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.9892663"
Evaluating: 26.9892663-3.5
 Parameter: ZMIN <- "23.4892663"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.1342764"
 Parameter: XMIN -> "-26.1342764"
 Parameter: YMAX -> "25.7217212"
 Parameter: YMIN -> "18.7217212"
 Parameter: ZMAX -> "30.4892663"
 Parameter: ZMIN -> "23.4892663"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "120"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "120" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "120"
Evaluating: 120
 Parameter: J <- "120"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "120" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "120"
 Parameter: NPOS -> "65"
Evaluating: 120-65
 Parameter: J <- "55"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.357913236"
Evaluating: 90.067469*(0.357913236-0.5)
 Parameter: XPOS <- "-12.7973952"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.655811411"
Evaluating: 90.067469*(0.655811411-0.5)
 Parameter: YPOS <- "14.0335394"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.537294143"
Evaluating: 143.194738*(0.537294143-0.5)+3.5172451
 Parameter: ZPOS <- "8.85757014"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.85757014" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.85757014" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "120"
Evaluating: 120
 Parameter: J <- "120"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "120" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "120"
 Parameter: NPOS -> "65"
Evaluating: 120-65
 Parameter: J <- "55"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.386107793"
Evaluating: 90.067469*(0.386107793-0.5)
 Parameter: XPOS <- "-10.2579828"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.125922313"
Evaluating: 90.067469*(0.125922313-0.5)
 Parameter: YPOS <- "-33.6922305"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.25377305"
Evaluating: 143.194738*(0.25377305-0.5)+3.5172451
 Parameter: ZPOS <- "-31.7411585"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-31.7411585" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-10.2579828"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -10.2579828-0
 Parameter: XTRAN <- "-10.2579828"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.6922305"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -33.6922305-0
 Parameter: YTRAN <- "-33.6922305"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.7411585"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -31.7411585-0
 Parameter: ZTRAN <- "-31.7411585"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.2579828"
 Parameter: YTRAN -> "-33.6922305"
 Parameter: ZTRAN -> "-31.7411585"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -10.257983  -33.692231  -31.741159
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.939915703"
Evaluating: 0.939915703*360.0
 Parameter: XPHI <- "338.369653"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.19692797"
Evaluating: 0.19692797*360.0
 Parameter: YPHI <- "70.8940692"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.78894457"
Evaluating: 0.78894457*360.0
 Parameter: ZPHI <- "284.020045"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-10.2579828"
 Parameter: YPOS -> "-33.6922305"
 Parameter: ZPOS -> "-31.7411585"
 Parameter: XPHI -> "338.369653"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.929581   -0.368617
    0.000000    0.368617    0.929581

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   21.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-10.2579828"
 Parameter: YPOS -> "-33.6922305"
 Parameter: ZPOS -> "-31.7411585"
 Parameter: YPHI -> "70.8940692"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.327316    0.000000   -0.944915
    0.000000    1.000000    0.000000
    0.944915    0.000000    0.327316

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   70.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-10.2579828"
 Parameter: YPOS -> "-33.6922305"
 Parameter: ZPOS -> "-31.7411585"
 Parameter: ZPHI -> "284.020045"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.242261   -0.970211    0.000000
    0.970211    0.242261    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   75.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -10.257983 XMAX =  -10.257983 XAVE =  -10.257983
    YMIN =  -33.692231 YMAX =  -33.692231 YAVE =  -33.692231
    ZMIN =  -31.741159 ZMAX =  -31.741159 ZAVE =  -31.741159
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-10.2579828"
Evaluating: -10.2579828+3.5
 Parameter: XMAX <- "-6.7579828"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.6922305"
Evaluating: -33.6922305+3.5
 Parameter: YMAX <- "-30.1922305"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.7411585"
Evaluating: -31.7411585+3.5
 Parameter: ZMAX <- "-28.2411585"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-10.2579828"
Evaluating: -10.2579828-3.5
 Parameter: XMIN <- "-13.7579828"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.6922305"
Evaluating: -33.6922305-3.5
 Parameter: YMIN <- "-37.1922305"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.7411585"
Evaluating: -31.7411585-3.5
 Parameter: ZMIN <- "-35.2411585"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-6.7579828"
 Parameter: XMIN -> "-13.7579828"
 Parameter: YMAX -> "-30.1922305"
 Parameter: YMIN -> "-37.1922305"
 Parameter: ZMAX -> "-28.2411585"
 Parameter: ZMIN -> "-35.2411585"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "121"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "121" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "121"
Evaluating: 121
 Parameter: J <- "121"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "121" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "121"
 Parameter: NPOS -> "65"
Evaluating: 121-65
 Parameter: J <- "56"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.79864979"
Evaluating: 90.067469*(0.79864979-0.5)
 Parameter: XPOS <- "26.8986307"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.516567458"
Evaluating: 90.067469*(0.516567458-0.5)
 Parameter: YPOS <- "1.49218901"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.712372651"
Evaluating: 143.194738*(0.712372651-0.5)+3.5172451
 Parameter: ZPOS <- "33.9278912"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "33.9278912" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "33.9278912" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.8986307"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 26.8986307-0
 Parameter: XTRAN <- "26.8986307"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.49218901"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 1.49218901-0
 Parameter: YTRAN <- "1.49218901"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.9278912"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 33.9278912-0
 Parameter: ZTRAN <- "33.9278912"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "26.8986307"
 Parameter: YTRAN -> "1.49218901"
 Parameter: ZTRAN -> "33.9278912"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    26.898631    1.492189   33.927891
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.400653946"
Evaluating: 0.400653946*360.0
 Parameter: XPHI <- "144.235421"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.449929851"
Evaluating: 0.449929851*360.0
 Parameter: YPHI <- "161.974746"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.227026955"
Evaluating: 0.227026955*360.0
 Parameter: ZPHI <- "81.7297038"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.8986307"
 Parameter: YPOS -> "1.49218901"
 Parameter: ZPOS -> "33.9278912"
 Parameter: XPHI -> "144.235421"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.811425    0.584456
    0.000000   -0.584456   -0.811425

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  144.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.8986307"
 Parameter: YPOS -> "1.49218901"
 Parameter: ZPOS -> "33.9278912"
 Parameter: YPHI -> "161.974746"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.950920    0.000000   -0.309436
    0.000000    1.000000    0.000000
    0.309436    0.000000   -0.950920

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  161.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.8986307"
 Parameter: YPOS -> "1.49218901"
 Parameter: ZPOS -> "33.9278912"
 Parameter: ZPHI -> "81.7297038"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.143843    0.989600    0.000000
   -0.989600    0.143843    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   81.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.898631 XMAX =   26.898631 XAVE =   26.898631
    YMIN =    1.492189 YMAX =    1.492189 YAVE =    1.492189
    ZMIN =   33.927891 ZMAX =   33.927891 ZAVE =   33.927891
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.8986307"
Evaluating: 26.8986307+3.5
 Parameter: XMAX <- "30.3986307"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.49218901"
Evaluating: 1.49218901+3.5
 Parameter: YMAX <- "4.99218901"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.9278912"
Evaluating: 33.9278912+3.5
 Parameter: ZMAX <- "37.4278912"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.8986307"
Evaluating: 26.8986307-3.5
 Parameter: XMIN <- "23.3986307"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.49218901"
Evaluating: 1.49218901-3.5
 Parameter: YMIN <- "-2.00781099"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.9278912"
Evaluating: 33.9278912-3.5
 Parameter: ZMIN <- "30.4278912"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.3986307"
 Parameter: XMIN -> "23.3986307"
 Parameter: YMAX -> "4.99218901"
 Parameter: YMIN -> "-2.00781099"
 Parameter: ZMAX -> "37.4278912"
 Parameter: ZMIN -> "30.4278912"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "122"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "122" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "122" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "122"
 Parameter: NPOS -> "65"
Evaluating: 122-65
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.871117368"
Evaluating: 90.067469*(0.871117368-0.5)
 Parameter: XPOS <- "33.425602"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "7.58489546E-02"
Evaluating: 90.067469*(7.58489546E-02-0.5)
 Parameter: YPOS <- "-38.2022111"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.435892296"
Evaluating: 143.194738*(0.435892296-0.5)+3.5172451
 Parameter: ZPOS <- "-5.66264078"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-5.66264078" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-5.66264078" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "122" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "122"
 Parameter: NPOS -> "65"
Evaluating: 122-65
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.648904574"
Evaluating: 90.067469*(0.648904574-0.5)
 Parameter: XPOS <- "13.4114581"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.358786204"
Evaluating: 90.067469*(0.358786204-0.5)
 Parameter: YPOS <- "-12.7187692"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.611403762"
Evaluating: 143.194738*(0.611403762-0.5)+3.5172451
 Parameter: ZPOS <- "19.4696776"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "19.4696776" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "19.4696776" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.4114581"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 13.4114581-0
 Parameter: XTRAN <- "13.4114581"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.7187692"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -12.7187692-0
 Parameter: YTRAN <- "-12.7187692"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.4696776"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 19.4696776-0
 Parameter: ZTRAN <- "19.4696776"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "13.4114581"
 Parameter: YTRAN -> "-12.7187692"
 Parameter: ZTRAN -> "19.4696776"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    13.411458  -12.718769   19.469678
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.176452004"
Evaluating: 0.176452004*360.0
 Parameter: XPHI <- "63.5227214"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.64701585"
Evaluating: 0.64701585*360.0
 Parameter: YPHI <- "232.925706"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.771733543"
Evaluating: 0.771733543*360.0
 Parameter: ZPHI <- "277.824075"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.4114581"
 Parameter: YPOS -> "-12.7187692"
 Parameter: ZPOS -> "19.4696776"
 Parameter: XPHI -> "63.5227214"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.445843    0.895111
    0.000000   -0.895111    0.445843

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   63.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.4114581"
 Parameter: YPOS -> "-12.7187692"
 Parameter: ZPOS -> "19.4696776"
 Parameter: YPHI -> "232.925706"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.602850    0.000000    0.797854
    0.000000    1.000000    0.000000
   -0.797854    0.000000   -0.602850

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  127.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.4114581"
 Parameter: YPOS -> "-12.7187692"
 Parameter: ZPOS -> "19.4696776"
 Parameter: ZPHI -> "277.824075"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.136132   -0.990691    0.000000
    0.990691    0.136132    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   82.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.411458 XMAX =   13.411458 XAVE =   13.411458
    YMIN =  -12.718769 YMAX =  -12.718769 YAVE =  -12.718769
    ZMIN =   19.469678 ZMAX =   19.469678 ZAVE =   19.469678
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.4114581"
Evaluating: 13.4114581+3.5
 Parameter: XMAX <- "16.9114581"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.7187692"
Evaluating: -12.7187692+3.5
 Parameter: YMAX <- "-9.2187692"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.4696776"
Evaluating: 19.4696776+3.5
 Parameter: ZMAX <- "22.9696776"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.4114581"
Evaluating: 13.4114581-3.5
 Parameter: XMIN <- "9.9114581"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.7187692"
Evaluating: -12.7187692-3.5
 Parameter: YMIN <- "-16.2187692"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.4696776"
Evaluating: 19.4696776-3.5
 Parameter: ZMIN <- "15.9696776"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.9114581"
 Parameter: XMIN -> "9.9114581"
 Parameter: YMAX -> "-9.2187692"
 Parameter: YMIN -> "-16.2187692"
 Parameter: ZMAX -> "22.9696776"
 Parameter: ZMIN -> "15.9696776"
 SELRPN>     17 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      9 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35083 NEG      CLA      57       CLA     -8832 MEMB     POPC     9        N             3.6228
35083 NEG      CLA      57       CLA     -8833 MEMB     POPC     9        C12           3.7006
35083 NEG      CLA      57       CLA     -8840 MEMB     POPC     9        C14           2.7234
35083 NEG      CLA      57       CLA     -8848 MEMB     POPC     9        C11           2.9873
35083 NEG      CLA      57       CLA     -8851 MEMB     POPC     9        P             2.4152
35083 NEG      CLA      57       CLA     -8852 MEMB     POPC     9        O13           2.5405
35083 NEG      CLA      57       CLA     -8853 MEMB     POPC     9        O14           3.0823
35083 NEG      CLA      57       CLA     -8854 MEMB     POPC     9        O12           1.7371
35083 NEG      CLA      57       CLA     -8855 MEMB     POPC     9        O11           3.9004
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "122" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "122"
 Parameter: NPOS -> "65"
Evaluating: 122-65
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.899333073"
Evaluating: 90.067469*(0.899333073-0.5)
 Parameter: XPOS <- "35.9669192"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.963350256"
Evaluating: 90.067469*(0.963350256-0.5)
 Parameter: YPOS <- "41.7327848"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.490017197"
Evaluating: 143.194738*(0.490017197-0.5)+3.5172451
 Parameter: ZPOS <- "2.08776024"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "2.08776024" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "2.08776024" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "122" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "122"
 Parameter: NPOS -> "65"
Evaluating: 122-65
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "7.360774648E-02"
Evaluating: 90.067469*(7.360774648E-02-0.5)
 Parameter: XPOS <- "-38.4040711"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.646484117"
Evaluating: 90.067469*(0.646484117-0.5)
 Parameter: YPOS <- "13.1934537"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.959512743"
Evaluating: 143.194738*(0.959512743-0.5)+3.5172451
 Parameter: ZPOS <- "69.3170519"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "69.3170519" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "69.3170519" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.411458 XMAX =   13.411458 XAVE =   13.411458
    YMIN =  -12.718769 YMAX =  -12.718769 YAVE =  -12.718769
    ZMIN =   19.469678 ZMAX =   19.469678 ZAVE =   19.469678
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.4040711"
 RDCMND substituted energy or value "?XAVE" to "13.4114581"
Evaluating: -38.4040711-13.4114581
 Parameter: XTRAN <- "-51.8155292"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.1934537"
 RDCMND substituted energy or value "?YAVE" to "-12.7187692"
Evaluating: 13.1934537--12.7187692
 Parameter: YTRAN <- "25.9122229"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "69.3170519"
 RDCMND substituted energy or value "?ZAVE" to "19.4696776"
Evaluating: 69.3170519-19.4696776
 Parameter: ZTRAN <- "49.8473743"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-51.8155292"
 Parameter: YTRAN -> "25.9122229"
 Parameter: ZTRAN -> "49.8473743"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -51.815529   25.912223   49.847374
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.143357609"
Evaluating: 0.143357609*360.0
 Parameter: XPHI <- "51.6087392"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.299653678"
Evaluating: 0.299653678*360.0
 Parameter: YPHI <- "107.875324"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.150538939"
Evaluating: 0.150538939*360.0
 Parameter: ZPHI <- "54.194018"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.4040711"
 Parameter: YPOS -> "13.1934537"
 Parameter: ZPOS -> "69.3170519"
 Parameter: XPHI -> "51.6087392"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.621028    0.783788
    0.000000   -0.783788    0.621028

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   51.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.4040711"
 Parameter: YPOS -> "13.1934537"
 Parameter: ZPOS -> "69.3170519"
 Parameter: YPHI -> "107.875324"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.306947    0.000000   -0.951727
    0.000000    1.000000    0.000000
    0.951727    0.000000   -0.306947

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  107.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.4040711"
 Parameter: YPOS -> "13.1934537"
 Parameter: ZPOS -> "69.3170519"
 Parameter: ZPHI -> "54.194018"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.585042    0.811003    0.000000
   -0.811003    0.585042    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   54.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.404071 XMAX =  -38.404071 XAVE =  -38.404071
    YMIN =   13.193454 YMAX =   13.193454 YAVE =   13.193454
    ZMIN =   69.317052 ZMAX =   69.317052 ZAVE =   69.317052
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.4040711"
Evaluating: -38.4040711+3.5
 Parameter: XMAX <- "-34.9040711"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.1934537"
Evaluating: 13.1934537+3.5
 Parameter: YMAX <- "16.6934537"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "69.3170519"
Evaluating: 69.3170519+3.5
 Parameter: ZMAX <- "72.8170519"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.4040711"
Evaluating: -38.4040711-3.5
 Parameter: XMIN <- "-41.9040711"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.1934537"
Evaluating: 13.1934537-3.5
 Parameter: YMIN <- "9.6934537"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "69.3170519"
Evaluating: 69.3170519-3.5
 Parameter: ZMIN <- "65.8170519"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.9040711"
 Parameter: XMIN -> "-41.9040711"
 Parameter: YMAX -> "16.6934537"
 Parameter: YMIN -> "9.6934537"
 Parameter: ZMAX -> "72.8170519"
 Parameter: ZMIN -> "65.8170519"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "123"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "123" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "123"
Evaluating: 123
 Parameter: J <- "123"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "123" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "123"
 Parameter: NPOS -> "65"
Evaluating: 123-65
 Parameter: J <- "58"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "2.091974679E-03"
Evaluating: 90.067469*(2.091974679E-03-0.5)
 Parameter: XPOS <- "-44.8453156"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.586602528"
Evaluating: 90.067469*(0.586602528-0.5)
 Parameter: YPOS <- "7.80007051"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.693296058"
Evaluating: 143.194738*(0.693296058-0.5)+3.5172451
 Parameter: ZPOS <- "31.1962235"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.1962235" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.1962235" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-44.8453156"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -44.8453156-0
 Parameter: XTRAN <- "-44.8453156"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "7.80007051"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 7.80007051-0
 Parameter: YTRAN <- "7.80007051"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.1962235"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.1962235-0
 Parameter: ZTRAN <- "31.1962235"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.8453156"
 Parameter: YTRAN -> "7.80007051"
 Parameter: ZTRAN -> "31.1962235"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -44.845316    7.800071   31.196223
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.935395321"
Evaluating: 0.935395321*360.0
 Parameter: XPHI <- "336.742316"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.484186573"
Evaluating: 0.484186573*360.0
 Parameter: YPHI <- "174.307166"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336089084"
Evaluating: 0.336089084*360.0
 Parameter: ZPHI <- "120.99207"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-44.8453156"
 Parameter: YPOS -> "7.80007051"
 Parameter: ZPOS -> "31.1962235"
 Parameter: XPHI -> "336.742316"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.918738   -0.394867
    0.000000    0.394867    0.918738

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   23.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-44.8453156"
 Parameter: YPOS -> "7.80007051"
 Parameter: ZPOS -> "31.1962235"
 Parameter: YPHI -> "174.307166"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.995068    0.000000   -0.099195
    0.000000    1.000000    0.000000
    0.099195    0.000000   -0.995068

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  174.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-44.8453156"
 Parameter: YPOS -> "7.80007051"
 Parameter: ZPOS -> "31.1962235"
 Parameter: ZPHI -> "120.99207"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.514919    0.857239    0.000000
   -0.857239   -0.514919    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  120.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -44.845316 XMAX =  -44.845316 XAVE =  -44.845316
    YMIN =    7.800071 YMAX =    7.800071 YAVE =    7.800071
    ZMIN =   31.196223 ZMAX =   31.196223 ZAVE =   31.196223
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-44.8453156"
Evaluating: -44.8453156+3.5
 Parameter: XMAX <- "-41.3453156"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "7.80007051"
Evaluating: 7.80007051+3.5
 Parameter: YMAX <- "11.3000705"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.1962235"
Evaluating: 31.1962235+3.5
 Parameter: ZMAX <- "34.6962235"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-44.8453156"
Evaluating: -44.8453156-3.5
 Parameter: XMIN <- "-48.3453156"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "7.80007051"
Evaluating: 7.80007051-3.5
 Parameter: YMIN <- "4.30007051"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.1962235"
Evaluating: 31.1962235-3.5
 Parameter: ZMIN <- "27.6962235"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.3453156"
 Parameter: XMIN -> "-48.3453156"
 Parameter: YMAX -> "11.3000705"
 Parameter: YMIN -> "4.30007051"
 Parameter: ZMAX -> "34.6962235"
 Parameter: ZMIN -> "27.6962235"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "124"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "124" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "124"
Evaluating: 124
 Parameter: J <- "124"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "124" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "124"
 Parameter: NPOS -> "65"
Evaluating: 124-65
 Parameter: J <- "59"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.588811045"
Evaluating: 90.067469*(0.588811045-0.5)
 Parameter: XPOS <- "7.99898604"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.107473192"
Evaluating: 90.067469*(0.107473192-0.5)
 Parameter: YPOS <- "-35.3538961"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.989720686"
Evaluating: 143.194738*(0.989720686-0.5)+3.5172451
 Parameter: ZPOS <- "73.6426704"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "73.6426704" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "73.6426704" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.99898604"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.99898604-0
 Parameter: XTRAN <- "7.99898604"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.3538961"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.3538961-0
 Parameter: YTRAN <- "-35.3538961"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "73.6426704"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 73.6426704-0
 Parameter: ZTRAN <- "73.6426704"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.99898604"
 Parameter: YTRAN -> "-35.3538961"
 Parameter: ZTRAN -> "73.6426704"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     7.998986  -35.353896   73.642670
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.943242821"
Evaluating: 0.943242821*360.0
 Parameter: XPHI <- "339.567416"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.277953041"
Evaluating: 0.277953041*360.0
 Parameter: YPHI <- "100.063095"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.612624877"
Evaluating: 0.612624877*360.0
 Parameter: ZPHI <- "220.544956"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.99898604"
 Parameter: YPOS -> "-35.3538961"
 Parameter: ZPOS -> "73.6426704"
 Parameter: XPHI -> "339.567416"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.937084   -0.349105
    0.000000    0.349105    0.937084

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   20.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.99898604"
 Parameter: YPOS -> "-35.3538961"
 Parameter: ZPOS -> "73.6426704"
 Parameter: YPHI -> "100.063095"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.174733    0.000000   -0.984616
    0.000000    1.000000    0.000000
    0.984616    0.000000   -0.174733

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  100.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.99898604"
 Parameter: YPOS -> "-35.3538961"
 Parameter: ZPOS -> "73.6426704"
 Parameter: ZPHI -> "220.544956"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.759896   -0.650044    0.000000
    0.650044   -0.759896    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  139.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.998986 XMAX =    7.998986 XAVE =    7.998986
    YMIN =  -35.353896 YMAX =  -35.353896 YAVE =  -35.353896
    ZMIN =   73.642670 ZMAX =   73.642670 ZAVE =   73.642670
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.99898604"
Evaluating: 7.99898604+3.5
 Parameter: XMAX <- "11.498986"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.3538961"
Evaluating: -35.3538961+3.5
 Parameter: YMAX <- "-31.8538961"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "73.6426704"
Evaluating: 73.6426704+3.5
 Parameter: ZMAX <- "77.1426704"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.99898604"
Evaluating: 7.99898604-3.5
 Parameter: XMIN <- "4.49898604"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.3538961"
Evaluating: -35.3538961-3.5
 Parameter: YMIN <- "-38.8538961"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "73.6426704"
Evaluating: 73.6426704-3.5
 Parameter: ZMIN <- "70.1426704"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.498986"
 Parameter: XMIN -> "4.49898604"
 Parameter: YMAX -> "-31.8538961"
 Parameter: YMIN -> "-38.8538961"
 Parameter: ZMAX -> "77.1426704"
 Parameter: ZMIN -> "70.1426704"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "125"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "125" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "125" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "125"
 Parameter: NPOS -> "65"
Evaluating: 125-65
 Parameter: J <- "60"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.998193316"
Evaluating: 90.067469*(0.998193316-0.5)
 Parameter: XPOS <- "44.871011"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.888825724"
Evaluating: 90.067469*(0.888825724-0.5)
 Parameter: YPOS <- "35.0205488"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "8.783089514E-02"
Evaluating: 143.194738*(8.783089514E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-55.5032019"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-55.5032019" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "44.871011"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 44.871011-0
 Parameter: XTRAN <- "44.871011"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.0205488"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 35.0205488-0
 Parameter: YTRAN <- "35.0205488"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-55.5032019"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -55.5032019-0
 Parameter: ZTRAN <- "-55.5032019"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "44.871011"
 Parameter: YTRAN -> "35.0205488"
 Parameter: ZTRAN -> "-55.5032019"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    44.871011   35.020549  -55.503202
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.756350918"
Evaluating: 0.756350918*360.0
 Parameter: XPHI <- "272.28633"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.554671548"
Evaluating: 0.554671548*360.0
 Parameter: YPHI <- "199.681757"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.539961594"
Evaluating: 0.539961594*360.0
 Parameter: ZPHI <- "194.386174"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "44.871011"
 Parameter: YPOS -> "35.0205488"
 Parameter: ZPOS -> "-55.5032019"
 Parameter: XPHI -> "272.28633"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.039893   -0.999204
    0.000000    0.999204    0.039893

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   87.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "44.871011"
 Parameter: YPOS -> "35.0205488"
 Parameter: ZPOS -> "-55.5032019"
 Parameter: YPHI -> "199.681757"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.941578    0.000000    0.336795
    0.000000    1.000000    0.000000
   -0.336795    0.000000   -0.941578

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  160.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "44.871011"
 Parameter: YPOS -> "35.0205488"
 Parameter: ZPOS -> "-55.5032019"
 Parameter: ZPHI -> "194.386174"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.968643   -0.248456    0.000000
    0.248456   -0.968643    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  165.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.871011 XMAX =   44.871011 XAVE =   44.871011
    YMIN =   35.020549 YMAX =   35.020549 YAVE =   35.020549
    ZMIN =  -55.503202 ZMAX =  -55.503202 ZAVE =  -55.503202
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "44.871011"
Evaluating: 44.871011+3.5
 Parameter: XMAX <- "48.371011"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.0205488"
Evaluating: 35.0205488+3.5
 Parameter: YMAX <- "38.5205488"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-55.5032019"
Evaluating: -55.5032019+3.5
 Parameter: ZMAX <- "-52.0032019"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "44.871011"
Evaluating: 44.871011-3.5
 Parameter: XMIN <- "41.371011"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.0205488"
Evaluating: 35.0205488-3.5
 Parameter: YMIN <- "31.5205488"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-55.5032019"
Evaluating: -55.5032019-3.5
 Parameter: ZMIN <- "-59.0032019"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "48.371011"
 Parameter: XMIN -> "41.371011"
 Parameter: YMAX -> "38.5205488"
 Parameter: YMIN -> "31.5205488"
 Parameter: ZMAX -> "-52.0032019"
 Parameter: ZMIN -> "-59.0032019"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "126"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "126" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "126"
Evaluating: 126
 Parameter: J <- "126"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "126" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "126"
 Parameter: NPOS -> "65"
Evaluating: 126-65
 Parameter: J <- "61"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "1.972553263E-02"
Evaluating: 90.067469*(1.972553263E-02-0.5)
 Parameter: XPOS <- "-43.2571057"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.214545187"
Evaluating: 90.067469*(0.214545187-0.5)
 Parameter: YPOS <- "-25.7101925"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.705240789"
Evaluating: 143.194738*(0.705240789-0.5)+3.5172451
 Parameter: ZPOS <- "32.9066461"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "32.9066461" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "32.9066461" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.2571057"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.2571057-0
 Parameter: XTRAN <- "-43.2571057"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.7101925"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -25.7101925-0
 Parameter: YTRAN <- "-25.7101925"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.9066461"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 32.9066461-0
 Parameter: ZTRAN <- "32.9066461"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.2571057"
 Parameter: YTRAN -> "-25.7101925"
 Parameter: ZTRAN -> "32.9066461"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -43.257106  -25.710193   32.906646
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.479680112"
Evaluating: 0.479680112*360.0
 Parameter: XPHI <- "172.68484"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.862668587"
Evaluating: 0.862668587*360.0
 Parameter: YPHI <- "310.560691"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.346694744"
Evaluating: 0.346694744*360.0
 Parameter: ZPHI <- "124.810108"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.2571057"
 Parameter: YPOS -> "-25.7101925"
 Parameter: ZPOS -> "32.9066461"
 Parameter: XPHI -> "172.68484"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.991861    0.127327
    0.000000   -0.127327   -0.991861

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  172.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.2571057"
 Parameter: YPOS -> "-25.7101925"
 Parameter: ZPOS -> "32.9066461"
 Parameter: YPHI -> "310.560691"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.650253    0.000000    0.759718
    0.000000    1.000000    0.000000
   -0.759718    0.000000    0.650253

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   49.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.2571057"
 Parameter: YPOS -> "-25.7101925"
 Parameter: ZPOS -> "32.9066461"
 Parameter: ZPHI -> "124.810108"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.570858    0.821049    0.000000
   -0.821049   -0.570858    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  124.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.257106 XMAX =  -43.257106 XAVE =  -43.257106
    YMIN =  -25.710193 YMAX =  -25.710193 YAVE =  -25.710193
    ZMIN =   32.906646 ZMAX =   32.906646 ZAVE =   32.906646
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.2571057"
Evaluating: -43.2571057+3.5
 Parameter: XMAX <- "-39.7571057"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.7101925"
Evaluating: -25.7101925+3.5
 Parameter: YMAX <- "-22.2101925"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.9066461"
Evaluating: 32.9066461+3.5
 Parameter: ZMAX <- "36.4066461"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.2571057"
Evaluating: -43.2571057-3.5
 Parameter: XMIN <- "-46.7571057"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.7101925"
Evaluating: -25.7101925-3.5
 Parameter: YMIN <- "-29.2101925"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.9066461"
Evaluating: 32.9066461-3.5
 Parameter: ZMIN <- "29.4066461"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.7571057"
 Parameter: XMIN -> "-46.7571057"
 Parameter: YMAX -> "-22.2101925"
 Parameter: YMIN -> "-29.2101925"
 Parameter: ZMAX -> "36.4066461"
 Parameter: ZMIN -> "29.4066461"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      1 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "127"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "127" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "127"
Evaluating: 127
 Parameter: J <- "127"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "127" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "127"
 Parameter: NPOS -> "65"
Evaluating: 127-65
 Parameter: J <- "62"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.785584145"
Evaluating: 90.067469*(0.785584145-0.5)
 Parameter: XPOS <- "25.7218411"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "7.846153915E-03"
Evaluating: 90.067469*(7.846153915E-03-0.5)
 Parameter: YPOS <- "-44.3270513"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "5.736373815E-02"
Evaluating: 143.194738*(5.736373815E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-59.8659384"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-59.8659384" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.7218411"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 25.7218411-0
 Parameter: XTRAN <- "25.7218411"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-44.3270513"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -44.3270513-0
 Parameter: YTRAN <- "-44.3270513"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-59.8659384"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -59.8659384-0
 Parameter: ZTRAN <- "-59.8659384"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.7218411"
 Parameter: YTRAN -> "-44.3270513"
 Parameter: ZTRAN -> "-59.8659384"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    25.721841  -44.327051  -59.865938
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.129291985"
Evaluating: 0.129291985*360.0
 Parameter: XPHI <- "46.5451146"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.289599099"
Evaluating: 0.289599099*360.0
 Parameter: YPHI <- "104.255676"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.730501029E-02"
Evaluating: 3.730501029E-02*360.0
 Parameter: ZPHI <- "13.4298037"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.7218411"
 Parameter: YPOS -> "-44.3270513"
 Parameter: ZPOS -> "-59.8659384"
 Parameter: XPHI -> "46.5451146"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.687783    0.725916
    0.000000   -0.725916    0.687783

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   46.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.7218411"
 Parameter: YPOS -> "-44.3270513"
 Parameter: ZPOS -> "-59.8659384"
 Parameter: YPHI -> "104.255676"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.246249    0.000000   -0.969207
    0.000000    1.000000    0.000000
    0.969207    0.000000   -0.246249

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  104.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.7218411"
 Parameter: YPOS -> "-44.3270513"
 Parameter: ZPOS -> "-59.8659384"
 Parameter: ZPHI -> "13.4298037"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.972655    0.232254    0.000000
   -0.232254    0.972655    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.721841 XMAX =   25.721841 XAVE =   25.721841
    YMIN =  -44.327051 YMAX =  -44.327051 YAVE =  -44.327051
    ZMIN =  -59.865938 ZMAX =  -59.865938 ZAVE =  -59.865938
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.7218411"
Evaluating: 25.7218411+3.5
 Parameter: XMAX <- "29.2218411"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-44.3270513"
Evaluating: -44.3270513+3.5
 Parameter: YMAX <- "-40.8270513"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-59.8659384"
Evaluating: -59.8659384+3.5
 Parameter: ZMAX <- "-56.3659384"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.7218411"
Evaluating: 25.7218411-3.5
 Parameter: XMIN <- "22.2218411"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-44.3270513"
Evaluating: -44.3270513-3.5
 Parameter: YMIN <- "-47.8270513"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-59.8659384"
Evaluating: -59.8659384-3.5
 Parameter: ZMIN <- "-63.3659384"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.2218411"
 Parameter: XMIN -> "22.2218411"
 Parameter: YMAX -> "-40.8270513"
 Parameter: YMIN -> "-47.8270513"
 Parameter: ZMAX -> "-56.3659384"
 Parameter: ZMIN -> "-63.3659384"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "128"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "128" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "128"
Evaluating: 128
 Parameter: J <- "128"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "128" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "128"
 Parameter: NPOS -> "65"
Evaluating: 128-65
 Parameter: J <- "63"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.701845663"
Evaluating: 90.067469*(0.701845663-0.5)
 Parameter: XPOS <- "18.179728"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.142845613"
Evaluating: 90.067469*(0.142845613-0.5)
 Parameter: YPOS <- "-32.1679917"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.461240342"
Evaluating: 143.194738*(0.461240342-0.5)+3.5172451
 Parameter: ZPOS <- "-2.03293397"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-2.03293397" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-2.03293397" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "128"
Evaluating: 128
 Parameter: J <- "128"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "128" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "128"
 Parameter: NPOS -> "65"
Evaluating: 128-65
 Parameter: J <- "63"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.94253245"
Evaluating: 90.067469*(0.94253245-0.5)
 Parameter: XPOS <- "39.8577777"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.822164877"
Evaluating: 90.067469*(0.822164877-0.5)
 Parameter: YPOS <- "29.0165751"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "7.099509181E-02"
Evaluating: 143.194738*(7.099509181E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-57.9140003"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-57.9140003" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.8577777"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 39.8577777-0
 Parameter: XTRAN <- "39.8577777"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.0165751"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.0165751-0
 Parameter: YTRAN <- "29.0165751"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-57.9140003"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -57.9140003-0
 Parameter: ZTRAN <- "-57.9140003"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.8577777"
 Parameter: YTRAN -> "29.0165751"
 Parameter: ZTRAN -> "-57.9140003"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    39.857778   29.016575  -57.914000
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.647340746"
Evaluating: 0.647340746*360.0
 Parameter: XPHI <- "233.042669"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.650670267"
Evaluating: 0.650670267*360.0
 Parameter: YPHI <- "234.241296"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.399988963"
Evaluating: 0.399988963*360.0
 Parameter: ZPHI <- "143.996027"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.8577777"
 Parameter: YPOS -> "29.0165751"
 Parameter: ZPOS -> "-57.9140003"
 Parameter: XPHI -> "233.042669"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.601220   -0.799083
    0.000000    0.799083   -0.601220

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  126.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.8577777"
 Parameter: YPOS -> "29.0165751"
 Parameter: ZPOS -> "-57.9140003"
 Parameter: YPHI -> "234.241296"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.584373    0.000000    0.811485
    0.000000    1.000000    0.000000
   -0.811485    0.000000   -0.584373

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  125.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.8577777"
 Parameter: YPOS -> "29.0165751"
 Parameter: ZPOS -> "-57.9140003"
 Parameter: ZPHI -> "143.996027"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.808976    0.587841    0.000000
   -0.587841   -0.808976    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  144.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.857778 XMAX =   39.857778 XAVE =   39.857778
    YMIN =   29.016575 YMAX =   29.016575 YAVE =   29.016575
    ZMIN =  -57.914000 ZMAX =  -57.914000 ZAVE =  -57.914000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.8577777"
Evaluating: 39.8577777+3.5
 Parameter: XMAX <- "43.3577777"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.0165751"
Evaluating: 29.0165751+3.5
 Parameter: YMAX <- "32.5165751"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-57.9140003"
Evaluating: -57.9140003+3.5
 Parameter: ZMAX <- "-54.4140003"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.8577777"
Evaluating: 39.8577777-3.5
 Parameter: XMIN <- "36.3577777"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.0165751"
Evaluating: 29.0165751-3.5
 Parameter: YMIN <- "25.5165751"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-57.9140003"
Evaluating: -57.9140003-3.5
 Parameter: ZMIN <- "-61.4140003"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.3577777"
 Parameter: XMIN -> "36.3577777"
 Parameter: YMAX -> "32.5165751"
 Parameter: YMIN -> "25.5165751"
 Parameter: ZMAX -> "-54.4140003"
 Parameter: ZMIN -> "-61.4140003"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "129"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "129" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "129"
Evaluating: 129
 Parameter: J <- "129"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "129" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "129"
 Parameter: NPOS -> "65"
Evaluating: 129-65
 Parameter: J <- "64"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "2.641159617E-02"
Evaluating: 90.067469*(2.641159617E-02-0.5)
 Parameter: XPOS <- "-42.6549089"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.33096919"
Evaluating: 90.067469*(0.33096919-0.5)
 Parameter: YPOS <- "-15.2241772"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.731632869"
Evaluating: 143.194738*(0.731632869-0.5)+3.5172451
 Parameter: ZPOS <- "36.6858531"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "36.6858531" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "36.6858531" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.6549089"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -42.6549089-0
 Parameter: XTRAN <- "-42.6549089"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.2241772"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -15.2241772-0
 Parameter: YTRAN <- "-15.2241772"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.6858531"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 36.6858531-0
 Parameter: ZTRAN <- "36.6858531"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.6549089"
 Parameter: YTRAN -> "-15.2241772"
 Parameter: ZTRAN -> "36.6858531"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -42.654909  -15.224177   36.685853
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.909716078"
Evaluating: 0.909716078*360.0
 Parameter: XPHI <- "327.497788"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.236852855"
Evaluating: 0.236852855*360.0
 Parameter: YPHI <- "85.2670278"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.246148707"
Evaluating: 0.246148707*360.0
 Parameter: ZPHI <- "88.6135345"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.6549089"
 Parameter: YPOS -> "-15.2241772"
 Parameter: ZPOS -> "36.6858531"
 Parameter: XPHI -> "327.497788"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.843371   -0.537332
    0.000000    0.537332    0.843371

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   32.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.6549089"
 Parameter: YPOS -> "-15.2241772"
 Parameter: ZPOS -> "36.6858531"
 Parameter: YPHI -> "85.2670278"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.082512    0.000000   -0.996590
    0.000000    1.000000    0.000000
    0.996590    0.000000    0.082512

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   85.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.6549089"
 Parameter: YPOS -> "-15.2241772"
 Parameter: ZPOS -> "36.6858531"
 Parameter: ZPHI -> "88.6135345"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.024196    0.999707    0.000000
   -0.999707    0.024196    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   88.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.654909 XMAX =  -42.654909 XAVE =  -42.654909
    YMIN =  -15.224177 YMAX =  -15.224177 YAVE =  -15.224177
    ZMIN =   36.685853 ZMAX =   36.685853 ZAVE =   36.685853
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.6549089"
Evaluating: -42.6549089+3.5
 Parameter: XMAX <- "-39.1549089"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.2241772"
Evaluating: -15.2241772+3.5
 Parameter: YMAX <- "-11.7241772"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.6858531"
Evaluating: 36.6858531+3.5
 Parameter: ZMAX <- "40.1858531"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.6549089"
Evaluating: -42.6549089-3.5
 Parameter: XMIN <- "-46.1549089"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.2241772"
Evaluating: -15.2241772-3.5
 Parameter: YMIN <- "-18.7241772"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.6858531"
Evaluating: 36.6858531-3.5
 Parameter: ZMIN <- "33.1858531"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.1549089"
 Parameter: XMIN -> "-46.1549089"
 Parameter: YMAX -> "-11.7241772"
 Parameter: YMIN -> "-18.7241772"
 Parameter: ZMAX -> "40.1858531"
 Parameter: ZMIN -> "33.1858531"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "130"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "130" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "130" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "130"
 Parameter: NPOS -> "65"
Evaluating: 130-65
 Parameter: J <- "65"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.116677628"
Evaluating: 90.067469*(0.116677628-0.5)
 Parameter: XPOS <- "-34.5248759"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.338020733"
Evaluating: 90.067469*(0.338020733-0.5)
 Parameter: YPOS <- "-14.5890626"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.674657858"
Evaluating: 143.194738*(0.674657858-0.5)+3.5172451
 Parameter: ZPOS <- "28.5273313"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "28.5273313" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "28.5273313" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-34.5248759"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -34.5248759-0
 Parameter: XTRAN <- "-34.5248759"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.5890626"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.5890626-0
 Parameter: YTRAN <- "-14.5890626"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.5273313"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 28.5273313-0
 Parameter: ZTRAN <- "28.5273313"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.5248759"
 Parameter: YTRAN -> "-14.5890626"
 Parameter: ZTRAN -> "28.5273313"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -34.524876  -14.589063   28.527331
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.404033538"
Evaluating: 0.404033538*360.0
 Parameter: XPHI <- "145.452074"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.86462201"
Evaluating: 0.86462201*360.0
 Parameter: YPHI <- "311.263924"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.784111996"
Evaluating: 0.784111996*360.0
 Parameter: ZPHI <- "282.280319"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-34.5248759"
 Parameter: YPOS -> "-14.5890626"
 Parameter: ZPOS -> "28.5273313"
 Parameter: XPHI -> "145.452074"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.823652    0.567095
    0.000000   -0.567095   -0.823652

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  145.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-34.5248759"
 Parameter: YPOS -> "-14.5890626"
 Parameter: ZPOS -> "28.5273313"
 Parameter: YPHI -> "311.263924"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.659529    0.000000    0.751680
    0.000000    1.000000    0.000000
   -0.751680    0.000000    0.659529

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   48.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-34.5248759"
 Parameter: YPOS -> "-14.5890626"
 Parameter: ZPOS -> "28.5273313"
 Parameter: ZPHI -> "282.280319"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.212695   -0.977119    0.000000
    0.977119    0.212695    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   77.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -34.524876 XMAX =  -34.524876 XAVE =  -34.524876
    YMIN =  -14.589063 YMAX =  -14.589063 YAVE =  -14.589063
    ZMIN =   28.527331 ZMAX =   28.527331 ZAVE =   28.527331
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-34.5248759"
Evaluating: -34.5248759+3.5
 Parameter: XMAX <- "-31.0248759"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.5890626"
Evaluating: -14.5890626+3.5
 Parameter: YMAX <- "-11.0890626"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.5273313"
Evaluating: 28.5273313+3.5
 Parameter: ZMAX <- "32.0273313"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-34.5248759"
Evaluating: -34.5248759-3.5
 Parameter: XMIN <- "-38.0248759"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.5890626"
Evaluating: -14.5890626-3.5
 Parameter: YMIN <- "-18.0890626"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.5273313"
Evaluating: 28.5273313-3.5
 Parameter: ZMIN <- "25.0273313"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-31.0248759"
 Parameter: XMIN -> "-38.0248759"
 Parameter: YMAX -> "-11.0890626"
 Parameter: YMIN -> "-18.0890626"
 Parameter: ZMAX -> "32.0273313"
 Parameter: ZMIN -> "25.0273313"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "131"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "131" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "131"
Evaluating: 131
 Parameter: J <- "131"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "131" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "131"
 Parameter: NPOS -> "65"
Evaluating: 131-65
 Parameter: J <- "66"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.157481497"
Evaluating: 90.067469*(0.157481497-0.5)
 Parameter: XPOS <- "-30.8497747"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "6.403028503E-02"
Evaluating: 90.067469*(6.403028503E-02-0.5)
 Parameter: YPOS <- "-39.2666888"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.808863082"
Evaluating: 143.194738*(0.808863082-0.5)+3.5172451
 Parameter: ZPOS <- "47.7448132"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.7448132" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.7448132" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.8497747"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -30.8497747-0
 Parameter: XTRAN <- "-30.8497747"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.2666888"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -39.2666888-0
 Parameter: YTRAN <- "-39.2666888"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.7448132"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 47.7448132-0
 Parameter: ZTRAN <- "47.7448132"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-30.8497747"
 Parameter: YTRAN -> "-39.2666888"
 Parameter: ZTRAN -> "47.7448132"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -30.849775  -39.266689   47.744813
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.139513518E-03"
Evaluating: 4.139513518E-03*360.0
 Parameter: XPHI <- "1.49022487"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.144122926"
Evaluating: 0.144122926*360.0
 Parameter: YPHI <- "51.8842534"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.333050631"
Evaluating: 0.333050631*360.0
 Parameter: ZPHI <- "119.898227"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.8497747"
 Parameter: YPOS -> "-39.2666888"
 Parameter: ZPOS -> "47.7448132"
 Parameter: XPHI -> "1.49022487"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999662    0.026006
    0.000000   -0.026006    0.999662

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    1.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.8497747"
 Parameter: YPOS -> "-39.2666888"
 Parameter: ZPOS -> "47.7448132"
 Parameter: YPHI -> "51.8842534"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.617252    0.000000   -0.786765
    0.000000    1.000000    0.000000
    0.786765    0.000000    0.617252

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   51.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.8497747"
 Parameter: YPOS -> "-39.2666888"
 Parameter: ZPOS -> "47.7448132"
 Parameter: ZPHI -> "119.898227"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.498461    0.866912    0.000000
   -0.866912   -0.498461    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  119.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.849775 XMAX =  -30.849775 XAVE =  -30.849775
    YMIN =  -39.266689 YMAX =  -39.266689 YAVE =  -39.266689
    ZMIN =   47.744813 ZMAX =   47.744813 ZAVE =   47.744813
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.8497747"
Evaluating: -30.8497747+3.5
 Parameter: XMAX <- "-27.3497747"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.2666888"
Evaluating: -39.2666888+3.5
 Parameter: YMAX <- "-35.7666888"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.7448132"
Evaluating: 47.7448132+3.5
 Parameter: ZMAX <- "51.2448132"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.8497747"
Evaluating: -30.8497747-3.5
 Parameter: XMIN <- "-34.3497747"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.2666888"
Evaluating: -39.2666888-3.5
 Parameter: YMIN <- "-42.7666888"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.7448132"
Evaluating: 47.7448132-3.5
 Parameter: ZMIN <- "44.2448132"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.3497747"
 Parameter: XMIN -> "-34.3497747"
 Parameter: YMAX -> "-35.7666888"
 Parameter: YMIN -> "-42.7666888"
 Parameter: ZMAX -> "51.2448132"
 Parameter: ZMIN -> "44.2448132"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "132"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "132" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "132"
Evaluating: 132
 Parameter: J <- "132"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "132" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "132"
 Parameter: NPOS -> "65"
Evaluating: 132-65
 Parameter: J <- "67"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.223384821"
Evaluating: 90.067469*(0.223384821-0.5)
 Parameter: XPOS <- "-24.9140291"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.629443444"
Evaluating: 90.067469*(0.629443444-0.5)
 Parameter: YPOS <- "11.6586434"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.179044679"
Evaluating: 143.194738*(0.179044679-0.5)+3.5172451
 Parameter: ZPOS <- "-42.441868"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-42.441868" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.9140291"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -24.9140291-0
 Parameter: XTRAN <- "-24.9140291"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.6586434"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 11.6586434-0
 Parameter: YTRAN <- "11.6586434"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-42.441868"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -42.441868-0
 Parameter: ZTRAN <- "-42.441868"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.9140291"
 Parameter: YTRAN -> "11.6586434"
 Parameter: ZTRAN -> "-42.441868"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -24.914029   11.658643  -42.441868
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.854700096"
Evaluating: 0.854700096*360.0
 Parameter: XPHI <- "307.692035"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.8645803E-02"
Evaluating: 1.8645803E-02*360.0
 Parameter: YPHI <- "6.71248908"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.719729272"
Evaluating: 0.719729272*360.0
 Parameter: ZPHI <- "259.102538"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.9140291"
 Parameter: YPOS -> "11.6586434"
 Parameter: ZPOS -> "-42.441868"
 Parameter: XPHI -> "307.692035"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.611417   -0.791309
    0.000000    0.791309    0.611417

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   52.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.9140291"
 Parameter: YPOS -> "11.6586434"
 Parameter: ZPOS -> "-42.441868"
 Parameter: YPHI -> "6.71248908"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.993145    0.000000   -0.116887
    0.000000    1.000000    0.000000
    0.116887    0.000000    0.993145

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    6.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.9140291"
 Parameter: YPOS -> "11.6586434"
 Parameter: ZPOS -> "-42.441868"
 Parameter: ZPHI -> "259.102538"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.189052   -0.981967    0.000000
    0.981967   -0.189052    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  100.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.914029 XMAX =  -24.914029 XAVE =  -24.914029
    YMIN =   11.658643 YMAX =   11.658643 YAVE =   11.658643
    ZMIN =  -42.441868 ZMAX =  -42.441868 ZAVE =  -42.441868
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.9140291"
Evaluating: -24.9140291+3.5
 Parameter: XMAX <- "-21.4140291"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.6586434"
Evaluating: 11.6586434+3.5
 Parameter: YMAX <- "15.1586434"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-42.441868"
Evaluating: -42.441868+3.5
 Parameter: ZMAX <- "-38.941868"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.9140291"
Evaluating: -24.9140291-3.5
 Parameter: XMIN <- "-28.4140291"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.6586434"
Evaluating: 11.6586434-3.5
 Parameter: YMIN <- "8.1586434"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-42.441868"
Evaluating: -42.441868-3.5
 Parameter: ZMIN <- "-45.941868"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.4140291"
 Parameter: XMIN -> "-28.4140291"
 Parameter: YMAX -> "15.1586434"
 Parameter: YMIN -> "8.1586434"
 Parameter: ZMAX -> "-38.941868"
 Parameter: ZMIN -> "-45.941868"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "133"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "133" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "133" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "133"
 Parameter: NPOS -> "65"
Evaluating: 133-65
 Parameter: J <- "68"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.29196827"
Evaluating: 90.067469*(0.29196827-0.5)
 Parameter: XPOS <- "-18.7368914"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.340417366"
Evaluating: 90.067469*(0.340417366-0.5)
 Parameter: YPOS <- "-14.3732039"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.336034559"
Evaluating: 143.194738*(0.336034559-0.5)+3.5172451
 Parameter: ZPOS <- "-19.9617433"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-19.9617433" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.7368914"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -18.7368914-0
 Parameter: XTRAN <- "-18.7368914"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.3732039"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -14.3732039-0
 Parameter: YTRAN <- "-14.3732039"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.9617433"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -19.9617433-0
 Parameter: ZTRAN <- "-19.9617433"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.7368914"
 Parameter: YTRAN -> "-14.3732039"
 Parameter: ZTRAN -> "-19.9617433"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -18.736891  -14.373204  -19.961743
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.418145247"
Evaluating: 0.418145247*360.0
 Parameter: XPHI <- "150.532289"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.360747163"
Evaluating: 0.360747163*360.0
 Parameter: YPHI <- "129.868979"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.542679776"
Evaluating: 0.542679776*360.0
 Parameter: ZPHI <- "195.364719"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.7368914"
 Parameter: YPOS -> "-14.3732039"
 Parameter: ZPOS -> "-19.9617433"
 Parameter: XPHI -> "150.532289"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.870633    0.491933
    0.000000   -0.491933   -0.870633

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  150.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.7368914"
 Parameter: YPOS -> "-14.3732039"
 Parameter: ZPOS -> "-19.9617433"
 Parameter: YPHI -> "129.868979"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.641034    0.000000   -0.767512
    0.000000    1.000000    0.000000
    0.767512    0.000000   -0.641034

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  129.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.7368914"
 Parameter: YPOS -> "-14.3732039"
 Parameter: ZPOS -> "-19.9617433"
 Parameter: ZPHI -> "195.364719"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.964259   -0.264962    0.000000
    0.264962   -0.964259    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  164.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.736891 XMAX =  -18.736891 XAVE =  -18.736891
    YMIN =  -14.373204 YMAX =  -14.373204 YAVE =  -14.373204
    ZMIN =  -19.961743 ZMAX =  -19.961743 ZAVE =  -19.961743
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.7368914"
Evaluating: -18.7368914+3.5
 Parameter: XMAX <- "-15.2368914"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.3732039"
Evaluating: -14.3732039+3.5
 Parameter: YMAX <- "-10.8732039"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.9617433"
Evaluating: -19.9617433+3.5
 Parameter: ZMAX <- "-16.4617433"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.7368914"
Evaluating: -18.7368914-3.5
 Parameter: XMIN <- "-22.2368914"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.3732039"
Evaluating: -14.3732039-3.5
 Parameter: YMIN <- "-17.8732039"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.9617433"
Evaluating: -19.9617433-3.5
 Parameter: ZMIN <- "-23.4617433"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.2368914"
 Parameter: XMIN -> "-22.2368914"
 Parameter: YMAX -> "-10.8732039"
 Parameter: YMIN -> "-17.8732039"
 Parameter: ZMAX -> "-16.4617433"
 Parameter: ZMIN -> "-23.4617433"
 SELRPN>     36 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      5 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35094 NEG      CLA      68       CLA     -5906 PROA     LYS      401      C             4.5335
35094 NEG      CLA      68       CLA     -5907 PROA     LYS      401      O             3.9014
35094 NEG      CLA      68       CLA     -5912 PROA     ILE      402      CB            3.2999
35094 NEG      CLA      68       CLA     -5918 PROA     ILE      402      CG1           3.0000
35094 NEG      CLA      68       CLA     -5921 PROA     ILE      402      CD            2.0182
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "133" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "133"
 Parameter: NPOS -> "65"
Evaluating: 133-65
 Parameter: J <- "68"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.219963201"
Evaluating: 90.067469*(0.219963201-0.5)
 Parameter: XPOS <- "-25.2222057"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "8.604249599E-02"
Evaluating: 90.067469*(8.604249599E-02-0.5)
 Parameter: YPOS <- "-37.2841047"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.488752957"
Evaluating: 143.194738*(0.488752957-0.5)+3.5172451
 Parameter: ZPOS <- "1.90672772"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "1.90672772" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "1.90672772" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "133" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "133"
 Parameter: NPOS -> "65"
Evaluating: 133-65
 Parameter: J <- "68"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.797919742"
Evaluating: 90.067469*(0.797919742-0.5)
 Parameter: XPOS <- "26.8328771"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.461392585"
Evaluating: 90.067469*(0.461392585-0.5)
 Parameter: YPOS <- "-3.47727215"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.911756412"
Evaluating: 143.194738*(0.911756412-0.5)+3.5172451
 Parameter: ZPOS <- "62.4785966"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "62.4785966" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "62.4785966" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.736891 XMAX =  -18.736891 XAVE =  -18.736891
    YMIN =  -14.373204 YMAX =  -14.373204 YAVE =  -14.373204
    ZMIN =  -19.961743 ZMAX =  -19.961743 ZAVE =  -19.961743
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.8328771"
 RDCMND substituted energy or value "?XAVE" to "-18.7368914"
Evaluating: 26.8328771--18.7368914
 Parameter: XTRAN <- "45.5697685"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.47727215"
 RDCMND substituted energy or value "?YAVE" to "-14.3732039"
Evaluating: -3.47727215--14.3732039
 Parameter: YTRAN <- "10.8959317"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "62.4785966"
 RDCMND substituted energy or value "?ZAVE" to "-19.9617433"
Evaluating: 62.4785966--19.9617433
 Parameter: ZTRAN <- "82.4403399"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "45.5697685"
 Parameter: YTRAN -> "10.8959317"
 Parameter: ZTRAN -> "82.4403399"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    45.569769   10.895932   82.440340
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.46340376"
Evaluating: 0.46340376*360.0
 Parameter: XPHI <- "166.825354"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.190923466"
Evaluating: 0.190923466*360.0
 Parameter: YPHI <- "68.7324478"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.288127817"
Evaluating: 0.288127817*360.0
 Parameter: ZPHI <- "103.726014"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.8328771"
 Parameter: YPOS -> "-3.47727215"
 Parameter: ZPOS -> "62.4785966"
 Parameter: XPHI -> "166.825354"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.973680    0.227920
    0.000000   -0.227920   -0.973680

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  166.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.8328771"
 Parameter: YPOS -> "-3.47727215"
 Parameter: ZPOS -> "62.4785966"
 Parameter: YPHI -> "68.7324478"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.362724    0.000000   -0.931897
    0.000000    1.000000    0.000000
    0.931897    0.000000    0.362724

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.8328771"
 Parameter: YPOS -> "-3.47727215"
 Parameter: ZPOS -> "62.4785966"
 Parameter: ZPHI -> "103.726014"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.237279    0.971441    0.000000
   -0.971441   -0.237279    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  103.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.832877 XMAX =   26.832877 XAVE =   26.832877
    YMIN =   -3.477272 YMAX =   -3.477272 YAVE =   -3.477272
    ZMIN =   62.478597 ZMAX =   62.478597 ZAVE =   62.478597
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.8328771"
Evaluating: 26.8328771+3.5
 Parameter: XMAX <- "30.3328771"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.47727215"
Evaluating: -3.47727215+3.5
 Parameter: YMAX <- "2.272785E-02"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "62.4785966"
Evaluating: 62.4785966+3.5
 Parameter: ZMAX <- "65.9785966"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.8328771"
Evaluating: 26.8328771-3.5
 Parameter: XMIN <- "23.3328771"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.47727215"
Evaluating: -3.47727215-3.5
 Parameter: YMIN <- "-6.97727215"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "62.4785966"
Evaluating: 62.4785966-3.5
 Parameter: ZMIN <- "58.9785966"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.3328771"
 Parameter: XMIN -> "23.3328771"
 Parameter: YMAX -> "2.272785E-02"
 Parameter: YMIN -> "-6.97727215"
 Parameter: ZMAX -> "65.9785966"
 Parameter: ZMIN -> "58.9785966"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "134"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "134" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "134" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "134"
 Parameter: NPOS -> "65"
Evaluating: 134-65
 Parameter: J <- "69"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.545121922"
Evaluating: 90.067469*(0.545121922-0.5)
 Parameter: XPOS <- "4.06401731"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.984511876"
Evaluating: 90.067469*(0.984511876-0.5)
 Parameter: YPOS <- "43.6387584"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.630703354"
Evaluating: 143.194738*(0.630703354-0.5)+3.5172451
 Parameter: ZPOS <- "22.2332776"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "22.2332776" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "22.2332776" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.06401731"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 4.06401731-0
 Parameter: XTRAN <- "4.06401731"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "43.6387584"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 43.6387584-0
 Parameter: YTRAN <- "43.6387584"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.2332776"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 22.2332776-0
 Parameter: ZTRAN <- "22.2332776"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.06401731"
 Parameter: YTRAN -> "43.6387584"
 Parameter: ZTRAN -> "22.2332776"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     4.064017   43.638758   22.233278
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.30075404"
Evaluating: 0.30075404*360.0
 Parameter: XPHI <- "108.271454"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.648060796"
Evaluating: 0.648060796*360.0
 Parameter: YPHI <- "233.301887"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.958008592E-02"
Evaluating: 1.958008592E-02*360.0
 Parameter: ZPHI <- "7.04883093"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.06401731"
 Parameter: YPOS -> "43.6387584"
 Parameter: ZPOS -> "22.2332776"
 Parameter: XPHI -> "108.271454"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.313519    0.949582
    0.000000   -0.949582   -0.313519

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  108.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.06401731"
 Parameter: YPOS -> "43.6387584"
 Parameter: ZPOS -> "22.2332776"
 Parameter: YPHI -> "233.301887"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.597599    0.000000    0.801795
    0.000000    1.000000    0.000000
   -0.801795    0.000000   -0.597599

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  126.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.06401731"
 Parameter: YPOS -> "43.6387584"
 Parameter: ZPOS -> "22.2332776"
 Parameter: ZPHI -> "7.04883093"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.992442    0.122715    0.000000
   -0.122715    0.992442    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    7.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.064017 XMAX =    4.064017 XAVE =    4.064017
    YMIN =   43.638758 YMAX =   43.638758 YAVE =   43.638758
    ZMIN =   22.233278 ZMAX =   22.233278 ZAVE =   22.233278
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.06401731"
Evaluating: 4.06401731+3.5
 Parameter: XMAX <- "7.56401731"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "43.6387584"
Evaluating: 43.6387584+3.5
 Parameter: YMAX <- "47.1387584"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.2332776"
Evaluating: 22.2332776+3.5
 Parameter: ZMAX <- "25.7332776"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.06401731"
Evaluating: 4.06401731-3.5
 Parameter: XMIN <- "0.56401731"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "43.6387584"
Evaluating: 43.6387584-3.5
 Parameter: YMIN <- "40.1387584"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.2332776"
Evaluating: 22.2332776-3.5
 Parameter: ZMIN <- "18.7332776"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.56401731"
 Parameter: XMIN -> "0.56401731"
 Parameter: YMAX -> "47.1387584"
 Parameter: YMIN -> "40.1387584"
 Parameter: ZMAX -> "25.7332776"
 Parameter: ZMIN -> "18.7332776"
 SELRPN>     12 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      4 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35095 NEG      CLA      69       CLA     -**** MEMB     POPC     85       N             3.3291
35095 NEG      CLA      69       CLA     -**** MEMB     POPC     85       C12           3.4189
35095 NEG      CLA      69       CLA     -**** MEMB     POPC     85       C14           3.7205
35095 NEG      CLA      69       CLA     -**** MEMB     POPC     85       C15           2.3858
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "134" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "134"
 Parameter: NPOS -> "65"
Evaluating: 134-65
 Parameter: J <- "69"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.335639432"
Evaluating: 90.067469*(0.335639432-0.5)
 Parameter: XPOS <- "-14.8035404"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.568551697"
Evaluating: 90.067469*(0.568551697-0.5)
 Parameter: YPOS <- "6.17427784"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.309617901"
Evaluating: 143.194738*(0.309617901-0.5)+3.5172451
 Parameter: ZPOS <- "-23.7444697"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-23.7444697" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.064017 XMAX =    4.064017 XAVE =    4.064017
    YMIN =   43.638758 YMAX =   43.638758 YAVE =   43.638758
    ZMIN =   22.233278 ZMAX =   22.233278 ZAVE =   22.233278
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.8035404"
 RDCMND substituted energy or value "?XAVE" to "4.06401731"
Evaluating: -14.8035404-4.06401731
 Parameter: XTRAN <- "-18.8675577"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.17427784"
 RDCMND substituted energy or value "?YAVE" to "43.6387584"
Evaluating: 6.17427784-43.6387584
 Parameter: YTRAN <- "-37.4644806"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.7444697"
 RDCMND substituted energy or value "?ZAVE" to "22.2332776"
Evaluating: -23.7444697-22.2332776
 Parameter: ZTRAN <- "-45.9777473"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.8675577"
 Parameter: YTRAN -> "-37.4644806"
 Parameter: ZTRAN -> "-45.9777473"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -18.867558  -37.464481  -45.977747
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.286051387"
Evaluating: 0.286051387*360.0
 Parameter: XPHI <- "102.978499"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.897057201"
Evaluating: 0.897057201*360.0
 Parameter: YPHI <- "322.940592"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.441996158"
Evaluating: 0.441996158*360.0
 Parameter: ZPHI <- "159.118617"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.8035404"
 Parameter: YPOS -> "6.17427784"
 Parameter: ZPOS -> "-23.7444697"
 Parameter: XPHI -> "102.978499"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.224585    0.974454
    0.000000   -0.974454   -0.224585

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  102.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.8035404"
 Parameter: YPOS -> "6.17427784"
 Parameter: ZPOS -> "-23.7444697"
 Parameter: YPHI -> "322.940592"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.798011    0.000000    0.602643
    0.000000    1.000000    0.000000
   -0.602643    0.000000    0.798011

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   37.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.8035404"
 Parameter: YPOS -> "6.17427784"
 Parameter: ZPOS -> "-23.7444697"
 Parameter: ZPHI -> "159.118617"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.934320    0.356434    0.000000
   -0.356434   -0.934320    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  159.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.803540 XMAX =  -14.803540 XAVE =  -14.803540
    YMIN =    6.174278 YMAX =    6.174278 YAVE =    6.174278
    ZMIN =  -23.744470 ZMAX =  -23.744470 ZAVE =  -23.744470
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.8035404"
Evaluating: -14.8035404+3.5
 Parameter: XMAX <- "-11.3035404"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.17427782"
Evaluating: 6.17427782+3.5
 Parameter: YMAX <- "9.67427782"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.7444697"
Evaluating: -23.7444697+3.5
 Parameter: ZMAX <- "-20.2444697"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.8035404"
Evaluating: -14.8035404-3.5
 Parameter: XMIN <- "-18.3035404"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.17427782"
Evaluating: 6.17427782-3.5
 Parameter: YMIN <- "2.67427782"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.7444697"
Evaluating: -23.7444697-3.5
 Parameter: ZMIN <- "-27.2444697"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.3035404"
 Parameter: XMIN -> "-18.3035404"
 Parameter: YMAX -> "9.67427782"
 Parameter: YMIN -> "2.67427782"
 Parameter: ZMAX -> "-20.2444697"
 Parameter: ZMIN -> "-27.2444697"
 SELRPN>      2 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "135"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "135" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "135"
Evaluating: 135
 Parameter: J <- "135"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "135" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "135"
 Parameter: NPOS -> "65"
Evaluating: 135-65
 Parameter: J <- "70"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.148472427"
Evaluating: 90.067469*(0.148472427-0.5)
 Parameter: XPOS <- "-31.6611988"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.255555784"
Evaluating: 90.067469*(0.255555784-0.5)
 Parameter: YPOS <- "-22.0164718"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.792892083"
Evaluating: 143.194738*(0.792892083-0.5)+3.5172451
 Parameter: ZPOS <- "45.4578502"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.4578502" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.4578502" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.6611988"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -31.6611988-0
 Parameter: XTRAN <- "-31.6611988"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.0164718"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.0164718-0
 Parameter: YTRAN <- "-22.0164718"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.4578502"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 45.4578502-0
 Parameter: ZTRAN <- "45.4578502"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.6611988"
 Parameter: YTRAN -> "-22.0164718"
 Parameter: ZTRAN -> "45.4578502"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -31.661199  -22.016472   45.457850
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.333668482"
Evaluating: 0.333668482*360.0
 Parameter: XPHI <- "120.120654"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.881991326"
Evaluating: 0.881991326*360.0
 Parameter: YPHI <- "317.516877"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.949496955"
Evaluating: 0.949496955*360.0
 Parameter: ZPHI <- "341.818904"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.6611988"
 Parameter: YPOS -> "-22.0164718"
 Parameter: ZPOS -> "45.4578502"
 Parameter: XPHI -> "120.120654"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.501823    0.864971
    0.000000   -0.864971   -0.501823

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  120.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.6611988"
 Parameter: YPOS -> "-22.0164718"
 Parameter: ZPOS -> "45.4578502"
 Parameter: YPHI -> "317.516877"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.737476    0.000000    0.675373
    0.000000    1.000000    0.000000
   -0.675373    0.000000    0.737476

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   42.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.6611988"
 Parameter: YPOS -> "-22.0164718"
 Parameter: ZPOS -> "45.4578502"
 Parameter: ZPHI -> "341.818904"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.950075   -0.312021    0.000000
    0.312021    0.950075    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   18.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.661199 XMAX =  -31.661199 XAVE =  -31.661199
    YMIN =  -22.016472 YMAX =  -22.016472 YAVE =  -22.016472
    ZMIN =   45.457850 ZMAX =   45.457850 ZAVE =   45.457850
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.6611988"
Evaluating: -31.6611988+3.5
 Parameter: XMAX <- "-28.1611988"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.0164718"
Evaluating: -22.0164718+3.5
 Parameter: YMAX <- "-18.5164718"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.4578502"
Evaluating: 45.4578502+3.5
 Parameter: ZMAX <- "48.9578502"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.6611988"
Evaluating: -31.6611988-3.5
 Parameter: XMIN <- "-35.1611988"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.0164718"
Evaluating: -22.0164718-3.5
 Parameter: YMIN <- "-25.5164718"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.4578502"
Evaluating: 45.4578502-3.5
 Parameter: ZMIN <- "41.9578502"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.1611988"
 Parameter: XMIN -> "-35.1611988"
 Parameter: YMAX -> "-18.5164718"
 Parameter: YMIN -> "-25.5164718"
 Parameter: ZMAX -> "48.9578502"
 Parameter: ZMIN -> "41.9578502"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "136"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "136" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "136" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "136"
 Parameter: NPOS -> "65"
Evaluating: 136-65
 Parameter: J <- "71"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "2.083272555E-02"
Evaluating: 90.067469*(2.083272555E-02-0.5)
 Parameter: XPOS <- "-43.1573836"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.438376633"
Evaluating: 90.067469*(0.438376633-0.5)
 Parameter: YPOS <- "-5.5502607"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.698343717"
Evaluating: 143.194738*(0.698343717-0.5)+3.5172451
 Parameter: ZPOS <- "31.9190217"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "31.9190217" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "31.9190217" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-43.1573836"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -43.1573836-0
 Parameter: XTRAN <- "-43.1573836"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.5502607"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -5.5502607-0
 Parameter: YTRAN <- "-5.5502607"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.9190217"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 31.9190217-0
 Parameter: ZTRAN <- "31.9190217"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.1573836"
 Parameter: YTRAN -> "-5.5502607"
 Parameter: ZTRAN -> "31.9190217"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -43.157384   -5.550261   31.919022
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.794790459"
Evaluating: 0.794790459*360.0
 Parameter: XPHI <- "286.124565"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67570504"
Evaluating: 0.67570504*360.0
 Parameter: YPHI <- "243.253814"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.662036179"
Evaluating: 0.662036179*360.0
 Parameter: ZPHI <- "238.333024"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-43.1573836"
 Parameter: YPOS -> "-5.5502607"
 Parameter: ZPOS -> "31.9190217"
 Parameter: XPHI -> "286.124565"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.277727   -0.960660
    0.000000    0.960660    0.277727

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   73.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-43.1573836"
 Parameter: YPOS -> "-5.5502607"
 Parameter: ZPOS -> "31.9190217"
 Parameter: YPHI -> "243.253814"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.450039    0.000000    0.893009
    0.000000    1.000000    0.000000
   -0.893009    0.000000   -0.450039

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  116.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-43.1573836"
 Parameter: YPOS -> "-5.5502607"
 Parameter: ZPOS -> "31.9190217"
 Parameter: ZPHI -> "238.333024"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.524981   -0.851114    0.000000
    0.851114   -0.524981    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  121.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -43.157384 XMAX =  -43.157384 XAVE =  -43.157384
    YMIN =   -5.550261 YMAX =   -5.550261 YAVE =   -5.550261
    ZMIN =   31.919022 ZMAX =   31.919022 ZAVE =   31.919022
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-43.1573836"
Evaluating: -43.1573836+3.5
 Parameter: XMAX <- "-39.6573836"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.5502607"
Evaluating: -5.5502607+3.5
 Parameter: YMAX <- "-2.0502607"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.9190217"
Evaluating: 31.9190217+3.5
 Parameter: ZMAX <- "35.4190217"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-43.1573836"
Evaluating: -43.1573836-3.5
 Parameter: XMIN <- "-46.6573836"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.5502607"
Evaluating: -5.5502607-3.5
 Parameter: YMIN <- "-9.0502607"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.9190217"
Evaluating: 31.9190217-3.5
 Parameter: ZMIN <- "28.4190217"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.6573836"
 Parameter: XMIN -> "-46.6573836"
 Parameter: YMAX -> "-2.0502607"
 Parameter: YMIN -> "-9.0502607"
 Parameter: ZMAX -> "35.4190217"
 Parameter: ZMIN -> "28.4190217"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "137"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "137" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "137" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "137"
 Parameter: NPOS -> "65"
Evaluating: 137-65
 Parameter: J <- "72"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.691490409"
Evaluating: 90.067469*(0.691490409-0.5)
 Parameter: XPOS <- "17.2470565"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.456414524"
Evaluating: 90.067469*(0.456414524-0.5)
 Parameter: YPOS <- "-3.92563351"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.542039958"
Evaluating: 143.194738*(0.542039958-0.5)+3.5172451
 Parameter: ZPOS <- "9.53714587"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "9.53714587" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "9.53714587" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "137" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "137"
 Parameter: NPOS -> "65"
Evaluating: 137-65
 Parameter: J <- "72"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.564617429"
Evaluating: 90.067469*(0.564617429-0.5)
 Parameter: XPOS <- "5.81992828"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.922302067"
Evaluating: 90.067469*(0.922302067-0.5)
 Parameter: YPOS <- "38.0356783"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.668746173"
Evaluating: 143.194738*(0.668746173-0.5)+3.5172451
 Parameter: ZPOS <- "27.6808091"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "27.6808091" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "27.6808091" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.81992828"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 5.81992828-0
 Parameter: XTRAN <- "5.81992828"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.0356783"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 38.0356783-0
 Parameter: YTRAN <- "38.0356783"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.6808091"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 27.6808091-0
 Parameter: ZTRAN <- "27.6808091"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "5.81992828"
 Parameter: YTRAN -> "38.0356783"
 Parameter: ZTRAN -> "27.6808091"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     5.819928   38.035678   27.680809
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.661374234"
Evaluating: 0.661374234*360.0
 Parameter: XPHI <- "238.094724"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.661533204"
Evaluating: 0.661533204*360.0
 Parameter: YPHI <- "238.151953"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.226665682"
Evaluating: 0.226665682*360.0
 Parameter: ZPHI <- "81.5996455"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.81992828"
 Parameter: YPOS -> "38.0356783"
 Parameter: ZPOS -> "27.6808091"
 Parameter: XPHI -> "238.094724"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.528517   -0.848923
    0.000000    0.848923   -0.528517

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  121.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.81992828"
 Parameter: YPOS -> "38.0356783"
 Parameter: ZPOS -> "27.6808091"
 Parameter: YPHI -> "238.151953"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.527668    0.000000    0.849451
    0.000000    1.000000    0.000000
   -0.849451    0.000000   -0.527668

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  121.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.81992828"
 Parameter: YPOS -> "38.0356783"
 Parameter: ZPOS -> "27.6808091"
 Parameter: ZPHI -> "81.5996455"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.146089    0.989271    0.000000
   -0.989271    0.146089    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   81.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.819928 XMAX =    5.819928 XAVE =    5.819928
    YMIN =   38.035678 YMAX =   38.035678 YAVE =   38.035678
    ZMIN =   27.680809 ZMAX =   27.680809 ZAVE =   27.680809
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.81992828"
Evaluating: 5.81992828+3.5
 Parameter: XMAX <- "9.31992828"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.0356783"
Evaluating: 38.0356783+3.5
 Parameter: YMAX <- "41.5356783"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.6808091"
Evaluating: 27.6808091+3.5
 Parameter: ZMAX <- "31.1808091"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.81992828"
Evaluating: 5.81992828-3.5
 Parameter: XMIN <- "2.31992828"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.0356783"
Evaluating: 38.0356783-3.5
 Parameter: YMIN <- "34.5356783"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.6808091"
Evaluating: 27.6808091-3.5
 Parameter: ZMIN <- "24.1808091"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.31992828"
 Parameter: XMIN -> "2.31992828"
 Parameter: YMAX -> "41.5356783"
 Parameter: YMIN -> "34.5356783"
 Parameter: ZMAX -> "31.1808091"
 Parameter: ZMIN -> "24.1808091"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "138"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "138" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "138" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "138"
 Parameter: NPOS -> "65"
Evaluating: 138-65
 Parameter: J <- "73"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "9.117856071E-02"
Evaluating: 90.067469*(9.117856071E-02-0.5)
 Parameter: XPOS <- "-36.8215123"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.892780915"
Evaluating: 90.067469*(0.892780915-0.5)
 Parameter: YPOS <- "35.3767829"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.451686984"
Evaluating: 143.194738*(0.451686984-0.5)+3.5172451
 Parameter: ZPOS <- "-3.40092457"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-3.40092457" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-3.40092457" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "138" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "138"
 Parameter: NPOS -> "65"
Evaluating: 138-65
 Parameter: J <- "73"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.915398941"
Evaluating: 90.067469*(0.915398941-0.5)
 Parameter: XPOS <- "37.4139312"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.600797711"
Evaluating: 90.067469*(0.600797711-0.5)
 Parameter: YPOS <- "9.07859471"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.956379321"
Evaluating: 143.194738*(0.956379321-0.5)+3.5172451
 Parameter: ZPOS <- "68.8683624"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "68.8683624" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "68.8683624" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.4139312"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 37.4139312-0
 Parameter: XTRAN <- "37.4139312"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.07859471"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 9.07859471-0
 Parameter: YTRAN <- "9.07859471"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "68.8683624"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 68.8683624-0
 Parameter: ZTRAN <- "68.8683624"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "37.4139312"
 Parameter: YTRAN -> "9.07859471"
 Parameter: ZTRAN -> "68.8683624"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    37.413931    9.078595   68.868362
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.799794663"
Evaluating: 0.799794663*360.0
 Parameter: XPHI <- "287.926079"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.430382526"
Evaluating: 0.430382526*360.0
 Parameter: YPHI <- "154.937709"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.465269764"
Evaluating: 0.465269764*360.0
 Parameter: ZPHI <- "167.497115"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.4139312"
 Parameter: YPOS -> "9.07859471"
 Parameter: ZPOS -> "68.8683624"
 Parameter: XPHI -> "287.926079"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.307790   -0.951454
    0.000000    0.951454    0.307790

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   72.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.4139312"
 Parameter: YPOS -> "9.07859471"
 Parameter: ZPOS -> "68.8683624"
 Parameter: YPHI -> "154.937709"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.905848    0.000000   -0.423603
    0.000000    1.000000    0.000000
    0.423603    0.000000   -0.905848

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  154.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.4139312"
 Parameter: YPOS -> "9.07859471"
 Parameter: ZPOS -> "68.8683624"
 Parameter: ZPHI -> "167.497115"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.976285    0.216489    0.000000
   -0.216489   -0.976285    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  167.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.413931 XMAX =   37.413931 XAVE =   37.413931
    YMIN =    9.078595 YMAX =    9.078595 YAVE =    9.078595
    ZMIN =   68.868362 ZMAX =   68.868362 ZAVE =   68.868362
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.4139312"
Evaluating: 37.4139312+3.5
 Parameter: XMAX <- "40.9139312"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.07859471"
Evaluating: 9.07859471+3.5
 Parameter: YMAX <- "12.5785947"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "68.8683624"
Evaluating: 68.8683624+3.5
 Parameter: ZMAX <- "72.3683624"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.4139312"
Evaluating: 37.4139312-3.5
 Parameter: XMIN <- "33.9139312"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.07859471"
Evaluating: 9.07859471-3.5
 Parameter: YMIN <- "5.57859471"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "68.8683624"
Evaluating: 68.8683624-3.5
 Parameter: ZMIN <- "65.3683624"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.9139312"
 Parameter: XMIN -> "33.9139312"
 Parameter: YMAX -> "12.5785947"
 Parameter: YMIN -> "5.57859471"
 Parameter: ZMAX -> "72.3683624"
 Parameter: ZMIN -> "65.3683624"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "139"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "139" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "139"
Evaluating: 139
 Parameter: J <- "139"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "139" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "139"
 Parameter: NPOS -> "65"
Evaluating: 139-65
 Parameter: J <- "74"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "9.513777218E-02"
Evaluating: 90.067469*(9.513777218E-02-0.5)
 Parameter: XPOS <- "-36.4649162"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.299925923"
Evaluating: 90.067469*(0.299925923-0.5)
 Parameter: YPOS <- "-18.0201657"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.193758728"
Evaluating: 143.194738*(0.193758728-0.5)+3.5172451
 Parameter: ZPOS <- "-40.3348936"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-40.3348936" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.4649162"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -36.4649162-0
 Parameter: XTRAN <- "-36.4649162"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.0201657"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -18.0201657-0
 Parameter: YTRAN <- "-18.0201657"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-40.3348936"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -40.3348936-0
 Parameter: ZTRAN <- "-40.3348936"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.4649162"
 Parameter: YTRAN -> "-18.0201657"
 Parameter: ZTRAN -> "-40.3348936"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -36.464916  -18.020166  -40.334894
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.694025521"
Evaluating: 0.694025521*360.0
 Parameter: XPHI <- "249.849188"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.359436527E-02"
Evaluating: 6.359436527E-02*360.0
 Parameter: YPHI <- "22.8939715"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.440239986"
Evaluating: 0.440239986*360.0
 Parameter: ZPHI <- "158.486395"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.4649162"
 Parameter: YPOS -> "-18.0201657"
 Parameter: ZPOS -> "-40.3348936"
 Parameter: XPHI -> "249.849188"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.344492   -0.938789
    0.000000    0.938789   -0.344492

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  110.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.4649162"
 Parameter: YPOS -> "-18.0201657"
 Parameter: ZPOS -> "-40.3348936"
 Parameter: YPHI -> "22.8939715"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.921226    0.000000   -0.389027
    0.000000    1.000000    0.000000
    0.389027    0.000000    0.921226

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   22.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.4649162"
 Parameter: YPOS -> "-18.0201657"
 Parameter: ZPOS -> "-40.3348936"
 Parameter: ZPHI -> "158.486395"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.930331    0.366722    0.000000
   -0.366722   -0.930331    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  158.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.464916 XMAX =  -36.464916 XAVE =  -36.464916
    YMIN =  -18.020166 YMAX =  -18.020166 YAVE =  -18.020166
    ZMIN =  -40.334894 ZMAX =  -40.334894 ZAVE =  -40.334894
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.4649162"
Evaluating: -36.4649162+3.5
 Parameter: XMAX <- "-32.9649162"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.0201657"
Evaluating: -18.0201657+3.5
 Parameter: YMAX <- "-14.5201657"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-40.3348936"
Evaluating: -40.3348936+3.5
 Parameter: ZMAX <- "-36.8348936"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.4649162"
Evaluating: -36.4649162-3.5
 Parameter: XMIN <- "-39.9649162"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.0201657"
Evaluating: -18.0201657-3.5
 Parameter: YMIN <- "-21.5201657"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-40.3348936"
Evaluating: -40.3348936-3.5
 Parameter: ZMIN <- "-43.8348936"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.9649162"
 Parameter: XMIN -> "-39.9649162"
 Parameter: YMAX -> "-14.5201657"
 Parameter: YMIN -> "-21.5201657"
 Parameter: ZMAX -> "-36.8348936"
 Parameter: ZMIN -> "-43.8348936"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "140"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "140" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "140" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "140"
 Parameter: NPOS -> "65"
Evaluating: 140-65
 Parameter: J <- "75"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.580765569"
Evaluating: 90.067469*(0.580765569-0.5)
 Parameter: XPOS <- "7.27435038"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.762291251"
Evaluating: 90.067469*(0.762291251-0.5)
 Parameter: YPOS <- "23.6239091"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.36196583"
Evaluating: 143.194738*(0.36196583-0.5)+3.5172451
 Parameter: ZPOS <- "-16.2485217"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-16.2485217" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.27435038"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 7.27435038-0
 Parameter: XTRAN <- "7.27435038"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "23.6239091"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 23.6239091-0
 Parameter: YTRAN <- "23.6239091"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.2485217"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -16.2485217-0
 Parameter: ZTRAN <- "-16.2485217"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.27435038"
 Parameter: YTRAN -> "23.6239091"
 Parameter: ZTRAN -> "-16.2485217"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR     7.274350   23.623909  -16.248522
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.404046998"
Evaluating: 0.404046998*360.0
 Parameter: XPHI <- "145.456919"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.343532386"
Evaluating: 0.343532386*360.0
 Parameter: YPHI <- "123.671659"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.80129753"
Evaluating: 0.80129753*360.0
 Parameter: ZPHI <- "288.467111"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.27435038"
 Parameter: YPOS -> "23.6239091"
 Parameter: ZPOS -> "-16.2485217"
 Parameter: XPHI -> "145.456919"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.823700    0.567026
    0.000000   -0.567026   -0.823700

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  145.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.27435038"
 Parameter: YPOS -> "23.6239091"
 Parameter: ZPOS -> "-16.2485217"
 Parameter: YPHI -> "123.671659"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.554433    0.000000   -0.832228
    0.000000    1.000000    0.000000
    0.832228    0.000000   -0.554433

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  123.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.27435038"
 Parameter: YPOS -> "23.6239091"
 Parameter: ZPOS -> "-16.2485217"
 Parameter: ZPHI -> "288.467111"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.316760   -0.948506    0.000000
    0.948506    0.316760    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   71.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.274350 XMAX =    7.274350 XAVE =    7.274350
    YMIN =   23.623909 YMAX =   23.623909 YAVE =   23.623909
    ZMIN =  -16.248522 ZMAX =  -16.248522 ZAVE =  -16.248522
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.27435038"
Evaluating: 7.27435038+3.5
 Parameter: XMAX <- "10.7743504"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "23.6239091"
Evaluating: 23.6239091+3.5
 Parameter: YMAX <- "27.1239091"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.2485217"
Evaluating: -16.2485217+3.5
 Parameter: ZMAX <- "-12.7485217"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.27435038"
Evaluating: 7.27435038-3.5
 Parameter: XMIN <- "3.77435038"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "23.6239091"
Evaluating: 23.6239091-3.5
 Parameter: YMIN <- "20.1239091"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.2485217"
Evaluating: -16.2485217-3.5
 Parameter: ZMIN <- "-19.7485217"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.7743504"
 Parameter: XMIN -> "3.77435038"
 Parameter: YMAX -> "27.1239091"
 Parameter: YMIN -> "20.1239091"
 Parameter: ZMAX -> "-12.7485217"
 Parameter: ZMIN -> "-19.7485217"
 SELRPN>     29 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     12 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35101 NEG      CLA      75       CLA     -**** MEMB     POPC     117      C12           3.8717
35101 NEG      CLA      75       CLA     -**** MEMB     POPC     117      C25           3.8950
35101 NEG      CLA      75       CLA     -**** MEMB     POPC     117      C26           3.9446
35101 NEG      CLA      75       CLA     -**** MEMB     POPC     117      C27           3.6956
35101 NEG      CLA      75       CLA     -**** MEMB     POPC     118      O21           3.4583
35101 NEG      CLA      75       CLA     -**** MEMB     POPC     118      C21           2.1331
35101 NEG      CLA      75       CLA     -**** MEMB     POPC     118      O22           1.5608
35101 NEG      CLA      75       CLA     -**** MEMB     POPC     118      C22           2.3770
35101 NEG      CLA      75       CLA     -**** MEMB     POPC     118      C23           2.0130
35101 NEG      CLA      75       CLA     -**** MEMB     POPC     118      C24           3.1285
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "140" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "140"
 Parameter: NPOS -> "65"
Evaluating: 140-65
 Parameter: J <- "75"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.447197813"
Evaluating: 90.067469*(0.447197813-0.5)
 Parameter: XPOS <- "-4.75575934"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.319305825"
Evaluating: 90.067469*(0.319305825-0.5)
 Parameter: YPOS <- "-16.274667"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.950794004"
Evaluating: 143.194738*(0.950794004-0.5)+3.5172451
 Parameter: ZPOS <- "68.0685744"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "68.0685744" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "68.0685744" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.274350 XMAX =    7.274350 XAVE =    7.274350
    YMIN =   23.623909 YMAX =   23.623909 YAVE =   23.623909
    ZMIN =  -16.248522 ZMAX =  -16.248522 ZAVE =  -16.248522
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.75575934"
 RDCMND substituted energy or value "?XAVE" to "7.27435038"
Evaluating: -4.75575934-7.27435038
 Parameter: XTRAN <- "-12.0301097"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.274667"
 RDCMND substituted energy or value "?YAVE" to "23.6239091"
Evaluating: -16.274667-23.6239091
 Parameter: YTRAN <- "-39.8985761"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "68.0685744"
 RDCMND substituted energy or value "?ZAVE" to "-16.2485217"
Evaluating: 68.0685744--16.2485217
 Parameter: ZTRAN <- "84.3170961"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.0301097"
 Parameter: YTRAN -> "-39.8985761"
 Parameter: ZTRAN -> "84.3170961"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -12.030110  -39.898576   84.317096
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.505737608"
Evaluating: 0.505737608*360.0
 Parameter: XPHI <- "182.065539"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.572690345"
Evaluating: 0.572690345*360.0
 Parameter: YPHI <- "206.168524"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.226033693"
Evaluating: 0.226033693*360.0
 Parameter: ZPHI <- "81.3721295"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.75575934"
 Parameter: YPOS -> "-16.274667"
 Parameter: ZPOS -> "68.0685744"
 Parameter: XPHI -> "182.065539"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999350   -0.036043
    0.000000    0.036043   -0.999350

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  177.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.75575934"
 Parameter: YPOS -> "-16.274667"
 Parameter: ZPOS -> "68.0685744"
 Parameter: YPHI -> "206.168524"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.897501    0.000000    0.441013
    0.000000    1.000000    0.000000
   -0.441013    0.000000   -0.897501

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  153.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.75575934"
 Parameter: YPOS -> "-16.274667"
 Parameter: ZPOS -> "68.0685744"
 Parameter: ZPHI -> "81.3721295"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.150016    0.988684    0.000000
   -0.988684    0.150016    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   81.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.755759 XMAX =   -4.755759 XAVE =   -4.755759
    YMIN =  -16.274667 YMAX =  -16.274667 YAVE =  -16.274667
    ZMIN =   68.068574 ZMAX =   68.068574 ZAVE =   68.068574
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.75575934"
Evaluating: -4.75575934+3.5
 Parameter: XMAX <- "-1.25575934"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.274667"
Evaluating: -16.274667+3.5
 Parameter: YMAX <- "-12.774667"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "68.0685744"
Evaluating: 68.0685744+3.5
 Parameter: ZMAX <- "71.5685744"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.75575934"
Evaluating: -4.75575934-3.5
 Parameter: XMIN <- "-8.25575934"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.274667"
Evaluating: -16.274667-3.5
 Parameter: YMIN <- "-19.774667"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "68.0685744"
Evaluating: 68.0685744-3.5
 Parameter: ZMIN <- "64.5685744"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.25575934"
 Parameter: XMIN -> "-8.25575934"
 Parameter: YMAX -> "-12.774667"
 Parameter: YMIN -> "-19.774667"
 Parameter: ZMAX -> "71.5685744"
 Parameter: ZMIN -> "64.5685744"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "141"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "141" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "141" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "141"
 Parameter: NPOS -> "65"
Evaluating: 141-65
 Parameter: J <- "76"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.707530109"
Evaluating: 90.067469*(0.707530109-0.5)
 Parameter: XPOS <- "18.6917117"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.529832936"
Evaluating: 90.067469*(0.529832936-0.5)
 Parameter: YPOS <- "2.68697704"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.267265261"
Evaluating: 143.194738*(0.267265261-0.5)+3.5172451
 Parameter: ZPOS <- "-29.8091449"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-29.8091449" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.6917117"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 18.6917117-0
 Parameter: XTRAN <- "18.6917117"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.68697704"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 2.68697704-0
 Parameter: YTRAN <- "2.68697704"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.8091449"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -29.8091449-0
 Parameter: ZTRAN <- "-29.8091449"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "18.6917117"
 Parameter: YTRAN -> "2.68697704"
 Parameter: ZTRAN -> "-29.8091449"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    18.691712    2.686977  -29.809145
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.133910777"
Evaluating: 0.133910777*360.0
 Parameter: XPHI <- "48.2078797"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.369383574"
Evaluating: 0.369383574*360.0
 Parameter: YPHI <- "132.978087"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.303952935"
Evaluating: 0.303952935*360.0
 Parameter: ZPHI <- "109.423057"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.6917117"
 Parameter: YPOS -> "2.68697704"
 Parameter: ZPOS -> "-29.8091449"
 Parameter: XPHI -> "48.2078797"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.666430    0.745568
    0.000000   -0.745568    0.666430

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   48.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.6917117"
 Parameter: YPOS -> "2.68697704"
 Parameter: ZPOS -> "-29.8091449"
 Parameter: YPHI -> "132.978087"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.681719    0.000000   -0.731614
    0.000000    1.000000    0.000000
    0.731614    0.000000   -0.681719

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  132.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.6917117"
 Parameter: YPOS -> "2.68697704"
 Parameter: ZPOS -> "-29.8091449"
 Parameter: ZPHI -> "109.423057"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.332541    0.943089    0.000000
   -0.943089   -0.332541    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  109.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.691712 XMAX =   18.691712 XAVE =   18.691712
    YMIN =    2.686977 YMAX =    2.686977 YAVE =    2.686977
    ZMIN =  -29.809145 ZMAX =  -29.809145 ZAVE =  -29.809145
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.6917117"
Evaluating: 18.6917117+3.5
 Parameter: XMAX <- "22.1917117"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.68697704"
Evaluating: 2.68697704+3.5
 Parameter: YMAX <- "6.18697704"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.8091449"
Evaluating: -29.8091449+3.5
 Parameter: ZMAX <- "-26.3091449"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.6917117"
Evaluating: 18.6917117-3.5
 Parameter: XMIN <- "15.1917117"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.68697704"
Evaluating: 2.68697704-3.5
 Parameter: YMIN <- "-0.81302296"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.8091449"
Evaluating: -29.8091449-3.5
 Parameter: ZMIN <- "-33.3091449"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.1917117"
 Parameter: XMIN -> "15.1917117"
 Parameter: YMAX -> "6.18697704"
 Parameter: YMIN -> "-0.81302296"
 Parameter: ZMAX -> "-26.3091449"
 Parameter: ZMIN -> "-33.3091449"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "142"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "142" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "142"
Evaluating: 142
 Parameter: J <- "142"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "142" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "142"
 Parameter: NPOS -> "65"
Evaluating: 142-65
 Parameter: J <- "77"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.74592667"
Evaluating: 90.067469*(0.74592667-0.5)
 Parameter: XPOS <- "22.1499927"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.252098934"
Evaluating: 90.067469*(0.252098934-0.5)
 Parameter: YPOS <- "-22.3278216"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.852102713"
Evaluating: 143.194738*(0.852102713-0.5)+3.5172451
 Parameter: ZPOS <- "53.9365008"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "53.9365008" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "53.9365008" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.1499927"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 22.1499927-0
 Parameter: XTRAN <- "22.1499927"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.3278216"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.3278216-0
 Parameter: YTRAN <- "-22.3278216"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "53.9365008"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 53.9365008-0
 Parameter: ZTRAN <- "53.9365008"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.1499927"
 Parameter: YTRAN -> "-22.3278216"
 Parameter: ZTRAN -> "53.9365008"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    22.149993  -22.327822   53.936501
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.337583282"
Evaluating: 0.337583282*360.0
 Parameter: XPHI <- "121.529982"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.674962093"
Evaluating: 0.674962093*360.0
 Parameter: YPHI <- "242.986353"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.781401104"
Evaluating: 0.781401104*360.0
 Parameter: ZPHI <- "281.304397"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.1499927"
 Parameter: YPOS -> "-22.3278216"
 Parameter: ZPOS -> "53.9365008"
 Parameter: XPHI -> "121.529982"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.522945    0.852367
    0.000000   -0.852367   -0.522945

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  121.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.1499927"
 Parameter: YPOS -> "-22.3278216"
 Parameter: ZPOS -> "53.9365008"
 Parameter: YPHI -> "242.986353"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.454203    0.000000    0.890898
    0.000000    1.000000    0.000000
   -0.890898    0.000000   -0.454203

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  117.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.1499927"
 Parameter: YPOS -> "-22.3278216"
 Parameter: ZPOS -> "53.9365008"
 Parameter: ZPHI -> "281.304397"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.196021   -0.980600    0.000000
    0.980600    0.196021    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   78.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.149993 XMAX =   22.149993 XAVE =   22.149993
    YMIN =  -22.327822 YMAX =  -22.327822 YAVE =  -22.327822
    ZMIN =   53.936501 ZMAX =   53.936501 ZAVE =   53.936501
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.1499927"
Evaluating: 22.1499927+3.5
 Parameter: XMAX <- "25.6499927"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.3278216"
Evaluating: -22.3278216+3.5
 Parameter: YMAX <- "-18.8278216"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "53.9365008"
Evaluating: 53.9365008+3.5
 Parameter: ZMAX <- "57.4365008"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.1499927"
Evaluating: 22.1499927-3.5
 Parameter: XMIN <- "18.6499927"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.3278216"
Evaluating: -22.3278216-3.5
 Parameter: YMIN <- "-25.8278216"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "53.9365008"
Evaluating: 53.9365008-3.5
 Parameter: ZMIN <- "50.4365008"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.6499927"
 Parameter: XMIN -> "18.6499927"
 Parameter: YMAX -> "-18.8278216"
 Parameter: YMIN -> "-25.8278216"
 Parameter: ZMAX -> "57.4365008"
 Parameter: ZMIN -> "50.4365008"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "143"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "143" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "143"
Evaluating: 143
 Parameter: J <- "143"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "143" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "143"
 Parameter: NPOS -> "65"
Evaluating: 143-65
 Parameter: J <- "78"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.666906899"
Evaluating: 90.067469*(0.666906899-0.5)
 Parameter: XPOS <- "15.032882"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.108272949"
Evaluating: 90.067469*(0.108272949-0.5)
 Parameter: YPOS <- "-35.281864"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.14068645"
Evaluating: 143.194738*(0.14068645-0.5)+3.5172451
 Parameter: ZPOS <- "-47.9345646"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-47.9345646" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "15.032882"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 15.032882-0
 Parameter: XTRAN <- "15.032882"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.281864"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -35.281864-0
 Parameter: YTRAN <- "-35.281864"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-47.9345646"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -47.9345646-0
 Parameter: ZTRAN <- "-47.9345646"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.032882"
 Parameter: YTRAN -> "-35.281864"
 Parameter: ZTRAN -> "-47.9345646"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    15.032882  -35.281864  -47.934565
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.78942135"
Evaluating: 0.78942135*360.0
 Parameter: XPHI <- "284.191686"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.959558231"
Evaluating: 0.959558231*360.0
 Parameter: YPHI <- "345.440963"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.880727197"
Evaluating: 0.880727197*360.0
 Parameter: ZPHI <- "317.061791"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "15.032882"
 Parameter: YPOS -> "-35.281864"
 Parameter: ZPOS -> "-47.9345646"
 Parameter: XPHI -> "284.191686"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.245167   -0.969481
    0.000000    0.969481    0.245167

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   75.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "15.032882"
 Parameter: YPOS -> "-35.281864"
 Parameter: ZPOS -> "-47.9345646"
 Parameter: YPHI -> "345.440963"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.967889    0.000000    0.251377
    0.000000    1.000000    0.000000
   -0.251377    0.000000    0.967889

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   14.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "15.032882"
 Parameter: YPOS -> "-35.281864"
 Parameter: ZPOS -> "-47.9345646"
 Parameter: ZPHI -> "317.061791"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.732089   -0.681209    0.000000
    0.681209    0.732089    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   42.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   15.032882 XMAX =   15.032882 XAVE =   15.032882
    YMIN =  -35.281864 YMAX =  -35.281864 YAVE =  -35.281864
    ZMIN =  -47.934565 ZMAX =  -47.934565 ZAVE =  -47.934565
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "15.032882"
Evaluating: 15.032882+3.5
 Parameter: XMAX <- "18.532882"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.281864"
Evaluating: -35.281864+3.5
 Parameter: YMAX <- "-31.781864"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-47.9345646"
Evaluating: -47.9345646+3.5
 Parameter: ZMAX <- "-44.4345646"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "15.032882"
Evaluating: 15.032882-3.5
 Parameter: XMIN <- "11.532882"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.281864"
Evaluating: -35.281864-3.5
 Parameter: YMIN <- "-38.781864"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-47.9345646"
Evaluating: -47.9345646-3.5
 Parameter: ZMIN <- "-51.4345646"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "18.532882"
 Parameter: XMIN -> "11.532882"
 Parameter: YMAX -> "-31.781864"
 Parameter: YMIN -> "-38.781864"
 Parameter: ZMAX -> "-44.4345646"
 Parameter: ZMIN -> "-51.4345646"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "144"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "144" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "144"
Evaluating: 144
 Parameter: J <- "144"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "144" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "144"
 Parameter: NPOS -> "65"
Evaluating: 144-65
 Parameter: J <- "79"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "4.069282021E-02"
Evaluating: 90.067469*(4.069282021E-02-0.5)
 Parameter: XPOS <- "-41.3686352"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.617011335"
Evaluating: 90.067469*(0.617011335-0.5)
 Parameter: YPOS <- "10.5389148"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.326958331"
Evaluating: 143.194738*(0.326958331-0.5)+3.5172451
 Parameter: ZPOS <- "-21.2614114"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.2614114" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-41.3686352"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -41.3686352-0
 Parameter: XTRAN <- "-41.3686352"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.5389148"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 10.5389148-0
 Parameter: YTRAN <- "10.5389148"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.2614114"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.2614114-0
 Parameter: ZTRAN <- "-21.2614114"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-41.3686352"
 Parameter: YTRAN -> "10.5389148"
 Parameter: ZTRAN -> "-21.2614114"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -41.368635   10.538915  -21.261411
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.713222788"
Evaluating: 0.713222788*360.0
 Parameter: XPHI <- "256.760204"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.220419902"
Evaluating: 0.220419902*360.0
 Parameter: YPHI <- "79.3511647"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.899585009"
Evaluating: 0.899585009*360.0
 Parameter: ZPHI <- "323.850603"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-41.3686352"
 Parameter: YPOS -> "10.5389148"
 Parameter: ZPOS -> "-21.2614114"
 Parameter: XPHI -> "256.760204"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.229027   -0.973420
    0.000000    0.973420   -0.229027

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  103.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-41.3686352"
 Parameter: YPOS -> "10.5389148"
 Parameter: ZPOS -> "-21.2614114"
 Parameter: YPHI -> "79.3511647"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.184789    0.000000   -0.982778
    0.000000    1.000000    0.000000
    0.982778    0.000000    0.184789

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   79.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-41.3686352"
 Parameter: YPOS -> "10.5389148"
 Parameter: ZPOS -> "-21.2614114"
 Parameter: ZPHI -> "323.850603"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.807482   -0.589893    0.000000
    0.589893    0.807482    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   36.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.368635 XMAX =  -41.368635 XAVE =  -41.368635
    YMIN =   10.538915 YMAX =   10.538915 YAVE =   10.538915
    ZMIN =  -21.261411 ZMAX =  -21.261411 ZAVE =  -21.261411
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-41.3686352"
Evaluating: -41.3686352+3.5
 Parameter: XMAX <- "-37.8686352"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.5389148"
Evaluating: 10.5389148+3.5
 Parameter: YMAX <- "14.0389148"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.2614114"
Evaluating: -21.2614114+3.5
 Parameter: ZMAX <- "-17.7614114"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-41.3686352"
Evaluating: -41.3686352-3.5
 Parameter: XMIN <- "-44.8686352"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.5389148"
Evaluating: 10.5389148-3.5
 Parameter: YMIN <- "7.0389148"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.2614114"
Evaluating: -21.2614114-3.5
 Parameter: ZMIN <- "-24.7614114"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-37.8686352"
 Parameter: XMIN -> "-44.8686352"
 Parameter: YMAX -> "14.0389148"
 Parameter: YMIN -> "7.0389148"
 Parameter: ZMAX -> "-17.7614114"
 Parameter: ZMIN -> "-24.7614114"
 SELRPN>     22 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      7 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35105 NEG      CLA      79       CLA     -**** MEMB     POPC     172      C14           3.3189
35105 NEG      CLA      79       CLA     -**** MEMB     POPC     172      C11           3.2584
35105 NEG      CLA      79       CLA     -**** MEMB     POPC     187      N             3.5532
35105 NEG      CLA      79       CLA     -**** MEMB     POPC     187      C14           2.1055
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "144"
Evaluating: 144
 Parameter: J <- "144"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "144" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "144"
 Parameter: NPOS -> "65"
Evaluating: 144-65
 Parameter: J <- "79"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.979016311"
Evaluating: 90.067469*(0.979016311-0.5)
 Parameter: XPOS <- "43.1437867"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.751095794"
Evaluating: 90.067469*(0.751095794-0.5)
 Parameter: YPOS <- "22.6155626"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.621816398"
Evaluating: 143.194738*(0.621816398-0.5)+3.5172451
 Parameter: ZPOS <- "20.9607123"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "20.9607123" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "20.9607123" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -41.368635 XMAX =  -41.368635 XAVE =  -41.368635
    YMIN =   10.538915 YMAX =   10.538915 YAVE =   10.538915
    ZMIN =  -21.261411 ZMAX =  -21.261411 ZAVE =  -21.261411
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "43.1437867"
 RDCMND substituted energy or value "?XAVE" to "-41.3686352"
Evaluating: 43.1437867--41.3686352
 Parameter: XTRAN <- "84.5124219"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.6155626"
 RDCMND substituted energy or value "?YAVE" to "10.5389148"
Evaluating: 22.6155626-10.5389148
 Parameter: YTRAN <- "12.0766478"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "20.9607123"
 RDCMND substituted energy or value "?ZAVE" to "-21.2614114"
Evaluating: 20.9607123--21.2614114
 Parameter: ZTRAN <- "42.2221237"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "84.5124219"
 Parameter: YTRAN -> "12.0766478"
 Parameter: ZTRAN -> "42.2221237"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    84.512422   12.076648   42.222124
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.611245301E-02"
Evaluating: 2.611245301E-02*360.0
 Parameter: XPHI <- "9.40048308"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.232546437"
Evaluating: 0.232546437*360.0
 Parameter: YPHI <- "83.7167173"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.625918026"
Evaluating: 0.625918026*360.0
 Parameter: ZPHI <- "225.330489"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "43.1437867"
 Parameter: YPOS -> "22.6155626"
 Parameter: ZPOS -> "20.9607123"
 Parameter: XPHI -> "9.40048308"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.986571    0.163334
    0.000000   -0.163334    0.986571

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    9.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "43.1437867"
 Parameter: YPOS -> "22.6155626"
 Parameter: ZPOS -> "20.9607123"
 Parameter: YPHI -> "83.7167173"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.109444    0.000000   -0.993993
    0.000000    1.000000    0.000000
    0.993993    0.000000    0.109444

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   83.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "43.1437867"
 Parameter: YPOS -> "22.6155626"
 Parameter: ZPOS -> "20.9607123"
 Parameter: ZPHI -> "225.330489"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.703016   -0.711174    0.000000
    0.711174   -0.703016    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  134.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.143787 XMAX =   43.143787 XAVE =   43.143787
    YMIN =   22.615563 YMAX =   22.615563 YAVE =   22.615563
    ZMIN =   20.960712 ZMAX =   20.960712 ZAVE =   20.960712
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "43.1437867"
Evaluating: 43.1437867+3.5
 Parameter: XMAX <- "46.6437867"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.6155626"
Evaluating: 22.6155626+3.5
 Parameter: YMAX <- "26.1155626"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "20.9607123"
Evaluating: 20.9607123+3.5
 Parameter: ZMAX <- "24.4607123"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "43.1437867"
Evaluating: 43.1437867-3.5
 Parameter: XMIN <- "39.6437867"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.6155626"
Evaluating: 22.6155626-3.5
 Parameter: YMIN <- "19.1155626"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "20.9607123"
Evaluating: 20.9607123-3.5
 Parameter: ZMIN <- "17.4607123"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "46.6437867"
 Parameter: XMIN -> "39.6437867"
 Parameter: YMAX -> "26.1155626"
 Parameter: YMIN -> "19.1155626"
 Parameter: ZMAX -> "24.4607123"
 Parameter: ZMIN -> "17.4607123"
 SELRPN>     14 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      4 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35105 NEG      CLA      79       CLA     -**** MEMB     POPC     79       C15           3.3693
35105 NEG      CLA      79       CLA     -**** MEMB     POPC     94       C15           3.2347
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "144"
Evaluating: 144
 Parameter: J <- "144"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "144" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "144"
 Parameter: NPOS -> "65"
Evaluating: 144-65
 Parameter: J <- "79"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.630953437"
Evaluating: 90.067469*(0.630953437-0.5)
 Parameter: XPOS <- "11.7946446"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.236390137"
Evaluating: 90.067469*(0.236390137-0.5)
 Parameter: YPOS <- "-23.7426732"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.789835352"
Evaluating: 143.194738*(0.789835352-0.5)+3.5172451
 Parameter: ZPOS <- "45.0201424"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "45.0201424" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "45.0201424" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   43.143787 XMAX =   43.143787 XAVE =   43.143787
    YMIN =   22.615563 YMAX =   22.615563 YAVE =   22.615563
    ZMIN =   20.960712 ZMAX =   20.960712 ZAVE =   20.960712
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.7946446"
 RDCMND substituted energy or value "?XAVE" to "43.1437867"
Evaluating: 11.7946446-43.1437867
 Parameter: XTRAN <- "-31.3491421"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.7426732"
 RDCMND substituted energy or value "?YAVE" to "22.6155626"
Evaluating: -23.7426732-22.6155626
 Parameter: YTRAN <- "-46.3582358"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "45.0201424"
 RDCMND substituted energy or value "?ZAVE" to "20.9607123"
Evaluating: 45.0201424-20.9607123
 Parameter: ZTRAN <- "24.0594301"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.3491421"
 Parameter: YTRAN -> "-46.3582358"
 Parameter: ZTRAN -> "24.0594301"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -31.349142  -46.358236   24.059430
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.410790538"
Evaluating: 0.410790538*360.0
 Parameter: XPHI <- "147.884594"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.71055307"
Evaluating: 0.71055307*360.0
 Parameter: YPHI <- "255.799105"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.289110985"
Evaluating: 0.289110985*360.0
 Parameter: ZPHI <- "104.079955"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.7946446"
 Parameter: YPOS -> "-23.7426732"
 Parameter: ZPOS -> "45.0201424"
 Parameter: XPHI -> "147.884594"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.846979    0.531626
    0.000000   -0.531626   -0.846979

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  147.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.7946446"
 Parameter: YPOS -> "-23.7426732"
 Parameter: ZPOS -> "45.0201424"
 Parameter: YPHI -> "255.799105"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.245323    0.000000    0.969442
    0.000000    1.000000    0.000000
   -0.969442    0.000000   -0.245323

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  104.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.7946446"
 Parameter: YPOS -> "-23.7426732"
 Parameter: ZPOS -> "45.0201424"
 Parameter: ZPHI -> "104.079955"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.243276    0.969957    0.000000
   -0.969957   -0.243276    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  104.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.794645 XMAX =   11.794645 XAVE =   11.794645
    YMIN =  -23.742673 YMAX =  -23.742673 YAVE =  -23.742673
    ZMIN =   45.020142 ZMAX =   45.020142 ZAVE =   45.020142
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.7946446"
Evaluating: 11.7946446+3.5
 Parameter: XMAX <- "15.2946446"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.7426732"
Evaluating: -23.7426732+3.5
 Parameter: YMAX <- "-20.2426732"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "45.0201424"
Evaluating: 45.0201424+3.5
 Parameter: ZMAX <- "48.5201424"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.7946446"
Evaluating: 11.7946446-3.5
 Parameter: XMIN <- "8.2946446"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.7426732"
Evaluating: -23.7426732-3.5
 Parameter: YMIN <- "-27.2426732"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "45.0201424"
Evaluating: 45.0201424-3.5
 Parameter: ZMIN <- "41.5201424"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.2946446"
 Parameter: XMIN -> "8.2946446"
 Parameter: YMAX -> "-20.2426732"
 Parameter: YMIN -> "-27.2426732"
 Parameter: ZMAX -> "48.5201424"
 Parameter: ZMIN -> "41.5201424"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "145"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "145" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "145" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "65"
Evaluating: 145-65
 Parameter: J <- "80"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.764821077"
Evaluating: 90.067469*(0.764821077-0.5)
 Parameter: XPOS <- "23.8517641"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.252577793"
Evaluating: 90.067469*(0.252577793-0.5)
 Parameter: YPOS <- "-22.284692"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.972693301"
Evaluating: 143.194738*(0.972693301-0.5)+3.5172451
 Parameter: ZPOS <- "71.2044385"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "71.2044385" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "71.2044385" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.8517641"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 23.8517641-0
 Parameter: XTRAN <- "23.8517641"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.284692"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -22.284692-0
 Parameter: YTRAN <- "-22.284692"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "71.2044385"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 71.2044385-0
 Parameter: ZTRAN <- "71.2044385"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "23.8517641"
 Parameter: YTRAN -> "-22.284692"
 Parameter: ZTRAN -> "71.2044385"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    23.851764  -22.284692   71.204438
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.269557458"
Evaluating: 0.269557458*360.0
 Parameter: XPHI <- "97.0406849"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335489903"
Evaluating: 0.335489903*360.0
 Parameter: YPHI <- "120.776365"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.80047553"
Evaluating: 0.80047553*360.0
 Parameter: ZPHI <- "288.171191"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.8517641"
 Parameter: YPOS -> "-22.284692"
 Parameter: ZPOS -> "71.2044385"
 Parameter: XPHI -> "97.0406849"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.122574    0.992459
    0.000000   -0.992459   -0.122574

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   97.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.8517641"
 Parameter: YPOS -> "-22.284692"
 Parameter: ZPOS -> "71.2044385"
 Parameter: YPHI -> "120.776365"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.511688    0.000000   -0.859171
    0.000000    1.000000    0.000000
    0.859171    0.000000   -0.511688

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  120.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.8517641"
 Parameter: YPOS -> "-22.284692"
 Parameter: ZPOS -> "71.2044385"
 Parameter: ZPHI -> "288.171191"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.311857   -0.950129    0.000000
    0.950129    0.311857    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   71.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.851764 XMAX =   23.851764 XAVE =   23.851764
    YMIN =  -22.284692 YMAX =  -22.284692 YAVE =  -22.284692
    ZMIN =   71.204438 ZMAX =   71.204438 ZAVE =   71.204438
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.8517641"
Evaluating: 23.8517641+3.5
 Parameter: XMAX <- "27.3517641"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.284692"
Evaluating: -22.284692+3.5
 Parameter: YMAX <- "-18.784692"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "71.2044385"
Evaluating: 71.2044385+3.5
 Parameter: ZMAX <- "74.7044385"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.8517641"
Evaluating: 23.8517641-3.5
 Parameter: XMIN <- "20.3517641"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.284692"
Evaluating: -22.284692-3.5
 Parameter: YMIN <- "-25.784692"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "71.2044385"
Evaluating: 71.2044385-3.5
 Parameter: ZMIN <- "67.7044385"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.3517641"
 Parameter: XMIN -> "20.3517641"
 Parameter: YMAX -> "-18.784692"
 Parameter: YMIN -> "-25.784692"
 Parameter: ZMAX -> "74.7044385"
 Parameter: ZMIN -> "67.7044385"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "146"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "146" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "146" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "65"
Evaluating: 146-65
 Parameter: J <- "81"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.400567034"
Evaluating: 90.067469*(0.400567034-0.5)
 Parameter: XPOS <- "-8.95567558"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.830632214"
Evaluating: 90.067469*(0.830632214-0.5)
 Parameter: YPOS <- "29.7792067"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.356074427"
Evaluating: 143.194738*(0.356074427-0.5)+3.5172451
 Parameter: ZPOS <- "-17.0921396"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.0921396" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.95567558"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -8.95567558-0
 Parameter: XTRAN <- "-8.95567558"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.7792067"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 29.7792067-0
 Parameter: YTRAN <- "29.7792067"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.0921396"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.0921396-0
 Parameter: ZTRAN <- "-17.0921396"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.95567558"
 Parameter: YTRAN -> "29.7792067"
 Parameter: ZTRAN -> "-17.0921396"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -8.955676   29.779207  -17.092140
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.348971E-02"
Evaluating: 9.348971E-02*360.0
 Parameter: XPHI <- "33.6562956"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.60227295"
Evaluating: 0.60227295*360.0
 Parameter: YPHI <- "216.818262"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.801661676"
Evaluating: 0.801661676*360.0
 Parameter: ZPHI <- "288.598203"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.95567558"
 Parameter: YPOS -> "29.7792067"
 Parameter: ZPOS -> "-17.0921396"
 Parameter: XPHI -> "33.6562956"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.832377    0.554210
    0.000000   -0.554210    0.832377

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   33.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.95567558"
 Parameter: YPOS -> "29.7792067"
 Parameter: ZPOS -> "-17.0921396"
 Parameter: YPHI -> "216.818262"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.800540    0.000000    0.599279
    0.000000    1.000000    0.000000
   -0.599279    0.000000   -0.800540

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  143.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.95567558"
 Parameter: YPOS -> "29.7792067"
 Parameter: ZPOS -> "-17.0921396"
 Parameter: ZPHI -> "288.598203"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.318930   -0.947778    0.000000
    0.947778    0.318930    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   71.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.955676 XMAX =   -8.955676 XAVE =   -8.955676
    YMIN =   29.779207 YMAX =   29.779207 YAVE =   29.779207
    ZMIN =  -17.092140 ZMAX =  -17.092140 ZAVE =  -17.092140
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.95567558"
Evaluating: -8.95567558+3.5
 Parameter: XMAX <- "-5.45567558"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.7792067"
Evaluating: 29.7792067+3.5
 Parameter: YMAX <- "33.2792067"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.0921396"
Evaluating: -17.0921396+3.5
 Parameter: ZMAX <- "-13.5921396"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.95567558"
Evaluating: -8.95567558-3.5
 Parameter: XMIN <- "-12.4556756"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.7792067"
Evaluating: 29.7792067-3.5
 Parameter: YMIN <- "26.2792067"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.0921396"
Evaluating: -17.0921396-3.5
 Parameter: ZMIN <- "-20.5921396"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.45567558"
 Parameter: XMIN -> "-12.4556756"
 Parameter: YMAX -> "33.2792067"
 Parameter: YMIN -> "26.2792067"
 Parameter: ZMAX -> "-13.5921396"
 Parameter: ZMIN -> "-20.5921396"
 SELRPN>     25 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      1 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35107 NEG      CLA      81       CLA     -3842 PROA     ARG      264      NH1           4.4834
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "146" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "65"
Evaluating: 146-65
 Parameter: J <- "81"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "81"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.946351554"
Evaluating: 90.067469*(0.946351554-0.5)
 Parameter: XPOS <- "40.2017548"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.146586774"
Evaluating: 90.067469*(0.146586774-0.5)
 Parameter: YPOS <- "-31.8310348"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.933019776"
Evaluating: 143.194738*(0.933019776-0.5)+3.5172451
 Parameter: ZPOS <- "65.5233985"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "65.5233985" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "65.5233985" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.955676 XMAX =   -8.955676 XAVE =   -8.955676
    YMIN =   29.779207 YMAX =   29.779207 YAVE =   29.779207
    ZMIN =  -17.092140 ZMAX =  -17.092140 ZAVE =  -17.092140
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.2017548"
 RDCMND substituted energy or value "?XAVE" to "-8.95567558"
Evaluating: 40.2017548--8.95567558
 Parameter: XTRAN <- "49.1574304"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.8310348"
 RDCMND substituted energy or value "?YAVE" to "29.7792067"
Evaluating: -31.8310348-29.7792067
 Parameter: YTRAN <- "-61.6102415"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "65.5233985"
 RDCMND substituted energy or value "?ZAVE" to "-17.0921396"
Evaluating: 65.5233985--17.0921396
 Parameter: ZTRAN <- "82.6155381"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.1574304"
 Parameter: YTRAN -> "-61.6102415"
 Parameter: ZTRAN -> "82.6155381"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    49.157430  -61.610242   82.615538
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.390722321"
Evaluating: 0.390722321*360.0
 Parameter: XPHI <- "140.660036"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111460203"
Evaluating: 0.111460203*360.0
 Parameter: YPHI <- "40.1256731"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.752172045"
Evaluating: 0.752172045*360.0
 Parameter: ZPHI <- "270.781936"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.2017548"
 Parameter: YPOS -> "-31.8310348"
 Parameter: ZPOS -> "65.5233985"
 Parameter: XPHI -> "140.660036"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.773398    0.633920
    0.000000   -0.633920   -0.773398

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  140.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.2017548"
 Parameter: YPOS -> "-31.8310348"
 Parameter: ZPOS -> "65.5233985"
 Parameter: YPHI -> "40.1256731"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.764633    0.000000   -0.644466
    0.000000    1.000000    0.000000
    0.644466    0.000000    0.764633

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   40.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.2017548"
 Parameter: YPOS -> "-31.8310348"
 Parameter: ZPOS -> "65.5233985"
 Parameter: ZPHI -> "270.781936"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.013647   -0.999907    0.000000
    0.999907    0.013647    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   89.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.201755 XMAX =   40.201755 XAVE =   40.201755
    YMIN =  -31.831035 YMAX =  -31.831035 YAVE =  -31.831035
    ZMIN =   65.523399 ZMAX =   65.523399 ZAVE =   65.523399
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.2017548"
Evaluating: 40.2017548+3.5
 Parameter: XMAX <- "43.7017548"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.8310348"
Evaluating: -31.8310348+3.5
 Parameter: YMAX <- "-28.3310348"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "65.5233985"
Evaluating: 65.5233985+3.5
 Parameter: ZMAX <- "69.0233985"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.2017548"
Evaluating: 40.2017548-3.5
 Parameter: XMIN <- "36.7017548"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.8310348"
Evaluating: -31.8310348-3.5
 Parameter: YMIN <- "-35.3310348"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "65.5233985"
Evaluating: 65.5233985-3.5
 Parameter: ZMIN <- "62.0233985"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.7017548"
 Parameter: XMIN -> "36.7017548"
 Parameter: YMAX -> "-28.3310348"
 Parameter: YMIN -> "-35.3310348"
 Parameter: ZMAX -> "69.0233985"
 Parameter: ZMIN -> "62.0233985"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "147"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "147" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "147"
Evaluating: 147
 Parameter: J <- "147"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "147" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "147"
 Parameter: NPOS -> "65"
Evaluating: 147-65
 Parameter: J <- "82"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "7.37708815E-02"
Evaluating: 90.067469*(7.37708815E-02-0.5)
 Parameter: XPOS <- "-38.3893779"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.409655984"
Evaluating: 90.067469*(0.409655984-0.5)
 Parameter: YPOS <- "-8.13705686"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.44101225"
Evaluating: 143.194738*(0.44101225-0.5)+3.5172451
 Parameter: ZPOS <- "-4.92949031"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.92949031" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.92949031" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "147"
Evaluating: 147
 Parameter: J <- "147"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "147" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "147"
 Parameter: NPOS -> "65"
Evaluating: 147-65
 Parameter: J <- "82"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.3532867"
Evaluating: 90.067469*(0.3532867-0.5)
 Parameter: XPOS <- "-13.2140956"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.521276328"
Evaluating: 90.067469*(0.521276328-0.5)
 Parameter: YPOS <- "1.91630501"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.531574839"
Evaluating: 143.194738*(0.531574839-0.5)+3.5172451
 Parameter: ZPOS <- "8.0385959"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "8.0385959" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "8.0385959" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "147"
Evaluating: 147
 Parameter: J <- "147"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "147" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "147"
 Parameter: NPOS -> "65"
Evaluating: 147-65
 Parameter: J <- "82"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.103047445"
Evaluating: 90.067469*(0.103047445-0.5)
 Parameter: XPOS <- "-35.7525119"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.412546778"
Evaluating: 90.067469*(0.412546778-0.5)
 Parameter: YPOS <- "-7.87669036"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.554491022"
Evaluating: 143.194738*(0.554491022-0.5)+3.5172451
 Parameter: ZPOS <- "11.3200727"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "11.3200727" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "11.3200727" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "147"
Evaluating: 147
 Parameter: J <- "147"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "147" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "147"
 Parameter: NPOS -> "65"
Evaluating: 147-65
 Parameter: J <- "82"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "82"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.19800591"
Evaluating: 90.067469*(0.19800591-0.5)
 Parameter: XPOS <- "-27.1998433"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.273694713"
Evaluating: 90.067469*(0.273694713-0.5)
 Parameter: YPOS <- "-20.3827444"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.906501127"
Evaluating: 143.194738*(0.906501127-0.5)+3.5172451
 Parameter: ZPOS <- "61.7260675"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "61.7260675" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "61.7260675" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.1998433"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -27.1998433-0
 Parameter: XTRAN <- "-27.1998433"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.3827444"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.3827444-0
 Parameter: YTRAN <- "-20.3827444"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "61.7260675"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 61.7260675-0
 Parameter: ZTRAN <- "61.7260675"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.1998433"
 Parameter: YTRAN -> "-20.3827444"
 Parameter: ZTRAN -> "61.7260675"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -27.199843  -20.382744   61.726067
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.722170943"
Evaluating: 0.722170943*360.0
 Parameter: XPHI <- "259.981539"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.835796417"
Evaluating: 0.835796417*360.0
 Parameter: YPHI <- "300.88671"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.231151994"
Evaluating: 0.231151994*360.0
 Parameter: ZPHI <- "83.2147178"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.1998433"
 Parameter: YPOS -> "-20.3827444"
 Parameter: ZPOS -> "61.7260675"
 Parameter: XPHI -> "259.981539"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.173965   -0.984752
    0.000000    0.984752   -0.173965

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.1998433"
 Parameter: YPOS -> "-20.3827444"
 Parameter: ZPOS -> "61.7260675"
 Parameter: YPHI -> "300.88671"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.513342    0.000000    0.858184
    0.000000    1.000000    0.000000
   -0.858184    0.000000    0.513342

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   59.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.1998433"
 Parameter: YPOS -> "-20.3827444"
 Parameter: ZPOS -> "61.7260675"
 Parameter: ZPHI -> "83.2147178"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.118149    0.992996    0.000000
   -0.992996    0.118149    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   83.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.199843 XMAX =  -27.199843 XAVE =  -27.199843
    YMIN =  -20.382744 YMAX =  -20.382744 YAVE =  -20.382744
    ZMIN =   61.726067 ZMAX =   61.726067 ZAVE =   61.726067
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.1998433"
Evaluating: -27.1998433+3.5
 Parameter: XMAX <- "-23.6998433"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.3827444"
Evaluating: -20.3827444+3.5
 Parameter: YMAX <- "-16.8827444"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "61.7260675"
Evaluating: 61.7260675+3.5
 Parameter: ZMAX <- "65.2260675"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.1998433"
Evaluating: -27.1998433-3.5
 Parameter: XMIN <- "-30.6998433"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.3827444"
Evaluating: -20.3827444-3.5
 Parameter: YMIN <- "-23.8827444"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "61.7260675"
Evaluating: 61.7260675-3.5
 Parameter: ZMIN <- "58.2260675"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.6998433"
 Parameter: XMIN -> "-30.6998433"
 Parameter: YMAX -> "-16.8827444"
 Parameter: YMIN -> "-23.8827444"
 Parameter: ZMAX -> "65.2260675"
 Parameter: ZMIN -> "58.2260675"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "148"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "148" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "148"
Evaluating: 148
 Parameter: J <- "148"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "148" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "148"
 Parameter: NPOS -> "65"
Evaluating: 148-65
 Parameter: J <- "83"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.47233594"
Evaluating: 90.067469*(0.47233594-0.5)
 Parameter: XPOS <- "-2.49163187"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.608235246"
Evaluating: 90.067469*(0.608235246-0.5)
 Parameter: YPOS <- "9.74847466"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.447104174"
Evaluating: 143.194738*(0.447104174-0.5)+3.5172451
 Parameter: ZPOS <- "-4.05715885"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-4.05715885" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "-4.05715885" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "148"
Evaluating: 148
 Parameter: J <- "148"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "148" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "148"
 Parameter: NPOS -> "65"
Evaluating: 148-65
 Parameter: J <- "83"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.902179504"
Evaluating: 90.067469*(0.902179504-0.5)
 Parameter: XPOS <- "36.22329"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.884157435"
Evaluating: 90.067469*(0.884157435-0.5)
 Parameter: YPOS <- "34.6000879"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.326693341"
Evaluating: 143.194738*(0.326693341-0.5)+3.5172451
 Parameter: ZPOS <- "-21.2993565"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-21.2993565" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.22329"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 36.22329-0
 Parameter: XTRAN <- "36.22329"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.6000879"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 34.6000879-0
 Parameter: YTRAN <- "34.6000879"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.2993565"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -21.2993565-0
 Parameter: ZTRAN <- "-21.2993565"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "36.22329"
 Parameter: YTRAN -> "34.6000879"
 Parameter: ZTRAN -> "-21.2993565"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    36.223290   34.600088  -21.299356
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.971229698"
Evaluating: 0.971229698*360.0
 Parameter: XPHI <- "349.642691"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.56010239"
Evaluating: 0.56010239*360.0
 Parameter: YPHI <- "201.63686"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.906633816"
Evaluating: 0.906633816*360.0
 Parameter: ZPHI <- "326.388174"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.22329"
 Parameter: YPOS -> "34.6000879"
 Parameter: ZPOS -> "-21.2993565"
 Parameter: XPHI -> "349.642691"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.983706   -0.179786
    0.000000    0.179786    0.983706

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   10.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.22329"
 Parameter: YPOS -> "34.6000879"
 Parameter: ZPOS -> "-21.2993565"
 Parameter: YPHI -> "201.63686"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.929539    0.000000    0.368723
    0.000000    1.000000    0.000000
   -0.368723    0.000000   -0.929539

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  158.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.22329"
 Parameter: YPOS -> "34.6000879"
 Parameter: ZPOS -> "-21.2993565"
 Parameter: ZPHI -> "326.388174"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.832807   -0.553563    0.000000
    0.553563    0.832807    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   33.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.223290 XMAX =   36.223290 XAVE =   36.223290
    YMIN =   34.600088 YMAX =   34.600088 YAVE =   34.600088
    ZMIN =  -21.299356 ZMAX =  -21.299356 ZAVE =  -21.299356
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.22329"
Evaluating: 36.22329+3.5
 Parameter: XMAX <- "39.72329"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.6000879"
Evaluating: 34.6000879+3.5
 Parameter: YMAX <- "38.1000879"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.2993565"
Evaluating: -21.2993565+3.5
 Parameter: ZMAX <- "-17.7993565"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.22329"
Evaluating: 36.22329-3.5
 Parameter: XMIN <- "32.72329"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.6000879"
Evaluating: 34.6000879-3.5
 Parameter: YMIN <- "31.1000879"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.2993565"
Evaluating: -21.2993565-3.5
 Parameter: ZMIN <- "-24.7993565"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.72329"
 Parameter: XMIN -> "32.72329"
 Parameter: YMAX -> "38.1000879"
 Parameter: YMIN -> "31.1000879"
 Parameter: ZMAX -> "-17.7993565"
 Parameter: ZMIN -> "-24.7993565"
 SELRPN>      5 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      3 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35109 NEG      CLA      83       CLA     -**** MEMB     POPC     200      O14           3.1670
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "148"
Evaluating: 148
 Parameter: J <- "148"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "148" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "148"
 Parameter: NPOS -> "65"
Evaluating: 148-65
 Parameter: J <- "83"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "83"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "2.789323219E-02"
Evaluating: 90.067469*(2.789323219E-02-0.5)
 Parameter: XPOS <- "-42.5214617"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.52540896"
Evaluating: 90.067469*(0.52540896-0.5)
 Parameter: YPOS <- "2.28852072"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.808883295"
Evaluating: 143.194738*(0.808883295-0.5)+3.5172451
 Parameter: ZPOS <- "47.7477076"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "47.7477076" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "47.7477076" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.223290 XMAX =   36.223290 XAVE =   36.223290
    YMIN =   34.600088 YMAX =   34.600088 YAVE =   34.600088
    ZMIN =  -21.299356 ZMAX =  -21.299356 ZAVE =  -21.299356
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-42.5214617"
 RDCMND substituted energy or value "?XAVE" to "36.22329"
Evaluating: -42.5214617-36.22329
 Parameter: XTRAN <- "-78.7447517"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "2.28852072"
 RDCMND substituted energy or value "?YAVE" to "34.6000879"
Evaluating: 2.28852072-34.6000879
 Parameter: YTRAN <- "-32.3115672"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "47.7477076"
 RDCMND substituted energy or value "?ZAVE" to "-21.2993565"
Evaluating: 47.7477076--21.2993565
 Parameter: ZTRAN <- "69.0470641"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-78.7447517"
 Parameter: YTRAN -> "-32.3115672"
 Parameter: ZTRAN -> "69.0470641"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -78.744752  -32.311567   69.047064
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.132013012"
Evaluating: 0.132013012*360.0
 Parameter: XPHI <- "47.5246843"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.536378674"
Evaluating: 0.536378674*360.0
 Parameter: YPHI <- "193.096323"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.502712831"
Evaluating: 0.502712831*360.0
 Parameter: ZPHI <- "180.976619"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-42.5214617"
 Parameter: YPOS -> "2.28852072"
 Parameter: ZPOS -> "47.7477076"
 Parameter: XPHI -> "47.5246843"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.675273    0.737568
    0.000000   -0.737568    0.675273

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   47.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-42.5214617"
 Parameter: YPOS -> "2.28852072"
 Parameter: ZPOS -> "47.7477076"
 Parameter: YPHI -> "193.096323"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.973991    0.000000    0.226589
    0.000000    1.000000    0.000000
   -0.226589    0.000000   -0.973991

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-42.5214617"
 Parameter: YPOS -> "2.28852072"
 Parameter: ZPOS -> "47.7477076"
 Parameter: ZPHI -> "180.976619"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.999855   -0.017044    0.000000
    0.017044   -0.999855    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  179.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -42.521462 XMAX =  -42.521462 XAVE =  -42.521462
    YMIN =    2.288521 YMAX =    2.288521 YAVE =    2.288521
    ZMIN =   47.747708 ZMAX =   47.747708 ZAVE =   47.747708
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-42.5214617"
Evaluating: -42.5214617+3.5
 Parameter: XMAX <- "-39.0214617"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "2.28852073"
Evaluating: 2.28852073+3.5
 Parameter: YMAX <- "5.78852073"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "47.7477076"
Evaluating: 47.7477076+3.5
 Parameter: ZMAX <- "51.2477076"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-42.5214617"
Evaluating: -42.5214617-3.5
 Parameter: XMIN <- "-46.0214617"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "2.28852073"
Evaluating: 2.28852073-3.5
 Parameter: YMIN <- "-1.21147927"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "47.7477076"
Evaluating: 47.7477076-3.5
 Parameter: ZMIN <- "44.2477076"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-39.0214617"
 Parameter: XMIN -> "-46.0214617"
 Parameter: YMAX -> "5.78852073"
 Parameter: YMIN -> "-1.21147927"
 Parameter: ZMAX -> "51.2477076"
 Parameter: ZMIN -> "44.2477076"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "149"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "149" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "149"
Evaluating: 149
 Parameter: J <- "149"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "149" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "149"
 Parameter: NPOS -> "65"
Evaluating: 149-65
 Parameter: J <- "84"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "84"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.627528986"
Evaluating: 90.067469*(0.627528986-0.5)
 Parameter: XPOS <- "11.486213"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.999094608"
Evaluating: 90.067469*(0.999094608-0.5)
 Parameter: YPOS <- "44.9521881"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.85665852"
Evaluating: 143.194738*(0.85665852-0.5)+3.5172451
 Parameter: ZPOS <- "54.5888684"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "54.5888684" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "54.5888684" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.486213"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: 11.486213-0
 Parameter: XTRAN <- "11.486213"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "44.9521881"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 44.9521881-0
 Parameter: YTRAN <- "44.9521881"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "54.5888684"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 54.5888684-0
 Parameter: ZTRAN <- "54.5888684"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "11.486213"
 Parameter: YTRAN -> "44.9521881"
 Parameter: ZTRAN -> "54.5888684"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    11.486213   44.952188   54.588868
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.822731137"
Evaluating: 0.822731137*360.0
 Parameter: XPHI <- "296.183209"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126738055"
Evaluating: 0.126738055*360.0
 Parameter: YPHI <- "45.6256998"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.736008884"
Evaluating: 0.736008884*360.0
 Parameter: ZPHI <- "264.963198"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.486213"
 Parameter: YPOS -> "44.9521881"
 Parameter: ZPOS -> "54.5888684"
 Parameter: XPHI -> "296.183209"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.441243   -0.897388
    0.000000    0.897388    0.441243

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   63.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.486213"
 Parameter: YPOS -> "44.9521881"
 Parameter: ZPOS -> "54.5888684"
 Parameter: YPHI -> "45.6256998"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.699343    0.000000   -0.714786
    0.000000    1.000000    0.000000
    0.714786    0.000000    0.699343

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   45.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.486213"
 Parameter: YPOS -> "44.9521881"
 Parameter: ZPOS -> "54.5888684"
 Parameter: ZPHI -> "264.963198"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.087796   -0.996139    0.000000
    0.996139   -0.087796    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   95.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.486213 XMAX =   11.486213 XAVE =   11.486213
    YMIN =   44.952188 YMAX =   44.952188 YAVE =   44.952188
    ZMIN =   54.588868 ZMAX =   54.588868 ZAVE =   54.588868
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.486213"
Evaluating: 11.486213+3.5
 Parameter: XMAX <- "14.986213"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "44.9521881"
Evaluating: 44.9521881+3.5
 Parameter: YMAX <- "48.4521881"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "54.5888684"
Evaluating: 54.5888684+3.5
 Parameter: ZMAX <- "58.0888684"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.486213"
Evaluating: 11.486213-3.5
 Parameter: XMIN <- "7.986213"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "44.9521881"
Evaluating: 44.9521881-3.5
 Parameter: YMIN <- "41.4521881"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "54.5888684"
Evaluating: 54.5888684-3.5
 Parameter: ZMIN <- "51.0888684"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.986213"
 Parameter: XMIN -> "7.986213"
 Parameter: YMAX -> "48.4521881"
 Parameter: YMIN -> "41.4521881"
 Parameter: ZMAX -> "58.0888684"
 Parameter: ZMIN -> "51.0888684"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "150"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "150" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "150"
Evaluating: 150
 Parameter: J <- "150"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "150" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "150"
 Parameter: NPOS -> "65"
Evaluating: 150-65
 Parameter: J <- "85"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "85"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.206207971"
Evaluating: 90.067469*(0.206207971-0.5)
 Parameter: XPOS <- "-26.4611045"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.267662208"
Evaluating: 90.067469*(0.267662208-0.5)
 Parameter: YPOS <- "-20.9260769"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.35150959"
Evaluating: 143.194738*(0.35150959-0.5)+3.5172451
 Parameter: ZPOS <- "-17.7458003"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-17.7458003" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.4611045"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -26.4611045-0
 Parameter: XTRAN <- "-26.4611045"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.9260769"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -20.9260769-0
 Parameter: YTRAN <- "-20.9260769"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.7458003"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -17.7458003-0
 Parameter: ZTRAN <- "-17.7458003"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-26.4611045"
 Parameter: YTRAN -> "-20.9260769"
 Parameter: ZTRAN -> "-17.7458003"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -26.461105  -20.926077  -17.745800
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.653247301E-02"
Evaluating: 2.653247301E-02*360.0
 Parameter: XPHI <- "9.55169028"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.538561246"
Evaluating: 0.538561246*360.0
 Parameter: YPHI <- "193.882049"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.985274874"
Evaluating: 0.985274874*360.0
 Parameter: ZPHI <- "354.698955"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.4611045"
 Parameter: YPOS -> "-20.9260769"
 Parameter: ZPOS -> "-17.7458003"
 Parameter: XPHI -> "9.55169028"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.986136    0.165937
    0.000000   -0.165937    0.986136

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    9.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.4611045"
 Parameter: YPOS -> "-20.9260769"
 Parameter: ZPOS -> "-17.7458003"
 Parameter: YPHI -> "193.882049"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.970792    0.000000    0.239924
    0.000000    1.000000    0.000000
   -0.239924    0.000000   -0.970792

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  166.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.4611045"
 Parameter: YPOS -> "-20.9260769"
 Parameter: ZPOS -> "-17.7458003"
 Parameter: ZPHI -> "354.698955"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.995723   -0.092389    0.000000
    0.092389    0.995723    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    5.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.461105 XMAX =  -26.461105 XAVE =  -26.461105
    YMIN =  -20.926077 YMAX =  -20.926077 YAVE =  -20.926077
    ZMIN =  -17.745800 ZMAX =  -17.745800 ZAVE =  -17.745800
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.4611045"
Evaluating: -26.4611045+3.5
 Parameter: XMAX <- "-22.9611045"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.9260769"
Evaluating: -20.9260769+3.5
 Parameter: YMAX <- "-17.4260769"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.7458003"
Evaluating: -17.7458003+3.5
 Parameter: ZMAX <- "-14.2458003"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.4611045"
Evaluating: -26.4611045-3.5
 Parameter: XMIN <- "-29.9611045"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.9260769"
Evaluating: -20.9260769-3.5
 Parameter: YMIN <- "-24.4260769"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.7458003"
Evaluating: -17.7458003-3.5
 Parameter: ZMIN <- "-21.2458003"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-22.9611045"
 Parameter: XMIN -> "-29.9611045"
 Parameter: YMAX -> "-17.4260769"
 Parameter: YMIN -> "-24.4260769"
 Parameter: ZMAX -> "-14.2458003"
 Parameter: ZMIN -> "-21.2458003"
 SELRPN>     29 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>     16 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     133      N             2.9290
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     133      C12           2.9003
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     133      C13           2.1738
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     133      C14           3.5238
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     133      C11           2.6455
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     133      P             1.6331
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     133      O13           2.0117
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     133      O14           2.0500
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     133      O12           1.6919
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     133      O11           3.1218
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     165      C3            3.5657
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     165      O31           3.3503
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     165      C31           3.4376
35111 NEG      CLA      85       CLA     -**** MEMB     POPC     165      O32           3.5576
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        14
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "14"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "150"
Evaluating: 150
 Parameter: J <- "150"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "150" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "150"
 Parameter: NPOS -> "65"
Evaluating: 150-65
 Parameter: J <- "85"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "85"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "3.579358947E-05"
Evaluating: 90.067469*(3.579358947E-05-0.5)
 Parameter: XPOS <- "-45.0305107"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.933525629"
Evaluating: 90.067469*(0.933525629-0.5)
 Parameter: YPOS <- "39.0465562"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.974121931"
Evaluating: 143.194738*(0.974121931-0.5)+3.5172451
 Parameter: ZPOS <- "71.4090108"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "71.4090108" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "71.4090108" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.461105 XMAX =  -26.461105 XAVE =  -26.461105
    YMIN =  -20.926077 YMAX =  -20.926077 YAVE =  -20.926077
    ZMIN =  -17.745800 ZMAX =  -17.745800 ZAVE =  -17.745800
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-45.0305107"
 RDCMND substituted energy or value "?XAVE" to "-26.4611045"
Evaluating: -45.0305107--26.4611045
 Parameter: XTRAN <- "-18.5694062"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.0465562"
 RDCMND substituted energy or value "?YAVE" to "-20.9260769"
Evaluating: 39.0465562--20.9260769
 Parameter: YTRAN <- "59.9726331"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "71.4090108"
 RDCMND substituted energy or value "?ZAVE" to "-17.7458003"
Evaluating: 71.4090108--17.7458003
 Parameter: ZTRAN <- "89.1548111"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.5694062"
 Parameter: YTRAN -> "59.9726331"
 Parameter: ZTRAN -> "89.1548111"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -18.569406   59.972633   89.154811
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.473236549"
Evaluating: 0.473236549*360.0
 Parameter: XPHI <- "170.365158"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.575330338"
Evaluating: 0.575330338*360.0
 Parameter: YPHI <- "207.118922"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.686222966"
Evaluating: 0.686222966*360.0
 Parameter: ZPHI <- "247.040268"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-45.0305107"
 Parameter: YPOS -> "39.0465562"
 Parameter: ZPOS -> "71.4090108"
 Parameter: XPHI -> "170.365158"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.985894    0.167368
    0.000000   -0.167368   -0.985894

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  170.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-45.0305107"
 Parameter: YPOS -> "39.0465562"
 Parameter: ZPOS -> "71.4090108"
 Parameter: YPHI -> "207.118922"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.890062    0.000000    0.455839
    0.000000    1.000000    0.000000
   -0.455839    0.000000   -0.890062

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  152.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-45.0305107"
 Parameter: YPOS -> "39.0465562"
 Parameter: ZPOS -> "71.4090108"
 Parameter: ZPHI -> "247.040268"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.390084   -0.920779    0.000000
    0.920779   -0.390084    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  112.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -45.030511 XMAX =  -45.030511 XAVE =  -45.030511
    YMIN =   39.046556 YMAX =   39.046556 YAVE =   39.046556
    ZMIN =   71.409011 ZMAX =   71.409011 ZAVE =   71.409011
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-45.0305107"
Evaluating: -45.0305107+3.5
 Parameter: XMAX <- "-41.5305107"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.0465562"
Evaluating: 39.0465562+3.5
 Parameter: YMAX <- "42.5465562"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "71.4090108"
Evaluating: 71.4090108+3.5
 Parameter: ZMAX <- "74.9090108"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-45.0305107"
Evaluating: -45.0305107-3.5
 Parameter: XMIN <- "-48.5305107"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.0465562"
Evaluating: 39.0465562-3.5
 Parameter: YMIN <- "35.5465562"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "71.4090108"
Evaluating: 71.4090108-3.5
 Parameter: ZMIN <- "67.9090108"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-41.5305107"
 Parameter: XMIN -> "-48.5305107"
 Parameter: YMAX -> "42.5465562"
 Parameter: YMIN -> "35.5465562"
 Parameter: ZMAX -> "74.9090108"
 Parameter: ZMIN -> "67.9090108"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "151"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "151" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "151"
Evaluating: 151
 Parameter: J <- "151"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "151" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "151"
 Parameter: NPOS -> "65"
Evaluating: 151-65
 Parameter: J <- "86"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "86"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "7.707050967E-02"
Evaluating: 90.067469*(7.707050967E-02-0.5)
 Parameter: XPOS <- "-38.0921888"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "3.166494352E-02"
Evaluating: 90.067469*(3.166494352E-02-0.5)
 Parameter: YPOS <- "-42.1817532"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "8.357911506E-02"
Evaluating: 143.194738*(8.357911506E-02-0.5)+3.5172451
 Parameter: ZPOS <- "-56.1120344"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-56.1120344" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.0921888"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.0921888-0
 Parameter: XTRAN <- "-38.0921888"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-42.1817532"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -42.1817532-0
 Parameter: YTRAN <- "-42.1817532"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-56.1120344"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -56.1120344-0
 Parameter: ZTRAN <- "-56.1120344"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.0921888"
 Parameter: YTRAN -> "-42.1817532"
 Parameter: ZTRAN -> "-56.1120344"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -38.092189  -42.181753  -56.112034
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.445225571"
Evaluating: 0.445225571*360.0
 Parameter: XPHI <- "160.281206"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.497846631"
Evaluating: 0.497846631*360.0
 Parameter: YPHI <- "179.224787"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.987517116"
Evaluating: 0.987517116*360.0
 Parameter: ZPHI <- "355.506162"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.0921888"
 Parameter: YPOS -> "-42.1817532"
 Parameter: ZPOS -> "-56.1120344"
 Parameter: XPHI -> "160.281206"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.941360    0.337404
    0.000000   -0.337404   -0.941360

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  160.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.0921888"
 Parameter: YPOS -> "-42.1817532"
 Parameter: ZPOS -> "-56.1120344"
 Parameter: YPHI -> "179.224787"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.999908    0.000000   -0.013530
    0.000000    1.000000    0.000000
    0.013530    0.000000   -0.999908

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  179.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.0921888"
 Parameter: YPOS -> "-42.1817532"
 Parameter: ZPOS -> "-56.1120344"
 Parameter: ZPHI -> "355.506162"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.996926   -0.078352    0.000000
    0.078352    0.996926    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    4.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.092189 XMAX =  -38.092189 XAVE =  -38.092189
    YMIN =  -42.181753 YMAX =  -42.181753 YAVE =  -42.181753
    ZMIN =  -56.112034 ZMAX =  -56.112034 ZAVE =  -56.112034
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.0921888"
Evaluating: -38.0921888+3.5
 Parameter: XMAX <- "-34.5921888"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-42.1817532"
Evaluating: -42.1817532+3.5
 Parameter: YMAX <- "-38.6817532"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-56.1120344"
Evaluating: -56.1120344+3.5
 Parameter: ZMAX <- "-52.6120344"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.0921888"
Evaluating: -38.0921888-3.5
 Parameter: XMIN <- "-41.5921888"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-42.1817532"
Evaluating: -42.1817532-3.5
 Parameter: YMIN <- "-45.6817532"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-56.1120344"
Evaluating: -56.1120344-3.5
 Parameter: ZMIN <- "-59.6120344"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.5921888"
 Parameter: XMIN -> "-41.5921888"
 Parameter: YMAX -> "-38.6817532"
 Parameter: YMIN -> "-45.6817532"
 Parameter: ZMAX -> "-52.6120344"
 Parameter: ZMIN -> "-59.6120344"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "152"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "152" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "152"
Evaluating: 152
 Parameter: J <- "152"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "152" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "152"
 Parameter: NPOS -> "65"
Evaluating: 152-65
 Parameter: J <- "87"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "87"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.397755964"
Evaluating: 90.067469*(0.397755964-0.5)
 Parameter: XPOS <- "-9.20886154"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.695411949"
Evaluating: 90.067469*(0.695411949-0.5)
 Parameter: YPOS <- "17.6002597"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.246695398"
Evaluating: 143.194738*(0.246695398-0.5)+3.5172451
 Parameter: ZPOS <- "-32.754641"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "-32.754641" and "-15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-9.20886154"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -9.20886154-0
 Parameter: XTRAN <- "-9.20886154"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.6002597"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: 17.6002597-0
 Parameter: YTRAN <- "17.6002597"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.754641"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: -32.754641-0
 Parameter: ZTRAN <- "-32.754641"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.20886154"
 Parameter: YTRAN -> "17.6002597"
 Parameter: ZTRAN -> "-32.754641"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR    -9.208862   17.600260  -32.754641
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.537739727"
Evaluating: 0.537739727*360.0
 Parameter: XPHI <- "193.586302"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.243988151"
Evaluating: 0.243988151*360.0
 Parameter: YPHI <- "87.8357344"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.481008517"
Evaluating: 0.481008517*360.0
 Parameter: ZPHI <- "173.163066"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-9.20886154"
 Parameter: YPOS -> "17.6002597"
 Parameter: ZPOS -> "-32.754641"
 Parameter: XPHI -> "193.586302"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.972017   -0.234910
    0.000000    0.234910   -0.972017

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  166.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-9.20886154"
 Parameter: YPOS -> "17.6002597"
 Parameter: ZPOS -> "-32.754641"
 Parameter: YPHI -> "87.8357344"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.037765    0.000000   -0.999287
    0.000000    1.000000    0.000000
    0.999287    0.000000    0.037765

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   87.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-9.20886154"
 Parameter: YPOS -> "17.6002597"
 Parameter: ZPOS -> "-32.754641"
 Parameter: ZPHI -> "173.163066"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
   -0.992889    0.119044    0.000000
   -0.119044   -0.992889    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  173.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -9.208862 XMAX =   -9.208862 XAVE =   -9.208862
    YMIN =   17.600260 YMAX =   17.600260 YAVE =   17.600260
    ZMIN =  -32.754641 ZMAX =  -32.754641 ZAVE =  -32.754641
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-9.20886154"
Evaluating: -9.20886154+3.5
 Parameter: XMAX <- "-5.70886154"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.6002597"
Evaluating: 17.6002597+3.5
 Parameter: YMAX <- "21.1002597"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.754641"
Evaluating: -32.754641+3.5
 Parameter: ZMAX <- "-29.254641"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-9.20886154"
Evaluating: -9.20886154-3.5
 Parameter: XMIN <- "-12.7088615"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.6002597"
Evaluating: 17.6002597-3.5
 Parameter: YMIN <- "14.1002597"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.754641"
Evaluating: -32.754641-3.5
 Parameter: ZMIN <- "-36.254641"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.70886154"
 Parameter: XMIN -> "-12.7088615"
 Parameter: YMAX -> "21.1002597"
 Parameter: YMIN -> "14.1002597"
 Parameter: ZMAX -> "-29.254641"
 Parameter: ZMIN -> "-36.254641"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "153"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "153" and "153".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "153"
Evaluating: 153
 Parameter: J <- "153"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "153" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "153"
 Parameter: NPOS -> "65"
Evaluating: 153-65
 Parameter: J <- "88"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "88"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.244071829"
Evaluating: 90.067469*(0.244071829-0.5)
 Parameter: XPOS <- "-23.0508026"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "0.984520109"
Evaluating: 90.067469*(0.984520109-0.5)
 Parameter: YPOS <- "43.6394999"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.500307946"
Evaluating: 143.194738*(0.500307946-0.5)+3.5172451
 Parameter: ZPOS <- "3.56134135"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "3.56134135" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "3.56134135" and "15".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. 100 stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "153"
Evaluating: 153
 Parameter: J <- "153"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "65"
 Comparing "153" and "65".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "153"
 Parameter: NPOS -> "65"
Evaluating: 153-65
 Parameter: J <- "88"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "88"
 SELRPN>      1 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            calc xpos = @A * ( ?random - 0.5 )
 Parameter: A -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "7.178380976E-02"
Evaluating: 90.067469*(7.178380976E-02-0.5)
 Parameter: XPOS <- "-38.5683484"
  
 CHARMM>            calc ypos = @B * ( ?random - 0.5 )
 Parameter: B -> "90.067469"
 RDCMND substituted energy or value "?RANDOM" to "7.105974413E-02"
Evaluating: 90.067469*(7.105974413E-02-0.5)
 Parameter: YPOS <- "-38.6335632"
  
 CHARMM>            calc zpos = @C * ( ?random - 0.5 ) + @zcen
 Parameter: C -> "143.194738"
 Parameter: ZCEN -> "3.5172451"
 RDCMND substituted energy or value "?RANDOM" to "0.824681929"
Evaluating: 143.194738*(0.824681929-0.5)+3.5172451
 Parameter: ZPOS <- "50.0099889"
  
 CHARMM>     
  
 CHARMM>            if zpos .gt. -15 if zpos .lt. 15 goto doinit
 Comparing "50.0099889" and "-15".
 IF test evaluated as true.  Performing command
 Comparing "50.0099889" and "15".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.000000 XMAX =    0.000000 XAVE =    0.000000
    YMIN =    0.000000 YMAX =    0.000000 YAVE =    0.000000
    ZMIN =    0.000000 ZMAX =    0.000000 ZAVE =    0.000000
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.5683484"
 RDCMND substituted energy or value "?XAVE" to "0"
Evaluating: -38.5683484-0
 Parameter: XTRAN <- "-38.5683484"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-38.6335632"
 RDCMND substituted energy or value "?YAVE" to "0"
Evaluating: -38.6335632-0
 Parameter: YTRAN <- "-38.6335632"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "50.0099889"
 RDCMND substituted energy or value "?ZAVE" to "0"
Evaluating: 50.0099889-0
 Parameter: ZTRAN <- "50.0099889"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.5683484"
 Parameter: YTRAN -> "-38.6335632"
 Parameter: ZTRAN -> "50.0099889"
 SELRPN>      1 atoms have been selected out of  35114
 TRANSLATION VECTOR   -38.568348  -38.633563   50.009989
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.75824293"
Evaluating: 0.75824293*360.0
 Parameter: XPHI <- "272.967455"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.92352673E-02"
Evaluating: 1.92352673E-02*360.0
 Parameter: YPHI <- "6.92469623"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.847986172"
Evaluating: 0.847986172*360.0
 Parameter: ZPHI <- "305.275022"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.5683484"
 Parameter: YPOS -> "-38.6335632"
 Parameter: ZPOS -> "50.0099889"
 Parameter: XPHI -> "272.967455"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.051769   -0.998659
    0.000000    0.998659    0.051769

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   87.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.5683484"
 Parameter: YPOS -> "-38.6335632"
 Parameter: ZPOS -> "50.0099889"
 Parameter: YPHI -> "6.92469623"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.992705    0.000000   -0.120565
    0.000000    1.000000    0.000000
    0.120565    0.000000    0.992705

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    6.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.5683484"
 Parameter: YPOS -> "-38.6335632"
 Parameter: ZPOS -> "50.0099889"
 Parameter: ZPHI -> "305.275022"
 SELRPN>      1 atoms have been selected out of  35114
 ROTATION MATRIX
    0.577502   -0.816389    0.000000
    0.816389    0.577502    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   54.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>     
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of  35114
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.568348 XMAX =  -38.568348 XAVE =  -38.568348
    YMIN =  -38.633563 YMAX =  -38.633563 YAVE =  -38.633563
    ZMIN =   50.009989 ZMAX =   50.009989 ZAVE =   50.009989
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.5683484"
Evaluating: -38.5683484+3.5
 Parameter: XMAX <- "-35.0683484"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-38.6335632"
Evaluating: -38.6335632+3.5
 Parameter: YMAX <- "-35.1335632"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "50.0099889"
Evaluating: 50.0099889+3.5
 Parameter: ZMAX <- "53.5099889"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.5683484"
Evaluating: -38.5683484-3.5
 Parameter: XMIN <- "-42.0683484"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-38.6335632"
Evaluating: -38.6335632-3.5
 Parameter: YMIN <- "-42.1335632"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "50.0099889"
Evaluating: 50.0099889-3.5
 Parameter: ZMIN <- "46.5099889"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.0683484"
 Parameter: XMIN -> "-42.0683484"
 Parameter: YMAX -> "-35.1335632"
 Parameter: YMIN -> "-42.1335632"
 Parameter: ZMAX -> "53.5099889"
 Parameter: ZMIN -> "46.5099889"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to protein
  
 CHARMM>            define XXX sele PROT end
 SELRPN>   7759 atoms have been selected out of  35114
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7759"
 Comparing "7759" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>                coor dist cut 10.0 sele target end -
 CHARMM>                                   sele PROT .and. JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>                if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor dist cut 4.0 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  48496
 SELRPN>      0 atoms have been selected out of  48496

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>            if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "154"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "153"
 Comparing "154" and "153".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @pos end
 Parameter: POS -> "SOD"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "65"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele ( segid IONS .or. LPSION ) .and. resname @neg end
 Parameter: NEG -> "CLA"
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "88"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     65 atoms have been selected out of  35114
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "34962"
 Parameter: POSAT <- "34962"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     88 atoms have been selected out of  35114
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "35027"
 Parameter: NEGAT <- "35027"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "35027" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            if posat .gt. @negat then
 Parameter: NEGAT -> "35027"
 Comparing "34962" and "35027".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        label skipreorder
  
 CHARMM>     
  
 CHARMM>        ! update LPS selection
  
 CHARMM>        define LPSION sele segid LION .or. segid CION .or. segid OION end
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of  35114
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>     65 atoms have been selected out of  35114
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "65"
 Parameter: NPOSATOMS <- "65"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>     88 atoms have been selected out of  35114
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "88"
 Parameter: NNEGATOMS <- "88"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>     65 atoms have been selected out of  35114
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>     65 atoms have been selected out of  35114
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "65"
 Parameter: NIONATOMS <- "65"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "65" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "88" and "0".
 IF test evaluated as true.  Performing command
 SEGMENTS "IONS    " AND "NEG     " HAVE BEEN JOINED.
 THE RESIDUE IDENTIFIERS HAVE BEEN RENUMBERED
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =      842
         Number of atoms         =    35114   Number of groups     =     9364
         Number of bonds         =    34850   Number of angles     =    66197
         Number of dihedrals     =    93181   Number of impropers  =     1661
         Number of cross-terms   =      484
         Number of HB acceptors  =      699   Number of HB donors  =      889
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step4.3_ion_protmemb.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step4.3_ion_protmemb.crd::
 OPNLGU> Unit 10 opened for READONLY access to step4.3_ion_protmemb.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON FEB, 24. 2022. JOB
 TITLE> * GENERATES ION CONFORMATION USING MONTE-CARLO SIMULATION
 TITLE> *  DATE:     2/24/22      9:47: 2      CREATED BY USER: APACHE
 TITLE> *

 ** WARNING ** Coordinates were overwritten for 34961 atoms.
 *** LEVEL  2 WARNING *** BOMLEV IS    0
  
 CHARMM>     
  
 CHARMM>    write coor pdb name step4.3_ion.pdb
 VOPEN> Attempting to open::step4.3_ion.pdb::
 RDTITL>  
 RDTITL> No title read.
  Write CHARMM-pdb format
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-7.105427358E-13"
Evaluating: -7.105427358E-13
 Parameter: CGTOTINIT <- "-7.105427358E-13"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-7.105427358E-13"
Evaluating: INT(-7.105427358E-13)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "-7.105427358E-13"
Evaluating: ABS(0--7.105427358E-13)
 Parameter: CGDIFF <- "7.105427358E-13"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "7.105427358E-13" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    delete atom sele .not. ( segid IONS ) end
 SELRPN>  34961 atoms have been selected out of  35114

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:        689 residues deleted.

 Message from MAPIC:          2 segments deleted.
 DELTIC:     34850 bonds deleted
 DELTIC:     66197 angles deleted
 DELTIC:     93181 dihedrals deleted
 DELTIC:      1661 improper dihedrals deleted
 DELTIC:       484 crossterm maps deleted
 DELTIC:       889 donors deleted
 DELTIC:       699 acceptors deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      153
         Number of atoms         =      153   Number of groups     =      153
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =  -23.00000
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step4.3_ion.psf
 VOPEN> Attempting to open::step4.3_ion.psf::
 RDTITL> WRITE COOR CARD NAME STEP4.3_ION.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step4.3_ion.crd
 VOPEN> Attempting to open::step4.3_ion.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    write title card name step4.3_ion.str
 VOPEN> Attempting to open::step4.3_ion.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 65
 RDTITL> * SET NNEGTOT = 88
 RDTITL> * SET NIONTOT = 153
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   10 with status "KEEP"
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                     17.55 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    MOST SEVERE WARNING WAS AT LEVEL  1

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:    17.56  SECONDS 
                         CPU TIME:    17.45  SECONDS 
